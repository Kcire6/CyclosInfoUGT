!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,i=!1,r=void 0;try{for(var c,o=e[Symbol.iterator]();!(a=(c=o.next()).done)&&(n.push(c.value),!t||n.length!==t);a=!0);}catch(l){i=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw r}}return n}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw c}}}}function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function r(e,t,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return f(this,n)}}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{oBd1:function(a,i,o){"use strict";o.r(i),o.d(i,"BankingModule",(function(){return Vd}));var u=o("XDzf"),f=o("VeBv"),m=o("t+Rn"),g=o("rCAV"),p=o("v4xg"),h=o("ObUu"),y=o("QH++"),v=o("2Vo4"),x=o("vkgz"),P=o("8Y7J"),D=o("3qho"),k=o("SVse"),L=o("I0FJ"),w=o("Zilp"),C=o("IbGL"),Q=o("Ae/X"),I=o("s7LF"),F=o("JFlR"),T=o("Ls5z"),S=o("WYBn"),O=o("chz4"),N=o("4APx"),B=o("6g1M"),A=o("iXUt"),E=o("DIHi"),$=o("JbOn"),R=o("Aw04"),Z=o("qCwG"),M=o("I9hm");function H(e,t){1&e&&P.Lb(0,"hr",7)}function q(e,t){if(1&e&&(P.Qb(0,"div",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.Fc(" ",n.account.type.name," ")}}function U(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",9),P.Dc(2),P.Pb(),P.Qb(3,"div",10),P.Lb(4,"user-link",11),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.Fc(" ",n.i18n.general.user," "),P.xb(2),P.gc("user",n.account.user)}}function V(e,t){1&e&&P.Lb(0,"hr")}function j(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.ac(2,"currency"),P.Nb()),2&e){var n=P.Zb().$implicit,a=P.Zb(2);P.xb(1),P.Fc(" ",P.cc(2,1,n.amount,a.currency)," ")}}var z=function(e,t,n){return{negative:e,positive:t,"status-value-last":n}};function G(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",12),P.Qb(2,"span",13),P.Dc(3),P.Pb(),P.Pb(),P.Qb(4,"div",14),P.Bc(5,j,3,4,"ng-container",5),P.Pb(),P.Nb()),2&e){var n=t.$implicit,a=t.last,i=P.Zb(2);P.xb(1),P.gc("ngClass",a?"status-label-last":""),P.xb(2),P.Ec(n.label),P.xb(1),P.gc("ngClass",P.lc(4,z,n.alwaysNegative||i.format.isNegative(n.amount),!n.alwaysNegative&&i.format.isPositive(n.amount),a)),P.xb(1),P.gc("ngIf",n.amount)}}function _(e,t){if(1&e&&(P.Qb(0,"div",1),P.Bc(1,H,1,0,"hr",2),P.Qb(2,"div",3),P.Bc(3,q,2,1,"div",4),P.Bc(4,U,5,2,"ng-container",5),P.Bc(5,V,1,0,"hr",5),P.Bc(6,G,6,8,"ng-container",6),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.xb(1),P.gc("ngIf",n.showSeparator),P.xb(2),P.gc("ngIf",n.showAccount),P.xb(1),P.gc("ngIf",n.account.user&&n.showUser),P.xb(1),P.gc("ngIf",n.showAccount||n.account.user&&n.showUser),P.xb(1),P.gc("ngForOf",n.indicators$.value)}}var K,X=((K=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).mode="current",a._showAccount=!1,a._showUser=!1,a._showSeparator=!1,a.indicators$=new v.a(null),a}return l(n,[{key:"ngOnInit",value:function(){this.updateIndicators()}},{key:"updateIndicators",value:function(){var e=this,t=[],n=this.status,a=function(n,a){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&t.push({label:a,amount:n,alwaysNegative:!e.format.isZero(n)&&i})};if("current"===this.mode)a(n.balance,this.i18n.account.balance),n.availableBalance!==n.balance&&a(n.availableBalance,this.i18n.account.availableBalance),n.reservedAmount&&!this.format.isZero(n.reservedAmount)&&a(n.reservedAmount,this.i18n.account.reservedAmount,!0),n.creditLimit&&!this.format.isZero(n.creditLimit)&&a(n.creditLimit,this.i18n.account.negativeLimit),n.upperCreditLimit&&!this.format.isZero(n.upperCreditLimit)&&a(n.upperCreditLimit,this.i18n.account.positiveLimit);else{if(this.layout.gtxxs&&null!=n.balanceAtBegin&&a(n.balanceAtBegin,this.i18n.account.balanceOn(this.format.formatAsDate(n.beginDate))),this.layout.gtxxs&&null!=n.balanceAtEnd&&a(n.balanceAtEnd,this.i18n.account.balanceOn(this.format.formatAsDate(n.endDate))),null!=n.incoming&&n.incoming.sum&&a(n.incoming.sum,this.i18n.account.totalIncome),null!=n.outgoing&&n.outgoing.sum){var i=n.outgoing.sum;this.format.isZero(i)||(i="-"+i),a(i,this.i18n.account.totalOutflow)}null!=n.netInflow&&a(n.netInflow,this.i18n.account.netInflow)}this.indicators$.next(t)}},{key:"ngOnChanges",value:function(e){(e.mode||e.account||e.showAccount)&&this.updateIndicators()}},{key:"showAccount",get:function(){return this._showAccount},set:function(e){this._showAccount=Object(h.E)(e)}},{key:"showUser",get:function(){return this._showUser},set:function(e){this._showUser=Object(h.E)(e)}},{key:"showSeparator",get:function(){return this._showSeparator},set:function(e){this._showSeparator=Object(h.E)(e)}},{key:"status",get:function(){return this.account.status}},{key:"currency",get:function(){return this.account.currency}}]),n}(Z.a)).\u0275fac=function(e){return new(e||K)(P.Kb(P.r))},K.\u0275cmp=P.Eb({type:K,selectors:[["account-status-view"]],inputs:{account:"account",mode:"mode",showAccount:"showAccount",showUser:"showUser",showSeparator:"showSeparator"},features:[P.ub,P.vb],decls:2,vars:3,consts:[["class","container mw-100 px-0",4,"ngIf"],[1,"container","mw-100","px-0"],["class","mt-0",4,"ngIf"],[1,"row","no-gutters"],["class","status-label col-12",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"mt-0"],[1,"status-label","col-12"],[1,"status-label","col-6","col-md-3","mb-0"],[1,"status-label","col-6","col-md-9","mb-0"],[3,"user"],[1,"status-label","col-6","col-sm-3",3,"ngClass"],[1,"ellipsis"],[1,"status-value","col-6","col-sm-3",3,"ngClass"]],template:function(e,t){var n;1&e&&(P.Bc(0,_,7,5,"div",0),P.ac(1,"async")),2&e&&P.gc("ngIf",(null==(n=P.bc(1,1,t.indicators$))?null:n.length)>0)},directives:[k.t,k.s,T.a,k.q],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),K),Y=o("oj/z"),W=o("iM3x"),J=o("sifq"),ee=o("iInd"),te=o("yL40");function ne(e,t){1&e&&P.Mb(0)}function ae(e,t){1&e&&P.Lb(0,"div",15)}function ie(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",15),P.Qb(2,"label-value",16),P.Lb(3,"user-link",17),P.Pb(),P.Pb(),P.Bc(4,ae,1,0,"div",12),P.Nb()),2&e){var n=P.Zb(3);P.xb(2),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.account.user),P.xb(1),P.gc("ngIf",n.layout.gtsm$)}}function re(e,t){if(1&e&&P.Lb(0,"field-option",20),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n)("text",n.name)}}function ce(e,t){if(1&e&&(P.Qb(0,"div",15),P.Qb(1,"single-selection-field",18),P.Bc(2,re,1,3,"field-option",19),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.general.period),P.xb(1),P.gc("ngForOf",n.data.preselectedPeriods)}}function oe(e,t){if(1&e&&P.Lb(0,"field-option",20),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n.id)("text",n.name)}}function le(e,t){if(1&e&&(P.Qb(0,"div",15),P.Qb(1,"multi-selection-field",21),P.Bc(2,oe,1,3,"field-option",19),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.account.transferFilter),P.xb(1),P.gc("ngForOf",n.data.transferFilters)}}function se(e,t){1&e&&P.Lb(0,"div",15)}function ue(e,t){if(1&e&&P.Bc(0,se,1,0,"div",12),2&e){var n=P.Zb(3);P.gc("ngIf",n.layout.gtsm$)}}function be(e,t){if(1&e&&(P.Qb(0,"div",15),P.Lb(1,"date-field",22),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.general.beginDate)}}function fe(e,t){if(1&e&&(P.Qb(0,"div",15),P.Lb(1,"date-field",23),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.general.endDate)}}function de(e,t){if(1&e&&P.Lb(0,"field-option",38),2&e){var n=t.$implicit,a=P.Zb(5);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function me(e,t){if(1&e&&(P.Qb(0,"div",15),P.Qb(1,"multi-selection-field",36),P.Bc(2,de,1,5,"field-option",37),P.Pb(),P.Pb()),2&e){var n=P.Zb(4);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.user.groupFilter),P.xb(1),P.gc("ngForOf",n.data.groups)}}function ge(e,t){if(1&e&&P.Lb(0,"field-option",41),2&e){var n=t.$implicit;P.gc("id",n.id)("internalName",n.internalName)("value",n.internalName)("text",n.name)}}function pe(e,t){if(1&e&&(P.Qb(0,"div",15),P.Qb(1,"multi-selection-field",39),P.Bc(2,ge,1,4,"field-option",40),P.Pb(),P.Pb()),2&e){var n=P.Zb(4);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.transaction.channel),P.xb(1),P.gc("ngForOf",n.data.channels)}}function he(e,t){if(1&e&&(P.Qb(0,"div",15),P.Lb(1,"input-field",42),P.Pb()),2&e){var n=P.Zb(4);P.xb(1),P.gc("mask",n.data.transactionNumberMask)("label",n.i18n.transaction.number)}}function ye(e,t){if(1&e&&P.Lb(0,"field-option",45),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.display)}}function ve(e,t){if(1&e&&(P.Qb(0,"div",15),P.Qb(1,"single-selection-field",43),P.Bc(2,ye,1,2,"field-option",44),P.Pb(),P.Pb()),2&e){var n=P.Zb(4);P.xb(1),P.gc("label",n.i18n.general.operator)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.data.operators)}}function xe(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",15),P.Lb(2,"decimal-field",24),P.Pb(),P.Qb(3,"div",15),P.Lb(4,"decimal-field",25),P.Pb(),P.Qb(5,"div",15),P.Lb(6,"input-field",26),P.Pb(),P.Qb(7,"div",15),P.Qb(8,"single-selection-field",27),P.Lb(9,"field-option",28),P.Lb(10,"field-option",29),P.Pb(),P.Pb(),P.Bc(11,me,3,3,"div",12),P.Bc(12,pe,3,3,"div",12),P.Qb(13,"div",15),P.Lb(14,"user-field",30),P.Pb(),P.Bc(15,he,2,2,"div",12),P.Bc(16,ve,3,3,"div",12),P.Qb(17,"div",15),P.Qb(18,"single-selection-field",31),P.Lb(19,"field-option",32),P.Lb(20,"field-option",33),P.Lb(21,"field-option",34),P.Lb(22,"field-option",35),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(2),P.gc("label",n.i18n.account.minAmount)("prefix",n.currency.prefix)("suffix",n.currency.suffix)("scale",n.currency.decimalDigits),P.xb(2),P.gc("label",n.i18n.account.maxAmount)("prefix",n.currency.prefix)("suffix",n.currency.suffix)("scale",n.currency.decimalDigits),P.xb(2),P.gc("label",n.i18n.general.description),P.xb(2),P.gc("label",n.i18n.account.direction)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("text",n.i18n.account.incoming),P.xb(1),P.gc("text",n.i18n.account.outgoing),P.xb(1),P.gc("ngIf",(null==n.data.groups?null:n.data.groups.length)>1),P.xb(1),P.gc("ngIf",(null==n.data.channels?null:n.data.channels.length)>1),P.xb(2),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("ngIf",n.data.transactionNumberMask),P.xb(1),P.gc("ngIf",(null==n.data.operators?null:n.data.operators.length)>0),P.xb(2),P.gc("label",n.i18n.general.orderBy),P.xb(1),P.gc("text",n.i18n.account.orderBy.dateDesc),P.xb(1),P.gc("text",n.i18n.account.orderBy.dateAsc),P.xb(1),P.gc("text",n.i18n.account.orderBy.amountAsc),P.xb(1),P.gc("text",n.i18n.account.orderBy.amountDesc)}}var Pe=function(e){return{"border-0":e}};function De(e,t){if(1&e&&(P.Qb(0,"form",10),P.ac(1,"async"),P.Qb(2,"div",11),P.Bc(3,ie,5,3,"ng-container",6),P.Bc(4,ce,3,2,"div",12),P.Bc(5,le,3,2,"div",13),P.ac(6,"async"),P.Bc(7,ue,1,1,"ng-template",null,14,P.Cc),P.Bc(9,be,2,1,"div",12),P.ac(10,"async"),P.Bc(11,fe,2,1,"div",12),P.ac(12,"async"),P.Bc(13,xe,23,23,"ng-container",6),P.ac(14,"async"),P.Pb(),P.Pb()),2&e){var n,a,i=P.qc(8),r=P.Zb(2);P.gc("formGroup",r.form)("ngClass",P.jc(19,Pe,P.bc(1,9,r.noStatus$))),P.xb(3),P.gc("ngIf",r.data.account.user&&!r.self),P.xb(1),P.gc("ngIf",(null==r.data.preselectedPeriods?null:r.data.preselectedPeriods.length)>1),P.xb(1),P.gc("ngIf",P.bc(6,11,r.layout.gtxxs$)&&(null==r.data.transferFilters?null:r.data.transferFilters.length)>1)("ngIfElse",i),P.xb(4),P.gc("ngIf",null==(null==(n=r.form.value||P.bc(10,13,r.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),P.xb(2),P.gc("ngIf",null==(null==(a=r.form.value||P.bc(12,15,r.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.end)),P.xb(2),P.gc("ngIf",P.bc(14,17,r.layout.gtxxs$))}}function ke(e,t){if(1&e&&(P.Lb(0,"account-status-view",47),P.ac(1,"async"),P.ac(2,"async"),P.ac(3,"async"),P.ac(4,"async")),2&e){var n=P.Zb(3);P.gc("account",n.status$.value)("mode",P.bc(1,5,n.moreFilters$)?"period":"current")("showSeparator",P.bc(2,7,n.showForm$))("showAccount",P.bc(3,9,n.layout.ltsm$)&&n.multipleAccounts)("showUser",!n.self&&!1===P.bc(4,11,n.showForm$))}}function Le(e,t){1&e&&P.Lb(0,"spinner")}function we(e,t){if(1&e&&(P.Ob(0),P.Bc(1,ke,5,13,"account-status-view",46),P.ac(2,"async"),P.ac(3,"async"),P.Bc(4,Le,1,0,"spinner",6),P.ac(5,"async"),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngIf",P.bc(2,2,n.status$)&&(P.bc(3,4,n.layout.gtxxs$)||0===(null==n.results?null:n.results.page))),P.xb(3),P.gc("ngIf",null===P.bc(5,6,n.status$))}}function Ce(e,t){if(1&e&&(P.Qb(0,"mobile-result",48),P.Qb(1,"div",49),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("avatarImage",a.avatarImage(n))("avatarIcon",a.avatarIcon(n))("date",n.date)("amount",n.amount)("currency",a.currency),P.xb(2),P.Fc(" ",a.subjectName(n)," ")}}function Qe(e,t){if(1&e&&(P.Qb(0,"th",55),P.Dc(1),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.Ec(n.i18n.general.description)}}function Ie(e,t){if(1&e&&(P.Qb(0,"a",61),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2).$implicit,a=P.Zb(3);P.gc("routerLink",a.path(n)),P.xb(1),P.Fc(" ",n.description," ")}}function Fe(e,t){if(1&e&&(P.Qb(0,"td"),P.Bc(1,Ie,2,2,"a",60),P.Pb()),2&e){var n=P.Zb().$implicit;P.xb(1),P.gc("ngIf",n.description)}}var Te=function(e,t){return{positive:e,negative:t}};function Se(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",56),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.path(e))})),P.Qb(2,"td",51),P.Lb(3,"avatar",57),P.Pb(),P.Qb(4,"td"),P.Qb(5,"a",58),P.Dc(6),P.ac(7,"date"),P.Pb(),P.Pb(),P.Qb(8,"td"),P.Qb(9,"a",58),P.Dc(10),P.Pb(),P.Pb(),P.Bc(11,Fe,2,1,"td",6),P.ac(12,"async"),P.Qb(13,"td",53),P.Qb(14,"a",59),P.Dc(15),P.ac(16,"currency"),P.Pb(),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.gc("image",i.avatarImage(a))("icon",i.avatarIcon(a)),P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",P.bc(7,10,a.date)," "),P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",i.subjectName(a)," "),P.xb(1),P.gc("ngIf",P.bc(12,12,i.layout.gtsm$)),P.xb(3),P.gc("routerLink",i.path(a))("ngClass",P.kc(18,Te,i.format.isPositive(a.amount),i.format.isNegative(a.amount))),P.xb(1),P.Fc(" ",P.dc(16,14,a.amount,i.currency,!0)," ")}}function Oe(e,t){if(1&e&&(P.Qb(0,"table",50),P.Qb(1,"thead"),P.Lb(2,"th",51),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Bc(7,Qe,2,1,"th",52),P.ac(8,"async"),P.Qb(9,"th",53),P.Dc(10),P.Pb(),P.Pb(),P.Qb(11,"tbody"),P.Bc(12,Se,17,21,"ng-container",54),P.ac(13,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(4),P.Ec(a.i18n.general.date),P.xb(2),P.Ec(a.i18n.transaction.fromTo),P.xb(1),P.gc("ngIf",P.bc(8,5,a.layout.gtsm$)),P.xb(3),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(13,7,a.results$))?null:n.results)}}function Ne(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",4),P.ac(1,"async"),P.Bc(2,De,15,21,"form",5),P.ac(3,"async"),P.Bc(4,we,6,8,"ng-container",6),P.ac(5,"async"),P.Pb(),P.Qb(6,"results-layout",7),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(7,"async"),P.Bc(8,Ce,3,6,"mobile-result",8),P.Bc(9,Oe,14,9,"table",9),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.title)("mobileHeading",a.i18n.account.mobileTitle)("headingActions",P.bc(1,8,a.headingActions$)),P.xb(2),P.gc("ngIf",P.bc(3,10,a.showForm$)),P.xb(2),P.gc("ngIf",!1===P.bc(5,12,a.noStatus$)),P.xb(2),P.gc("results",P.bc(7,14,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}function Be(e,t){1&e&&P.Lb(0,"spinner",62)}var Ae,Ee=((Ae=function(e){s(a,e);var t=b(a);function a(e,n,i){var r;return c(this,a),(r=t.call(this,e)).accountsService=n,r.bankingHelper=i,r.status$=new v.a(null),r.noStatus$=new v.a(!1),r.showForm$=new v.a(!1),r}return l(a,[{key:"getFormControlNames",value:function(){return["transferFilters","preselectedPeriod","periodBegin","periodEnd","minAmount","maxAmount","transactionNumber","direction","user","by","orderBy","groups","channels","description"]}},{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot.params;this.ownerParam=t.owner,this.typeParam=t.type,this.self=this.authHelper.isSelf(this.ownerParam),this.multipleAccounts=this.accountTypes.length>1,this.stateManager.cache("data",this.accountsService.getAccountHistoryDataByOwnerAndType({owner:this.ownerParam,accountType:this.typeParam})).subscribe((function(t){e.data=t}))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(a.prototype),"onDataInitialized",this).call(this,e),this.exportActions=this.exportHelper.headingActions(e.exportFormats,(function(e){return t.accountsService.exportAccountHistory$Response(Object.assign({format:e.internalName},t.toSearchParams(t.form.value)))})),this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.layout.xxs$.subscribe((function(){return t.updateShowForm(e)}))),this.addSub(this.moreFilters$.subscribe((function(){return t.updateShowForm(e)}))),this.updateShowForm(e)}},{key:"updateShowForm",value:function(e){this.showForm$.next(this.layout.xxs&&!Object(h.h)(e.preselectedPeriods)||this.moreFilters)}},{key:"toSearchParams",value:function(e){var t=e;return t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=g.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],t.owner=this.ownerParam,t.accountType=this.typeParam,t}},{key:"doSearch",value:function(e){var t=this;return this.accountsService.searchAccountHistory$Response(e).pipe(Object(x.a)((function(){e.fields=["status"],t.addSub(t.accountsService.getAccountStatusByOwnerAndType(e).subscribe((function(e){var a=Object.assign(Object.assign({},t.data.account),{status:(e||{}).status});null==a.status?(t.noStatus$.next(!0),t.moreFilters=!0,t.headingActions=t.exportActions):t.headingActions=[t.moreFiltersAction].concat(n(t.exportActions)),t.status$.next(a)})))})))}},{key:"subjectName",value:function(e){return this.bankingHelper.subjectName(e.relatedAccount)}},{key:"path",value:function(e){return["/banking","transfer",this.data.account.id,this.bankingHelper.transactionNumberOrId(e)]}},{key:"avatarIcon",value:function(e){return"user"===e.relatedAccount.kind?"user":"account_balance_circle"}},{key:"avatarImage",value:function(e){return"user"===e.relatedAccount.kind?e.relatedAccount.user.image:null}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.showFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.hideFilters}},{key:"resolveMenu",value:function(e){var t=new y.a(y.b.ACCOUNT_HISTORY,{accountType:e.account.type});return e.account.kind===u.a.SYSTEM?t:this.menu.userMenu(e.account.user,t)}},{key:"type",get:function(){return null==this.data?null:this.data.account.type}},{key:"number",get:function(){return null==this.data?null:this.data.account.number}},{key:"currency",get:function(){return null==this.data?null:this.data.account.currency}},{key:"preselectedPeriods",get:function(){return null==this.data?null:this.data.preselectedPeriods}},{key:"transferFilters",get:function(){return null==this.data?null:this.data.transferFilters}},{key:"title",get:function(){var e=this.type;if(null==e)return null;var t=this.layout.ltsm?null:this.number;return null==t?e.name:e.name+" - "+t}},{key:"accountTypes",get:function(){return(((this.login.auth||{}).permissions||{}).banking.accounts.filter((function(e){return!1!==e.visible}))||[]).map((function(e){return e.account.type}))}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),a}(p.a)).\u0275fac=function(e){return new(e||Ae)(P.Kb(P.r),P.Kb(f.a),P.Kb(m.a))},Ae.\u0275cmp=P.Eb({type:Ae,selectors:[["account-history"]],features:[P.ub],decls:8,vars:7,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],["class","filters-form",3,"formGroup","ngClass",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"filters-form",3,"formGroup","ngClass"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-12 col-md-6",4,"ngIf","ngIfElse"],["noTransferFilters",""],[1,"col-12","col-md-6"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","transferFilters",3,"label"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["type","text","formControlName","description",3,"label"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","by",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[3,"account","mode","showSeparator","showAccount","showUser",4,"ngIf"],[3,"account","mode","showSeparator","showAccount","showUser"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","30%",4,"ngIf"],[1,"amount"],[4,"ngFor","ngForOf"],["width","30%"],[3,"click"],[3,"image","icon"],[3,"routerLink"],[3,"routerLink","ngClass"],["class","d-inline-block",3,"routerLink",4,"ngIf"],[1,"d-inline-block",3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,ne,1,0,"ng-container",1),P.Pb(),P.Bc(4,Ne,10,16,"ng-template",null,2,P.Cc),P.Bc(6,Be,1,0,"ng-template",null,3,P.Cc)),2&e){var n=P.qc(5);P.gc("ready",P.bc(1,3,t.noStatus$)||P.bc(2,5,t.status$)),P.xb(3),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,w.a,C.a,Q.a,I.I,I.w,I.n,k.q,F.a,T.a,S.a,I.v,I.l,k.s,O.a,N.a,B.a,A.a,E.a,$.a,R.a,X,Y.a,W.a,J.a,ee.h],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),Ae),$e=o("TFmz"),Re=o("+HmS"),Ze=o("XvX2"),Me=o("9AzD"),He=o("fe3a"),qe=o("uao2");function Ue(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",4),P.Dc(2),P.Pb(),P.Qb(3,"div",5),P.Dc(4),P.ac(5,"currency"),P.Pb(),P.Qb(6,"div",6),P.Dc(7),P.ac(8,"currency"),P.Pb(),P.Qb(9,"div",7),P.Dc(10),P.ac(11,"currency"),P.Pb(),P.Qb(12,"div",4),P.Dc(13),P.ac(14,"currency"),P.Pb(),P.Qb(15,"div",4),P.Dc(16),P.Pb(),P.Qb(17,"div",5),P.Dc(18),P.ac(19,"currency"),P.Pb(),P.Qb(20,"div",6),P.Dc(21),P.ac(22,"currency"),P.Pb(),P.Qb(23,"div",7),P.Dc(24),P.ac(25,"currency"),P.Pb(),P.Qb(26,"div",4),P.Dc(27),P.ac(28,"currency"),P.Pb(),P.Qb(29,"div",4),P.Dc(30),P.Pb(),P.Qb(31,"div",5),P.Dc(32),P.Pb(),P.Qb(33,"div",6),P.Dc(34),P.Pb(),P.Qb(35,"div",7),P.Dc(36),P.Pb(),P.Qb(37,"div",4),P.Dc(38),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(2),P.Fc(" ",n.i18n.account.userBalances.balancesSum," "),P.xb(2),P.Fc(" ",P.cc(5,15,n.summary.low.sum,n.currency)," "),P.xb(3),P.Fc(" ",P.cc(8,18,n.summary.medium.sum,n.currency)," "),P.xb(3),P.Fc(" ",P.cc(11,21,n.summary.high.sum,n.currency)," "),P.xb(3),P.Fc(" ",n.totalSum(P.cc(14,24,n.summary.total.sum,n.currency))," "),P.xb(3),P.Fc(" ",n.i18n.account.userBalances.balancesAverage," "),P.xb(2),P.Fc(" ",P.cc(19,27,n.summary.low.average,n.currency)," "),P.xb(3),P.Fc(" ",P.cc(22,30,n.summary.medium.average,n.currency)," "),P.xb(3),P.Fc(" ",P.cc(25,33,n.summary.high.average,n.currency)," "),P.xb(3),P.Fc(" ",n.totalSum(P.cc(28,36,n.summary.total.average,n.currency))," "),P.xb(3),P.Fc(" ",n.i18n.account.userBalances.balancesCount," "),P.xb(2),P.Fc(" ",n.summary.low.count," "),P.xb(2),P.Fc(" ",n.summary.medium.count," "),P.xb(2),P.Fc(" ",n.summary.high.count," "),P.xb(2),P.Fc(" ",n.totalSum(n.summary.total.count)," ")}}function Ve(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",8),P.Dc(2),P.Pb(),P.Qb(3,"div",9),P.Dc(4),P.ac(5,"currency"),P.Pb(),P.Qb(6,"div",8),P.Dc(7),P.Pb(),P.Qb(8,"div",9),P.Dc(9),P.ac(10,"currency"),P.Pb(),P.Qb(11,"div",8),P.Dc(12),P.Pb(),P.Qb(13,"div",9),P.Dc(14),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(2),P.Fc(" ",n.i18n.account.userBalances.balancesSum," "),P.xb(2),P.Fc(" ",P.cc(5,6,n.summary.total.sum,n.currency)," "),P.xb(3),P.Fc(" ",n.i18n.account.userBalances.balancesAverage," "),P.xb(2),P.Fc(" ",P.cc(10,9,n.summary.total.average,n.currency)," "),P.xb(3),P.Fc(" ",n.i18n.account.userBalances.balancesCount," "),P.xb(2),P.Fc(" ",n.summary.total.count," ")}}var je,ze=((je=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).hasYellowRange$=new v.a(!1),a}return l(n,[{key:"ngOnInit",value:function(){var e=this;this.summary$.subscribe((function(t){return e.hasYellowRange$.next(!!t.low)}))}},{key:"totalSum",value:function(e){return this.i18n.account.userBalances.total+": "+e}},{key:"summary",get:function(){return this.summary$.value}}]),n}(Z.a)).\u0275fac=function(e){return new(e||je)(P.Kb(P.r))},je.\u0275cmp=P.Eb({type:je,selectors:[["balances-summary"]],inputs:{summary$:"summary$",currency:"currency"},features:[P.ub],decls:7,vars:6,consts:[[1,"p-1"],[1,"mt-0","mb-0"],[1,"row","no-gutters","pt-1"],[4,"ngIf"],[1,"col-12","col-sm-3"],[1,"col-12","col-sm-2","low-balance"],[1,"col-12","col-sm-2","medium-balance"],[1,"col-12","col-sm-2","high-balance"],[1,"col-6","col-sm-3"],[1,"col-6","col-sm-9"]],template:function(e,t){1&e&&(P.Qb(0,"div",0),P.Lb(1,"hr",1),P.Qb(2,"div",2),P.Bc(3,Ue,39,39,"ng-container",3),P.ac(4,"async"),P.Bc(5,Ve,15,12,"ng-container",3),P.ac(6,"async"),P.Pb(),P.Pb()),2&e&&(P.xb(3),P.gc("ngIf",P.bc(4,2,t.hasYellowRange$)),P.xb(2),P.gc("ngIf",!P.bc(6,4,t.hasYellowRange$)))},directives:[k.t],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),je),Ge=o("IJ5G");function _e(e,t){1&e&&P.Mb(0)}function Ke(e,t){if(1&e&&P.Lb(0,"field-option",19),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n.id)("internalName",n.internalName)("text",n.name)}}function Xe(e,t){if(1&e&&(P.Qb(0,"div",7),P.Lb(1,"max-distance-field",37),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("data",n.data.searchByDistanceData)("label",n.i18n.general.distanceFilter)}}function Ye(e,t){if(1&e&&P.Lb(0,"field-option",40),2&e){var n=t.$implicit,a=P.Zb(4);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function We(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"multi-selection-field",38),P.Bc(2,Ye,1,5,"field-option",39),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.user.groupFilter),P.xb(1),P.gc("ngForOf",n.data.groups)}}function Je(e,t){if(1&e&&P.Lb(0,"field-option",43),2&e){var n=t.$implicit,a=P.Zb(4);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)}}function et(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"multi-selection-field",41),P.Bc(2,Je,1,4,"field-option",42),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.user.assignedProducts),P.xb(1),P.gc("ngForOf",n.data.products)}}function tt(e,t){if(1&e&&P.Lb(0,"field-option",43),2&e){var n=t.$implicit,a=P.Zb(4);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)}}function nt(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"multi-selection-field",44),P.Bc(2,tt,1,4,"field-option",42),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.user.acceptedAgreements),P.xb(1),P.gc("ngForOf",n.data.agreements)}}function at(e,t){if(1&e&&P.Lb(0,"field-option",43),2&e){var n=t.$implicit,a=P.Zb(4);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)}}function it(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"multi-selection-field",45),P.Bc(2,at,1,4,"field-option",42),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.user.notAcceptedAgreements),P.xb(1),P.gc("ngForOf",n.data.agreements)}}function rt(e,t){if(1&e&&(P.Qb(0,"div",7),P.Lb(1,"basic-profile-field-filter",46),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(3);P.xb(1),P.gc("field",n)("formControl",a.form.get("profileFields").get(n.field))}}function ct(e,t){if(1&e&&(P.Qb(0,"div",7),P.Lb(1,"custom-field-filter",46),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(3);P.xb(1),P.gc("field",n)("formControl",a.form.get("profileFields").get(n.internalName))}}function ot(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"div",20),P.Qb(2,"div",7),P.Lb(3,"decimal-field",21),P.Pb(),P.Qb(4,"div",7),P.Lb(5,"decimal-field",22),P.Pb(),P.Qb(6,"div",7),P.Lb(7,"decimal-field",23),P.Pb(),P.Qb(8,"div",7),P.Lb(9,"decimal-field",24),P.Pb(),P.Bc(10,Xe,2,2,"div",25),P.Bc(11,We,3,3,"div",25),P.Bc(12,et,3,3,"div",25),P.Bc(13,nt,3,3,"div",25),P.Bc(14,it,3,3,"div",25),P.Qb(15,"div",26),P.Qb(16,"div",7),P.Lb(17,"date-field",27),P.Pb(),P.Qb(18,"div",7),P.Lb(19,"date-field",28),P.Pb(),P.Pb(),P.Qb(20,"div",26),P.Qb(21,"div",7),P.Lb(22,"date-field",29),P.Pb(),P.Qb(23,"div",7),P.Lb(24,"date-field",30),P.Pb(),P.Pb(),P.Qb(25,"div",26),P.Qb(26,"div",7),P.Lb(27,"date-field",31),P.Pb(),P.Qb(28,"div",7),P.Lb(29,"date-field",32),P.Pb(),P.Pb(),P.Qb(30,"div",26),P.Qb(31,"div",7),P.Lb(32,"date-field",33),P.Pb(),P.Qb(33,"div",7),P.Lb(34,"date-field",34),P.Pb(),P.Pb(),P.Qb(35,"div",7),P.Lb(36,"user-field",35),P.Pb(),P.Bc(37,rt,2,2,"div",36),P.Bc(38,ct,2,2,"div",36),P.Nb()),2&e){var n=P.Zb(2);P.xb(3),P.gc("label",n.i18n.account.userBalances.minBalance)("scale",0),P.xb(2),P.gc("label",n.i18n.account.userBalances.maxBalance)("scale",0),P.xb(2),P.gc("label",n.i18n.account.userBalances.fromYellowBalance)("scale",0),P.xb(2),P.gc("label",n.i18n.account.userBalances.toYellowBalance)("scale",0),P.xb(1),P.gc("ngIf",n.data.searchByDistanceData),P.xb(1),P.gc("ngIf",(null==n.data.groups?null:n.data.groups.length)>1),P.xb(1),P.gc("ngIf",(null==n.data.products?null:n.data.products.length)>1),P.xb(1),P.gc("ngIf",(null==n.data.agreements?null:n.data.agreements.length)>1),P.xb(1),P.gc("ngIf",(null==n.data.agreements?null:n.data.agreements.length)>1),P.xb(3),P.gc("label",n.i18n.user.creationBegin),P.xb(2),P.gc("label",n.i18n.user.creationEnd),P.xb(3),P.gc("label",n.i18n.user.beginUserActivationDate),P.xb(2),P.gc("label",n.i18n.user.endUserActivationDate),P.xb(3),P.gc("label",n.i18n.user.beginLastLoginDate),P.xb(2),P.gc("label",n.i18n.user.endLastLoginDate),P.xb(3),P.gc("label",n.i18n.account.userBalances.beginNegativeSince),P.xb(2),P.gc("label",n.i18n.account.userBalances.endNegativeSince),P.xb(2),P.gc("label",n.i18n.general.usersOfBroker)("filters",n.userSearchFilters()),P.xb(1),P.gc("ngForOf",n.data.basicFields),P.xb(1),P.gc("ngForOf",n.customFieldsInSearch)}}function lt(e,t){if(1&e&&(P.Qb(0,"div",47),P.Qb(1,"single-selection-field",48),P.Lb(2,"field-option",49),P.Lb(3,"field-option",50),P.Lb(4,"field-option",51),P.Lb(5,"field-option",52),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("formControl",n.form.get("orderBy"))("display",n.i18n.general.orderBy),P.xb(1),P.gc("text",n.i18n.account.userBalances.orderBy.alphabeticallyDesc),P.xb(1),P.gc("text",n.i18n.account.userBalances.orderBy.alphabeticallyAsc),P.xb(1),P.gc("text",n.i18n.account.userBalances.orderBy.balanceDesc),P.xb(1),P.gc("text",n.i18n.account.userBalances.orderBy.balanceAsc)}}function st(e,t){if(1&e&&(P.Lb(0,"balances-summary",53),P.ac(1,"async")),2&e){var n=P.Zb(2);P.gc("summary$",n.summary$)("currency",P.bc(1,2,n.currency$))}}function ut(e,t){1&e&&P.Lb(0,"spinner")}function bt(e,t){if(1&e&&(P.Qb(0,"mobile-result",54),P.Qb(1,"div",55),P.Qb(2,"div",56),P.Dc(3),P.Pb(),P.Qb(4,"div",57),P.Dc(5),P.ac(6,"currency"),P.Pb(),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("avatarImage",n.image)("avatarIcon","user"),P.xb(3),P.Fc(" ",n.name," "),P.xb(2),P.Fc(" ",P.cc(6,4,n.balance,a.findCurrency())," ")}}function ft(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",62),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.path(e))})),P.Qb(2,"td",59),P.Lb(3,"avatar",63),P.Pb(),P.Qb(4,"td"),P.Dc(5),P.Pb(),P.Qb(6,"td"),P.Dc(7),P.Pb(),P.Qb(8,"td"),P.Dc(9),P.ac(10,"date"),P.Pb(),P.Qb(11,"td",60),P.Dc(12),P.ac(13,"currency"),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.gc("image",a.image)("icon","user"),P.xb(2),P.Ec(a.name),P.xb(2),P.Ec(a.accountNumber),P.xb(2),P.Ec(P.bc(10,6,a.negativeSince)),P.xb(3),P.Fc(" ",P.cc(13,8,a.balance,i.findCurrency())," ")}}function dt(e,t){if(1&e&&(P.Qb(0,"table",58),P.Qb(1,"thead"),P.Lb(2,"th",59),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Qb(7,"th"),P.Dc(8),P.Pb(),P.Qb(9,"th",60),P.Dc(10),P.Pb(),P.Pb(),P.Qb(11,"tbody"),P.Bc(12,ft,14,11,"ng-container",61),P.ac(13,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(4),P.Ec(a.i18n.general.user),P.xb(2),P.Ec(a.i18n.account.number),P.xb(2),P.Ec(a.i18n.account.userBalances.negativeSince),P.xb(2),P.Ec(a.i18n.account.balance),P.xb(2),P.gc("ngForOf",null==(n=P.bc(13,5,a.results$))?null:n.results)}}function mt(e,t){if(1&e&&(P.Qb(0,"div",66),P.Dc(1),P.Pb()),2&e){var n=P.Zb().$implicit;P.xb(1),P.Fc(" ",n.name,"")}}function gt(e,t){if(1&e&&(P.Qb(0,"div"),P.Dc(1),P.Pb()),2&e){var n=P.Zb().$implicit;P.xb(1),P.Fc(" ",n.username,"")}}function pt(e,t){if(1&e&&(P.Qb(0,"map-result",64),P.Bc(1,mt,2,1,"div",65),P.Bc(2,gt,2,1,"div",10),P.Qb(3,"div",66),P.Dc(4),P.ac(5,"currency"),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("image",n.image)("address",n.address),P.xb(1),P.gc("ngIf",n.name),P.xb(1),P.gc("ngIf",n.username),P.xb(2),P.Fc(" ",P.cc(5,5,n.balance,a.findCurrency()),"")}}var ht=function(e){return{"mb-0":e}};function yt(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",4),P.ac(1,"async"),P.Qb(2,"form",5),P.Qb(3,"div",6),P.Qb(4,"div",7),P.Qb(5,"single-selection-field",8),P.Bc(6,Ke,1,4,"field-option",9),P.Pb(),P.Pb(),P.Bc(7,ot,39,25,"ng-container",10),P.ac(8,"async"),P.Pb(),P.Pb(),P.Qb(9,"div",6),P.Qb(10,"div",11),P.ac(11,"async"),P.Lb(12,"result-type-field",12),P.ac(13,"async"),P.Pb(),P.Bc(14,lt,6,6,"div",13),P.ac(15,"async"),P.Pb(),P.Ob(16),P.Bc(17,st,2,4,"balances-summary",14),P.ac(18,"async"),P.Bc(19,ut,1,0,"spinner",10),P.ac(20,"async"),P.Nb(),P.Pb(),P.Qb(21,"results-layout",15),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(22,"async"),P.Bc(23,bt,7,7,"mobile-result",16),P.Bc(24,dt,14,7,"table",17),P.Bc(25,pt,6,8,"map-result",18),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.account.userBalances.title)("mobileHeading",a.i18n.account.userBalances.mobileTitle)("headingActions",P.bc(1,18,a.headingActions$)),P.xb(2),P.gc("formGroup",a.form),P.xb(3),P.gc("label",a.i18n.account.account),P.xb(1),P.gc("ngForOf",a.data.accountTypes),P.xb(1),P.gc("ngIf",P.bc(8,20,a.moreFilters$)),P.xb(3),P.gc("ngClass",P.jc(34,ht,P.bc(11,22,a.layout.xs$))),P.xb(2),P.gc("allowedResultTypes",P.bc(13,24,a.allowedResultTypes$))("formControl",a.resultTypeControl),P.xb(2),P.gc("ngIf","map"!==P.bc(15,26,a.resultType$)),P.xb(3),P.gc("ngIf",P.bc(18,28,a.summary$)),P.xb(2),P.gc("ngIf",null===P.bc(20,30,a.summary$)),P.xb(2),P.gc("resultType",a.resultType)("results",P.bc(22,32,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)("toAddress",a.toAddress)}}function vt(e,t){1&e&&P.Lb(0,"spinner",67)}var xt,Pt=((xt=function(e){s(n,e);var t=b(n);function n(e,a,i){var r;return c(this,n),(r=t.call(this,e)).accountsService=a,r.bankingHelper=i,r.summary$=new v.a(null),r.currency$=new v.a(null),r}return l(n,[{key:"getFormControlNames",value:function(){return["accountType","minMediumRange","maxMediumRange","minBalance","maxBalance","orderBy","groups","distanceFilter","brokers","beginActivationPeriod","endActivationPeriod","beginCreationPeriod","endCreationPeriod","beginLastLoginPeriod","customValues","endLastLoginPeriod","beginNegativeSincePeriod","endNegativeSincePeriod","notAcceptedAgreements","acceptedAgreements","products"]}},{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.stateManager.cache("data",this.accountsService.getUserBalancesData()).subscribe((function(t){return e.data=t})),this.allowedResultTypes=(((this.login.auth||{}).permissions||{}).users||{}).map?[$e.a.LIST,$e.a.MAP]:[$e.a.LIST]}},{key:"onDataInitialized",value:function(e){var t=this;r(d(n.prototype),"onDataInitialized",this).call(this,e),this.customFieldsInSearch=e.customFields.filter((function(t){return e.fieldsInSearch.includes(t.internalName)})),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(e.basicFields,this.customFieldsInSearch));var a=this.moreFiltersAction;a.breakpoint=null,this.headingActions=[a],this.exportHelper.headingActions(e.exportFormats,(function(e){return t.accountsService.exportUsersWithBalances$Response(Object.assign({format:e.internalName},t.toSearchParams(t.form.value)))})).forEach((function(e){return t.headingActions.push(e)})),this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.form.controls.accountType.valueChanges.subscribe((function(e){var n=t.data.accountTypes.find((function(t){return t.id===e}));t.updateYellowRange(n),t.currency$.next(n.currency)})));var i=e.accountTypes[0];this.currency$.next(i.currency),this.updateYellowRange(i)}},{key:"onResultTypeChanged",value:function(e,t){r(d(n.prototype),"onResultTypeChanged",this).call(this,e,t),this.resetPage()}},{key:"updateYellowRange",value:function(e){null!=e.defaultMediumBalanceRange?(this.form.controls.minMediumRange.patchValue(e.defaultMediumBalanceRange.min),this.form.controls.maxMediumRange.patchValue(e.defaultMediumBalanceRange.max)):(this.form.controls.minMediumRange.patchValue(null),this.form.controls.maxMediumRange.patchValue(null))}},{key:"userSearchFilters",value:function(){return{roles:[u.kb.BROKER]}}},{key:"mapBalance",value:function(e){return this.i18n.account.balance+": "+e}},{key:"toAddress",value:function(e){return e.address}},{key:"getInitialResultType",value:function(){return $e.a.LIST}},{key:"toSearchParams",value:function(e){var t=e;t.activationPeriod=g.a.dateRangeFilter(e.beginActivationPeriod,e.endActivationPeriod),t.creationPeriod=g.a.dateRangeFilter(e.beginCreationPeriod,e.endCreationPeriod),t.lastLoginPeriod=g.a.dateRangeFilter(e.beginLastLoginPeriod,e.endLastLoginPeriod),t.negativeSincePeriod=g.a.dateRangeFilter(e.beginNegativeSincePeriod,e.endNegativeSincePeriod),e.minBalance&&e.maxBalance&&(t.balanceRange=[e.minBalance,e.maxBalance]),null!=e.minMediumRange&&null!=e.maxMediumRange&&(t.mediumBalanceRange=[e.minMediumRange,e.maxMediumRange]),t.addressResult=this.resultType===$e.a.MAP?u.Eb.ALL:null,t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields);var n=e.distanceFilter;return n&&(t.maxDistance=n.maxDistance,t.latitude=n.latitude,t.longitude=n.longitude),t.fields=[],t}},{key:"doSearch",value:function(e){var t=this;return this.accountsService.searchUsersWithBalances$Response(e).pipe(Object(x.a)((function(){t.addSub(t.accountsService.getUserBalancesSummary(e).subscribe((function(e){return t.summary$.next(e)})))})))}},{key:"findCurrency",value:function(){var e=this.form.controls.accountType.value;return e?this.data.accountTypes.find((function(t){return t.id===e})).currency:this.currency$.value}},{key:"currencyDecimalDigits",value:function(){var e=this.findCurrency();return e?e.decimalDigits:2}},{key:"currencyPrefix",value:function(){var e=this.findCurrency();return e?e.prefix:null}},{key:"currencySuffix",value:function(){var e=this.findCurrency();return e?e.suffix:null}},{key:"path",value:function(e){return["/users",e.id,"profile"]}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.showFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.hideFilters}},{key:"resolveMenu",value:function(){return y.b.USER_BALANCES_OVERVIEW}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(p.a)).\u0275fac=function(e){return new(e||xt)(P.Kb(P.r),P.Kb(f.a),P.Kb(m.a))},xt.\u0275cmp=P.Eb({type:xt,selectors:[["search-user-balances"]],features:[P.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","filters-row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","accountType",3,"label"],[3,"id","value","internalName","text",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12","col-md-9","col-xs-5","mb-1",3,"ngClass"],[3,"allowedResultTypes","formControl"],["class","col-12 col-md-3 col-xs-7",4,"ngIf"],[3,"summary$","currency",4,"ngIf"],[3,"resultType","results","toLink","rendering$","toAddress","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"image","address",4,"resultInfoWindow"],[3,"id","value","internalName","text"],[1,"w-100"],["labelPosition","side","formControlName","minBalance","fieldSize","full","allowNegative","",3,"label","scale"],["labelPosition","side","formControlName","maxBalance","fieldSize","full","allowNegative","",3,"label","scale"],["labelPosition","side","formControlName","minMediumRange","fieldSize","full",3,"label","scale"],["labelPosition","side","formControlName","maxMediumRange","fieldSize","full",3,"label","scale"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","brokers",3,"label","filters"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","products",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","acceptedAgreements",3,"emptyLabel","label"],["labelPosition","side","formControlName","notAcceptedAgreements",3,"emptyLabel","label"],["labelPosition","side",3,"field","formControl"],[1,"col-12","col-md-3","col-xs-7"],[3,"formControl","display"],["value","alphabeticallyDesc",3,"text"],["value","alphabeticallyAsc",3,"text"],["value","balanceDesc",3,"text"],["value","balanceAsc",3,"text"],[3,"summary$","currency"],[3,"avatarImage","avatarIcon"],[1,"cell-text","cell-main","row"],[1,"col-6","align-text-start"],[1,"col-6","align-text-end","amount"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[3,"image","address"],["class","font-weight-bold",4,"ngIf"],[1,"font-weight-bold"],[1,"p-3"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,_e,1,0,"ng-container",1),P.Pb(),P.Bc(3,yt,26,36,"ng-template",null,2,P.Cc),P.Bc(5,vt,1,0,"ng-template",null,3,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,S.a,I.v,I.l,k.s,k.q,Re.a,I.k,w.a,C.a,Q.a,Ze.a,O.a,A.a,B.a,$.a,Me.a,N.a,He.a,qe.a,ze,Y.a,W.a,J.a,Ge.a],pipes:[k.b,M.a,te.a],encapsulation:2,changeDetection:0}),xt),Dt=o("ZXJw"),kt=o("uuU0"),Lt=o("XIp8"),wt=o("UXR7"),Ct=o("OTwK"),Qt=o("YG2p");function It(e,t){if(1&e&&(P.Ob(0,4),P.Qb(1,"label-value",5),P.Lb(2,"user-link",6),P.Pb(),P.Qb(3,"label-value",7),P.Dc(4),P.Pb(),P.Qb(5,"div",8),P.Qb(6,"h3"),P.Dc(7),P.Pb(),P.Lb(8,"single-selection-field",9),P.Lb(9,"decimal-field",10),P.ac(10,"async"),P.ac(11,"async"),P.Qb(12,"label-value",11),P.ac(13,"async"),P.Dc(14),P.ac(15,"currency"),P.Pb(),P.Pb(),P.Qb(16,"div",8),P.Qb(17,"h3"),P.Dc(18),P.Pb(),P.Lb(19,"single-selection-field",12),P.Lb(20,"decimal-field",13),P.ac(21,"async"),P.ac(22,"async"),P.ac(23,"async"),P.ac(24,"async"),P.Qb(25,"label-value",11),P.ac(26,"async"),P.Dc(27),P.ac(28,"currency"),P.Pb(),P.Pb(),P.Lb(29,"textarea-field",14),P.Nb()),2&e){var n=P.Zb();P.gc("formGroup",n.form),P.xb(1),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("label",n.i18n.account.account),P.xb(1),P.Fc(" ",n.data.account.type.name," "),P.xb(3),P.Ec(n.i18n.account.balanceLimits.negativeLimit),P.xb(1),P.gc("label",n.i18n.account.limits.mode)("fieldOptions",n.negativeModeOptions),P.xb(1),P.gc("hidden",P.bc(10,30,n.isDefaultCreditLimit$))("required",!P.bc(11,32,n.isDefaultCreditLimit$))("label",n.i18n.account.balanceLimits.negativeLimit)("scale",n.data.account.currency.decimalDigits)("prefix",n.data.account.currency.prefix)("suffix",n.data.account.currency.suffix),P.xb(3),P.gc("hidden",!P.bc(13,34,n.isDefaultCreditLimit$))("label",n.i18n.account.balanceLimits.negativeLimit),P.xb(2),P.Fc(" ",P.cc(15,36,n.data.defaultCreditLimit?n.data.defaultCreditLimit:0,n.data.account.currency)," "),P.xb(4),P.Ec(n.i18n.account.balanceLimits.positiveLimit),P.xb(1),P.gc("label",n.i18n.account.limits.mode)("fieldOptions",n.positiveModeOptions),P.xb(1),P.gc("hidden",P.bc(21,39,n.isDefaultUpperCreditLimit$)||P.bc(22,41,n.isUnlimitedUpperCreditLimit$))("required",!(P.bc(23,43,n.isDefaultUpperCreditLimit$)||P.bc(24,45,n.isUnlimitedUpperCreditLimit$)))("label",n.i18n.account.balanceLimits.positiveLimit)("scale",n.data.account.currency.decimalDigits)("prefix",n.data.account.currency.prefix)("suffix",n.data.account.currency.suffix),P.xb(5),P.gc("hidden",!P.bc(26,47,n.isDefaultUpperCreditLimit$))("label",n.i18n.account.balanceLimits.positiveLimit),P.xb(2),P.Fc(" ",n.data.defaultUpperCreditLimit?P.cc(28,49,n.data.defaultUpperCreditLimit,n.data.account.currency):n.i18n.account.limits.unlimited," "),P.xb(2),P.gc("label",n.i18n.general.comments)}}var Ft,Tt=((Ft=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).balanceLimitsService=a,i.isDefaultCreditLimit$=new v.a(null),i.isDefaultUpperCreditLimit$=new v.a(null),i.isUnlimitedUpperCreditLimit$=new v.a(null),i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(n.prototype),"onDataInitialized",this).call(this,e);var a=e.customCreditLimit?"personalized":"default",i=e.customUpperCreditLimit?e.upperCreditLimit?"personalized":"unlimited":"default";this.form=this.formBuilder.group({creditLimitMode:a,creditLimit:e.creditLimit,upperCreditLimitMode:i,upperCreditLimit:e.upperCreditLimit,comment:null}),this.formControl("creditLimitMode").valueChanges.subscribe((function(e){return t.onCreditLimitModeChange(e)})),this.formControl("upperCreditLimitMode").valueChanges.subscribe((function(e){return t.onUpperCreditLimitModeChange(e)})),this.isDefaultCreditLimit$.next("default"===a),this.isDefaultUpperCreditLimit$.next("default"===i),this.isUnlimitedUpperCreditLimit$.next("unlimited"===i)}},{key:"onCreditLimitModeChange",value:function(e){this.isDefaultCreditLimit$.next("default"===e)}},{key:"onUpperCreditLimitModeChange",value:function(e){this.isDefaultUpperCreditLimit$.next("default"===e),this.isUnlimitedUpperCreditLimit$.next("unlimited"===e)}},{key:"save",value:function(){var e=this;if(Object(h.F)(this.form),this.form.valid){var t=Object(Lt.a)(this.form.value);t.customCreditLimit="default"!==t.creditLimitMode,t.customCreditLimit||delete t.creditLimit,t.customUpperCreditLimit="default"!==t.upperCreditLimitMode,"unlimited"!==t.upperCreditLimitMode&&t.customUpperCreditLimit||delete t.upperCreditLimit,delete t.creditLimitMode,delete t.upperCreditLimitMode,this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.account.balanceLimits.confirm,createDeviceConfirmation:this.balanceLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:function(n){return e.doSave(t,n.confirmationPassword)}}):this.doSave(t)}}},{key:"doSave",value:function(e,t){var n=this;this.addSub(this.balanceLimitsService.setAccountBalanceLimits({user:this.user,accountType:this.accountType,confirmationPassword:t,body:e}).subscribe((function(){n.notification.snackBar(n.i18n.account.balanceLimits.saved),n.reload()})))}},{key:"balanceLimitsDeviceConfirmation",value:function(){var e=this;return function(){return{type:u.s.CHANGE_ACCOUNT_LIMITS,account:e.data.account.id}}}},{key:"formControl",value:function(e){return this.form.get(e)}},{key:"resolveMenu",value:function(){return this.menu.searchUsersMenu()}},{key:"positiveModeOptions",get:function(){var e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e.push({value:"unlimited",text:this.i18n.account.limits.unlimited}),e}},{key:"negativeModeOptions",get:function(){var e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e}}]),n}(kt.a)).\u0275fac=function(e){return new(e||Ft)(P.Kb(P.r),P.Kb(Dt.a))},Ft.\u0275cmp=P.Eb({type:Ft,selectors:[["edit-account-balance-limits"]],features:[P.ub],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mt-3"],["labelPosition","side","formControlName","creditLimitMode",3,"label","fieldOptions"],["formControlName","creditLimit","negative","",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","upperCreditLimitMode",3,"label","fieldOptions"],["formControlName","upperCreditLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Qb(2,"page-content",1),P.ac(3,"async"),P.Bc(4,It,30,52,"ng-container",2),P.Qb(5,"actions"),P.Qb(6,"action-button",3),P.Xb("action",(function(){return t.save()})),P.ac(7,"async"),P.Pb(),P.Pb(),P.Pb(),P.Pb()),2&e&&(P.gc("ready",P.bc(1,7,t.data$)),P.xb(2),P.gc("heading",t.i18n.account.balanceLimits.title.edit)("mobileHeading",t.i18n.account.balanceLimits.mobileTitle.edit)("headingActions",P.bc(3,9,t.headingActions$)),P.xb(2),P.gc("ngIf",t.data),P.xb(2),P.gc("disabled",P.bc(7,11,t.requesting$))("label",t.i18n.general.save))},directives:[D.a,L.a,k.t,wt.a,Ct.a,I.w,I.n,F.a,T.a,S.a,I.v,I.l,A.a,I.D,Qt.a],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),Ft),St=o("s7Af");function Ot(e,t){if(1&e){var n=P.Rb();P.Qb(0,"tr",8),P.Xb("click",(function(e){P.sc(n);var a=t.$implicit,i=P.Zb(3);return i.router.navigate(i.path(a.account.type)),e.stopPropagation()})),P.Qb(1,"td",9),P.Dc(2),P.Pb(),P.Qb(3,"td"),P.Dc(4),P.ac(5,"currency"),P.Pb(),P.Qb(6,"td"),P.Dc(7),P.ac(8,"currency"),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(2),P.Ec(a.account.type.name),P.xb(2),P.Ec(P.cc(5,3,a.creditLimit,a.account.currency)),P.xb(3),P.Fc(" ",a.upperCreditLimit?P.cc(8,6,a.upperCreditLimit,a.account.currency):i.i18n.account.limits.unlimited," ")}}function Nt(e,t){if(1&e&&(P.Qb(0,"table",6),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Pb(),P.Qb(8,"tbody"),P.Bc(9,Ot,9,9,"tr",7),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(3),P.Ec(n.i18n.account.account),P.xb(2),P.Ec(n.i18n.account.balanceLimits.negativeLimit),P.xb(2),P.Ec(n.i18n.account.balanceLimits.positiveLimit),P.xb(2),P.gc("ngForOf",n.data.accountLimits)}}function Bt(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"page-content",2),P.ac(2,"async"),P.Lb(3,"user-info",3),P.Pb(),P.Qb(4,"results-layout",4),P.Bc(5,Nt,10,4,"table",5),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("mode","normal")("heading",n.i18n.account.balanceLimits.title.list)("mobileHeading",n.i18n.account.balanceLimits.mobileTitle.list)("headingActions",P.bc(2,6,n.headingActions$)),P.xb(2),P.gc("user",n.data.user),P.xb(1),P.gc("results",n.data.accountLimits)}}var At,Et=((At=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).balanceLimitsService=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.addSub(this.balanceLimitsService.getDataForUserBalanceLimits({user:this.user}).subscribe((function(t){1===t.accountLimits.length&&e.router.navigate(e.path(t.accountLimits[0].account.type)),e.data=t})))}},{key:"path",value:function(e){return["/banking",this.user,"account-balance-limits",e.id]}},{key:"resolveMenu",value:function(){return this.menu.searchUsersMenu()}}]),n}(kt.a)).\u0275fac=function(e){return new(e||At)(P.Kb(P.r),P.Kb(Dt.a))},At.\u0275cmp=P.Eb({type:At,selectors:[["list-accounts-balance-limits"]],features:[P.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,Bt,6,8,"ng-container",1),P.Pb()),2&e&&(P.gc("ready",P.bc(1,2,t.data$)),P.xb(2),P.gc("ngIf",t.data))},directives:[D.a,k.t,L.a,St.a,w.a,Q.a,k.s],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),At);function $t(e,t){1&e&&P.Mb(0)}function Rt(e,t){if(1&e&&P.Lb(0,"field-option",14),2&e){var n=t.$implicit,a=P.Zb(3);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function Zt(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"multi-selection-field",12),P.Bc(2,Rt,1,5,"field-option",13),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.user.groupFilter),P.xb(1),P.gc("ngForOf",n.data.groups)}}function Mt(e,t){if(1&e&&P.Lb(0,"field-option",17),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function Ht(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"single-selection-field",15),P.Bc(2,Mt,1,2,"field-option",16),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.currency)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.currencies)}}function qt(e,t){if(1&e&&P.Lb(0,"field-option",31),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n.id)("text",n.name)}}function Ut(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"single-selection-field",29),P.Bc(2,qt,1,3,"field-option",30),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.account.account)("emptyOption",n.i18n.general.all),P.xb(1),P.gc("ngForOf",n.accountTypes())}}function Vt(e,t){if(1&e&&(P.Ob(0),P.Bc(1,Ut,3,3,"div",6),P.Qb(2,"div",11),P.Lb(3,"single-selection-field",18),P.Pb(),P.Lb(4,"div",19),P.ac(5,"async"),P.Qb(6,"div",20),P.ac(7,"async"),P.Lb(8,"decimal-field",21),P.Pb(),P.Qb(9,"div",20),P.ac(10,"async"),P.Lb(11,"decimal-field",22),P.Pb(),P.Qb(12,"div",11),P.Lb(13,"single-selection-field",23),P.Pb(),P.Lb(14,"div",19),P.ac(15,"async"),P.Qb(16,"div",20),P.ac(17,"async"),P.Lb(18,"decimal-field",24),P.Pb(),P.Qb(19,"div",20),P.ac(20,"async"),P.Lb(21,"decimal-field",25),P.Pb(),P.Qb(22,"div",11),P.Lb(23,"user-field",26),P.Pb(),P.Qb(24,"div",11),P.Lb(25,"user-field",27),P.Pb(),P.Qb(26,"div",11),P.Lb(27,"user-field",28),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngIf",(null==n.data.accountTypes?null:n.data.accountTypes.length)>1),P.xb(2),P.gc("fieldOptions",n.customLimitOptions)("emptyOption",n.i18n.general.all)("label",n.i18n.account.balanceLimits.personalizedNegativeLimit),P.xb(1),P.gc("hidden",!P.bc(5,37,n.isCustomLimit$)),P.xb(2),P.gc("hidden",!P.bc(7,39,n.isCustomLimit$)),P.xb(2),P.gc("label",n.i18n.account.balanceLimits.fromNegativeLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(1),P.gc("hidden",!P.bc(10,41,n.isCustomLimit$)),P.xb(2),P.gc("label",n.i18n.account.balanceLimits.toNegativeLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(2),P.gc("fieldOptions",n.customLimitOptions)("emptyOption",n.i18n.general.all)("label",n.i18n.account.balanceLimits.personalizedPositiveLimit),P.xb(1),P.gc("hidden",!P.bc(15,43,n.isCustomUpperLimit$)),P.xb(2),P.gc("hidden",!P.bc(17,45,n.isCustomUpperLimit$)),P.xb(2),P.gc("label",n.i18n.account.balanceLimits.fromPositiveLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(1),P.gc("hidden",!P.bc(20,47,n.isCustomUpperLimit$)),P.xb(2),P.gc("label",n.i18n.account.balanceLimits.toPositiveLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(2),P.gc("label",n.i18n.general.user)("allowContacts",!1),P.xb(2),P.gc("label",n.i18n.general.usersOfBroker)("filters",n.userSearchFilters(!0))("allowContacts",!1),P.xb(2),P.gc("label",n.i18n.general.changedBy)("filters",n.userSearchFilters(!1))("allowContacts",!1)}}function jt(e,t){if(1&e){var n=P.Rb();P.Qb(0,"mobile-result",32),P.Xb("click",(function(e){P.sc(n);var a=t.$implicit,i=P.Zb(2);return i.router.navigate(i.view(a)),e.stopPropagation()})),P.Qb(1,"div",33),P.Qb(2,"div",34),P.Qb(3,"label-value",35),P.Dc(4),P.Pb(),P.Qb(5,"label-value",35),P.Dc(6),P.Pb(),P.Qb(7,"label-value",35),P.Dc(8),P.ac(9,"currency"),P.Pb(),P.Qb(10,"label-value",35),P.Dc(11),P.ac(12,"currency"),P.Pb(),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(2);P.xb(3),P.gc("label",i.i18n.general.user),P.xb(1),P.Fc(" ",a.user.display," "),P.xb(1),P.gc("label",i.i18n.account.account),P.xb(1),P.Fc(" ",a.account.type.name," "),P.xb(1),P.gc("label",i.i18n.account.balanceLimits.negative),P.xb(1),P.Fc(" ",a.customCreditLimit?P.cc(9,8,a.creditLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(2),P.gc("label",i.i18n.account.balanceLimits.positive),P.xb(1),P.Fc(" ",a.customUpperCreditLimit?a.upperCreditLimit?P.cc(12,11,a.upperCreditLimit,a.account.currency):i.i18n.account.limits.unlimited:i.i18n.account.limits.productDefault," ")}}function zt(e,t){if(1&e){var n=P.Rb();P.Qb(0,"tr",32),P.Xb("click",(function(e){P.sc(n);var a=t.$implicit,i=P.Zb(3);return i.router.navigate(i.view(a)),e.stopPropagation()})),P.Qb(1,"td",38),P.Dc(2),P.Pb(),P.Qb(3,"td",38),P.Dc(4),P.Pb(),P.Qb(5,"td"),P.Dc(6),P.ac(7,"currency"),P.Pb(),P.Qb(8,"td"),P.Dc(9),P.ac(10,"currency"),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(2),P.Ec(a.user.display),P.xb(2),P.Ec(a.account.type.name),P.xb(2),P.Fc(" ",a.customCreditLimit?P.cc(7,4,a.creditLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",a.customUpperCreditLimit?a.upperCreditLimit?P.cc(10,7,a.upperCreditLimit,a.account.currency):i.i18n.account.limits.unlimited:i.i18n.account.limits.productDefault," ")}}function Gt(e,t){if(1&e&&(P.Qb(0,"table",36),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Pb(),P.Qb(10,"tbody"),P.Bc(11,zt,11,10,"tr",37),P.ac(12,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.general.user),P.xb(2),P.Ec(a.i18n.account.account),P.xb(2),P.Ec(a.i18n.account.balanceLimits.negativeLimit),P.xb(2),P.Ec(a.i18n.account.balanceLimits.positiveLimit),P.xb(2),P.gc("ngForOf",null==(n=P.bc(12,5,a.results$))?null:n.results)}}function _t(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.ac(1,"async"),P.Qb(2,"form",4),P.Qb(3,"div",5),P.Bc(4,Zt,3,2,"div",6),P.Bc(5,Ht,3,3,"div",6),P.Bc(6,Vt,28,49,"ng-container",7),P.ac(7,"async"),P.Pb(),P.Pb(),P.Pb(),P.Qb(8,"results-layout",8),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(9,"async"),P.Bc(10,jt,13,14,"mobile-result",9),P.Bc(11,Gt,13,7,"table",10),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.account.balanceLimits.title.overview)("mobileHeading",a.i18n.account.balanceLimits.mobileTitle.overview)("headingActions",P.bc(1,9,a.headingActions$)),P.xb(2),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",(null==a.data.groups?null:a.data.groups.length)>1),P.xb(1),P.gc("ngIf",(null==a.currencies?null:a.currencies.length)>1),P.xb(1),P.gc("ngIf",P.bc(7,11,a.moreFilters$)),P.xb(2),P.gc("results",P.bc(9,13,a.results$))("rendering$",a.rendering$)}}var Kt,Xt=((Kt=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).balanceLimitsService=a,i.isCustomLimit$=new v.a(!1),i.isCustomUpperLimit$=new v.a(!1),i.currencies=[],i}return l(n,[{key:"getFormControlNames",value:function(){return["accountType","broker","brokers","by","currency","customLimit","limitFrom","limitTo","customUpperLimit","upperLimitFrom","upperLimitTo","groups","user"]}},{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.addSub(this.balanceLimitsService.getAccountBalanceLimitsData().subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(n.prototype),"onDataInitialized",this).call(this,e),(e.accountTypes||[]).forEach((function(e){return t.currencies.push(e.currency)})),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customUpperLimit").valueChanges.subscribe((function(e){return t.isCustomUpperLimit$.next("yes"===e)})),this.form.get("customLimit").valueChanges.subscribe((function(e){return t.isCustomLimit$.next("yes"===e)})),this.addSub(this.form.controls.currency.valueChanges.subscribe((function(e){return t.updateAccountTypes(e)}))),this.headingActions=[this.moreFiltersAction]}},{key:"doSearch",value:function(e){return this.balanceLimitsService.searchAccountBalanceLimits$Response(e)}},{key:"toSearchParams",value:function(e){var t=e;return this.isCustomLimit$.value?(t.customLimit=!0,t.customLimitRange=g.a.rangeFilter(e.limitFrom,e.limitTo)):t.customLimit=!e.customLimit&&null,this.isCustomUpperLimit$.value?(t.customUpperLimit=!0,t.customUpperLimitRange=g.a.rangeFilter(e.upperLimitFrom,e.upperLimitTo)):t.customUpperLimit=!e.customUpperLimit&&null,t}},{key:"userSearchFilters",value:function(e){var t={roles:[u.kb.BROKER]};return e||t.roles.push(u.kb.ADMINISTRATOR),t}},{key:"updateAccountTypes",value:function(e){var t=this.form.controls.accountType.value;e&&t&&this.data.accountTypes.find((function(e){return e.id===t})).currency.id!==e&&this.form.controls.accountType.setValue(null)}},{key:"accountTypes",value:function(){var e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter((function(t){return t.currency.id===e.id})):t}},{key:"findCurrency",value:function(e){if(this.singleCurrency)return this.singleCurrency;var t=this.form.controls.currency.value;if(t)return this.currencies.find((function(e){return e.id===t}));var n=this.form.controls.accountType.value;return e&&n?this.data.accountTypes.find((function(e){return e.id===n})).currency:null}},{key:"currencyDecimalDigits",value:function(){var e=this.findCurrency(!0);return e?e.decimalDigits:2}},{key:"currencyPrefix",value:function(){var e=this.findCurrency(!0);return e?e.prefix:null}},{key:"currencySuffix",value:function(){var e=this.findCurrency(!0);return e?e.suffix:null}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.moreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.lessFilters}},{key:"view",value:function(e){return["/banking",e.user.id,"account-balance-limits",e.account.type.id]}},{key:"resolveMenu",value:function(){return new y.a(y.b.ACCOUNT_BALANCE_LIMITS_OVERVIEW)}},{key:"customLimitOptions",get:function(){var e=[{value:"yes",text:this.i18n.general.yes}];return e.push({value:"no",text:this.i18n.general.no}),e}}]),n}(p.a)).\u0275fac=function(e){return new(e||Kt)(P.Kb(P.r),P.Kb(Dt.a))},Kt.\u0275cmp=P.Eb({type:Kt,selectors:[["search-balance-limits-overview"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","customLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","limitFrom","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","limitTo","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customUpperLimit",3,"fieldOptions","emptyOption","label"],["formControlName","upperLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","upperLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label","allowContacts"],["labelPosition","side","formControlName","broker",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","by",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","25%"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,$t,1,0,"ng-container",1),P.Pb(),P.Bc(3,_t,12,15,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,w.a,C.a,Q.a,N.a,I.v,I.l,k.s,O.a,S.a,A.a,$.a,W.a,F.a],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),Kt),Yt=o("tAww");function Wt(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"label-value",5),P.Lb(2,"user-link",6),P.Pb(),P.Qb(3,"label-value",7),P.Dc(4),P.Pb(),P.Qb(5,"h3"),P.Dc(6),P.Pb(),P.Qb(7,"label-value",7),P.Dc(8),P.ac(9,"currency"),P.Pb(),P.Qb(10,"label-value",7),P.Dc(11),P.Pb(),P.Qb(12,"h3"),P.Dc(13),P.Pb(),P.Qb(14,"label-value",7),P.Dc(15),P.ac(16,"currency"),P.Pb(),P.Qb(17,"label-value",7),P.Dc(18),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("label",n.i18n.account.account),P.xb(1),P.Fc(" ",n.data.account.type.name," "),P.xb(2),P.Ec(n.i18n.account.balanceLimits.negativeLimit),P.xb(1),P.gc("label",n.i18n.account.balanceLimits.negativeLimit),P.xb(1),P.Fc(" ",P.cc(9,14,n.data.creditLimit,n.data.account.currency)," "),P.xb(2),P.gc("label",n.i18n.account.limits.mode),P.xb(1),P.Fc(" ",n.data.customCreditLimit?n.i18n.account.limits.personalized:n.i18n.account.limits.productDefault," "),P.xb(2),P.Ec(n.i18n.account.balanceLimits.positiveLimit),P.xb(1),P.gc("label",n.i18n.account.balanceLimits.positiveLimit),P.xb(1),P.Fc(" ",n.data.upperCreditLimit?P.cc(16,17,n.data.upperCreditLimit,n.data.account.currency):n.i18n.account.limits.unlimited," "),P.xb(2),P.gc("label",n.i18n.account.limits.mode),P.xb(1),P.Fc(" ",n.upperCreditLimitMode()," ")}}function Jt(e,t){if(1&e&&(P.Qb(0,"page-content",3),P.ac(1,"async"),P.Bc(2,Wt,19,20,"ng-container",4),P.Pb()),2&e){var n=P.Zb();P.gc("heading",n.i18n.account.balanceLimits.title.view)("mobileHeading",n.i18n.account.balanceLimits.mobileTitle.view)("headingActions",P.bc(1,4,n.headingActions$)),P.xb(2),P.gc("ngIf",n.data)}}function en(e,t){if(1&e&&(P.Qb(0,"tr"),P.Qb(1,"td"),P.Dc(2),P.ac(3,"date"),P.Pb(),P.Qb(4,"td"),P.Dc(5),P.Pb(),P.Qb(6,"td"),P.Dc(7),P.ac(8,"currency"),P.Pb(),P.Qb(9,"td"),P.Dc(10),P.ac(11,"currency"),P.Pb(),P.Qb(12,"td"),P.Dc(13),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(3);P.xb(2),P.Ec(P.bc(3,5,n.date)),P.xb(3),P.Ec(n.by.display),P.xb(2),P.Fc(" ",n.customCreditLimit?P.cc(8,7,n.creditLimit,a.data.account.currency):a.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",n.customUpperCreditLimit?n.upperCreditLimit?P.cc(11,10,n.upperCreditLimit,a.data.account.currency):a.i18n.account.limits.unlimited:a.i18n.account.limits.productDefault," "),P.xb(3),P.Ec(n.comment)}}function tn(e,t){if(1&e&&(P.Qb(0,"table",11),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Qb(10,"th"),P.Dc(11),P.Pb(),P.Pb(),P.Qb(12,"tbody"),P.Bc(13,en,14,13,"tr",12),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(3),P.Ec(n.i18n.general.date),P.xb(2),P.Ec(n.i18n.general.performedBy),P.xb(2),P.Ec(n.i18n.account.balanceLimits.negative),P.xb(2),P.Ec(n.i18n.account.balanceLimits.positive),P.xb(2),P.Ec(n.i18n.general.comments),P.xb(2),P.gc("ngForOf",n.data.history)}}function nn(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"page-content",8),P.ac(2,"async"),P.Lb(3,"user-info",6),P.Pb(),P.Qb(4,"results-layout",9),P.Bc(5,tn,14,6,"table",10),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("mode","empty")("heading",n.i18n.account.balanceLimits.title.history)("mobileHeading",n.i18n.account.balanceLimits.mobileTitle.history)("headingActions",P.bc(2,6,n.headingActions$)),P.xb(2),P.gc("user",n.data.user),P.xb(1),P.gc("results",n.data.history)}}var an,rn=((an=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).balanceLimitsService=a,i.step$=new v.a("details"),i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(n.prototype),"onDataInitialized",this).call(this,e),this.detailsHeadingActions=e.editable?[new Yt.c("edit",this.i18n.general.edit,(function(){return t.navigateToEdit()}))]:[],this.detailsHeadingActions.push(new Yt.c("history",this.i18n.general.viewHistory,(function(){return t.showHistory()}))),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=e.editable?[new Yt.c("edit",this.i18n.general.edit,(function(){return t.navigateToEdit()}))]:[],this.historyHeadingActions.push(new Yt.c("arrow_back",this.i18n.general.details,(function(){return t.showView()})))}},{key:"upperCreditLimitMode",value:function(){return this.data.upperCreditLimit?this.data.customUpperCreditLimit?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault:this.data.customUpperCreditLimit?this.i18n.account.limits.unlimited:this.i18n.account.limits.productDefault}},{key:"showHistory",value:function(){this.headingActions=this.historyHeadingActions,this.step="history"}},{key:"showView",value:function(){this.headingActions=this.detailsHeadingActions,this.step="details"}},{key:"navigateToEdit",value:function(){this.router.navigate(["/banking",this.user,"account-balance-limits",this.accountType,"edit"])}},{key:"resolveMenu",value:function(){return this.menu.searchUsersMenu()}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}}]),n}(kt.a)).\u0275fac=function(e){return new(e||an)(P.Kb(P.r),P.Kb(Dt.a))},an.\u0275cmp=P.Eb({type:an,selectors:[["view-account-balance-limits"]],features:[P.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],["class","table",4,"resultTable"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Jt,3,6,"page-content",1),P.Bc(4,nn,6,8,"ng-container",2),P.Pb()),2&e&&(P.gc("ready",P.bc(1,4,t.data$))("ngSwitch",P.bc(2,6,t.step$)),P.xb(3),P.gc("ngSwitchCase","details"),P.xb(1),P.gc("ngSwitchCase","history"))},directives:[D.a,k.x,k.y,L.a,k.t,F.a,T.a,St.a,w.a,Q.a,k.s],pipes:[k.b,M.a,te.a],encapsulation:2,changeDetection:0}),an),cn=o("TJod");function on(e,t){if(1&e&&(P.Ob(0,4),P.Qb(1,"label-value",5),P.Lb(2,"user-link",6),P.Pb(),P.Qb(3,"label-value",7),P.Dc(4),P.Pb(),P.Qb(5,"div",8),P.Qb(6,"h3"),P.Dc(7),P.Pb(),P.Lb(8,"single-selection-field",9),P.Lb(9,"decimal-field",10),P.ac(10,"async"),P.ac(11,"async"),P.Qb(12,"label-value",11),P.ac(13,"async"),P.Dc(14),P.ac(15,"currency"),P.Pb(),P.Pb(),P.Qb(16,"div",8),P.Qb(17,"h3"),P.Dc(18),P.Pb(),P.Lb(19,"single-selection-field",12),P.Lb(20,"decimal-field",13),P.ac(21,"async"),P.ac(22,"async"),P.Qb(23,"label-value",11),P.ac(24,"async"),P.Dc(25),P.ac(26,"currency"),P.Pb(),P.Pb(),P.Qb(27,"div",8),P.Qb(28,"h3"),P.Dc(29),P.Pb(),P.Lb(30,"single-selection-field",14),P.Lb(31,"decimal-field",15),P.ac(32,"async"),P.ac(33,"async"),P.Qb(34,"label-value",11),P.ac(35,"async"),P.Dc(36),P.ac(37,"currency"),P.Pb(),P.Pb(),P.Qb(38,"div",8),P.Qb(39,"h3"),P.Dc(40),P.Pb(),P.Lb(41,"single-selection-field",16),P.Lb(42,"decimal-field",17),P.ac(43,"async"),P.ac(44,"async"),P.Qb(45,"label-value",11),P.ac(46,"async"),P.Dc(47),P.ac(48,"currency"),P.Pb(),P.Pb(),P.Lb(49,"textarea-field",18),P.Nb()),2&e){var n=P.Zb();P.gc("formGroup",n.form),P.xb(1),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("label",n.i18n.account.account),P.xb(1),P.Fc(" ",n.data.account.type.name," "),P.xb(3),P.Ec(n.i18n.account.paymentLimits.paymentLimit),P.xb(1),P.gc("label",n.i18n.account.limits.mode)("fieldOptions",n.modeOptions),P.xb(1),P.gc("hidden",P.bc(10,54,n.isDefaultPaymentLimit$))("required",!P.bc(11,56,n.isDefaultPaymentLimit$))("label",n.i18n.account.paymentLimits.paymentLimit)("scale",n.data.account.currency.decimalDigits)("prefix",n.data.account.currency.prefix)("suffix",n.data.account.currency.suffix),P.xb(3),P.gc("hidden",!P.bc(13,58,n.isDefaultPaymentLimit$))("label",n.i18n.account.paymentLimits.paymentLimit),P.xb(2),P.Fc(" ",P.cc(15,60,n.data.productAmountLimit?n.data.productAmountLimit:0,n.data.account.currency)," "),P.xb(4),P.Ec(n.i18n.account.paymentLimits.dailyLimit),P.xb(1),P.gc("label",n.i18n.account.limits.mode)("fieldOptions",n.modeOptions),P.xb(1),P.gc("hidden",P.bc(21,63,n.isDefaultDailyLimit$))("required",!P.bc(22,65,n.isDefaultDailyLimit$))("label",n.i18n.account.paymentLimits.dailyLimit)("scale",n.data.account.currency.decimalDigits)("prefix",n.data.account.currency.prefix)("suffix",n.data.account.currency.suffix),P.xb(3),P.gc("hidden",!P.bc(24,67,n.isDefaultDailyLimit$))("label",n.i18n.account.paymentLimits.dailyLimit),P.xb(2),P.Fc(" ",P.cc(26,69,n.data.productAmountPerDayLimit?n.data.productAmountPerDayLimit:0,n.data.account.currency)," "),P.xb(4),P.Ec(n.i18n.account.paymentLimits.weeklyLimit),P.xb(1),P.gc("label",n.i18n.account.limits.mode)("fieldOptions",n.modeOptions),P.xb(1),P.gc("hidden",P.bc(32,72,n.isDefaultWeeklyLimit$))("required",!P.bc(33,74,n.isDefaultWeeklyLimit$))("label",n.i18n.account.paymentLimits.weeklyLimit)("scale",n.data.account.currency.decimalDigits)("prefix",n.data.account.currency.prefix)("suffix",n.data.account.currency.suffix),P.xb(3),P.gc("hidden",!P.bc(35,76,n.isDefaultWeeklyLimit$))("label",n.i18n.account.paymentLimits.weeklyLimit),P.xb(2),P.Fc(" ",P.cc(37,78,n.data.productAmountPerWeekLimit?n.data.productAmountPerWeekLimit:0,n.data.account.currency)," "),P.xb(4),P.Ec(n.i18n.account.paymentLimits.monthlyLimit),P.xb(1),P.gc("label",n.i18n.account.limits.mode)("fieldOptions",n.modeOptions),P.xb(1),P.gc("hidden",P.bc(43,81,n.isDefaultMonthlyLimit$))("required",!P.bc(44,83,n.isDefaultMonthlyLimit$))("label",n.i18n.account.paymentLimits.monthlyLimit)("scale",n.data.account.currency.decimalDigits)("prefix",n.data.account.currency.prefix)("suffix",n.data.account.currency.suffix),P.xb(3),P.gc("hidden",!P.bc(46,85,n.isDefaultMonthlyLimit$))("label",n.i18n.account.paymentLimits.monthlyLimit),P.xb(2),P.Fc(" ",P.cc(48,87,n.data.productAmountPerMonthLimit?n.data.productAmountPerMonthLimit:0,n.data.account.currency)," "),P.xb(2),P.gc("label",n.i18n.general.comments)}}var ln,sn=((ln=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).paymentLimitsService=a,i.isDefaultPaymentLimit$=new v.a(null),i.isDefaultDailyLimit$=new v.a(null),i.isDefaultWeeklyLimit$=new v.a(null),i.isDefaultMonthlyLimit$=new v.a(null),i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe((function(t){return e.data=t})))}},{key:"mode",value:function(e){return e?"personalized":"default"}},{key:"onDataInitialized",value:function(e){var t=this;r(d(n.prototype),"onDataInitialized",this).call(this,e);var a=this.mode(e.customAmountLimit),i=this.mode(e.customAmountPerDayLimit),c=this.mode(e.customAmountPerWeekLimit),o=this.mode(e.customAmountPerMonthLimit);this.form=this.formBuilder.group({paymentLimitMode:a,amountLimit:e.amountLimit,dailyLimitMode:i,amountPerDayLimit:e.amountPerDayLimit,weeklyLimitMode:c,amountPerWeekLimit:e.amountPerWeekLimit,monthlyLimitMode:o,amountPerMonthLimit:e.amountPerMonthLimit,comment:null}),this.formControl("paymentLimitMode").valueChanges.subscribe((function(e){return t.isDefaultPaymentLimit$.next("default"===e)})),this.isDefaultPaymentLimit$.next("default"===a),this.formControl("dailyLimitMode").valueChanges.subscribe((function(e){return t.isDefaultDailyLimit$.next("default"===e)})),this.isDefaultDailyLimit$.next("default"===i),this.formControl("weeklyLimitMode").valueChanges.subscribe((function(e){return t.isDefaultWeeklyLimit$.next("default"===e)})),this.isDefaultWeeklyLimit$.next("default"===c),this.formControl("monthlyLimitMode").valueChanges.subscribe((function(e){return t.isDefaultMonthlyLimit$.next("default"===e)})),this.isDefaultMonthlyLimit$.next("default"===o)}},{key:"save",value:function(){var e=this;if(Object(h.F)(this.form),this.form.valid){var t=Object(Lt.a)(this.form.value);t.customAmountLimit="default"!==t.paymentLimitMode,t.customAmountLimit||delete t.amountLimit,t.customAmountPerDayLimit="default"!==t.dailyLimitMode,t.customAmountPerDayLimit||delete t.amountPerDayLimit,t.customAmountPerWeekLimit="default"!==t.weeklyLimitMode,t.customAmountPerWeekLimit||delete t.amountPerWeekLimit,t.customAmountPerMonthLimit="default"!==t.monthlyLimitMode,t.customAmountPerMonthLimit||delete t.amountPerMonthLimit,delete t.creditLimitMode,delete t.upperCreditLimitMode,this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.account.paymentLimits.confirm,createDeviceConfirmation:this.paymentLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:function(n){return e.doSave(t,n.confirmationPassword)}}):this.doSave(t)}}},{key:"doSave",value:function(e,t){var n=this;this.addSub(this.paymentLimitsService.setAccountPaymentLimits({user:this.user,accountType:this.accountType,confirmationPassword:t,body:e}).subscribe((function(){n.notification.snackBar(n.i18n.account.paymentLimits.saved),n.reload()})))}},{key:"paymentLimitsDeviceConfirmation",value:function(){var e=this;return function(){return{type:u.s.CHANGE_ACCOUNT_LIMITS,account:e.data.account.id}}}},{key:"formControl",value:function(e){return this.form.get(e)}},{key:"resolveMenu",value:function(){return this.menu.searchUsersMenu()}},{key:"modeOptions",get:function(){var e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e}}]),n}(kt.a)).\u0275fac=function(e){return new(e||ln)(P.Kb(P.r),P.Kb(cn.a))},ln.\u0275cmp=P.Eb({type:ln,selectors:[["edit-account-payment-limits"]],features:[P.ub],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mt-3"],["labelPosition","side","formControlName","paymentLimitMode",3,"label","fieldOptions"],["formControlName","amountLimit",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","dailyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerDayLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","weeklyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerWeekLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","monthlyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerMonthLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Qb(2,"page-content",1),P.ac(3,"async"),P.Bc(4,on,50,90,"ng-container",2),P.Qb(5,"actions"),P.Qb(6,"action-button",3),P.Xb("action",(function(){return t.save()})),P.ac(7,"async"),P.Pb(),P.Pb(),P.Pb(),P.Pb()),2&e&&(P.gc("ready",P.bc(1,7,t.data$)),P.xb(2),P.gc("heading",t.i18n.account.paymentLimits.title.edit)("mobileHeading",t.i18n.account.paymentLimits.mobileTitle.edit)("headingActions",P.bc(3,9,t.headingActions$)),P.xb(2),P.gc("ngIf",t.data),P.xb(2),P.gc("disabled",P.bc(7,11,t.requesting$))("label",t.i18n.general.save))},directives:[D.a,L.a,k.t,wt.a,Ct.a,I.w,I.n,F.a,T.a,S.a,I.v,I.l,A.a,I.D,Qt.a],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),ln);function un(e,t){if(1&e){var n=P.Rb();P.Qb(0,"tr",8),P.Xb("click",(function(e){P.sc(n);var a=t.$implicit,i=P.Zb(3);return i.router.navigate(i.path(a.account.type)),e.stopPropagation()})),P.Qb(1,"td",9),P.Dc(2),P.Pb(),P.Qb(3,"td"),P.Dc(4),P.ac(5,"currency"),P.Pb(),P.Qb(6,"td"),P.Dc(7),P.ac(8,"currency"),P.Pb(),P.Qb(9,"td"),P.Dc(10),P.ac(11,"currency"),P.Pb(),P.Qb(12,"td"),P.Dc(13),P.ac(14,"currency"),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(2),P.Ec(a.account.type.name),P.xb(2),P.Fc(" ",a.amountLimit?P.cc(5,5,a.amountLimit,a.account.currency):i.i18n.account.limits.unlimited," "),P.xb(3),P.Fc(" ",a.amountPerDayLimit?P.cc(8,8,a.amountPerDayLimit,a.account.currency):i.i18n.account.limits.unlimited," "),P.xb(3),P.Fc(" ",a.amountPerWeekLimit?P.cc(11,11,a.amountPerWeekLimit,a.account.currency):i.i18n.account.limits.unlimited," "),P.xb(3),P.Fc(" ",a.amountPerMonthLimit?P.cc(14,14,a.amountPerMonthLimit,a.account.currency):i.i18n.account.limits.unlimited," ")}}function bn(e,t){if(1&e&&(P.Qb(0,"table",6),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Qb(10,"th"),P.Dc(11),P.Pb(),P.Pb(),P.Qb(12,"tbody"),P.Bc(13,un,15,17,"tr",7),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(3),P.Ec(n.i18n.account.account),P.xb(2),P.Ec(n.i18n.account.paymentLimits.paymentLimit),P.xb(2),P.Ec(n.i18n.account.paymentLimits.dailyLimit),P.xb(2),P.Ec(n.i18n.account.paymentLimits.weeklyLimit),P.xb(2),P.Ec(n.i18n.account.paymentLimits.monthlyLimit),P.xb(2),P.gc("ngForOf",n.data.accountLimits)}}function fn(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"page-content",2),P.ac(2,"async"),P.Lb(3,"user-info",3),P.Pb(),P.Qb(4,"results-layout",4),P.Bc(5,bn,14,6,"table",5),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("mode","normal")("heading",n.i18n.account.paymentLimits.title.list)("mobileHeading",n.i18n.account.paymentLimits.mobileTitle.list)("headingActions",P.bc(2,6,n.headingActions$)),P.xb(2),P.gc("user",n.data.user),P.xb(1),P.gc("results",n.data.accountLimits)}}var dn,mn=((dn=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).paymentLimitsService=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.addSub(this.paymentLimitsService.getDataForUserPaymentLimits({user:this.user}).subscribe((function(t){1===t.accountLimits.length&&e.router.navigate(e.path(t.accountLimits[0].account.type)),e.data=t})))}},{key:"path",value:function(e){return["/banking",this.user,"account-payment-limits",e.id]}},{key:"resolveMenu",value:function(){return this.menu.searchUsersMenu()}}]),n}(kt.a)).\u0275fac=function(e){return new(e||dn)(P.Kb(P.r),P.Kb(cn.a))},dn.\u0275cmp=P.Eb({type:dn,selectors:[["list-accounts-payment-limits"]],features:[P.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,fn,6,8,"ng-container",1),P.Pb()),2&e&&(P.gc("ready",P.bc(1,2,t.data$)),P.xb(2),P.gc("ngIf",t.data))},directives:[D.a,k.t,L.a,St.a,w.a,Q.a,k.s],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),dn);function gn(e,t){1&e&&P.Mb(0)}function pn(e,t){if(1&e&&P.Lb(0,"field-option",14),2&e){var n=t.$implicit,a=P.Zb(3);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function hn(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"multi-selection-field",12),P.Bc(2,pn,1,5,"field-option",13),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.user.groupFilter),P.xb(1),P.gc("ngForOf",n.data.groups)}}function yn(e,t){if(1&e&&P.Lb(0,"field-option",17),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function vn(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"single-selection-field",15),P.Bc(2,yn,1,2,"field-option",16),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.currency)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.currencies)}}function xn(e,t){if(1&e&&P.Lb(0,"field-option",37),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n.id)("text",n.name)}}function Pn(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"single-selection-field",35),P.Bc(2,xn,1,3,"field-option",36),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.account.account)("emptyOption",n.i18n.general.all),P.xb(1),P.gc("ngForOf",n.accountTypes())}}function Dn(e,t){if(1&e&&(P.Ob(0),P.Bc(1,Pn,3,3,"div",6),P.Qb(2,"div",11),P.Lb(3,"single-selection-field",18),P.Pb(),P.Lb(4,"div",19),P.ac(5,"async"),P.Qb(6,"div",20),P.ac(7,"async"),P.Lb(8,"decimal-field",21),P.Pb(),P.Qb(9,"div",20),P.ac(10,"async"),P.Lb(11,"decimal-field",22),P.Pb(),P.Qb(12,"div",11),P.Lb(13,"single-selection-field",23),P.Pb(),P.Lb(14,"div",19),P.ac(15,"async"),P.Qb(16,"div",20),P.ac(17,"async"),P.Lb(18,"decimal-field",24),P.Pb(),P.Qb(19,"div",20),P.ac(20,"async"),P.Lb(21,"decimal-field",25),P.Pb(),P.Qb(22,"div",11),P.Lb(23,"single-selection-field",26),P.Pb(),P.Lb(24,"div",19),P.ac(25,"async"),P.Qb(26,"div",20),P.ac(27,"async"),P.Lb(28,"decimal-field",27),P.Pb(),P.Qb(29,"div",20),P.ac(30,"async"),P.Lb(31,"decimal-field",28),P.Pb(),P.Qb(32,"div",11),P.Lb(33,"single-selection-field",29),P.Pb(),P.Lb(34,"div",19),P.ac(35,"async"),P.Qb(36,"div",20),P.ac(37,"async"),P.Lb(38,"decimal-field",30),P.Pb(),P.Qb(39,"div",20),P.ac(40,"async"),P.Lb(41,"decimal-field",31),P.Pb(),P.Qb(42,"div",11),P.Lb(43,"user-field",32),P.Pb(),P.Qb(44,"div",11),P.Lb(45,"user-field",33),P.Pb(),P.Qb(46,"div",11),P.Lb(47,"user-field",34),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngIf",(null==n.data.accountTypes?null:n.data.accountTypes.length)>1),P.xb(2),P.gc("fieldOptions",n.customLimitOptions)("emptyOption",n.i18n.general.all)("label",n.i18n.account.paymentLimits.personalizedPaymentLimit),P.xb(1),P.gc("hidden",!P.bc(5,65,n.isCustomPaymentLimit$)),P.xb(2),P.gc("hidden",!P.bc(7,67,n.isCustomPaymentLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.fromPaymentLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(1),P.gc("hidden",!P.bc(10,69,n.isCustomPaymentLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.toPaymentLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(2),P.gc("fieldOptions",n.customLimitOptions)("emptyOption",n.i18n.general.all)("label",n.i18n.account.paymentLimits.personalizedDailyLimit),P.xb(1),P.gc("hidden",!P.bc(15,71,n.isCustomDailyLimit$)),P.xb(2),P.gc("hidden",!P.bc(17,73,n.isCustomDailyLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.fromDailyLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(1),P.gc("hidden",!P.bc(20,75,n.isCustomDailyLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.toDailyLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(2),P.gc("fieldOptions",n.customLimitOptions)("emptyOption",n.i18n.general.all)("label",n.i18n.account.paymentLimits.personalizedWeeklyLimit),P.xb(1),P.gc("hidden",!P.bc(25,77,n.isCustomWeeklyLimit$)),P.xb(2),P.gc("hidden",!P.bc(27,79,n.isCustomWeeklyLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.fromWeeklyLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(1),P.gc("hidden",!P.bc(30,81,n.isCustomWeeklyLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.toWeeklyLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(2),P.gc("fieldOptions",n.customLimitOptions)("emptyOption",n.i18n.general.all)("label",n.i18n.account.paymentLimits.personalizedMonthlyLimit),P.xb(1),P.gc("hidden",!P.bc(35,83,n.isCustomMonthlyLimit$)),P.xb(2),P.gc("hidden",!P.bc(37,85,n.isCustomMonthlyLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.fromMonthlyLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(1),P.gc("hidden",!P.bc(40,87,n.isCustomMonthlyLimit$)),P.xb(2),P.gc("label",n.i18n.account.paymentLimits.toMonthlyLimit)("scale",n.currencyDecimalDigits())("prefix",n.currencyPrefix())("suffix",n.currencySuffix()),P.xb(2),P.gc("label",n.i18n.general.user)("allowContacts",!1),P.xb(2),P.gc("label",n.i18n.general.usersOfBroker)("filters",n.userSearchFilters(!0))("allowContacts",!1),P.xb(2),P.gc("label",n.i18n.general.changedBy)("filters",n.userSearchFilters(!1))("allowContacts",!1)}}function kn(e,t){if(1&e){var n=P.Rb();P.Qb(0,"mobile-result",38),P.Xb("click",(function(e){P.sc(n);var a=t.$implicit,i=P.Zb(2);return i.router.navigate(i.view(a)),e.stopPropagation()})),P.Qb(1,"div",39),P.Qb(2,"div",40),P.Qb(3,"label-value",41),P.Dc(4),P.Pb(),P.Qb(5,"label-value",41),P.Dc(6),P.Pb(),P.Qb(7,"label-value",41),P.Dc(8),P.ac(9,"currency"),P.Pb(),P.Qb(10,"label-value",41),P.Dc(11),P.ac(12,"currency"),P.Pb(),P.Qb(13,"label-value",41),P.Dc(14),P.ac(15,"currency"),P.Pb(),P.Qb(16,"label-value",41),P.Dc(17),P.ac(18,"currency"),P.Pb(),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(2);P.xb(3),P.gc("label",i.i18n.general.user),P.xb(1),P.Fc(" ",a.user.display," "),P.xb(1),P.gc("label",i.i18n.account.account),P.xb(1),P.Fc(" ",a.account.type.name," "),P.xb(1),P.gc("label",i.i18n.account.paymentLimits.paymentLimit),P.xb(1),P.Fc(" ",a.customAmountLimit?P.cc(9,12,a.amountLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(2),P.gc("label",i.i18n.account.paymentLimits.dailyLimit),P.xb(1),P.Fc(" ",a.customAmountPerDayLimit?P.cc(12,15,a.amountPerDayLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(2),P.gc("label",i.i18n.account.paymentLimits.weeklyLimit),P.xb(1),P.Fc(" ",a.customAmountPerWeekLimit?P.cc(15,18,a.amountPerWeekLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(2),P.gc("label",i.i18n.account.paymentLimits.monthlyLimit),P.xb(1),P.Fc(" ",a.customAmountPerMonthLimit?P.cc(18,21,a.amountPerMonthLimit,a.account.currency):i.i18n.account.limits.productDefault," ")}}function Ln(e,t){if(1&e){var n=P.Rb();P.Qb(0,"tr",38),P.Xb("click",(function(e){P.sc(n);var a=t.$implicit,i=P.Zb(3);return i.router.navigate(i.view(a)),e.stopPropagation()})),P.Qb(1,"td"),P.Dc(2),P.Pb(),P.Qb(3,"td"),P.Dc(4),P.Pb(),P.Qb(5,"td"),P.Dc(6),P.ac(7,"currency"),P.Pb(),P.Qb(8,"td"),P.Dc(9),P.ac(10,"currency"),P.Pb(),P.Qb(11,"td"),P.Dc(12),P.ac(13,"currency"),P.Pb(),P.Qb(14,"td"),P.Dc(15),P.ac(16,"currency"),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(2),P.Ec(a.user.display),P.xb(2),P.Ec(a.account.type.name),P.xb(2),P.Fc(" ",a.customAmountLimit?P.cc(7,6,a.amountLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",a.customAmountPerDayLimit?P.cc(10,9,a.amountPerDayLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",a.customAmountPerWeekLimit?P.cc(13,12,a.amountPerWeekLimit,a.account.currency):i.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",a.customAmountPerMonthLimit?P.cc(16,15,a.amountPerMonthLimit,a.account.currency):i.i18n.account.limits.productDefault," ")}}function wn(e,t){if(1&e&&(P.Qb(0,"table",42),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Qb(10,"th"),P.Dc(11),P.Pb(),P.Qb(12,"th"),P.Dc(13),P.Pb(),P.Pb(),P.Qb(14,"tbody"),P.Bc(15,Ln,17,18,"tr",43),P.ac(16,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.general.user),P.xb(2),P.Ec(a.i18n.account.account),P.xb(2),P.Ec(a.i18n.account.paymentLimits.paymentLimit),P.xb(2),P.Ec(a.i18n.account.paymentLimits.dailyLimit),P.xb(2),P.Ec(a.i18n.account.paymentLimits.weeklyLimit),P.xb(2),P.Ec(a.i18n.account.paymentLimits.monthlyLimit),P.xb(2),P.gc("ngForOf",null==(n=P.bc(16,7,a.results$))?null:n.results)}}function Cn(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.ac(1,"async"),P.Qb(2,"form",4),P.Qb(3,"div",5),P.Bc(4,hn,3,2,"div",6),P.Bc(5,vn,3,3,"div",6),P.Bc(6,Dn,48,89,"ng-container",7),P.ac(7,"async"),P.Pb(),P.Pb(),P.Pb(),P.Qb(8,"results-layout",8),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(9,"async"),P.Bc(10,kn,19,24,"mobile-result",9),P.Bc(11,wn,17,9,"table",10),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.account.paymentLimits.title.overview)("mobileHeading",a.i18n.account.paymentLimits.mobileTitle.overview)("headingActions",P.bc(1,9,a.headingActions$)),P.xb(2),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",(null==a.data.groups?null:a.data.groups.length)>1),P.xb(1),P.gc("ngIf",(null==a.currencies?null:a.currencies.length)>1),P.xb(1),P.gc("ngIf",P.bc(7,11,a.moreFilters$)),P.xb(2),P.gc("results",P.bc(9,13,a.results$))("rendering$",a.rendering$)}}var Qn,In=((Qn=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).paymentLimitsService=a,i.isCustomPaymentLimit$=new v.a(!1),i.isCustomDailyLimit$=new v.a(!1),i.isCustomWeeklyLimit$=new v.a(!1),i.isCustomMonthlyLimit$=new v.a(!1),i.currencies=[],i}return l(n,[{key:"getFormControlNames",value:function(){return["accountType","broker","brokers","by","currency","customAmountLimit","paymentLimitFrom","paymentLimitTo","dailyLimitFrom","dailyLimitTo","customAmountPerDayLimit","customAmountPerWeekLimit","weeklyLimitFrom","weeklyLimitTo","customAmountPerMonthLimit","monthlyLimitFrom","monthlyLimitTo","groups","user"]}},{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.addSub(this.paymentLimitsService.getAccountPaymentLimitsData().subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(n.prototype),"onDataInitialized",this).call(this,e),(e.accountTypes||[]).forEach((function(e){return t.currencies.push(e.currency)})),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customAmountLimit").valueChanges.subscribe((function(e){return t.isCustomPaymentLimit$.next("yes"===e)})),this.form.get("customAmountPerDayLimit").valueChanges.subscribe((function(e){return t.isCustomDailyLimit$.next("yes"===e)})),this.form.get("customAmountPerWeekLimit").valueChanges.subscribe((function(e){return t.isCustomWeeklyLimit$.next("yes"===e)})),this.form.get("customAmountPerMonthLimit").valueChanges.subscribe((function(e){return t.isCustomMonthlyLimit$.next("yes"===e)})),this.addSub(this.form.controls.currency.valueChanges.subscribe((function(e){return t.updateAccountTypes(e)}))),this.headingActions=[this.moreFiltersAction]}},{key:"doSearch",value:function(e){return this.paymentLimitsService.searchAccountPaymentLimits$Response(e)}},{key:"toSearchParams",value:function(e){var t=e;return this.isCustomPaymentLimit$.value?(t.customAmountLimit=!0,t.customAmountLimitRange=g.a.rangeFilter(e.paymentLimitFrom,e.paymentLimitTo)):t.customAmountLimit=!e.customAmountLimit&&null,this.isCustomDailyLimit$.value?(t.customAmountPerDayLimit=!0,t.customAmountPerDayLimitRange=g.a.rangeFilter(e.dailyLimitFrom,e.dailyLimitTo)):t.customAmountPerDayLimit=!e.customAmountPerDayLimit&&null,this.isCustomWeeklyLimit$.value?(t.customAmountPerWeekLimit=!0,t.customAmountPerWeekLimitRange=g.a.rangeFilter(e.weeklyLimitFrom,e.weeklyLimitTo)):t.customAmountPerWeekLimit=!e.customAmountPerWeekLimit&&null,this.isCustomMonthlyLimit$.value?(t.customAmountPerMonthLimit=!0,t.customAmountPerMonthLimitRange=g.a.rangeFilter(e.monthlyLimitFrom,e.monthlyLimitTo)):t.customAmountPerMonthLimit=!e.customAmountPerMonthLimit&&null,t}},{key:"userSearchFilters",value:function(e){var t={roles:[u.kb.BROKER]};return e||t.roles.push(u.kb.ADMINISTRATOR),t}},{key:"updateAccountTypes",value:function(e){var t=this.form.controls.accountType.value;e&&t&&this.data.accountTypes.find((function(e){return e.id===t})).currency.id!==e&&this.form.controls.accountType.setValue(null)}},{key:"accountTypes",value:function(){var e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter((function(t){return t.currency.id===e.id})):t}},{key:"findCurrency",value:function(e){if(this.singleCurrency)return this.singleCurrency;var t=this.form.controls.currency.value;if(t)return this.currencies.find((function(e){return e.id===t}));var n=this.form.controls.accountType.value;return e&&n?this.data.accountTypes.find((function(e){return e.id===n})).currency:null}},{key:"currencyDecimalDigits",value:function(){var e=this.findCurrency(!0);return e?e.decimalDigits:2}},{key:"currencyPrefix",value:function(){var e=this.findCurrency(!0);return e?e.prefix:null}},{key:"currencySuffix",value:function(){var e=this.findCurrency(!0);return e?e.suffix:null}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.moreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.lessFilters}},{key:"view",value:function(e){return["/banking",e.user.id,"account-payment-limits",e.account.type.id]}},{key:"resolveMenu",value:function(){return new y.a(y.b.ACCOUNT_PAYMENT_LIMITS_OVERVIEW)}},{key:"customLimitOptions",get:function(){var e=[{value:"yes",text:this.i18n.general.yes}];return e.push({value:"no",text:this.i18n.general.no}),e}}]),n}(p.a)).\u0275fac=function(e){return new(e||Qn)(P.Kb(P.r),P.Kb(cn.a))},Qn.\u0275cmp=P.Eb({type:Qn,selectors:[["search-payment-limits-overview"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","customAmountLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","paymentLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","paymentLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerDayLimit",3,"fieldOptions","emptyOption","label"],["formControlName","dailyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","dailyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerWeekLimit",3,"fieldOptions","emptyOption","label"],["formControlName","weeklyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","weeklyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerMonthLimit",3,"fieldOptions","emptyOption","label"],["formControlName","monthlyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","monthlyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label","allowContacts"],["labelPosition","side","formControlName","broker",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","by",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,gn,1,0,"ng-container",1),P.Pb(),P.Bc(3,Cn,12,15,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,w.a,C.a,Q.a,N.a,I.v,I.l,k.s,O.a,S.a,A.a,$.a,W.a,F.a],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),Qn);function Fn(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"label-value",5),P.Lb(2,"user-link",6),P.Pb(),P.Qb(3,"label-value",7),P.Dc(4),P.Pb(),P.Qb(5,"h3"),P.Dc(6),P.Pb(),P.Qb(7,"label-value",7),P.Dc(8),P.ac(9,"currency"),P.Pb(),P.Qb(10,"label-value",7),P.Dc(11),P.Pb(),P.Qb(12,"h3"),P.Dc(13),P.Pb(),P.Qb(14,"label-value",7),P.Dc(15),P.ac(16,"currency"),P.Pb(),P.Qb(17,"label-value",7),P.Dc(18),P.Pb(),P.Qb(19,"h3"),P.Dc(20),P.Pb(),P.Qb(21,"label-value",7),P.Dc(22),P.ac(23,"currency"),P.Pb(),P.Qb(24,"label-value",7),P.Dc(25),P.Pb(),P.Qb(26,"h3"),P.Dc(27),P.Pb(),P.Qb(28,"label-value",7),P.Dc(29),P.ac(30,"currency"),P.Pb(),P.Qb(31,"label-value",7),P.Dc(32),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("label",n.i18n.account.account),P.xb(1),P.Fc(" ",n.data.account.type.name," "),P.xb(2),P.Ec(n.i18n.account.paymentLimits.paymentLimit),P.xb(1),P.gc("label",n.i18n.account.paymentLimits.paymentLimit),P.xb(1),P.Fc(" ",P.cc(9,24,n.data.amountLimit,n.data.account.currency)," "),P.xb(2),P.gc("label",n.i18n.account.limits.mode),P.xb(1),P.Fc(" ",n.limitMode(n.data.customAmountLimit)," "),P.xb(2),P.Ec(n.i18n.account.paymentLimits.dailyLimit),P.xb(1),P.gc("label",n.i18n.account.paymentLimits.dailyLimit),P.xb(1),P.Fc(" ",P.cc(16,27,n.data.amountLimit,n.data.account.currency)," "),P.xb(2),P.gc("label",n.i18n.account.limits.mode),P.xb(1),P.Fc(" ",n.limitMode(n.data.customAmountLimit)," "),P.xb(2),P.Ec(n.i18n.account.paymentLimits.weeklyLimit),P.xb(1),P.gc("label",n.i18n.account.paymentLimits.weeklyLimit),P.xb(1),P.Fc(" ",P.cc(23,30,n.data.amountLimit,n.data.account.currency)," "),P.xb(2),P.gc("label",n.i18n.account.limits.mode),P.xb(1),P.Fc(" ",n.limitMode(n.data.customAmountLimit)," "),P.xb(2),P.Ec(n.i18n.account.paymentLimits.monthlyLimit),P.xb(1),P.gc("label",n.i18n.account.paymentLimits.monthlyLimit),P.xb(1),P.Fc(" ",P.cc(30,33,n.data.amountLimit,n.data.account.currency)," "),P.xb(2),P.gc("label",n.i18n.account.limits.mode),P.xb(1),P.Fc(" ",n.limitMode(n.data.customAmountLimit)," ")}}function Tn(e,t){if(1&e&&(P.Qb(0,"page-content",3),P.ac(1,"async"),P.Bc(2,Fn,33,36,"ng-container",4),P.Pb()),2&e){var n=P.Zb();P.gc("heading",n.i18n.account.paymentLimits.title.view)("mobileHeading",n.i18n.account.paymentLimits.mobileTitle.view)("headingActions",P.bc(1,4,n.headingActions$)),P.xb(2),P.gc("ngIf",n.data)}}function Sn(e,t){if(1&e&&(P.Qb(0,"tr"),P.Qb(1,"td"),P.Dc(2),P.ac(3,"date"),P.Pb(),P.Qb(4,"td"),P.Dc(5),P.Pb(),P.Qb(6,"td"),P.Dc(7),P.ac(8,"currency"),P.Pb(),P.Qb(9,"td"),P.Dc(10),P.ac(11,"currency"),P.Pb(),P.Qb(12,"td"),P.Dc(13),P.ac(14,"currency"),P.Pb(),P.Qb(15,"td"),P.Dc(16),P.ac(17,"currency"),P.Pb(),P.Qb(18,"td"),P.Dc(19),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(3);P.xb(2),P.Ec(P.bc(3,7,n.date)),P.xb(3),P.Ec(n.by.display),P.xb(2),P.Fc(" ",n.customAmountLimit?P.cc(8,9,n.amountLimit,a.data.account.currency):a.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",n.customAmountPerDayLimit?P.cc(11,12,n.amountPerDayLimit,a.data.account.currency):a.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",n.customAmountPerWeekLimit?P.cc(14,15,n.amountPerWeekLimit,a.data.account.currency):a.i18n.account.limits.productDefault," "),P.xb(3),P.Fc(" ",n.customAmountPerMonthLimit?P.cc(17,18,n.amountPerMonthLimit,a.data.account.currency):a.i18n.account.limits.productDefault," "),P.xb(3),P.Ec(n.comment)}}function On(e,t){if(1&e&&(P.Qb(0,"table",11),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Qb(10,"th"),P.Dc(11),P.Pb(),P.Qb(12,"th"),P.Dc(13),P.Pb(),P.Qb(14,"th"),P.Dc(15),P.Pb(),P.Pb(),P.Qb(16,"tbody"),P.Bc(17,Sn,20,21,"tr",12),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(3),P.Ec(n.i18n.general.date),P.xb(2),P.Ec(n.i18n.general.performedBy),P.xb(2),P.Ec(n.i18n.account.paymentLimits.paymentLimit),P.xb(2),P.Ec(n.i18n.account.paymentLimits.dailyLimit),P.xb(2),P.Ec(n.i18n.account.paymentLimits.weeklyLimit),P.xb(2),P.Ec(n.i18n.account.paymentLimits.monthlyLimit),P.xb(2),P.Ec(n.i18n.general.comments),P.xb(2),P.gc("ngForOf",n.data.history)}}function Nn(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"page-content",8),P.ac(2,"async"),P.Lb(3,"user-info",6),P.Pb(),P.Qb(4,"results-layout",9),P.Bc(5,On,18,8,"table",10),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("mode","empty")("heading",n.i18n.account.paymentLimits.title.history)("mobileHeading",n.i18n.account.paymentLimits.mobileTitle.history)("headingActions",P.bc(2,6,n.headingActions$)),P.xb(2),P.gc("user",n.data.user),P.xb(1),P.gc("results",n.data.history)}}var Bn,An=((Bn=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).paymentLimitsService=a,i.step$=new v.a("details"),i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(n.prototype),"onDataInitialized",this).call(this,e),this.detailsHeadingActions=e.editable?[new Yt.c("edit",this.i18n.general.edit,(function(){return t.navigateToEdit()}))]:[],this.detailsHeadingActions.push(new Yt.c("history",this.i18n.general.viewHistory,(function(){return t.showHistory()}))),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=e.editable?[new Yt.c("edit",this.i18n.general.edit,(function(){return t.navigateToEdit()}))]:[],this.historyHeadingActions.push(new Yt.c("arrow_back",this.i18n.general.details,(function(){return t.showView()})))}},{key:"limitMode",value:function(e){return e?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault}},{key:"showHistory",value:function(){this.headingActions=this.historyHeadingActions,this.step="history"}},{key:"showView",value:function(){this.headingActions=this.detailsHeadingActions,this.step="details"}},{key:"navigateToEdit",value:function(){this.router.navigate(["/banking",this.user,"account-payment-limits",this.accountType,"edit"])}},{key:"resolveMenu",value:function(){return this.menu.searchUsersMenu()}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}}]),n}(kt.a)).\u0275fac=function(e){return new(e||Bn)(P.Kb(P.r),P.Kb(cn.a))},Bn.\u0275cmp=P.Eb({type:Bn,selectors:[["view-account-payment-limits"]],features:[P.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],["class","table",4,"resultTable"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Tn,3,6,"page-content",1),P.Bc(4,Nn,6,8,"ng-container",2),P.Pb()),2&e&&(P.gc("ready",P.bc(1,4,t.data$))("ngSwitch",P.bc(2,6,t.step$)),P.xb(3),P.gc("ngSwitchCase","details"),P.xb(1),P.gc("ngSwitchCase","history"))},directives:[D.a,k.x,k.y,L.a,k.t,F.a,T.a,St.a,w.a,Q.a,k.s],pipes:[k.b,M.a,te.a],encapsulation:2,changeDetection:0}),Bn),En=o("PmQH"),$n=o("dVyd"),Rn=o("9d5G"),Zn=o("Muja"),Mn=o("SxV6");function Hn(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",4),P.ac(1,"async"),P.Qb(2,"payment-step-form",5),P.Xb("availablePaymentTypes",(function(e){return P.sc(n),P.Zb().availablePaymentTypes=e})),P.ac(3,"async"),P.Pb(),P.Qb(4,"actions",6),P.Qb(5,"action-button",7),P.Xb("action",(function(){return P.sc(n),P.Zb().toConfirm()})),P.ac(6,"async"),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.title)("mobileHeading",a.mobileTitle)("mode",P.bc(1,11,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("data",a.data)("pos",a.pos)("form",a.form)("currency",P.bc(3,13,a.currency$))("paymentTypeData$",a.paymentTypeData$)("customValuesControlGetter",a.customValuesControlGetter),P.xb(3),P.gc("disabled",P.bc(6,15,a.requesting$))("label",a.i18n.general.next)}}function qn(e,t){if(1&e){var n=P.Rb();P.Qb(0,"action-button",7),P.Xb("action",(function(){return P.sc(n),P.Zb(2).perform()})),P.ac(1,"async"),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("disabled",!a.canConfirm||P.bc(1,2,a.requesting$))("label",a.i18n.general.confirm)}}function Un(e,t){1&e&&P.Dc(0,"\xa0")}var Vn=function(){return[]};function jn(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",8),P.ac(1,"async"),P.Qb(2,"payment-step-confirm",9),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationMode$.next(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().perform(e)})),P.Pb(),P.Qb(3,"actions",6),P.Bc(4,qn,2,4,"action-button",10),P.ac(5,"async"),P.Bc(6,Un,1,0,"ng-template",null,11,P.Cc),P.Qb(8,"action-button",12),P.Xb("action",(function(){return P.sc(n),P.Zb().backToForm()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.qc(7),i=P.Zb();P.gc("heading",i.i18n.transaction.title.paymentConfirmation)("mobileHeading",i.i18n.transaction.mobileTitle.paymentConfirmation)("mode",P.bc(1,10,i.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("pos",i.pos)("preview",i.preview)("confirmationPassword",i.confirmationPassword)("showPaymentType",(i.availablePaymentTypes||P.ic(14,Vn)).length>1),P.xb(2),P.gc("ngIf",P.bc(5,12,i.confirmationMode$)!=i.ConfirmationMode.Device)("ngIfElse",a),P.xb(4),P.gc("label",i.i18n.general.previous)}}function zn(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",8),P.ac(1,"async"),P.Lb(2,"payment-step-done",13),P.Qb(3,"actions",6),P.Qb(4,"action-button",14),P.Xb("action",(function(){return P.sc(n),P.Zb().viewPerformed()})),P.Pb(),P.Qb(5,"action-button",12),P.Xb("action",(function(){return P.sc(n),P.Zb().reload()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.doneTitle)("mobileHeading",a.doneMobileTitle)("mode",P.bc(1,6,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("performed",a.performed),P.xb(2),P.gc("label",a.i18n.transaction.doneView),P.xb(1),P.gc("label",a.i18n.transaction.doneNew)}}function Gn(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var _n,Kn=function(e){var t=e.parent;if(t){var n=t.get("scheduling").value,a=t.get("firstInstallmentIsNow").value;if(Object(h.h)(e.value)&&("futureDate"===n||n===u.Y.SCHEDULED&&!a))return{required:!0}}return null},Xn=function(e){var t=e.parent;if(t){var n=t.get("scheduling").value,a=t.get("repeatUntilCanceled").value;if(n===u.Y.RECURRING&&!a){var i=parseInt(e.value,10);return isNaN(i)?{required:!0}:I.G.min(2)(e)}}return null},Yn=function(e){var t=e.parent;if(t){var n=t.get("scheduling").value,a=t.get("firstOccurrenceIsNow").value;if(Object(h.h)(e.value)&&n===u.Y.RECURRING&&!a)return{required:!0}}return null},Wn=((_n=function(e){s(a,e);var n=b(a);function a(e,t,i,r,o){var l;return c(this,a),(l=n.call(this,e)).bankingHelper=t,l.paymentsService=i,l.posService=r,l.changeDetector=o,l.ConfirmationMode=Rn.a,l.steps=["form","confirm","done"],l.step$=new v.a(null),l.currency$=new v.a(null),l.paymentTypeData$=new v.a(null),l.customValuesControls=new Map,l.confirmationMode$=new v.a(null),l}return l(a,[{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot;this.pos="pos"===t.url[t.url.length-1].path,this.pos||(this.fromParam=t.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=t.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam)),this.pos?(this.title=this.i18n.transaction.title.pos,this.mobileTitle=this.i18n.transaction.mobileTitle.pos):this.fromSystem?this.toSystem?(this.title=this.i18n.transaction.title.paymentSystemToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToSystem):(this.title=this.i18n.transaction.title.paymentSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToUser):this.toSelf?(this.title=this.i18n.transaction.title.paymentToSelf,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSelf):this.toSystem?(this.title=this.i18n.transaction.title.paymentToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSystem):(this.title=this.i18n.transaction.title.paymentToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToUser),this.form=this.buildForm(),this.confirmationPassword=this.formBuilder.control(null),this.addSub(this.pos?this.posService.dataForReceivePayment({}).subscribe((function(t){return e.data=t})):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:this.toParam}).subscribe((function(t){return e.data=t}))),this.addSub(this.form.get("account").valueChanges.subscribe((function(t){return e.updateCurrency(e.data,t)}))),this.addSub(this.paymentTypeData$.subscribe((function(t){null!=e.lastPaymentTypeData&&Object(Zn.a)(e.lastPaymentTypeData,t)||e.adjustForm(t),e.lastPaymentTypeData=t}))),this.addSub(this.form.valueChanges.subscribe((function(t){return e.adjustFormValidators(t)})))}},{key:"buildForm",value:function(){return this.formBuilder.group({account:null,subject:[this.pos?null:this.toParam,I.G.required],type:[null,I.G.required],amount:[null,I.G.required],description:null,scheduling:[u.Y.DIRECT,I.G.required],installmentsCount:null,firstInstallmentIsNow:!0,firstInstallmentDate:[null,Kn],repeatUntilCanceled:!0,occurrencesCount:[null,Xn],firstOccurrenceIsNow:!0,firstOccurrenceDate:[null,Yn]})}},{key:"updateCurrency",value:function(e,t){var n=null;!Object(h.h)(t)&&e&&e.accounts&&(n=e.accounts.find((function(e){return e.type.id===t}))),this.currency=n?n.currency:null}},{key:"adjustForm",value:function(e){var t=this.form.get("description");(e||{}).descriptionAvailability===u.i.REQUIRED?t.setValidators(I.G.required):Object(h.c)(t)}},{key:"adjustFormValidators",value:function(e){if(!this.lastValue||!Object(Zn.a)(this.lastValue,e)){this.lastValue=e;var t=this.form.get("firstInstallmentDate");"futureDate"===e.scheduling||e.scheduling===u.Y.SCHEDULED&&!e.firstInstallmentIsNow?t.setValidators(I.G.required):Object(h.c)(t);var n=this.form.get("installmentsCount");e.scheduling===u.Y.SCHEDULED?n.setValidators(I.G.compose([I.G.required,I.G.min(2)])):Object(h.c)(n);var a=this.form.get("occurrencesCount"),i=this.form.get("firstOccurrenceDate");e.scheduling===u.Y.RECURRING?(e.repeatUntilCanceled?Object(h.c)(a):a.setValidators(I.G.compose([I.G.required,I.G.min(2)])),e.firstOccurrenceIsNow?Object(h.c)(i):i.setValidators(I.G.required)):(Object(h.c)(a),Object(h.c)(i)),this.changeDetector.detectChanges()}}},{key:"onDataInitialized",value:function(e){if(Object(h.h)(e.accounts))this.notification.error(this.i18n.transaction.noAccounts);else{this.step="form";var t=e.accounts[0].type.id;this.form.patchValue({account:t},{emitEvent:!1}),this.updateCurrency(e,t)}}},{key:"updatePaymentTypeData",value:function(e){var t=this.form.get("amount");e&&e.fixedAmount?(t.setValue(e.fixedAmount),t.disable()):t.disabled&&t.enable()}},{key:"backToForm",value:function(){this.step="form"}},{key:"toConfirm",value:function(){var e=this,n={},a=this.paymentTypeData;if(a&&a.customFields){var i,r=t(a.customFields);try{for(r.s();!(i=r.n()).done;){var c=i.value;n[c.internalName]=this.customValuesControlGetter(c)}}catch(o){r.e(o)}finally{r.f()}}this.form.setControl("customValues",new I.m(n)),Object(h.F)(this.form)&&this.addSub(this.confirmDataRequest().subscribe((function(t){e.preview=t,e.step="confirm",e.canConfirm=e.authHelper.canConfirm(t.confirmationPasswordInput),e.canConfirm||e.notification.warning(e.authHelper.getConfirmationMessage(t.confirmationPasswordInput)),e.confirmationPassword.setValidators(t.confirmationPasswordInput?I.G.required:null),Object(h.y)()})))}},{key:"perform",value:function(e){var t=this;e&&this.confirmationPassword.setValue(e),Object(h.F)(this.confirmationPassword)&&(this.pos?this.posService.receivePayment({body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}):this.paymentsService.performPayment({owner:this.fromParam,body:this.preview.payment,confirmationPassword:this.confirmationPassword.value})).pipe(Object(Mn.a)()).subscribe((function(e){t.performed=e,t.step="done",Object(h.y)()}))}},{key:"confirmDataRequest",value:function(){var e=Object(Lt.a)(this.form.value),t=e;switch(e.scheduling){case"futureDate":t.scheduling=u.Y.SCHEDULED,t.installmentsCount=1;break;case u.Y.SCHEDULED:e.firstInstallmentIsNow&&(t.firstInstallmentDate=null);break;case u.Y.RECURRING:e.repeatUntilCanceled&&(t.occurrencesCount=null),e.firstOccurrenceIsNow&&(t.firstOccurrenceDate=null)}return delete e.firstInstallmentIsNow,delete e.repeatUntilCanceled,delete e.firstOccurrenceIsNow,this.pos?this.posService.previewReceivePayment({body:t}):this.paymentsService.previewPayment({owner:this.fromParam,body:t})}},{key:"viewPerformed",value:function(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}},{key:"reload",value:function(){this.step=null,this.currency=null,this.paymentTypeData=null,r(d(a.prototype),"reload",this).call(this)}},{key:"locateControl",value:function(e){return Object(h.t)(this.form,e)}},{key:"resolveMenu",value:function(e){return this.pos?y.b.POS:this.fromSystem?this.toSystem?y.b.PAYMENT_TO_SYSTEM:y.b.PAYMENT_TO_USER:this.menu.userMenu(e.fromUser,this.toSystem?y.b.PAYMENT_TO_SYSTEM:this.toSelf?y.b.PAYMENT_TO_SELF:y.b.PAYMENT_TO_USER)}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}},{key:"currency",get:function(){return this.currency$.value},set:function(e){this.currency$.next(e)}},{key:"paymentTypeData",get:function(){return this.paymentTypeData$.value},set:function(e){this.paymentTypeData$.next(e),this.updatePaymentTypeData(e)}},{key:"doneTitle",get:function(){if(this.performed)return this.performed.authorizationStatus===u.yb.PENDING?this.i18n.transaction.title.pendingPayment:this.i18n.transaction.title.processedPayment}},{key:"doneMobileTitle",get:function(){if(this.performed)return this.performed.authorizationStatus===u.yb.PENDING?this.i18n.transaction.mobileTitle.pendingPayment:this.i18n.transaction.mobileTitle.processedPayment}},{key:"customValuesControlGetter",get:function(){var e=this;return function(t){var n=t.internalName,a=e.customValuesControls.get(n);return null==a&&(a=e.formBuilder.control(t.defaultValue,t.required?I.G.required:null),e.customValuesControls.set(n,a)),a}}}]),a}(kt.a)).\u0275fac=function(e){return new(e||_n)(P.Kb(P.r),P.Kb(m.a),P.Kb(En.a),P.Kb($n.a),P.Kb(P.h))},_n.\u0275cmp=P.Eb({type:_n,selectors:[["payment"]],features:[P.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","pos","form","currency","paymentTypeData$","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"pos","preview","confirmationPassword","showPaymentType","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],["outline","",3,"label","action"],[1,"flex-grow-1","d-flex","flex-column",3,"performed"],[3,"label","action"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Hn,7,17,"page-content",1),P.Bc(4,jn,9,15,"page-content",2),P.Bc(5,zn,6,8,"page-content",2),P.Bc(6,Gn,2,0,"page-content",3),P.Pb()),2&e&&(P.gc("ready",P.bc(1,5,t.data$))("ngSwitch",P.bc(2,7,t.step$)),P.xb(3),P.gc("ngSwitchCase","form"),P.xb(1),P.gc("ngSwitchCase","confirm"),P.xb(1),P.gc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),_n),Jn=o("DvBi"),ea=o("+MtR"),ta=o("978R"),na=o("cvAk"),aa=o("nznZ"),ia=o("lS/A"),ra=o("bBjs");function ca(e,t){if(1&e&&(P.Qb(0,"notification",9),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.xb(1),P.Fc(" ",n.i18n.transaction.requiresAuthorization,"\n")}}function oa(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Lb(1,"user-link",11),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.fromUser),P.xb(1),P.gc("user",n.fromUser)}}function la(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.fromAccount),P.xb(1),P.Fc(" ",n.preview.fromAccount.type.name,"\n")}}function sa(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Lb(1,"user-link",11),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.toUser),P.xb(1),P.gc("user",n.toUser)}}function ua(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.toAccount),P.xb(1),P.Fc(" ",n.preview.toAccount.type.name,"\n")}}function ba(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.type),P.xb(1),P.Fc(" ",n.preview.paymentType.name,"\n")}}function fa(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Dc(1),P.ac(2,"currency"),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.amount),P.xb(1),P.Fc(" ",P.cc(2,2,n.preview.mainAmount,n.preview.currency),"\n")}}function da(e,t){if(1&e&&(P.Qb(0,"div"),P.Dc(1),P.ac(2,"currency"),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.xb(1),P.Gc(" ",n.fee.name,": ",P.cc(2,2,n.amount,a.preview.currency)," ")}}function ma(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Bc(1,da,3,5,"div",12),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.appliedFees),P.xb(1),P.gc("ngForOf",n.fees)}}function ga(e,t){1&e&&P.Lb(0,"custom-field-value",13),2&e&&P.gc("fieldValue",t.$implicit)}function pa(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Dc(1),P.ac(2,"date"),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.dueDate),P.xb(1),P.Fc(" ",P.bc(2,2,n.preview.installments[0].dueDate),"\n")}}function ha(e,t){if(1&e&&(P.Qb(0,"thead"),P.Qb(1,"th"),P.Dc(2),P.Pb(),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th",15),P.Dc(6),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(2),P.Ec(n.i18n.transaction.installmentNumber),P.xb(2),P.Ec(n.i18n.transaction.dueDate),P.xb(2),P.Ec(n.i18n.transaction.amount)}}function ya(e,t){if(1&e&&(P.Qb(0,"tr"),P.Qb(1,"td"),P.Dc(2),P.Pb(),P.Qb(3,"td"),P.Dc(4),P.ac(5,"date"),P.Pb(),P.Qb(6,"td",15),P.Dc(7),P.ac(8,"currency"),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.xb(2),P.Fc(" ",n.number," "),P.xb(2),P.Fc(" ",P.bc(5,3,n.dueDate)," "),P.xb(3),P.Fc(" ",P.cc(8,5,n.mainAmount,a.preview.currency)," ")}}function va(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Qb(1,"table",14),P.Bc(2,ha,7,3,"thead",4),P.ac(3,"async"),P.Qb(4,"tbody"),P.Bc(5,ya,9,8,"tr",12),P.Pb(),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.installments),P.xb(2),P.gc("ngIf",P.bc(3,3,n.layout.gtxs$)),P.xb(3),P.gc("ngForOf",n.preview.installments)}}function xa(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentNowManual," ")}}function Pa(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentNowFixed(n.preview.payment.occurrencesCount)," ")}}function Da(e,t){if(1&e&&(P.Ob(0),P.Bc(1,xa,2,1,"ng-container",4),P.Bc(2,Pa,2,1,"ng-container",4),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngIf",null==n.preview.payment.occurrencesCount),P.xb(1),P.gc("ngIf",null!=n.preview.payment.occurrencesCount)}}function ka(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.ac(2,"date"),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentDateManual(P.bc(2,1,n.preview.payment.firstOccurrenceDate))," ")}}var La=function(e,t){return{date:e,count:t}};function wa(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.ac(2,"date"),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentDateFixed(P.kc(3,La,P.bc(2,1,n.preview.payment.firstOccurrenceDate),n.preview.payment.occurrencesCount))," ")}}function Ca(e,t){if(1&e&&(P.Bc(0,ka,3,3,"ng-container",4),P.Bc(1,wa,3,6,"ng-container",4)),2&e){var n=P.Zb(2);P.gc("ngIf",null==n.preview.payment.occurrencesCount),P.xb(1),P.gc("ngIf",null!=n.preview.payment.occurrencesCount)}}function Qa(e,t){if(1&e&&(P.Qb(0,"label-value",10),P.Bc(1,Da,3,2,"ng-container",16),P.Bc(2,Ca,2,2,"ng-template",null,17,P.Cc),P.Pb()),2&e){var n=P.qc(3),a=P.Zb();P.gc("label",a.i18n.transaction.recurringPayment),P.xb(1),P.gc("ngIf",null==a.preview.payment.firstOccurrenceDate)("ngIfElse",n)}}function Ia(e,t){if(1&e&&P.Lb(0,"label-value",18),2&e){var n=P.Zb();P.gc("label",n.i18n.general.description)("value",n.preview.payment.description)}}function Fa(e,t){1&e&&P.Lb(0,"hr")}function Ta(e,t){1&e&&P.Lb(0,"hr")}function Sa(e,t){if(1&e&&(P.Ob(0),P.Bc(1,Ta,1,0,"hr",4),P.ac(2,"async"),P.Qb(3,"div",19),P.Dc(4),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("ngIf",P.bc(2,2,n.layout.gtxxs$)),P.xb(3),P.Ec(n.preview.confirmationMessage)}}function Oa(e,t){1&e&&P.Lb(0,"hr")}function Na(e,t){1&e&&P.Lb(0,"hr")}function Ba(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Bc(1,Na,1,0,"hr",4),P.ac(2,"async"),P.Qb(3,"confirmation-password",20),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationModeChanged.emit(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().confirmed.emit(e)})),P.Pb(),P.Nb()}if(2&e){var a=P.Zb();P.xb(1),P.gc("ngIf",P.bc(2,3,a.layout.gtxxs$)),P.xb(2),P.gc("passwordInput",a.preview.confirmationPasswordInput)("createDeviceConfirmation",a.createDeviceConfirmation)}}var Aa,Ea,$a=((Aa=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).confirmationModeChanged=new P.n,a.confirmed=new P.n,a}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===u.a.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===u.a.SYSTEM,this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,Object(h.h)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=function(){return{type:u.s.MANAGE_PAYMENT_REQUEST,transaction:e.transaction,paymentRequestAction:u.V.ACCEPT}},this.preview.confirmationPasswordInput||this.addShortcut(ea.k,(function(){return e.confirmed.emit()}))}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Aa)(P.Kb(P.r))},Aa.\u0275cmp=P.Eb({type:Aa,selectors:[["accept-payment-request-step-confirm"]],inputs:{form:"form",preview:"preview",transaction:"transaction",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[P.ub],decls:25,vars:30,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],[3,"formGroup"],["labelPosition","side","formControlName","processDate","minDate","tomorrow","maxDate","future100","fieldSize","full",3,"label","tooltip"],["formControlName","comments",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[3,"fieldValue"],[1,"table","table-hover"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(P.Bc(0,ca,2,1,"notification",0),P.Bc(1,oa,2,2,"label-value",1),P.Bc(2,la,2,2,"label-value",1),P.Bc(3,sa,2,2,"label-value",1),P.Bc(4,ua,2,2,"label-value",1),P.Bc(5,ba,2,2,"label-value",1),P.Bc(6,fa,3,5,"label-value",1),P.Bc(7,ma,2,2,"label-value",1),P.Bc(8,ga,1,1,"custom-field-value",2),P.Bc(9,pa,3,4,"label-value",1),P.Bc(10,va,6,5,"label-value",1),P.Bc(11,Qa,4,3,"label-value",1),P.Bc(12,Ia,1,2,"label-value",3),P.Bc(13,Fa,1,0,"hr",4),P.ac(14,"async"),P.Qb(15,"label-value",5),P.Dc(16),P.ac(17,"currency"),P.Pb(),P.Bc(18,Sa,5,4,"ng-container",4),P.Qb(19,"form",6),P.Bc(20,Oa,1,0,"hr",4),P.ac(21,"async"),P.Lb(22,"date-field",7),P.Lb(23,"textarea-field",8),P.Bc(24,Ba,4,5,"ng-container",4),P.Pb()),2&e&&(P.gc("ngIf",t.preview.pendingAuthorization),P.xb(1),P.gc("ngIf",!t.fromSelf&&t.fromUser),P.xb(1),P.gc("ngIf",t.fromSystem),P.xb(1),P.gc("ngIf",t.toUser),P.xb(1),P.gc("ngIf",t.toSystem),P.xb(1),P.gc("ngIf",t.showPaymentType),P.xb(1),P.gc("ngIf",null!=t.preview.mainAmount&&t.preview.totalAmount!==t.preview.mainAmount),P.xb(1),P.gc("ngIf",(null==t.fees?null:t.fees.length)>0),P.xb(1),P.gc("ngForOf",t.preview.customValues),P.xb(1),P.gc("ngIf",1===(null==t.preview.installments?null:t.preview.installments.length)),P.xb(1),P.gc("ngIf",(null==t.preview.installments?null:t.preview.installments.length)>1),P.xb(1),P.gc("ngIf","recurring"===t.preview.payment.scheduling),P.xb(1),P.gc("ngIf",t.preview.payment.description),P.xb(1),P.gc("ngIf",P.bc(14,23,t.layout.gtxxs$)),P.xb(2),P.gc("label",t.i18n.transaction.totalAmount),P.xb(1),P.Fc(" ",P.cc(17,25,t.preview.totalAmount,t.preview.currency),"\n"),P.xb(2),P.gc("ngIf",(t.preview.confirmationMessage||"").length>0),P.xb(1),P.gc("formGroup",t.form),P.xb(1),P.gc("ngIf",P.bc(21,28,t.layout.gtxxs$)),P.xb(2),P.gc("label",t.i18n.transaction.processDate)("tooltip",t.i18n.transaction.processDateTooltip),P.xb(1),P.gc("label",t.i18n.general.comments),P.xb(1),P.gc("ngIf",t.preview.confirmationPasswordInput))},directives:[k.t,k.s,F.a,I.I,I.w,I.n,B.a,I.v,I.l,ta.b,Qt.a,na.a,T.a,aa.a,ia.a,ra.a],pipes:[k.b,M.a,te.a],encapsulation:2,changeDetection:0}),Aa),Ra=o("H4pW"),Za=((Ea=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).bankingHelper=a,i}return l(n,[{key:"ngOnInit",value:function(){var e,t,a=this;r(d(n.prototype),"ngOnInit",this).call(this);var i=!0;(null===(e=this.performed)||void 0===e?void 0:e.kind)===u.zb.PAYMENT_REQUEST?(this.icon="done",this.message=this.performed.kind?this.i18n.transaction.processedPaymentRequestWithNumber(this.performed.transactionNumber):this.i18n.transaction.processedPaymentRequest):(null===(t=this.performed)||void 0===t?void 0:t.authorizationStatus)===u.yb.PENDING?(this.icon="scheduled",this.message=this.performed.transactionNumber?this.i18n.transaction.pendingWithNumber(this.performed.transactionNumber):this.i18n.transaction.pending):this.performed?(this.icon="done",this.message=this.performed.transactionNumber?this.i18n.transaction.processedWithNumber(this.performed.transactionNumber):this.i18n.transaction.processed):(this.icon="scheduled",this.message=this.i18n.transaction.acceptedScheduledPaymentRequest(this.processDate),i=!1),i&&this.addShortcut(ea.k,(function(){return a.router.navigate(["banking","transaction",a.bankingHelper.transactionNumberOrId(a.performed)])}))}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Ea)(P.Kb(P.r),P.Kb(m.a))},Ea.\u0275cmp=P.Eb({type:Ea,selectors:[["request-payment-step-done"]],inputs:{performed:"performed",processDate:"processDate"},features:[P.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(P.Qb(0,"div",0),P.Qb(1,"div",1),P.Qb(2,"div",2),P.Lb(3,"icon",3),P.Pb(),P.Qb(4,"div",4),P.Dc(5),P.Pb(),P.Pb(),P.Pb()),2&e&&(P.xb(3),P.gc("icon",t.icon),P.xb(2),P.Ec(t.message))},directives:[Ra.a],encapsulation:2,changeDetection:0}),Ea);function Ma(e,t){if(1&e){var n=P.Rb();P.Qb(0,"action-button",9),P.Xb("action",(function(){return P.sc(n),P.Zb(2).perform()})),P.ac(1,"async"),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("disabled",!a.canConfirm||P.bc(1,2,a.requesting$))("label",a.i18n.general.confirm)}}function Ha(e,t){1&e&&P.Dc(0,"\xa0")}function qa(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",4),P.ac(1,"async"),P.Qb(2,"accept-payment-request-step-confirm",5),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationMode$.next(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().perform(e)})),P.Pb(),P.Qb(3,"actions",6),P.Bc(4,Ma,2,4,"action-button",7),P.ac(5,"async"),P.Bc(6,Ha,1,0,"ng-template",null,8,P.Cc),P.Pb(),P.Pb()}if(2&e){var a=P.qc(7),i=P.Zb();P.gc("heading",i.i18n.transaction.title.paymentConfirmation)("mobileHeading",i.i18n.transaction.mobileTitle.paymentConfirmation)("mode",P.bc(1,10,i.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("transaction",i.transactionKey)("preview",i.data)("confirmationPassword",i.confirmationPassword)("form",i.form)("showPaymentType",!0),P.xb(2),P.gc("ngIf",P.bc(5,12,i.confirmationMode$)!=i.ConfirmationMode.Device)("ngIfElse",a)}}function Ua(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",10),P.ac(1,"async"),P.Lb(2,"request-payment-step-done",11),P.ac(3,"date"),P.Qb(4,"actions",6),P.Qb(5,"action-button",12),P.Xb("action",(function(){return P.sc(n),P.Zb().viewPerformed()})),P.Pb(),P.Qb(6,"action-button",13),P.Xb("action",(function(){return P.sc(n),P.Zb().reload()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.doneTitle)("mobileHeading",a.doneMobileTitle)("mode",P.bc(1,7,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("performed",a.performed)("processDate",P.bc(3,9,a.form.value.processDate)),P.xb(3),P.gc("label",a.i18n.transaction.doneView),P.xb(1),P.gc("label",a.i18n.transaction.doneNew)}}function Va(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var ja,za=((ja=function(e){s(n,e);var t=b(n);function n(e,a,i){var r;return c(this,n),(r=t.call(this,e)).bankingHelper=a,r.paymentRequestsService=i,r.ConfirmationMode=Rn.a,r.steps=["confirm","done"],r.step$=new v.a(null),r.confirmationMode$=new v.a(null),r}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.transactionKey=this.route.snapshot.params.key,this.addSub(this.paymentRequestsService.previewPaymentRequest({key:this.transactionKey}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){this.form=this.formBuilder.group({processDate:null,comments:null}),this.confirmationPassword=this.formBuilder.control(null),this.step="confirm",this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.confirmationPassword.setValidators(e.confirmationPasswordInput?I.G.required:null)}},{key:"perform",value:function(e){var t=this;if(Object(h.F)(this.form)&&Object(h.F)(this.confirmationPassword)){e&&this.confirmationPassword.setValue(e);var n=Object(Lt.a)(this.form.value);this.addSub(this.paymentRequestsService.acceptPaymentRequest({key:this.transactionKey,confirmationPassword:this.confirmationPassword.value,body:n}).subscribe((function(e){t.performed=e,t.step="done",Object(h.y)()})))}}},{key:"viewPerformed",value:function(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}},{key:"locateControl",value:function(e){return Object(h.t)(this.form,e)}},{key:"resolveMenu",value:function(){return y.b.PAYMENT_REQUESTS}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}},{key:"doneTitle",get:function(){if(this.performed)return this.performed.authorizationStatus===u.yb.PENDING?this.i18n.transaction.title.pendingPayment:this.i18n.transaction.title.processedPayment}},{key:"doneMobileTitle",get:function(){if(this.performed)return this.performed.authorizationStatus===u.yb.PENDING?this.i18n.transaction.mobileTitle.pendingPayment:this.i18n.transaction.mobileTitle.processedPayment}}]),n}(kt.a)).\u0275fac=function(e){return new(e||ja)(P.Kb(P.r),P.Kb(m.a),P.Kb(Jn.a))},ja.\u0275cmp=P.Eb({type:ja,selectors:[["accept-payment-request"]],features:[P.ub],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"transaction","preview","confirmationPassword","form","showPaymentType","confirmationModeChanged","confirmed"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"performed","processDate"],[3,"label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,qa,8,14,"page-content",1),P.Bc(4,Ua,7,11,"page-content",2),P.Bc(5,Va,2,0,"page-content",3),P.Pb()),2&e&&(P.gc("ready",P.bc(1,4,t.data$))("ngSwitch",P.bc(2,6,t.step$)),P.xb(3),P.gc("ngSwitchCase","confirm"),P.xb(1),P.gc("ngSwitchCase","done"))},directives:[D.a,k.x,k.y,k.z,L.a,$a,wt.a,k.t,Ct.a,Za,Y.a],pipes:[k.b,te.a],encapsulation:2,changeDetection:0}),ja),Ga=o("a/z7"),_a=o("/uUt"),Ka=o("Kj3r"),Xa=o("Xel3"),Ya=o("Y+zs"),Wa=o("Zcpn"),Ja=o("yHfF"),ei=o("wR2l"),ti=["toUser"],ni=["amount"];function ai(e,t){if(1&e&&(P.Qb(0,"label-value",13),P.Lb(1,"user-link",14),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.toSystem?n.i18n.transaction.receiver:n.i18n.transaction.fromUser),P.xb(1),P.gc("user",n.fromUser)}}function ii(e,t){1&e&&P.Lb(0,"br")}function ri(e,t){1&e&&P.Dc(0," - ")}function ci(e,t){if(1&e&&(P.Ob(0),P.Bc(1,ii,1,0,"br",24),P.ac(2,"async"),P.Bc(3,ri,1,0,"ng-template",null,25,P.Cc),P.Dc(5),P.Nb()),2&e){var n=P.qc(4),a=P.Zb().$implicit,i=P.Zb(2);P.xb(1),P.gc("ngIf",P.bc(2,3,i.layout.ltsm$))("ngIfElse",n),P.xb(4),P.Fc(" ",a.number," ")}}function oi(e,t){if(1&e){var n=P.Rb();P.Qb(0,"div",18),P.Qb(1,"div",19),P.Qb(2,"input",20,21),P.Xb("keyup.enter",(function(){return P.sc(n),P.qc(3).click()})),P.Pb(),P.Qb(4,"label",22),P.Qb(5,"div",23),P.Dc(6),P.Bc(7,ci,6,5,"ng-container",2),P.Pb(),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit;P.xb(2),P.gc("id","from_"+a.id)("value",a.type.id),P.xb(2),P.gc("for","from_"+a.id),P.xb(2),P.Fc(" ",a.type.name," "),P.xb(1),P.gc("ngIf",a.number)}}function li(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"label-value",15),P.Bc(2,oi,8,5,"div",16),P.Lb(3,"field-errors",17),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("label",n.i18n.transaction.toAccount),P.xb(1),P.gc("ngForOf",n.data.accounts),P.xb(1),P.gc("control",n.form.get("account"))}}function si(e,t){if(1&e&&P.Lb(0,"field-option",31),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.display)}}function ui(e,t){if(1&e&&(P.Qb(0,"single-selection-field",29),P.Bc(1,si,1,2,"field-option",30),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngForOf",n.data.allowedUsers)}}var bi=function(e){return[e]},fi=function(e){return{usersToExclude:e}};function di(e,t){if(1&e){var n=P.Rb();P.Qb(0,"user-field",32,33),P.Xb("selected",(function(e){P.sc(n),P.Zb(2);var t=P.qc(8);return e?t.focus():null})),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("autoSearch",!a.allowPrincipal)("filters",P.jc(9,fi,a.fromUser&&!a.fromSelf?P.jc(7,bi,a.fromParam):null))("allowContacts",a.allowContacts)("allowSearch",a.allowSearch)("allowPrincipal",a.allowPrincipal)("allowQrCode",a.allowQrCode)("principalTypes",a.data.principalTypes)}}function mi(e,t){if(1&e&&(P.Qb(0,"label-value",26),P.Bc(1,ui,2,1,"single-selection-field",27),P.Bc(2,di,2,11,"ng-template",null,28,P.Cc),P.Pb()),2&e){var n=P.qc(3),a=P.Zb();P.gc("label",a.i18n.transaction.receiver),P.xb(1),P.gc("ngIf",a.fixedUsersList)("ngIfElse",n)}}function gi(e,t){if(1&e&&(P.Qb(0,"label-value",34),P.Lb(1,"user-link",14),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.receiver),P.xb(1),P.gc("user",n.toUser)}}function pi(e,t){if(1&e&&P.Lb(0,"field-option",31),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function hi(e,t){if(1&e&&(P.Qb(0,"single-selection-field",35,36),P.Bc(2,pi,1,2,"field-option",30),P.ac(3,"async"),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.type),P.xb(2),P.gc("ngForOf",P.bc(3,2,n.paymentTypes$))}}function yi(e,t){if(1&e&&P.Lb(0,"custom-field-input",37),2&e){var n=t.$implicit,a=P.Zb();P.gc("field",n)("formControl",a.customValuesControlGetter(n))}}function vi(e,t){if(1&e&&P.Lb(0,"field-option",43),2&e){var n=P.Zb(2);P.gc("text",n.i18n.transaction.schedulingSingle)}}function xi(e,t){if(1&e&&P.Lb(0,"field-option",44),2&e){var n=P.Zb(2);P.gc("text",n.i18n.transaction.schedulingInstallments)}}function Pi(e,t){if(1&e&&P.Lb(0,"field-option",45),2&e){var n=P.Zb(2);P.gc("text",n.i18n.transaction.schedulingRecurring)}}function Di(e,t){if(1&e&&(P.Qb(0,"single-selection-field",38),P.Lb(1,"field-option",39),P.Bc(2,vi,1,1,"field-option",40),P.Bc(3,xi,1,1,"field-option",41),P.Bc(4,Pi,1,1,"field-option",42),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.scheduling),P.xb(1),P.gc("text",n.i18n.transaction.schedulingDirect),P.xb(1),P.gc("ngIf",(null==n.paymentTypeData$.value?null:n.paymentTypeData$.value.maxInstallments)>0),P.xb(1),P.gc("ngIf",(null==n.paymentTypeData$.value?null:n.paymentTypeData$.value.maxInstallments)>1),P.xb(1),P.gc("ngIf",null==n.paymentTypeData$.value?null:n.paymentTypeData$.value.allowsRecurringPayments)}}function ki(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"input-field",46),P.Lb(2,"boolean-field",47),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("label",n.i18n.transaction.installmentsCount),P.xb(1),P.gc("label",n.i18n.transaction.firstInstallmentIsImmediate)}}function Li(e,t){if(1&e&&P.Lb(0,"input-field",51),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.occurrencesCount)}}function wi(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"boolean-field",48),P.Qb(2,"radio-group-field",49),P.Lb(3,"field-option",31),P.Lb(4,"field-option",31),P.Pb(),P.Bc(5,Li,1,1,"input-field",50),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("label",n.i18n.transaction.firstOccurrenceIsImmediate),P.xb(1),P.gc("label",n.i18n.transaction.repeatUntil),P.xb(1),P.gc("value",!0)("text",n.i18n.transaction.repeatUntilManual),P.xb(1),P.gc("value",!1)("text",n.i18n.transaction.repeatUntilFixed),P.xb(1),P.gc("ngIf",!1===n.form.value.repeatUntilCanceled)}}function Ci(e,t){if(1&e&&P.Lb(0,"textarea-field",53),2&e){var n=P.Zb().ngIf,a=P.Zb();P.gc("required","required"===n)("label",a.i18n.general.description)}}function Qi(e,t){if(1&e&&(P.Ob(0),P.Bc(1,Ci,1,2,"textarea-field",52),P.Nb()),2&e){var n=t.ngIf;P.xb(1),P.gc("ngIf","disabled"!==n)}}var Ii,Fi=[Ga.a.FORBIDDEN,Ga.a.UNAUTHORIZED,Ga.a.NOT_FOUND],Ti=((Ii=function(e){s(n,e);var t=b(n);function n(e,a,i){var r;return c(this,n),(r=t.call(this,e)).bankingHelper=a,r.paymentRequestsService=i,r.availablePaymentTypes=new P.n,r.accountBalanceLabel$=new v.a(null),r.fixedDestination=!1,r.paymentTypes$=new v.a(null),r}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",(function(){return new Map})),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe(Object(_a.a)(),Object(Ka.a)(g.a.DEBOUNCE_TIME)).subscribe((function(){return e.fetchPaymentTypes()}))),this.addSub(this.form.get("account").valueChanges.pipe(Object(_a.a)(),Object(Ka.a)(g.a.DEBOUNCE_TIME)).subscribe((function(){return e.adjustPaymentTypes()}))),this.addSub(this.form.get("type").valueChanges.pipe(Object(_a.a)(),Object(Ka.a)(g.a.DEBOUNCE_TIME)).subscribe((function(t){return e.fetchPaymentTypeData(t)}))),this.addSub(this.layout.xxs$.subscribe((function(){return e.updateAccountBalanceLabel()}))),this.updateAccountBalanceLabel()}},{key:"updateAccountBalanceLabel",value:function(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}},{key:"fetchPaymentTypes",value:function(){var e=this;this.dataCache.clear(),this.fetchedPaymentTypes=null;var t=g.a.escapeNumeric(this.form.value.subject);""!==t&&this.errorHandler.requestWithCustomErrorHandler((function(n){e.addSub(e.paymentRequestsService.dataForSendPaymentRequest({owner:e.fromParam,to:t,fields:["toUser","paymentTypes","paymentTypeData"]}).subscribe((function(t){e.setFetchedPaymentTypes(t)}),(function(t){if(e.allowPrincipal&&e.userField&&t.status===Ga.a.NOT_FOUND){var a=t.error;if("string"==typeof a)try{a=JSON.parse(a)}catch(r){a={}}var i=a.entityType;if(!Object(h.a)(i)&&i.endsWith("User"))return void e.userField.search()}Fi.includes(t.status)||n(t)})))}))}},{key:"adjustPaymentTypes",value:function(){var e=this.form.value;if(0!==(e.subject||"").trim().length){var t=this.fetchedPaymentTypes||[];Object(h.h)(t)&&this.notification.error(this.i18n.transaction.noTypes);var n=t.filter((function(t){return t.from.id===e.account})),a=this.form.value.type,i=null;Object(h.h)(n)?i={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(n),n.find((function(e){return e.id===a}))||(a=n[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:a}),this.form.get("account").setErrors(i),this.form.get("account").markAsTouched(),Object(h.h)(a)||this.fetchPaymentTypeData(a),this.availablePaymentTypes.emit(n)}}},{key:"setFetchedPaymentTypes",value:function(e){this.userField&&(this.userField.user=e.toUser),this.fetchedPaymentTypes=e.paymentTypes;var t=e.paymentTypeData;t&&this.dataCache.set(t.id,t),this.adjustPaymentTypes()}},{key:"fetchPaymentTypeData",value:function(e){var t=this,n=this.form.value;if(!Object(h.h)(n.subject)&&!Object(h.h)(e)){var a=this.dataCache.get(e);a?this.setPaymentTypeData(a):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler((function(a){t.addSub(t.paymentRequestsService.dataForSendPaymentRequest({owner:t.fromParam,to:n.subject,type:e,fields:["paymentTypeData"]}).subscribe((function(e){t.setPaymentTypeData(e.paymentTypeData)}),(function(e){Fi.includes(e.status)||a(e)})))})))}}},{key:"setPaymentTypeData",value:function(e){((this.paymentTypeData$.value||{}).id||null)!==((e||{}).id||null)&&(e&&(this.dataCache.set(e.id,e),Object(h.j)(this.amountField)),this.paymentTypeData$.next(e))}},{key:"fixedUsersList",get:function(){return!Object(h.h)(this.data.allowedUsers)}},{key:"allowQrCode",get:function(){return this.allowPrincipal&&this.data.allowScanQrCode}},{key:"allowPrincipal",get:function(){return!Object(h.h)(this.data.principalTypes)}},{key:"allowSearch",get:function(){return this.data.allowAutocomplete}},{key:"allowContacts",get:function(){return this.data.allowContacts}},{key:"singleAccount",get:function(){var e=this.data.accounts||[];return 1===e.length?e[0]:null}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Ii)(P.Kb(P.r),P.Kb(m.a),P.Kb(Jn.a))},Ii.\u0275cmp=P.Eb({type:Ii,selectors:[["request-payment-step-form"]],viewQuery:function(e,t){var n;1&e&&(P.Hc(ti,!0),P.yc(ni,!0)),2&e&&(P.pc(n=P.Yb())&&(t.userField=n.first),P.pc(n=P.Yb())&&(t.amountField=n.first))},inputs:{data:"data",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",toSystem:"toSystem",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[P.ub],decls:20,vars:28,consts:[[3,"formGroup"],["kind","field",3,"label",4,"ngIf"],[4,"ngIf"],["kind","field","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],["formControlName","expirationDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["kind","field",3,"label"],[3,"user"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],[4,"ngIf","ngIfElse"],["separator",""],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["kind","fieldView",3,"label"],["formControlName","type","required","",3,"label"],["type",""],[3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsImmediate",3,"label"],["formControlName","firstOccurrenceIsImmediate",3,"label"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(e,t){if(1&e&&(P.Ob(0,0),P.Bc(1,ai,2,2,"label-value",1),P.Bc(2,li,4,3,"ng-container",2),P.Bc(3,mi,4,3,"label-value",3),P.Bc(4,gi,2,2,"label-value",4),P.Bc(5,hi,4,4,"single-selection-field",5),P.ac(6,"async"),P.Lb(7,"decimal-field",6,7),P.Lb(9,"date-field",8),P.Bc(10,yi,1,2,"custom-field-input",9),P.ac(11,"async"),P.Bc(12,Di,5,5,"single-selection-field",10),P.ac(13,"async"),P.ac(14,"async"),P.Ob(15,11),P.Bc(16,ki,3,2,"ng-container",12),P.Bc(17,wi,6,7,"ng-container",12),P.Nb(),P.Bc(18,Qi,2,1,"ng-container",2),P.ac(19,"async"),P.Nb()),2&e){var n,a,i,r=null;P.gc("formGroup",t.form),P.xb(1),P.gc("ngIf",t.fromUser&&!t.fromSelf),P.xb(1),P.gc("ngIf",!t.singleAccount),P.xb(1),P.gc("ngIf",!t.fixedDestination),P.xb(1),P.gc("ngIf",t.fixedDestination&&t.toUser),P.xb(1),P.gc("ngIf",(null==(n=P.bc(6,18,t.paymentTypes$))?null:n.length)>1),P.xb(2),P.gc("focused",t.fixedDestination)("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix),P.xb(2),P.gc("label",t.i18n.general.expirationDate),P.xb(1),P.gc("ngForOf",null==(a=P.bc(11,20,t.paymentTypeData$))?null:a.customFields),P.xb(2),P.gc("ngIf",(null==(r=P.bc(13,22,t.paymentTypeData$))?null:r.allowsRecurringPayments)||(null==(r=P.bc(14,24,t.paymentTypeData$))?null:r.maxInstallments)>0),P.xb(3),P.gc("ngSwitch",t.form.value.scheduling),P.xb(1),P.gc("ngSwitchCase","scheduled"),P.xb(1),P.gc("ngSwitchCase","recurring"),P.xb(1),P.gc("ngIf",(null==(i=P.bc(19,26,t.paymentTypeData$))?null:i.descriptionAvailability)||"disabled")}},directives:[I.w,I.n,k.t,A.a,I.v,I.l,I.D,ra.a,B.a,k.s,k.x,k.y,F.a,T.a,Xa.a,I.A,I.e,S.a,O.a,$.a,Ya.a,I.k,E.a,Wa.a,Ja.a,ei.a,Qt.a],pipes:[k.b],encapsulation:2,changeDetection:0}),Ii);function Si(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",4),P.ac(1,"async"),P.Qb(2,"request-payment-step-form",5),P.Xb("availablePaymentTypes",(function(e){return P.sc(n),P.Zb().availablePaymentTypes=e})),P.ac(3,"async"),P.Pb(),P.Qb(4,"actions",6),P.Qb(5,"action-button",7),P.Xb("action",(function(){return P.sc(n),P.Zb().perform()})),P.ac(6,"async"),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.title)("mobileHeading",a.mobileTitle)("mode",P.bc(1,11,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("data",a.data)("form",a.form)("currency",P.bc(3,13,a.currency$))("paymentTypeData$",a.paymentTypeData$)("toSystem",a.toSystem)("customValuesControlGetter",a.customValuesControlGetter),P.xb(3),P.gc("disabled",P.bc(6,15,a.requesting$))("label",a.i18n.general.confirm)}}function Oi(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",8),P.ac(1,"async"),P.Lb(2,"request-payment-step-done",9),P.Qb(3,"actions",6),P.Qb(4,"action-button",10),P.Xb("action",(function(){return P.sc(n),P.Zb().viewPerformed()})),P.Pb(),P.Qb(5,"action-button",11),P.Xb("action",(function(){return P.sc(n),P.Zb().reload()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.transaction.title.paymentRequestSent)("mobileHeading",a.i18n.transaction.mobileTitle.paymentRequestSent)("mode",P.bc(1,6,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("performed",a.performed),P.xb(2),P.gc("label",a.i18n.transaction.doneView),P.xb(1),P.gc("label",a.i18n.transaction.doneNew)}}function Ni(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var Bi,Ai=function(e){var t=e.parent;if(t){var n=t.get("scheduling").value,a=t.get("repeatUntilCanceled").value;if(n===u.Y.RECURRING&&!a){var i=parseInt(e.value,10);return isNaN(i)?{required:!0}:I.G.min(2)(e)}}return null},Ei=((Bi=function(e){s(a,e);var n=b(a);function a(e,t,i,r){var o;return c(this,a),(o=n.call(this,e)).bankingHelper=t,o.paymentRequestsService=i,o.changeDetector=r,o.steps=["form","done"],o.step$=new v.a(null),o.currency$=new v.a(null),o.paymentTypeData$=new v.a(null),o.customValuesControls=new Map,o}return l(a,[{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot;this.fromParam=t.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=t.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam),this.fromSystem?(this.title=this.i18n.transaction.title.paymentRequestSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestSystemToUser):this.toSystem?(this.title=this.i18n.transaction.title.paymentRequestToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToSystem):(this.title=this.i18n.transaction.title.paymentRequestToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToUser),this.form=this.buildForm(),this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:this.toParam}).subscribe((function(t){return e.data=t}))),this.addSub(this.form.get("account").valueChanges.subscribe((function(t){return e.updateCurrency(e.data,t)}))),this.addSub(this.paymentTypeData$.subscribe((function(t){null!=e.lastPaymentTypeData&&Object(Zn.a)(e.lastPaymentTypeData,t)||e.adjustForm(t),e.lastPaymentTypeData=t}))),this.addSub(this.form.valueChanges.subscribe((function(t){return e.adjustFormValidators(t)})))}},{key:"buildForm",value:function(){return this.formBuilder.group({account:null,subject:[this.toParam,I.G.required],type:[null,I.G.required],amount:[null,I.G.required],expirationDate:[null,I.G.required],description:null,scheduling:[u.Y.DIRECT,I.G.required],installmentsCount:null,firstInstallmentIsImmediate:!1,repeatUntilCanceled:!0,occurrencesCount:[null,Ai],firstOccurrenceIsImmediate:!1})}},{key:"updateCurrency",value:function(e,t){var n=null;!Object(h.h)(t)&&e&&e.accounts&&(n=e.accounts.find((function(e){return e.type.id===t}))),this.currency=n?n.currency:null}},{key:"adjustForm",value:function(e){var t=this.form.get("description");(e||{}).descriptionAvailability===u.i.REQUIRED?t.setValidators(I.G.required):Object(h.c)(t)}},{key:"adjustFormValidators",value:function(e){if(!this.lastValue||!Object(Zn.a)(this.lastValue,e)){this.lastValue=e;var t=this.form.get("installmentsCount");e.scheduling===u.Y.SCHEDULED?t.setValidators(I.G.compose([I.G.required,I.G.min(2)])):Object(h.c)(t);var n=this.form.get("occurrencesCount");e.scheduling===u.Y.RECURRING?e.repeatUntilCanceled?Object(h.c)(n):n.setValidators(I.G.compose([I.G.required,I.G.min(2)])):Object(h.c)(n),this.changeDetector.detectChanges()}}},{key:"onDataInitialized",value:function(e){if(Object(h.h)(e.accounts))this.notification.error(this.i18n.transaction.noAccounts);else{this.step="form";var t=e.accounts[0].type.id;this.form.patchValue({account:t},{emitEvent:!1}),this.updateCurrency(e,t)}}},{key:"updatePaymentTypeData",value:function(e){var t=this.form.get("amount");e&&e.fixedAmount?(t.setValue(e.fixedAmount),t.disable()):t.disabled&&t.enable()}},{key:"perform",value:function(){var e=this,n={},a=this.paymentTypeData;if(a&&a.customFields){var i,r=t(a.customFields);try{for(r.s();!(i=r.n()).done;){var c=i.value;n[c.internalName]=this.customValuesControlGetter(c)}}catch(o){r.e(o)}finally{r.f()}}this.form.setControl("customValues",new I.m(n)),Object(h.F)(this.form)&&this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.transaction.confirmPaymentRequest,callback:function(){return e.paymentRequestsService.sendPaymentRequest({owner:e.fromParam,body:e.confirmDataRequest()}).pipe(Object(Mn.a)()).subscribe((function(t){e.performed=t,e.step="done",Object(h.y)()}))}})}},{key:"confirmDataRequest",value:function(){var e=Object(Lt.a)(this.form.value),t=e;switch(e.scheduling){case"futureDate":t.scheduling=u.W.SCHEDULED,t.installmentsCount=1;break;case u.W.RECURRING:e.repeatUntilCanceled&&(t.occurrencesCount=null)}return t.expirationDate=g.a.shiftToDayEnd(t.expirationDate),delete e.firstInstallmentIsNow,delete e.repeatUntilCanceled,delete e.firstOccurrenceIsNow,t}},{key:"viewPerformed",value:function(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}},{key:"reload",value:function(){this.step=null,this.currency=null,this.paymentTypeData=null,r(d(a.prototype),"reload",this).call(this)}},{key:"locateControl",value:function(e){return Object(h.t)(this.form,e)}},{key:"resolveMenu",value:function(e){return this.fromSystem?y.b.PAYMENT_REQUEST_TO_USER:this.menu.userMenu(e.fromUser,this.toSystem?y.b.PAYMENT_REQUEST_TO_SYSTEM:y.b.PAYMENT_REQUEST_TO_USER)}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}},{key:"currency",get:function(){return this.currency$.value},set:function(e){this.currency$.next(e)}},{key:"paymentTypeData",get:function(){return this.paymentTypeData$.value},set:function(e){this.paymentTypeData$.next(e),this.updatePaymentTypeData(e)}},{key:"customValuesControlGetter",get:function(){var e=this;return function(t){var n=t.internalName,a=e.customValuesControls.get(n);return null==a&&(a=e.formBuilder.control(t.defaultValue,t.required?I.G.required:null),e.customValuesControls.set(n,a)),a}}}]),a}(kt.a)).\u0275fac=function(e){return new(e||Bi)(P.Kb(P.r),P.Kb(m.a),P.Kb(Jn.a),P.Kb(P.h))},Bi.\u0275cmp=P.Eb({type:Bi,selectors:[["request-payment"]],features:[P.ub],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","currency","paymentTypeData$","toSystem","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"performed"],[3,"label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Si,7,17,"page-content",1),P.Bc(4,Oi,6,8,"page-content",2),P.Bc(5,Ni,2,0,"page-content",3),P.Pb()),2&e&&(P.gc("ready",P.bc(1,4,t.data$))("ngSwitch",P.bc(2,6,t.step$)),P.xb(3),P.gc("ngSwitchCase","form"),P.xb(1),P.gc("ngSwitchCase","done"))},directives:[D.a,k.x,k.y,k.z,L.a,Ti,wt.a,Ct.a,Za,Y.a],pipes:[k.b],encapsulation:2,changeDetection:0}),Bi),$i=o("cBGn"),Ri=o("/q9M");function Zi(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",4),P.ac(1,"async"),P.Lb(2,"receive-qr-payment-step-form",5),P.ac(3,"async"),P.ac(4,"async"),P.ac(5,"async"),P.Qb(6,"actions",6),P.Qb(7,"action-button",7),P.Xb("action",(function(){return P.sc(n),P.Zb().toPending()})),P.ac(8,"async"),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.transaction.title.receiveQrPayment)("mobileHeading",a.i18n.transaction.mobileTitle.receiveQrPayment)("mode",P.bc(1,10,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("data",a.data)("form",a.form)("transferTypes",P.bc(3,12,a.paymentTypes$))("type",P.bc(4,14,a.paymentType$))("typeData",P.bc(5,16,a.paymentTypeData$)),P.xb(5),P.gc("disabled",P.bc(8,18,a.requesting$))("label",a.i18n.general.next)}}function Mi(e,t){if(1&e){var n=P.Rb();P.Qb(0,"action-button",13),P.Xb("action",(function(){return P.sc(n),P.Zb(2).share()})),P.ac(1,"async"),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("label",a.i18n.general.share)("disabled",P.bc(1,2,a.requesting$))}}function Hi(e,t){1&e&&P.Lb(0,"span")}function qi(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",8),P.ac(1,"async"),P.Lb(2,"receive-qr-payment-step-pending",9),P.ac(3,"async"),P.ac(4,"async"),P.Qb(5,"actions",6),P.Bc(6,Mi,2,4,"action-button",10),P.Bc(7,Hi,1,0,"ng-template",null,11,P.Cc),P.Qb(9,"action-button",12),P.Xb("action",(function(){return P.sc(n),P.Zb().reload()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.qc(8),i=P.Zb();P.gc("heading",i.i18n.transaction.title.receiveQrPayment)("mobileHeading",i.i18n.transaction.mobileTitle.receiveQrPayment)("mode",P.bc(1,8,i.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("ticket",P.bc(3,10,i.ticket$))("qrCodeUrl",P.bc(4,12,i.qrCodeUrl$)),P.xb(4),P.gc("ngIf",i.supportsShare)("ngIfElse",a),P.xb(3),P.gc("label",i.i18n.general.previous)}}function Ui(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",8),P.ac(1,"async"),P.Lb(2,"receive-qr-payment-step-done",14),P.ac(3,"async"),P.Qb(4,"actions",6),P.Qb(5,"action-button",15),P.Xb("action",(function(){return P.sc(n),P.Zb().viewPerformed()})),P.Pb(),P.Qb(6,"action-button",12),P.Xb("action",(function(){return P.sc(n),P.Zb().reload()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.transaction.title.receiveQrPayment)("mobileHeading",a.i18n.transaction.mobileTitle.receiveQrPayment)("mode",P.bc(1,6,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("payment",P.bc(3,8,a.payment$)),P.xb(3),P.gc("label",a.i18n.transaction.doneView),P.xb(1),P.gc("label",a.i18n.transaction.doneNew)}}function Vi(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var ji,zi=((ji=function(e){s(n,e);var t=b(n);function n(e,a,i,r){var o;return c(this,n),(o=t.call(this,e)).ticketsService=a,o.pushNotifications=i,o.bankingHelper=r,o.step$=new v.a(null),o.ticket$=new v.a(null),o.paymentTypes$=new v.a([]),o.paymentType$=new v.a(null),o.paymentTypeData$=new v.a(null),o.payment$=new v.a(null),o.paymentTypeDataCache=new Map,o.qrCodeUrl$=new v.a(null),o.supportsShare=Object(h.C)(),o}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.addSub(this.ticketsService.dataForNewTicket().subscribe((function(t){return e.data=t}))),this.addSub(this.step$.subscribe((function(t){return e.onStepChanged(t)})))}},{key:"ngOnDestroy",value:function(){r(d(n.prototype),"ngOnDestroy",this).call(this),this.unsubscribePush(),this.destroyQrCode()}},{key:"onDataInitialized",value:function(e){var t=this;Object(h.h)(e.accounts)||Object(h.h)(e.paymentTypes)?this.notification.error(this.i18n.transaction.noAccounts):(this.form=this.formBuilder.group({account:[null,I.G.required],type:[null,I.G.required],amount:[null,I.G.required],description:null}),this.paymentTypeDataCache.set(e.paymentTypes[0].id,e.paymentTypeData),this.addSub(this.form.controls.type.valueChanges.pipe(Object(_a.a)()).subscribe((function(e){return t.onPaymentTypeChange(e)}))),this.addSub(this.form.controls.account.valueChanges.pipe(Object(_a.a)()).subscribe((function(n){return t.onAccountChange(n,e)}))),this.form.patchValue({account:e.accounts[0].id}),this.step$.next("form"))}},{key:"onAccountChange",value:function(e,t){var n=t.accounts.find((function(t){return t.id===e})),a=n?t.paymentTypes.filter((function(e){return e.to.id===n.type.id})):[];this.paymentTypes$.next(a),this.form.patchValue({type:0===a.length?null:a[0].id})}},{key:"onPaymentTypeChange",value:function(e){var t=this,n=(this.paymentTypes$.value||[]).find((function(t){return t.id===e}));if(n){var a=function(a){(t.paymentType$.value||{}).id!==e&&(t.paymentTypeDataCache.set(e,a),t.paymentType$.next(n),t.paymentTypeData$.next(a),t.form.setControl("customValues",t.fieldHelper.customValuesFormGroup(a.customFields)),t.form.controls.type.setValidators(a.descriptionAvailability===u.i.REQUIRED?I.G.required:null))},i=this.paymentTypeDataCache.get(e);i?a(i):this.addSub(this.ticketsService.dataForNewTicket({type:e}).subscribe((function(e){a(e.paymentTypeData)})))}else this.notification.error(this.i18n.transaction.noTypes)}},{key:"toPending",value:function(){var e=this;Object(h.F)(this.form)&&this.addSub(this.ticketsService.newTicket({body:this.form.value}).subscribe((function(t){e.ticket$.next(t),e.addSub(e.ticketsService.getTicketQrCode({ticket:t.ticketNumber,size:u.D.MEDIUM}).subscribe((function(t){e.qrCodeUrl$.next(URL.createObjectURL(t))}))),e.step$.next("pending")})))}},{key:"viewPerformed",value:function(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.payment$.value)])}},{key:"onStepChanged",value:function(e){var t=this;"pending"===e?this.pushSub=this.pushNotifications.ticket$.subscribe((function(e){var n=t.ticket$.value;n&&n.id===e.id&&(t.payment$.next(e.transaction),t.step$.next("done"))})):(this.unsubscribePush(),this.destroyQrCode())}},{key:"unsubscribePush",value:function(){this.pushSub&&(this.pushSub.unsubscribe(),this.pushSub=null)}},{key:"destroyQrCode",value:function(){this.qrCodeUrl$.value&&(URL.revokeObjectURL(this.qrCodeUrl$.value),this.qrCodeUrl$.next(null))}},{key:"share",value:function(){var e=this.ticket$.value;navigator.share&&navigator.share({url:e.approveUrl,title:this.i18n.transaction.ticketShareTitle,text:this.i18n.transaction.ticketShareText({user:e.to.user.display,amount:this.format.formatAsCurrency(e.currency,e.amount)})})}},{key:"resolveMenu",value:function(){return y.b.RECEIVE_QR_PAYMENT}}]),n}(kt.a)).\u0275fac=function(e){return new(e||ji)(P.Kb(P.r),P.Kb($i.a),P.Kb(Ri.a),P.Kb(m.a))},ji.\u0275cmp=P.Eb({type:ji,selectors:[["receive-qr-payment"]],features:[P.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","transferTypes","type","typeData"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[3,"ticket","qrCodeUrl"],[3,"label","disabled","action",4,"ngIf","ngIfElse"],["empty",""],["outline","",3,"label","action"],[3,"label","disabled","action"],[3,"payment"],[3,"label","action"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Zi,9,20,"page-content",1),P.Bc(4,qi,10,14,"page-content",2),P.Bc(5,Ui,7,10,"page-content",2),P.Bc(6,Vi,2,0,"page-content",3),P.Pb()),2&e&&(P.gc("ready",P.bc(1,5,t.data$))("ngSwitch",P.bc(2,7,t.step$)),P.xb(3),P.gc("ngSwitchCase","form"),P.xb(1),P.gc("ngSwitchCase","pending"),P.xb(1),P.gc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),ji),Gi=o("QnlI");function _i(e,t){1&e&&P.Mb(0)}function Ki(e,t){1&e&&P.Lb(0,"div",7)}function Xi(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",7),P.Qb(2,"label-value",13),P.Lb(3,"user-link",14),P.Pb(),P.Pb(),P.Bc(4,Ki,1,0,"div",9),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("ngIf",n.layout.gtsm$)}}function Yi(e,t){if(1&e&&P.Lb(0,"field-option",17),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function Wi(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"single-selection-field",15),P.Bc(2,Yi,1,2,"field-option",16),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.transaction.account)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.data.accountTypes)}}function Ji(e,t){if(1&e&&(P.Qb(0,"div",7),P.Lb(1,"input-field",24),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("mask",n.transactionNumberPattern)("label",n.i18n.transaction.number)}}function er(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",7),P.Qb(2,"single-selection-field",18),P.Lb(3,"field-option",19),P.Lb(4,"field-option",20),P.Pb(),P.Pb(),P.Bc(5,Ji,2,2,"div",9),P.Qb(6,"div",7),P.Lb(7,"date-field",21),P.Pb(),P.Qb(8,"div",7),P.Lb(9,"date-field",22),P.Pb(),P.Qb(10,"div",7),P.Lb(11,"user-field",23),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.gc("label",n.i18n.account.direction)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("text",n.i18n.account.incoming),P.xb(1),P.gc("text",n.i18n.account.outgoing),P.xb(1),P.gc("ngIf",n.hasTransactionNumber),P.xb(2),P.gc("label",n.i18n.general.beginDate),P.xb(2),P.gc("label",n.i18n.general.endDate),P.xb(2),P.gc("label",n.i18n.general.user)}}function tr(e,t){if(1&e&&(P.Qb(0,"mobile-result",25),P.Qb(1,"div",26),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("date",n.date)("amount",n.amount)("avatarImage",a.bankingHelper.avatarImage(n.transaction.related))("avatarIcon",a.bankingHelper.avatarIcon(n.transaction.related))("currency",a.currencies.get(n.currency)),P.xb(2),P.Fc(" ",a.bankingHelper.subjectName(n.transaction.related)," ")}}var nr=function(e){return{"pb-0":e}},ar=function(e,t){return{positive:e,negative:t}};function ir(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",31),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.bankingHelper.transactionPath(e.transaction))})),P.Qb(2,"td",32),P.ac(3,"async"),P.Lb(4,"avatar",33),P.Pb(),P.Qb(5,"td"),P.Qb(6,"a",34),P.Dc(7),P.ac(8,"date"),P.Pb(),P.Pb(),P.Qb(9,"td"),P.Qb(10,"a",34),P.Dc(11),P.Pb(),P.Pb(),P.Qb(12,"td"),P.Qb(13,"a",35),P.Dc(14),P.Pb(),P.Pb(),P.Qb(15,"td",29),P.Qb(16,"a",36),P.Dc(17),P.ac(18,"currency"),P.Pb(),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(2),P.gc("ngClass",P.jc(20,nr,P.bc(3,12,i.layout.xxs$))),P.xb(2),P.gc("image",i.bankingHelper.avatarImage(a.transaction.related))("icon",i.bankingHelper.avatarIcon(a.transaction.related)),P.xb(2),P.gc("routerLink",i.bankingHelper.transactionPath(a.transaction)),P.xb(1),P.Fc(" ",P.bc(8,14,a.dueDate)," "),P.xb(3),P.gc("routerLink",i.bankingHelper.transactionPath(a.transaction)),P.xb(1),P.Fc(" ",i.bankingHelper.subjectName(a.transaction.related)," "),P.xb(2),P.gc("routerLink",i.bankingHelper.transactionPath(a.transaction)),P.xb(1),P.Fc(" ",i.number(a)," "),P.xb(2),P.gc("routerLink",i.bankingHelper.transactionPath(a.transaction))("ngClass",P.kc(22,ar,i.format.isPositive(a.amount),i.format.isNegative(a.amount))),P.xb(1),P.Fc(" ",P.dc(18,16,a.amount,i.currencies.get(a.transaction.currency),!0)," ")}}function rr(e,t){if(1&e&&(P.Qb(0,"table",27),P.Qb(1,"thead"),P.Lb(2,"th",28),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Qb(7,"th"),P.Dc(8),P.Pb(),P.Qb(9,"th",29),P.Dc(10),P.Pb(),P.Pb(),P.Qb(11,"tbody"),P.Bc(12,ir,19,25,"ng-container",30),P.ac(13,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(4),P.Ec(a.i18n.transaction.dueDate),P.xb(2),P.Ec(a.i18n.transaction.fromTo),P.xb(2),P.Ec(a.i18n.transaction.installmentNumber),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(13,5,a.results$))?null:n.results)}}function cr(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.ac(1,"async"),P.Qb(2,"form",4),P.Qb(3,"div",5),P.Bc(4,Xi,5,3,"ng-container",6),P.Qb(5,"div",7),P.Lb(6,"single-selection-field",8),P.Pb(),P.Bc(7,Wi,3,3,"div",9),P.Bc(8,er,12,8,"ng-container",6),P.ac(9,"async"),P.Pb(),P.Pb(),P.Pb(),P.Qb(10,"results-layout",10),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(11,"async"),P.Bc(12,tr,3,6,"mobile-result",11),P.Bc(13,rr,14,7,"table",12),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.transaction.title.scheduled)("mobileHeading",a.i18n.transaction.mobileTitle.scheduled)("headingActions",P.bc(1,12,a.headingActions$)),P.xb(2),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",a.data.user&&!a.self),P.xb(2),P.gc("label",a.i18n.general.status)("fieldOptions",a.statusOptions),P.xb(1),P.gc("ngIf",(null==a.data.accountTypes?null:a.data.accountTypes.length)>1),P.xb(1),P.gc("ngIf",P.bc(9,14,a.moreFilters$)),P.xb(2),P.gc("results",P.bc(11,16,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}var or,lr=((or=function(e){s(a,e);var t=b(a);function a(e,n,i){var r;return c(this,a),(r=t.call(this,e)).installmentsService=n,r.bankingHelper=i,r.currencies=new Map,r}return l(a,[{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.owner,this.self=this.authHelper.isSelf(this.param),this.stateManager.cache("data",this.installmentsService.getInstallmentsDataForSearch({owner:this.param,fields:["user","accountTypes","query"]})).subscribe((function(t){e.bankingHelper.preProcessPreselectedPeriods(t,e.form),(t.accountTypes||[]).forEach((function(t){var n=t.currency;e.currencies.set(n.id,n),Object(h.h)(n.internalName)||e.currencies.set(n.internalName,n)})),e.data=t}))}},{key:"onDataInitialized",value:function(e){r(d(a.prototype),"onDataInitialized",this).call(this,e);var t=(e.accountTypes||[]).map((function(e){var t;return null===(t=e.currency)||void 0===t?void 0:t.transactionNumberPattern})).filter((function(e){return e})).reduce((function(e,t){return e.includes(t)?e:[].concat(n(e),[t])}),[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=[this.moreFiltersAction]}},{key:"getFormControlNames",value:function(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}},{key:"getInitialFormValue",value:function(e){var t=r(d(a.prototype),"getInitialFormValue",this).call(this,e);return t.status=u.G.SCHEDULED,t}},{key:"toSearchParams",value:function(e){var t=e;return t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.statuses=[e.status],t}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.moreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.lessFilters}},{key:"resolveMenu",value:function(e){return this.menu.userMenu(e.user,y.b.SCHEDULED_PAYMENTS)}},{key:"doSearch",value:function(e){return this.installmentsService.searchInstallments$Response(e)}},{key:"number",value:function(e){return e.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:e.number,total:e.totalInstallments}):String(e.number)}},{key:"statusOptions",get:function(){var e=this;return Object.values(u.G).map((function(t){return{value:t,text:e.apiI18n.installmentStatus(t)}}))}},{key:"toLink",get:function(){var e=this;return function(t){return e.bankingHelper.transactionPath(t.transaction)}}}]),a}(p.a)).\u0275fac=function(e){return new(e||or)(P.Kb(P.r),P.Kb(Gi.a),P.Kb(m.a))},or.\u0275cmp=P.Eb({type:or,selectors:[["search-owner-installments"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],[3,"image","icon"],[3,"routerLink"],[1,"d-inline-block",3,"routerLink"],[3,"routerLink","ngClass"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,_i,1,0,"ng-container",1),P.Pb(),P.Bc(3,cr,14,18,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,S.a,I.v,I.l,w.a,C.a,Q.a,F.a,T.a,k.s,O.a,B.a,$.a,E.a,R.a,W.a,k.q,J.a,ee.h],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),or),sr=o("v6Le");function ur(e,t){1&e&&P.Mb(0)}function br(e,t){1&e&&P.Lb(0,"div",7)}function fr(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",7),P.Qb(2,"label-value",14),P.Lb(3,"user-link",15),P.Pb(),P.Pb(),P.Bc(4,br,1,0,"div",9),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("ngIf",n.layout.gtsm$)}}function dr(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"single-selection-field",16),P.Lb(2,"field-option",17),P.Lb(3,"field-option",18),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.transaction.direction)("emptyOption",n.i18n.general.all),P.xb(1),P.gc("text",n.i18n.transaction.sent),P.xb(1),P.gc("text",n.i18n.transaction.received)}}function mr(e,t){if(1&e&&(P.Qb(0,"div",7),P.Lb(1,"input-field",19),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("mask",n.transactionNumberPattern)("label",n.i18n.transaction.number)}}function gr(e,t){if(1&e&&P.Lb(0,"field-option",22),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function pr(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"single-selection-field",20),P.Bc(2,gr,1,2,"field-option",21),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.transaction.account)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.data.accountTypes)}}function hr(e,t){if(1&e&&P.Lb(0,"field-option",25),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n)("text",n.name)}}function yr(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"single-selection-field",23),P.Bc(2,hr,1,3,"field-option",24),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.period),P.xb(1),P.gc("ngForOf",n.data.preselectedPeriods)}}function vr(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"div",26),P.Qb(2,"div",7),P.Lb(3,"date-field",27),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(3),P.gc("label",n.i18n.general.beginDate)}}function xr(e,t){if(1&e&&(P.Qb(0,"div",7),P.Lb(1,"date-field",28),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.endDate)}}function Pr(e,t){if(1&e&&P.Lb(0,"field-option",31),2&e){var n=t.$implicit;P.gc("value",n)("id",n.id)("text",n.name)}}function Dr(e,t){if(1&e&&(P.Qb(0,"div",7),P.Qb(1,"single-selection-field",29),P.Bc(2,Pr,1,3,"field-option",30),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.account.transferFilter)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.transferFilters$.value)}}function kr(e,t){if(1&e&&(P.Qb(0,"mobile-result",32),P.Qb(1,"div",33),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("avatarImage",a.bankingHelper.avatarImage(n.related))("avatarIcon",a.bankingHelper.avatarIcon(n.related))("date",n.date)("amount",n.amount)("currency",a.currencies.get(n.currency)),P.xb(2),P.Fc(" ",a.bankingHelper.subjectName(n.related)," ")}}function Lr(e,t){if(1&e&&(P.Qb(0,"th"),P.Dc(1),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.Ec(n.i18n.transaction.fromTo)}}function wr(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"th"),P.Dc(2),P.Pb(),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(2),P.Ec(n.i18n.transaction.senderOrReceiver),P.xb(2),P.Ec(n.i18n.general.status)}}function Cr(e,t){if(1&e&&(P.Qb(0,"td"),P.Dc(1),P.Pb()),2&e){var n=P.Zb().$implicit,a=P.Zb(3);P.xb(1),P.Fc(" ",a.apiI18n.transactionStatus(n)," ")}}var Qr=function(e,t,n){return{"pb-0":e,positive:t,negative:n}};function Ir(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",38),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.bankingHelper.transactionPath(e))})),P.Qb(2,"td",35),P.Lb(3,"avatar",39),P.Pb(),P.Qb(4,"td"),P.Dc(5),P.ac(6,"date"),P.Pb(),P.Qb(7,"td"),P.Dc(8),P.Pb(),P.Bc(9,Cr,2,1,"td",6),P.Qb(10,"td"),P.Dc(11),P.Pb(),P.Qb(12,"td",40),P.ac(13,"async"),P.Dc(14),P.ac(15,"currency"),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.gc("image",i.bankingHelper.avatarImage(a.related))("icon",i.bankingHelper.avatarIcon(a.related)),P.xb(2),P.Fc(" ",P.bc(6,8,a.date)," "),P.xb(3),P.Fc(" ",i.bankingHelper.subjectName(a.related)," "),P.xb(1),P.gc("ngIf",i.isPaymentRequest()),P.xb(2),P.Fc(" ",i.bankingHelper.scheduling(a)," "),P.xb(1),P.gc("ngClass",P.lc(16,Qr,P.bc(13,10,i.layout.xxs$),i.format.isPositive(a.amount),i.format.isNegative(a.amount))),P.xb(2),P.Fc(" ",P.dc(15,12,a.amount,i.currencies.get(a.currency),!0)," ")}}function Fr(e,t){if(1&e&&(P.Qb(0,"table",34),P.Qb(1,"thead"),P.Lb(2,"th",35),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Bc(5,Lr,2,1,"th",6),P.Bc(6,wr,5,2,"ng-container",6),P.Qb(7,"th"),P.Dc(8),P.Pb(),P.Qb(9,"th",36),P.Dc(10),P.Pb(),P.Pb(),P.Qb(11,"tbody"),P.Bc(12,Ir,16,20,"ng-container",37),P.ac(13,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(4),P.Ec(a.i18n.general.date),P.xb(1),P.gc("ngIf",!a.isPaymentRequest()),P.xb(1),P.gc("ngIf",a.isPaymentRequest()),P.xb(2),P.Ec(a.i18n.transaction.scheduling),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(13,6,a.results$))?null:n.results)}}function Tr(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.Qb(1,"form",4),P.Qb(2,"div",5),P.Bc(3,fr,5,3,"ng-container",6),P.Qb(4,"div",7),P.Lb(5,"single-selection-field",8),P.Pb(),P.Bc(6,dr,4,4,"div",9),P.Bc(7,mr,2,2,"div",9),P.Bc(8,pr,3,3,"div",9),P.Bc(9,yr,3,2,"div",9),P.Bc(10,vr,4,1,"ng-container",6),P.ac(11,"async"),P.Bc(12,xr,2,1,"div",9),P.ac(13,"async"),P.Bc(14,Dr,3,3,"div",9),P.ac(15,"async"),P.Qb(16,"div",7),P.Lb(17,"user-field",10),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Qb(18,"results-layout",11),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(19,"async"),P.Bc(20,kr,3,6,"mobile-result",12),P.Bc(21,Fr,14,8,"table",13),P.Pb()}if(2&e){var a=P.Zb(),i=null,r=null;P.gc("heading",a.heading)("mobileHeading",a.mobileHeading),P.xb(1),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",a.data.user&&!a.self),P.xb(2),P.gc("label",a.i18n.general.status)("fieldOptions",a.statusOptions)("emptyOption",a.i18n.general.notApplied),P.xb(1),P.gc("ngIf",a.isPaymentRequest()),P.xb(1),P.gc("ngIf",a.hasTransactionNumber),P.xb(1),P.gc("ngIf",!a.isPaymentRequest()&&(null==a.data.accountTypes?null:a.data.accountTypes.length)>1),P.xb(1),P.gc("ngIf",a.usePreselectedPeriods&&(null==a.data.preselectedPeriods?null:a.data.preselectedPeriods.length)>0),P.xb(1),P.gc("ngIf",!a.usePreselectedPeriods||null==(null==(i=a.form.value||P.bc(11,18,a.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.begin)),P.xb(2),P.gc("ngIf",!a.usePreselectedPeriods||null==(null==(r=a.form.value||P.bc(13,20,a.form.valueChanges))||null==r.preselectedPeriod?null:r.preselectedPeriod.end)),P.xb(2),P.gc("ngIf",P.bc(15,22,a.transferFilters$).length>0),P.xb(3),P.gc("label",a.i18n.general.user),P.xb(1),P.gc("results",P.bc(19,24,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}var Sr,Or=((Sr=function(e){s(a,e);var t=b(a);function a(e,n,i){var r;return c(this,a),(r=t.call(this,e)).transactionsService=n,r.bankingHelper=i,r.transferFilters$=new v.a([]),r.currencies=new Map,r.usePreselectedPeriods=!1,r}return l(a,[{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot;switch(this.kind=t.data.kind,this.param=t.params.owner,this.self=this.authHelper.isSelf(this.param),this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations,this.usePreselectedPeriods=!0;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequests,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequests}this.stateManager.cache("data",this.transactionsService.getTransactionsDataForSearch({owner:this.param,fields:["user","accountTypes","visibleKinds","transferFilters"].concat(n(this.usePreselectedPeriods?["preselectedPeriods"]:[]),["query"])})).subscribe((function(t){e.bankingHelper.preProcessPreselectedPeriods(t,e.form),(t.accountTypes||[]).forEach((function(t){var n=t.currency;e.currencies.set(n.id,n),Object(h.h)(n.internalName)||e.currencies.set(n.internalName,n)})),e.data=t})),this.addSub(this.form.get("accountType").valueChanges.subscribe((function(t){e.form.patchValue({transferFilter:null},{emitEvent:!1});var n=e.data.transferFilters.filter((function(e){return e.accountType.id===t}));e.transferFilters$.next(n)})))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(a.prototype),"onDataInitialized",this).call(this,e);var i=Array.from(this.currencies.values()).map((function(e){return e.transactionNumberPattern})).filter((function(e){return e})).reduce((function(e,t){return e.includes(t)?e:[].concat(n(e),[t])}),[]);this.hasTransactionNumber=i.length>0,this.transactionNumberPattern=1===i.length?i[0]:null,this.headingActions=this.exportHelper.headingActions(e.exportFormats,(function(e){return t.transactionsService.exportTransactions$Response(Object.assign({format:e.internalName},t.toSearchParams(t.form.value)))}))}},{key:"isPaymentRequest",value:function(){return"payment-request"===this.kind}},{key:"doSearch",value:function(e){return this.transactionsService.searchTransactions$Response(e)}},{key:"getFormControlNames",value:function(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}},{key:"getInitialFormValue",value:function(e){var t=r(d(a.prototype),"getInitialFormValue",this).call(this,e);switch(this.kind){case"authorized":t.status=u.yb.PENDING;break;case"payment-request":t.status=u.X.OPEN}return t}},{key:"toSearchParams",value:function(e){var t=e;switch(t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0;break;case"payment-request":t.paymentRequestStatuses=[e.status],t.kinds=[u.zb.PAYMENT_REQUEST]}return t}},{key:"resolveMenu",value:function(e){var t;switch(this.kind){case"authorized":t=y.b.AUTHORIZED_PAYMENTS;break;case"payment-request":t=y.b.PAYMENT_REQUESTS}return this.menu.userMenu(e.user,t)}},{key:"statusOptions",get:function(){var e=this;switch(this.kind){case"authorized":return Object.values(u.yb).map((function(t){return{value:t,text:e.apiI18n.authorizationStatus(t)}}));case"payment-request":return Object.values(u.X).map((function(t){return{value:t,text:e.apiI18n.paymentRequestStatus(t)}}))}}},{key:"toLink",get:function(){var e=this;return function(t){return e.bankingHelper.transactionPath(t)}}}]),a}(p.a)).\u0275fac=function(e){return new(e||Sr)(P.Kb(P.r),P.Kb(sr.a),P.Kb(m.a))},Sr.\u0275cmp=P.Eb({type:Sr,selectors:[["search-owner-transactions"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions","emptyOption"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transferFilter",3,"label","emptyOption"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[1,"amount",3,"ngClass"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,ur,1,0,"ng-container",1),P.Pb(),P.Bc(3,Tr,22,26,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,S.a,I.v,I.l,$.a,w.a,C.a,Q.a,F.a,T.a,O.a,E.a,R.a,k.s,B.a,W.a,J.a,k.q],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),Sr);function Nr(e,t){1&e&&P.Mb(0)}function Br(e,t){if(1&e&&(P.Qb(0,"div",11),P.Lb(1,"single-selection-field",12),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.status)("fieldOptions",n.statusOptions)("emptyOption",n.i18n.general.notApplied)}}function Ar(e,t){if(1&e&&P.Lb(0,"field-option",15),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function Er(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"single-selection-field",13),P.Bc(2,Ar,1,2,"field-option",14),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.currency)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.currencies)}}function $r(e,t){if(1&e&&P.Lb(0,"field-option",21),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function Rr(e,t){if(1&e&&P.Lb(0,"field-option",21),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function Zr(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"div",17),P.Qb(2,"div",11),P.Qb(3,"single-selection-field",18),P.Bc(4,$r,1,4,"field-option",19),P.Pb(),P.Pb(),P.Qb(5,"div",11),P.Qb(6,"single-selection-field",20),P.Bc(7,Rr,1,4,"field-option",19),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(3),P.gc("emptyOption",n.i18n.general.notApplied)("label",n.i18n.transaction.fromAccount),P.xb(1),P.gc("ngForOf",n.accountTypes()),P.xb(2),P.gc("emptyOption",n.i18n.general.notApplied)("label",n.i18n.transaction.toAccount),P.xb(1),P.gc("ngForOf",n.accountTypes())}}function Mr(e,t){if(1&e&&(P.Qb(0,"div",11),P.Lb(1,"input-field",22),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("mask",n.transactionNumberPattern)("label",n.i18n.transaction.number)}}function Hr(e,t){if(1&e&&P.Lb(0,"field-option",25),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n)("text",n.name)}}function qr(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"single-selection-field",23),P.Bc(2,Hr,1,3,"field-option",24),P.Pb(),P.Pb()),2&e){var n=P.Zb(4);P.xb(1),P.gc("label",n.i18n.general.period),P.xb(1),P.gc("ngForOf",n.data.preselectedPeriods)}}function Ur(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"div",17),P.Qb(2,"div",11),P.Lb(3,"date-field",26),P.Pb(),P.Nb()),2&e){var n=P.Zb(4);P.xb(3),P.gc("label",n.i18n.general.beginDate)}}function Vr(e,t){if(1&e&&(P.Qb(0,"div",11),P.Lb(1,"date-field",27),P.Pb()),2&e){var n=P.Zb(4);P.xb(1),P.gc("label",n.i18n.general.endDate)}}function jr(e,t){if(1&e&&(P.Ob(0),P.Bc(1,qr,3,2,"div",6),P.Bc(2,Ur,4,1,"ng-container",7),P.ac(3,"async"),P.Bc(4,Vr,2,1,"div",6),P.ac(5,"async"),P.Nb()),2&e){var n=P.Zb(3),a=null,i=null;P.xb(1),P.gc("ngIf",n.usePreselectedPeriod&&(null==n.data.preselectedPeriods?null:n.data.preselectedPeriods.length)>0),P.xb(1),P.gc("ngIf",!n.usePreselectedPeriod||null==(null==(a=n.form.value||P.bc(3,3,n.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.begin)),P.xb(2),P.gc("ngIf",!n.usePreselectedPeriod||null==(null==(i=n.form.value||P.bc(5,5,n.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end))}}function zr(e,t){if(1&e&&P.Lb(0,"field-option",30),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)("category",n.from.name)}}function Gr(e,t){if(1&e&&(P.Qb(0,"div",11),P.Qb(1,"multi-selection-field",28),P.Bc(2,zr,1,5,"field-option",29),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.account.transferFilter),P.xb(1),P.gc("ngForOf",n.data.authorizablePaymentTypes)}}function _r(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",11),P.Lb(2,"date-field",31),P.Pb(),P.Qb(3,"div",11),P.Lb(4,"date-field",32),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(2),P.gc("label",n.i18n.general.expirationBeginDate),P.xb(2),P.gc("label",n.i18n.general.expirationEndDate)}}function Kr(e,t){if(1&e&&(P.Qb(0,"div",11),P.Lb(1,"user-field",33),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.transaction.actionPerformedBy)}}function Xr(e,t){if(1&e&&(P.Ob(0),P.Bc(1,Zr,8,6,"ng-container",7),P.Bc(2,Mr,2,2,"div",6),P.Bc(3,jr,6,7,"ng-container",7),P.Bc(4,Gr,3,3,"div",6),P.Bc(5,_r,5,2,"ng-container",7),P.Qb(6,"div",11),P.Lb(7,"user-field",16),P.Pb(),P.Bc(8,Kr,2,1,"div",6),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngIf",(n.isAuthorized()||n.isPaymentRequest())&&(null==n.data.accountTypes?null:n.data.accountTypes.length)>1),P.xb(1),P.gc("ngIf",!n.isMyAuth()&&n.hasTransactionNumber),P.xb(1),P.gc("ngIf",n.usePeriod),P.xb(1),P.gc("ngIf",n.isMyAuth()&&(null==n.data.authorizablePaymentTypes?null:n.data.authorizablePaymentTypes.length)>0),P.xb(1),P.gc("ngIf",n.isPaymentRequest()),P.xb(2),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("ngIf",n.isAuthorized())}}var Yr=function(e,t){return{from:e,to:t}};function Wr(e,t){if(1&e&&(P.Qb(0,"mobile-result",34),P.Qb(1,"div",35),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("date",n.date)("amount",n.amount)("currency",a.currenciesByKey.get(n.currency)),P.xb(2),P.Fc(" ",a.i18n.transaction.fromToText(P.kc(4,Yr,a.bankingHelper.subjectName(a.isPaymentRequest()?n.to:n.from),a.bankingHelper.subjectName(a.isPaymentRequest()?n.from:n.to)))," ")}}function Jr(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"th"),P.Dc(2),P.Pb(),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(2),P.Ec(n.i18n.transaction.from),P.xb(2),P.Ec(n.i18n.transaction.to),P.xb(2),P.Ec(n.i18n.transaction.scheduling)}}function ec(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"th"),P.Dc(2),P.Pb(),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Qb(7,"th"),P.Dc(8),P.Pb(),P.Qb(9,"th"),P.Dc(10),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(2),P.Ec(n.i18n.transaction.number),P.xb(2),P.Ec(n.i18n.transaction.sender),P.xb(2),P.Ec(n.i18n.transaction.receiver),P.xb(2),P.Ec(n.i18n.general.status),P.xb(2),P.Ec(n.i18n.general.expirationDate)}}function tc(e,t){if(1&e&&(P.Qb(0,"td"),P.Qb(1,"a",40),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=P.Zb().$implicit,a=P.Zb(3);P.xb(1),P.gc("routerLink",a.bankingHelper.transactionPath(n)),P.xb(1),P.Fc(" ",n.transactionNumber," ")}}function nc(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"td"),P.Qb(2,"a",42),P.Dc(3),P.Pb(),P.Pb(),P.Qb(4,"td"),P.Qb(5,"a",40),P.Dc(6),P.ac(7,"date"),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb().$implicit,a=P.Zb(3);P.xb(2),P.gc("routerLink",a.bankingHelper.transactionPath(n)),P.xb(1),P.Fc(" ",a.apiI18n.transactionStatus(n)," "),P.xb(2),P.gc("routerLink",a.bankingHelper.transactionPath(n)),P.xb(1),P.Fc(" ",P.bc(7,4,n.expirationDate)," ")}}function ac(e,t){if(1&e&&(P.Qb(0,"td"),P.Qb(1,"a",42),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=P.Zb().$implicit,a=P.Zb(3);P.xb(1),P.gc("routerLink",a.bankingHelper.transactionPath(n)),P.xb(1),P.Fc(" ",a.bankingHelper.scheduling(n)," ")}}var ic=function(e){return{"pb-0":e}};function rc(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",39),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.bankingHelper.transactionPath(e))})),P.Qb(2,"td"),P.Qb(3,"a",40),P.Dc(4),P.ac(5,"date"),P.Pb(),P.Pb(),P.Bc(6,tc,3,2,"td",7),P.Qb(7,"td"),P.Qb(8,"a",40),P.Dc(9),P.Pb(),P.Pb(),P.Qb(10,"td"),P.Qb(11,"a",40),P.Dc(12),P.Pb(),P.Pb(),P.Bc(13,nc,8,6,"ng-container",7),P.Bc(14,ac,3,2,"td",7),P.Qb(15,"td",41),P.ac(16,"async"),P.Qb(17,"a",40),P.Dc(18),P.ac(19,"currency"),P.Pb(),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.gc("routerLink",i.bankingHelper.transactionPath(a)),P.xb(1),P.Fc(" ",P.bc(5,12,a.date)," "),P.xb(2),P.gc("ngIf",i.isPaymentRequest()),P.xb(2),P.gc("routerLink",i.bankingHelper.transactionPath(a)),P.xb(1),P.Fc(" ",i.bankingHelper.subjectName(i.isPaymentRequest()?a.to:a.from)," "),P.xb(2),P.gc("routerLink",i.bankingHelper.transactionPath(a)),P.xb(1),P.Fc(" ",i.bankingHelper.subjectName(i.isPaymentRequest()?a.from:a.to)," "),P.xb(1),P.gc("ngIf",i.isPaymentRequest()),P.xb(1),P.gc("ngIf",!i.isPaymentRequest()),P.xb(1),P.gc("ngClass",P.jc(19,ic,P.bc(16,14,i.layout.xxs$))),P.xb(2),P.gc("routerLink",i.bankingHelper.transactionPath(a)),P.xb(1),P.Fc(" ",P.cc(19,16,a.amount,i.currenciesByKey.get(a.currency))," ")}}function cc(e,t){if(1&e&&(P.Qb(0,"table",36),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Bc(4,Jr,7,3,"ng-container",7),P.Bc(5,ec,11,5,"ng-container",7),P.Qb(6,"th",37),P.Dc(7),P.Pb(),P.Pb(),P.Qb(8,"tbody"),P.Bc(9,rc,20,21,"ng-container",38),P.ac(10,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.general.date),P.xb(1),P.gc("ngIf",!a.isPaymentRequest()),P.xb(1),P.gc("ngIf",a.isPaymentRequest()),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(10,5,a.results$))?null:n.results)}}function oc(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.ac(1,"async"),P.Qb(2,"form",4),P.Qb(3,"div",5),P.Bc(4,Br,2,3,"div",6),P.Bc(5,Er,3,3,"div",6),P.Bc(6,Xr,9,7,"ng-container",7),P.ac(7,"async"),P.Pb(),P.Pb(),P.Pb(),P.Qb(8,"results-layout",8),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(9,"async"),P.Bc(10,Wr,3,7,"mobile-result",9),P.Bc(11,cc,11,7,"table",10),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.heading)("mobileHeading",a.mobileHeading)("headingActions",P.bc(1,10,a.headingActions$)),P.xb(2),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",(null==a.statusOptions?null:a.statusOptions.length)>0),P.xb(1),P.gc("ngIf",!a.isMyAuth()&&(null==a.currencies?null:a.currencies.length)>1),P.xb(1),P.gc("ngIf",P.bc(7,12,a.moreFilters$)),P.xb(2),P.gc("results",P.bc(9,14,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}var lc,sc=((lc=function(e){s(a,e);var t=b(a);function a(e,n,i){var r;return c(this,a),(r=t.call(this,e)).transactionsService=n,r.bankingHelper=i,r.usePeriod=!0,r.usePreselectedPeriod=!0,r.currenciesByKey=new Map,r}return l(a,[{key:"ngOnInit",value:function(){var e=this;switch(r(d(a.prototype),"ngOnInit",this).call(this),this.kind=this.route.snapshot.data.kind,this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations;break;case"myAuth":this.heading=this.i18n.transaction.title.pendingMyAuthorization,this.mobileHeading=this.i18n.transaction.mobileTitle.pendingMyAuthorization;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequestsOverview,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequestsOverview}this.stateManager.cache("data",this.transactionsService.getTransactionsOverviewDataForSearch({fields:["user","accountTypes"].concat(n(this.usePreselectedPeriod?["preselectedPeriods"]:[]),["query"]),pendingMyAuthorization:"myAuth"===this.kind})).subscribe((function(t){e.usePeriod&&e.bankingHelper.preProcessPreselectedPeriods(t,e.form),e.data=t}))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(a.prototype),"onDataInitialized",this).call(this,e),this.currencies=n(new Set(e.accountTypes.map((function(e){return e.currency})))),this.currencies.sort((function(e,t){return e.name.localeCompare(t.name)})),this.currenciesByKey=new Map,this.currencies.forEach((function(e){return t.currenciesByKey.set(e.id,e)}));var i=this.currencies.map((function(e){return e.transactionNumberPattern})).filter((function(e){return e})).reduce((function(e,t){return e.includes(t)?e:[].concat(n(e),[t])}),[]);this.hasTransactionNumber=i.length>0,this.transactionNumberPattern=1===i.length?i[0]:null,this.headingActions=[this.moreFiltersAction],this.exportHelper.headingActions(e.exportFormats,(function(e){return t.transactionsService.exportTransactionsOverview$Response(Object.assign({format:e.internalName},t.toSearchParams(t.form.value)))})).forEach((function(e){return t.headingActions.push(e)})),this.addSub(this.form.controls.currency.valueChanges.subscribe((function(e){return t.updateAccountTypes(e)})))}},{key:"updateAccountTypes",value:function(e){var t,n,a=this.form.controls.fromAccountTypes.value,i=this.form.controls.toAccountTypes.value;e&&a&&this.form.controls.fromAccountTypes.setValue((null===(t=this.data.accountTypes.find((function(e){return e.id===a})).currency)||void 0===t?void 0:t.id)===e?a:null),e&&i&&this.form.controls.toAccountTypes.setValue((null===(n=this.data.accountTypes.find((function(e){return e.id===i})).currency)||void 0===n?void 0:n.id)===e?i:null)}},{key:"doSearch",value:function(e){return this.transactionsService.searchTransactionsOverview$Response(e)}},{key:"getFormControlNames",value:function(){return["status","currency","user","preselectedPeriod","periodBegin","periodEnd","transactionNumber","expirationBegin","expirationEnd","transferTypes","authorizationPerformedBy","fromAccountTypes","toAccountTypes"]}},{key:"getInitialFormValue",value:function(e){var t=r(d(a.prototype),"getInitialFormValue",this).call(this,e);switch(this.kind){case"authorized":t.status=u.yb.PENDING;break;case"payment-request":t.status=u.X.OPEN}return t}},{key:"toSearchParams",value:function(e){var t=e;switch(t.currencies=e.currency?[e.currency]:[],this.usePeriod&&(t.datePeriod=this.bankingHelper.resolveDatePeriod(e)),this.isPaymentRequest()&&(t.paymentRequestExpiration=g.a.dateRangeFilter(e.expirationBegin,e.expirationEnd)),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0;break;case"myAuth":t.pendingMyAuthorization=!0;break;case"payment-request":t.paymentRequestStatuses=[e.status],t.kinds=[u.zb.PAYMENT_REQUEST]}return t}},{key:"accountTypes",value:function(){var e=this.form.controls.currency.value,t=this.data.accountTypes||[];return e?t.filter((function(t){return t.currency.id===e})):t}},{key:"isPaymentRequest",value:function(){return"payment-request"===this.kind}},{key:"isMyAuth",value:function(){return"myAuth"===this.kind}},{key:"isAuthorized",value:function(){return"authorized"===this.kind}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.moreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.lessFilters}},{key:"resolveMenu",value:function(e){var t;switch(this.kind){case"authorized":t=this.dataForUiHolder.role===u.kb.BROKER?y.b.BROKER_AUTHORIZED_PAYMENTS_OVERVIEW:y.b.AUTHORIZED_PAYMENTS_OVERVIEW;break;case"myAuth":t=y.b.PENDING_MY_AUTHORIZATION;break;case"payment-request":t=y.b.PAYMENT_REQUESTS_OVERVIEW}return this.menu.userMenu(e.user,t)}},{key:"statusOptions",get:function(){var e=this;switch(this.kind){case"authorized":return Object.values(u.yb).map((function(t){return{value:t,text:e.apiI18n.authorizationStatus(t)}}));case"payment-request":return Object.values(u.X).map((function(t){return{value:t,text:e.apiI18n.paymentRequestStatus(t)}}));case"myAuth":return null}}},{key:"toLink",get:function(){var e=this;return function(t){return e.bankingHelper.transactionPath(t)}}}]),a}(p.a)).\u0275fac=function(e){return new(e||lc)(P.Kb(P.r),P.Kb(sr.a),P.Kb(m.a))},lc.\u0275cmp=P.Eb({type:lc,selectors:[["search-transactions-overview"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions","emptyOption"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","user",3,"label"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","fromAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transferTypes",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["labelPosition","side","formControlName","expirationBegin","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expirationEnd","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","authorizationPerformedBy",3,"label"],[3,"date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"amount",3,"ngClass"],[1,"d-inline-block",3,"routerLink"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,Nr,1,0,"ng-container",1),P.Pb(),P.Bc(3,oc,12,16,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,w.a,C.a,Q.a,S.a,I.v,I.l,k.s,O.a,$.a,E.a,R.a,B.a,N.a,W.a,ee.h,k.q],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),lc),uc=o("Pm8L"),bc=o("/kmK");function fc(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"label-value",5),P.Dc(2),P.Pb(),P.Lb(3,"hr"),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.transaction.number),P.xb(1),P.Fc(" ",n.transaction.transactionNumber," ")}}function dc(e,t){1&e&&P.Lb(0,"hr")}function mc(e,t){if(1&e&&(P.Qb(0,"label-value",5),P.Dc(1),P.Pb()),2&e){var n=P.Zb().$implicit,a=P.Zb(2);P.gc("label",a.i18n.general.performedBy),P.xb(1),P.Fc(" ",n.by.display," ")}}function gc(e,t){if(1&e&&P.Lb(0,"label-value",8),2&e){var n=P.Zb().$implicit,a=P.Zb(2);P.gc("label",a.i18n.general.comments)("value",n.comments)}}function pc(e,t){if(1&e&&(P.Ob(0),P.Bc(1,dc,1,0,"hr",3),P.Qb(2,"label-value",5),P.Dc(3),P.Pb(),P.Bc(4,mc,2,2,"label-value",6),P.Qb(5,"label-value",5),P.Dc(6),P.ac(7,"dateTime"),P.Pb(),P.Bc(8,gc,1,2,"label-value",7),P.Nb()),2&e){var n=t.$implicit,a=t.first,i=P.Zb(2);P.xb(1),P.gc("ngIf",!a),P.xb(1),P.gc("label",i.i18n.general.action),P.xb(1),P.Fc(" ",i.actionLabel(n)," "),P.xb(1),P.gc("ngIf",n.by),P.xb(1),P.gc("label",i.i18n.general.date),P.xb(1),P.Fc(" ",P.bc(7,7,n.date)," "),P.xb(2),P.gc("ngIf",n.comments)}}function hc(e,t){if(1&e&&(P.Qb(0,"page-content",2),P.Bc(1,fc,4,2,"ng-container",3),P.Bc(2,pc,9,9,"ng-container",4),P.Pb()),2&e){var n=P.Zb();P.gc("heading",n.i18n.transaction.title.authorizationHistory)("mobileHeading",n.i18n.transaction.mobileTitle.authorizationHistory),P.xb(1),P.gc("ngIf",n.transaction.transactionNumber),P.xb(1),P.gc("ngForOf",n.transaction.authorizations)}}var yc,vc=((yc=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).transactionsService=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot.paramMap.get("key");this.addSub(this.transactionsService.viewTransaction({key:t,fields:["transactionNumber","date","amount","kind","type","from","to","authorizations"]}).subscribe((function(t){e.data=t})))}},{key:"actionLabel",value:function(e){return this.apiI18n.authorizationAction(e.action)}},{key:"resolveMenu",value:function(e){return this.menu.accountMenu(e.from,e.to)}},{key:"transaction",get:function(){return this.data}}]),n}(uc.a)).\u0275fac=function(e){return new(e||yc)(P.Kb(P.r),P.Kb(sr.a))},yc.\u0275cmp=P.Eb({type:yc,selectors:[["view-authorization-history"]],features:[P.ub],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading",4,"ngIf"],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label"],[3,"label",4,"ngIf"],["valueFormat","break",3,"label","value",4,"ngIf"],["valueFormat","break",3,"label","value"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,hc,3,4,"page-content",1),P.Pb()),2&e&&(P.gc("ready",P.bc(1,2,t.data$)),P.xb(2),P.gc("ngIf",t.data))},directives:[D.a,k.t,L.a,k.s,F.a],pipes:[k.b,bc.a],encapsulation:2,changeDetection:0}),yc),xc=o("mK/S"),Pc=o("w0j7"),Dc=o("Bp6V"),kc=o("0D+q"),Lc=o("Ewue"),wc=o("R8pA");function Cc(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.number),P.xb(1),P.Fc(" ",n.transfer.transactionNumber,"\n")}}function Qc(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Qb(1,"a",7),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.chargedBackBy),P.xb(1),P.gc("routerLink",n.path(n.transfer.chargedBackBy)),P.xb(1),P.Fc(" ",n.transfer.chargedBackBy.display," ")}}function Ic(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Qb(1,"a",7),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.chargebackOf),P.xb(1),P.gc("routerLink",n.path(n.transfer.chargebackOf)),P.xb(1),P.Fc(" ",n.transfer.chargebackOf.display," ")}}function Fc(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.general.performedBy),P.xb(1),P.Fc(" ",n.transfer.transaction.by.display,"\n")}}function Tc(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.receivedBy),P.xb(1),P.Fc(" ",n.transfer.transaction.receivedBy.display,"\n")}}function Sc(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.channel),P.xb(1),P.Fc(" ",n.transfer.transaction.channel.name,"\n")}}function Oc(e,t){1&e&&P.Lb(0,"custom-field-value",8),2&e&&P.gc("fieldValue",t.$implicit)}function Nc(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Dc(1),P.Pb()),2&e){var n=t.$implicit;P.gc("label",n.flow.name),P.xb(1),P.Fc(" ",n.name,"\n")}}function Bc(e,t){if(1&e&&P.Lb(0,"label-value",9),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.authorizationComments)("value",n.lastAuthComment)}}function Ac(e,t){if(1&e&&P.Lb(0,"label-value",9),2&e){var n=P.Zb();P.gc("label",n.i18n.general.description)("value",n.transfer.transaction.description)}}function Ec(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.number),P.xb(1),P.Fc(" ",n.transfer.parent.transactionNumber," ")}}function $c(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"h2",10),P.Dc(2),P.ac(3,"async"),P.Pb(),P.Bc(4,Ec,2,2,"label-value",0),P.Qb(5,"label-value",1),P.Dc(6),P.ac(7,"dateTime"),P.Pb(),P.Qb(8,"label-value",1),P.Dc(9),P.ac(10,"currency"),P.Pb(),P.Qb(11,"label-value",1),P.Lb(12,"user-link",2),P.Pb(),P.Qb(13,"label-value",1),P.Lb(14,"user-link",2),P.Pb(),P.Qb(15,"label-value",1),P.Dc(16),P.Pb(),P.Qb(17,"actions"),P.Qb(18,"a",11),P.Dc(19),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(2),P.Ec(P.bc(3,14,n.layout.gtxs$)?n.i18n.transaction.title.parentTransfer:n.i18n.transaction.mobileTitle.parentTransfer),P.xb(2),P.gc("ngIf",n.transfer.parent.transactionNumber),P.xb(1),P.gc("label",n.i18n.general.date),P.xb(1),P.Fc(" ",P.bc(7,16,n.transfer.parent.date)," "),P.xb(2),P.gc("label",n.i18n.transaction.amount),P.xb(1),P.Fc(" ",P.cc(10,18,n.transfer.parent.amount,n.transfer.parent.currency)," "),P.xb(2),P.gc("label",n.i18n.transaction.from),P.xb(1),P.gc("account",n.transfer.parent.from),P.xb(1),P.gc("label",n.i18n.transaction.to),P.xb(1),P.gc("account",n.transfer.parent.to),P.xb(1),P.gc("label",n.i18n.transaction.type),P.xb(1),P.Fc(" ",n.transfer.parent.type.name," "),P.xb(2),P.gc("routerLink",n.path(n.transfer.parent)),P.xb(1),P.Fc(" ",n.i18n.transaction.viewThisTransfer," ")}}function Rc(e,t){if(1&e&&(P.Qb(0,"div"),P.Dc(1),P.Lb(2,"user-link",2),P.Pb()),2&e){var n=P.Zb().$implicit,a=P.Zb(2);P.xb(1),P.Fc(" ",a.i18n.transaction.from," "),P.xb(1),P.gc("account",n.from)}}function Zc(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.to,"")}}function Mc(e,t){if(1&e&&(P.Qb(0,"mobile-result",16),P.Qb(1,"div",17),P.Bc(2,Rc,3,2,"div",6),P.Qb(3,"div"),P.Bc(4,Zc,2,1,"ng-container",6),P.Lb(5,"user-link",2),P.Pb(),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("date",n.date)("amount",((null==n.from.user?null:n.from.user.id)===(null==a.login.user?null:a.login.user.id)?"-":"")+n.amount)("amountColor",(null==n.from.user?null:n.from.user.id)===(null==a.login.user?null:a.login.user.id))("currency",n.currency),P.xb(2),P.gc("ngIf",(null==n.from.user?null:n.from.user.id)!==(null==a.login.user?null:a.login.user.id)),P.xb(2),P.gc("ngIf",(null==n.from.user?null:n.from.user.id)!==(null==a.login.user?null:a.login.user.id)),P.xb(1),P.gc("account",n.to)}}function Hc(e,t){if(1&e){var n=P.Rb();P.Qb(0,"tr",21),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.path(e))})),P.Qb(1,"td"),P.Qb(2,"a",7),P.Dc(3),P.ac(4,"date"),P.Pb(),P.Pb(),P.Qb(5,"td"),P.Qb(6,"a",7),P.Lb(7,"user-link",2),P.Pb(),P.Pb(),P.Qb(8,"td"),P.Qb(9,"a",7),P.Lb(10,"user-link",2),P.Pb(),P.Pb(),P.Qb(11,"td",19),P.Qb(12,"a",7),P.Dc(13),P.ac(14,"currency"),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",P.bc(4,8,a.date)," "),P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.gc("account",a.from),P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.gc("account",a.to),P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",P.cc(14,10,a.amount,a.currency)," ")}}function qc(e,t){if(1&e&&(P.Qb(0,"table",18),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th",19),P.Dc(9),P.Pb(),P.Pb(),P.Qb(10,"tbody"),P.Bc(11,Hc,15,13,"tr",20),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(3),P.Ec(n.i18n.general.date),P.xb(2),P.Ec(n.i18n.transaction.from),P.xb(2),P.Ec(n.i18n.transaction.to),P.xb(2),P.Ec(n.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",n.transfer.children)}}function Uc(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"h2",12),P.Dc(2),P.ac(3,"async"),P.Pb(),P.Qb(4,"results-layout",13),P.Bc(5,Mc,6,7,"mobile-result",14),P.Bc(6,qc,12,5,"table",15),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(2),P.Ec(P.bc(3,3,n.layout.gtxs$)?n.i18n.transaction.title.childTransfers:n.i18n.transaction.mobileTitle.childTransfers),P.xb(2),P.gc("results",n.transfer.children)("toLink",n.toLink)}}var Vc,jc=((Vc=function(e){s(n,e);var t=b(n);function n(e,a,i){var r;return c(this,n),(r=t.call(this,e)).login=a,r.bankingHelper=i,r}return l(n,[{key:"ngOnInit",value:function(){r(d(n.prototype),"ngOnInit",this).call(this);var e=this.transfer.transaction||{};Object(h.h)(e.authorizations)||(this.lastAuthComment=e.authorizations[0].comments),this.hasAdditionalData=!Object(h.h)(this.lastAuthComment)||!!this.transfer.parent||!Object(h.h)(this.transfer.children)}},{key:"path",value:function(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Vc)(P.Kb(P.r),P.Kb(wc.a),P.Kb(m.a))},Vc.\u0275cmp=P.Eb({type:Vc,selectors:[["transfer-details"]],inputs:{transfer:"transfer",headingActions:"headingActions"},features:[P.ub],decls:24,vars:27,consts:[[3,"label",4,"ngIf"],[3,"label"],[3,"account"],[3,"fieldValue",4,"ngFor","ngForOf"],[3,"label",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"routerLink"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"mt-4"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"mt-4","mb-0"],[3,"results","toLink"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"date","amount","amountColor","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(P.Bc(0,Cc,2,2,"label-value",0),P.Qb(1,"label-value",1),P.Dc(2),P.ac(3,"dateTime"),P.Pb(),P.Qb(4,"label-value",1),P.Dc(5),P.ac(6,"currency"),P.Pb(),P.Bc(7,Qc,3,3,"label-value",0),P.Bc(8,Ic,3,3,"label-value",0),P.Bc(9,Fc,2,2,"label-value",0),P.Bc(10,Tc,2,2,"label-value",0),P.Qb(11,"label-value",1),P.Lb(12,"user-link",2),P.Pb(),P.Qb(13,"label-value",1),P.Lb(14,"user-link",2),P.Pb(),P.Qb(15,"label-value",1),P.Dc(16),P.Pb(),P.Bc(17,Sc,2,2,"label-value",0),P.Bc(18,Oc,1,1,"custom-field-value",3),P.Bc(19,Nc,2,2,"label-value",4),P.Bc(20,Bc,1,2,"label-value",5),P.Bc(21,Ac,1,2,"label-value",5),P.Bc(22,$c,20,21,"ng-container",6),P.Bc(23,Uc,7,5,"ng-container",6)),2&e&&(P.gc("ngIf",t.transfer.transactionNumber),P.xb(1),P.gc("label",t.i18n.general.date),P.xb(1),P.Fc(" ",P.bc(3,22,t.transfer.date),"\n"),P.xb(2),P.gc("label",t.i18n.transaction.amount),P.xb(1),P.Fc(" ",P.cc(6,24,t.transfer.amount,t.transfer.currency),"\n"),P.xb(2),P.gc("ngIf",t.transfer.chargedBackBy),P.xb(1),P.gc("ngIf",t.transfer.chargebackOf),P.xb(1),P.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.by),P.xb(1),P.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.receivedBy),P.xb(1),P.gc("label",t.i18n.transaction.from),P.xb(1),P.gc("account",t.transfer.from),P.xb(1),P.gc("label",t.i18n.transaction.to),P.xb(1),P.gc("account",t.transfer.to),P.xb(1),P.gc("label",t.i18n.transaction.type),P.xb(1),P.Fc(" ",t.transfer.type.name,"\n"),P.xb(1),P.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.channel),P.xb(1),P.gc("ngForOf",null==t.transfer.transaction?null:t.transfer.transaction.customValues),P.xb(1),P.gc("ngForOf",t.transfer.statuses),P.xb(1),P.gc("ngIf",t.lastAuthComment),P.xb(1),P.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.description),P.xb(1),P.gc("ngIf",t.transfer.parent),P.xb(1),P.gc("ngIf",(null==t.transfer.children?null:t.transfer.children.length)>0))},directives:[k.t,F.a,T.a,k.s,ee.h,aa.a,wt.a,w.a,C.a,Q.a,W.a],pipes:[bc.a,M.a,k.b,te.a],encapsulation:2,changeDetection:0}),Vc),zc=o("Wpnw");function Gc(e,t){if(1&e&&P.Lb(0,"transfer-details",5),2&e){var n=P.Zb(2);P.gc("transfer",n.transaction.transfer)}}function _c(e,t){if(1&e&&(P.Qb(0,"page-content",3),P.ac(1,"async"),P.Bc(2,Gc,1,1,"transfer-details",4),P.Pb()),2&e){var n=P.Zb(),a=P.qc(4);P.gc("heading",n.title)("mobileHeading",n.mobileTitle)("headingActions",P.bc(1,5,n.headingActions$)),P.xb(2),P.gc("ngIf",n.transaction.transfer)("ngIfElse",a)}}function Kc(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.number),P.xb(1),P.Fc(" ",n.transaction.transactionNumber," ")}}function Xc(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"dateTime"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.general.expirationDate),P.xb(1),P.Fc(" ",P.bc(2,2,n.transaction.expirationDate)," ")}}function Yc(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"dateTime"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.processDate),P.xb(1),P.Fc(" ",P.bc(2,2,n.transaction.processDate)," ")}}function Wc(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"currency"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.dueAmount),P.xb(1),P.Fc(" ",P.cc(2,2,n.transaction.dueAmount,n.transaction.currency)," ")}}function Jc(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.general.performedBy),P.xb(1),P.Fc(" ",n.transaction.by.display," ")}}function eo(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.receivedBy),P.xb(1),P.Fc(" ",n.transaction.receivedBy.display," ")}}function to(e,t){if(1&e&&P.Lb(0,"user-link",15),2&e){var n=P.Zb(2);P.gc("user",n.transaction.fromUser)}}function no(e,t){if(1&e&&P.Dc(0),2&e){var n=P.Zb(2);P.Fc(" ",n.transaction.type.from.name," ")}}function ao(e,t){if(1&e&&P.Lb(0,"user-link",15),2&e){var n=P.Zb(2);P.gc("user",n.transaction.toUser)}}function io(e,t){if(1&e&&P.Dc(0),2&e){var n=P.Zb(2);P.Fc(" ",n.transaction.type.to.name," ")}}function ro(e,t){1&e&&P.Lb(0,"custom-field-value",16),2&e&&P.gc("fieldValue",t.$implicit)}function co(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.channel),P.xb(1),P.Fc(" ",n.transaction.channel.name," ")}}function oo(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"date"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.dueDate),P.xb(1),P.Fc(" ",P.bc(2,2,n.transaction.installments[0].dueDate)," ")}}function lo(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"date"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.nextOccurrence),P.xb(1),P.Fc(" ",P.bc(2,2,n.transaction.nextOccurrenceDate)," ")}}function so(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.occurrencesCount),P.xb(1),P.Fc(" ",n.transaction.occurrencesCount," ")}}function uo(e,t){if(1&e&&P.Lb(0,"label-value",17),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.authorizationComments)("value",n.lastAuthComment)}}function bo(e,t){if(1&e&&P.Lb(0,"label-value",17),2&e){var n=P.Zb(2);P.gc("label",n.i18n.general.description)("value",n.transaction.description)}}function fo(e,t){if(1&e&&P.Lb(0,"label-value",17),2&e){var n=P.Zb(2);P.gc("label",n.i18n.general.comments)("value",n.transaction.comments)}}function mo(e,t){1&e&&P.Lb(0,"th",23)}function go(e,t){if(1&e&&(P.Qb(0,"thead"),P.Qb(1,"th"),P.Dc(2),P.Pb(),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Qb(7,"th",21),P.Dc(8),P.Pb(),P.Bc(9,mo,1,0,"th",22),P.Pb()),2&e){var n=P.Zb(3);P.xb(2),P.Ec(n.i18n.transaction.installmentNumber),P.xb(2),P.Ec(n.i18n.transaction.dueDate),P.xb(2),P.Ec(n.i18n.general.status),P.xb(2),P.Ec(n.i18n.transaction.amount),P.xb(1),P.gc("ngIf",n.hasActions)}}function po(e,t){if(1&e){var n=P.Rb();P.Qb(0,"button",31),P.Xb("click",(function(){P.sc(n);var e=P.Zb(2).$implicit;return P.Zb(3).processInstallment(e)})),P.Lb(1,"icon",32),P.Pb()}if(2&e){var a=P.Zb(5);P.gc("tooltip",a.i18n.transaction.processInstallment)}}var ho=function(e){return{"ml-2":e}};function yo(e,t){if(1&e){var n=P.Rb();P.Qb(0,"button",33),P.Xb("click",(function(){P.sc(n);var e=P.Zb(2).$implicit;return P.Zb(3).settleInstallment(e)})),P.Lb(1,"icon",34),P.Pb()}if(2&e){var a=P.Zb(2).$implicit,i=P.Zb(3);P.gc("tooltip",i.i18n.transaction.settleInstallment)("ngClass",P.jc(2,ho,a.canProcess))}}function vo(e,t){if(1&e&&(P.Qb(0,"td",28),P.Bc(1,po,2,1,"button",29),P.Bc(2,yo,2,4,"button",30),P.Pb()),2&e){var n=P.Zb().$implicit;P.xb(1),P.gc("ngIf",n.canProcess),P.xb(1),P.gc("ngIf",n.canSettle)}}var xo=function(e){return{"cursor-pointer":e}};function Po(e,t){if(1&e){var n=P.Rb();P.Qb(0,"tr",24),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.path(e)?a.router.navigate(a.path(e)):null})),P.Qb(1,"td"),P.Qb(2,"maybe-link",25),P.Dc(3),P.Pb(),P.Pb(),P.Qb(4,"td"),P.Qb(5,"maybe-link",25),P.Dc(6),P.ac(7,"date"),P.Pb(),P.Pb(),P.Qb(8,"td"),P.Qb(9,"maybe-link",25),P.Dc(10),P.Pb(),P.Pb(),P.Qb(11,"td",26),P.Qb(12,"maybe-link",25),P.Dc(13),P.ac(14,"currency"),P.Pb(),P.Pb(),P.Bc(15,vo,3,2,"td",27),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.gc("ngClass",P.jc(15,xo,i.path(a))),P.xb(2),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",a.number," "),P.xb(2),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",P.bc(7,10,a.dueDate)," "),P.xb(3),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",i.installmentStatus(a.status)," "),P.xb(2),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",P.cc(14,12,a.amount,i.transaction.currency)," "),P.xb(2),P.gc("ngIf",i.hasActions)}}function Do(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"h2",18),P.Dc(2),P.Pb(),P.Qb(3,"table",19),P.Bc(4,go,10,5,"thead",14),P.ac(5,"async"),P.Qb(6,"tbody"),P.Bc(7,Po,16,17,"tr",20),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.Ec(n.i18n.transaction.installments),P.xb(2),P.gc("ngIf",P.bc(5,3,n.layout.gtxs$)),P.xb(3),P.gc("ngForOf",n.transaction.installments)}}function ko(e,t){1&e&&P.Lb(0,"th",23)}function Lo(e,t){if(1&e&&(P.Qb(0,"thead"),P.Qb(1,"th"),P.Dc(2),P.Pb(),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Qb(7,"th",26),P.Dc(8),P.Pb(),P.Bc(9,ko,1,0,"th",22),P.Pb()),2&e){var n=P.Zb(3);P.xb(2),P.Ec(n.i18n.transaction.installmentNumber),P.xb(2),P.Ec(n.i18n.general.date),P.xb(2),P.Ec(n.i18n.general.status),P.xb(2),P.Ec(n.i18n.transaction.amount),P.xb(1),P.gc("ngIf",n.hasActions)}}function wo(e,t){if(1&e){var n=P.Rb();P.Qb(0,"button",31),P.Xb("click",(function(){P.sc(n);var e=P.Zb(2).$implicit;return P.Zb(3).processOccurrence(e)})),P.Lb(1,"icon",32),P.Pb()}if(2&e){var a=P.Zb(5);P.gc("tooltip",a.i18n.transaction.processFailedOccurrence)}}function Co(e,t){if(1&e&&(P.Qb(0,"td",23),P.Bc(1,wo,2,1,"button",29),P.Pb()),2&e){var n=P.Zb().$implicit;P.xb(1),P.gc("ngIf",n.canProcess)}}function Qo(e,t){if(1&e){var n=P.Rb();P.Qb(0,"tr",24),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.path(e)?a.router.navigate(a.path(e)):null})),P.Qb(1,"td"),P.Qb(2,"maybe-link",25),P.Dc(3),P.Pb(),P.Pb(),P.Qb(4,"td"),P.Qb(5,"maybe-link",25),P.Dc(6),P.ac(7,"date"),P.Pb(),P.Pb(),P.Qb(8,"td"),P.Qb(9,"maybe-link",25),P.Dc(10),P.Pb(),P.Pb(),P.Qb(11,"td",26),P.Qb(12,"maybe-link",25),P.Dc(13),P.ac(14,"currency"),P.Pb(),P.Pb(),P.Bc(15,Co,2,1,"td",22),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.gc("ngClass",P.jc(15,xo,i.path(a))),P.xb(2),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",a.number," "),P.xb(2),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",P.bc(7,10,a.dueDate)," "),P.xb(3),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",i.installmentStatus(a.status)," "),P.xb(2),P.gc("link",i.path(a)),P.xb(1),P.Fc(" ",P.cc(14,12,a.amount,i.transaction.currency)," "),P.xb(2),P.gc("ngIf",i.hasActions)}}function Io(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"h2",18),P.Dc(2),P.Pb(),P.Qb(3,"table",35),P.Bc(4,Lo,10,5,"thead",14),P.ac(5,"async"),P.Qb(6,"tbody"),P.Bc(7,Qo,16,17,"tr",20),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.Fc(" ",n.i18n.transaction.occurrences," "),P.xb(2),P.gc("ngIf",P.bc(5,3,n.layout.gtxs$)),P.xb(3),P.gc("ngForOf",n.transaction.occurrences)}}var Fo=function(){return[]};function To(e,t){if(1&e&&(P.Bc(0,Kc,2,2,"label-value",6),P.Lb(1,"label-value",7),P.Qb(2,"label-value",8),P.Dc(3),P.ac(4,"dateTime"),P.Pb(),P.Bc(5,Xc,3,4,"label-value",6),P.Bc(6,Yc,3,4,"label-value",6),P.Qb(7,"label-value",8),P.Dc(8),P.ac(9,"currency"),P.Pb(),P.Bc(10,Wc,3,5,"label-value",6),P.Bc(11,Jc,2,2,"label-value",6),P.Bc(12,eo,2,2,"label-value",6),P.Qb(13,"label-value",8),P.Bc(14,to,1,1,"user-link",9),P.Bc(15,no,1,1,"ng-template",null,10,P.Cc),P.Pb(),P.Qb(17,"label-value",8),P.Bc(18,ao,1,1,"user-link",9),P.Bc(19,io,1,1,"ng-template",null,11,P.Cc),P.Pb(),P.Qb(21,"label-value",8),P.Dc(22),P.Pb(),P.Bc(23,ro,1,1,"custom-field-value",12),P.Bc(24,co,2,2,"label-value",6),P.Bc(25,oo,3,4,"label-value",6),P.Bc(26,lo,3,4,"label-value",6),P.Bc(27,so,2,2,"label-value",6),P.Bc(28,uo,1,2,"label-value",13),P.Bc(29,bo,1,2,"label-value",13),P.Bc(30,fo,1,2,"label-value",13),P.Bc(31,Do,8,5,"ng-container",14),P.Bc(32,Io,8,5,"ng-container",14)),2&e){var n=P.qc(16),a=P.qc(20),i=P.Zb();P.gc("ngIf",i.transaction.transactionNumber),P.xb(1),P.gc("label",i.i18n.general.status)("value",i.status),P.xb(1),P.gc("label",i.i18n.general.date),P.xb(1),P.Fc(" ",P.bc(4,30,i.transaction.date)," "),P.xb(2),P.gc("ngIf",i.isPaymentRequest()),P.xb(1),P.gc("ngIf",i.isPaymentRequest()&&i.transaction.processDate),P.xb(1),P.gc("label",i.i18n.transaction.amount),P.xb(1),P.Fc(" ",P.cc(9,32,i.transaction.amount,i.transaction.currency)," "),P.xb(2),P.gc("ngIf",i.hasDueAmount),P.xb(1),P.gc("ngIf",i.transaction.by),P.xb(1),P.gc("ngIf",null==i.transaction?null:i.transaction.receivedBy),P.xb(1),P.gc("label",i.isPaymentRequest()?i.i18n.transaction.sender:i.i18n.transaction.from),P.xb(1),P.gc("ngIf",i.transaction.fromUser)("ngIfElse",n),P.xb(3),P.gc("label",i.isPaymentRequest()?i.i18n.transaction.receiver:i.i18n.transaction.to),P.xb(1),P.gc("ngIf",i.transaction.toUser)("ngIfElse",a),P.xb(3),P.gc("label",i.i18n.transaction.type),P.xb(1),P.Fc(" ",i.transaction.type.name," "),P.xb(1),P.gc("ngForOf",i.transaction.customValues),P.xb(1),P.gc("ngIf",i.transaction.channel),P.xb(1),P.gc("ngIf",1===(i.transaction.installments||P.ic(35,Fo)).length),P.xb(1),P.gc("ngIf",i.transaction.nextOccurrenceDate),P.xb(1),P.gc("ngIf",i.transaction.occurrencesCount),P.xb(1),P.gc("ngIf",i.lastAuthComment),P.xb(1),P.gc("ngIf",i.transaction.description),P.xb(1),P.gc("ngIf",i.transaction.comments),P.xb(1),P.gc("ngIf",(i.transaction.installments||P.ic(36,Fo)).length>1),P.xb(1),P.gc("ngIf",(i.transaction.occurrences||P.ic(37,Fo)).length>0)}}var So,Oo=((So=function(n){s(i,n);var a=b(i);function i(e,t,n,r,o,l,s,u,b){var f;return c(this,i),(f=a.call(this,e)).transactionsService=t,f.installmentsService=n,f.pendingPaymentsService=r,f.scheduledPaymentsService=o,f.recurringPaymentsService=l,f.paymentRequestsService=s,f.transfersService=u,f.operationHelper=b,f.hasDueAmount=!1,f.hasActions=!1,f}return l(i,[{key:"ngOnInit",value:function(){var t=this;r(d(i.prototype),"ngOnInit",this).call(this),this.addSub(this.transactionsService.viewTransaction({key:this.key}).subscribe((function(n){var a;a=e(t.titles(n.kind),2),t.title=a[0],t.mobileTitle=a[1],t.headingActions=t.initActions(n),t.hasDueAmount=n.dueAmount&&!t.format.isZero(n.dueAmount),t.hasActions=!!(n.installments||n.occurrences||[]).find((function(e){return e.canProcess||e.canSettle})),t.data=n,n.transfer&&(n.transfer.transaction=n),Object(h.h)(n.authorizations)||(t.lastAuthComment=n.authorizations[0].comments)})))}},{key:"initActions",value:function(e){var n,a,i=this,r=this.exportHelper.headingActions(e.exportFormats,(function(t){return i.transactionsService.exportTransaction$Response({format:t.internalName,key:e.id})})),c=e.authorizationPermissions||{};Object(h.h)(e.authorizations)||r.push(new Yt.c("check_circle_outline",this.i18n.transaction.viewAuthorizations,(function(){return i.router.navigate(["banking","transaction",i.key,"authorization-history"])}))),c.authorize&&r.push(new Yt.c("thumb_up",this.i18n.transaction.authorizePending,(function(){return i.authorize()}))),c.deny&&r.push(new Yt.c("thumb_down",this.i18n.transaction.denyPending,(function(){return i.deny()}))),c.cancel&&r.push(new Yt.c("cancel",this.i18n.transaction.cancelAuthorization,(function(){return i.cancelAuthorization()})));var o=e.scheduledPaymentPermissions||{};o.block&&r.push(new Yt.c("block",this.i18n.transaction.blockScheduling,(function(){return i.blockScheduled()}))),o.unblock&&r.push(new Yt.c("schedule",this.i18n.transaction.unblockScheduling,(function(){return i.unblockScheduled()}))),o.cancel&&r.push(new Yt.c("cancel",this.i18n.transaction.cancelScheduled,(function(){return i.cancelScheduled()}))),o.settle&&r.push(new Yt.c("done_all",this.i18n.transaction.settleScheduled,(function(){return i.settleScheduled()}))),e.kind===u.zb.SCHEDULED_PAYMENT&&1===e.installments.length&&e.installments[0].canProcess&&r.push(new Yt.c("play_circle_outline",this.i18n.transaction.processScheduled,(function(){return i.processScheduled(e.installments[0])}))),(null===(n=e.recurringPaymentPermissions)||void 0===n?void 0:n.cancel)&&r.push(new Yt.c("cancel",this.i18n.transaction.cancelRecurring,(function(){return i.cancelRecurring()})));var l=e.paymentRequestPermissions||{};l.accept&&r.push(new Yt.c("thumb_up",this.i18n.transaction.acceptPaymentRequest,(function(){return i.acceptPaymentRequest()}))),l.reject&&r.push(new Yt.c("thumb_down",this.i18n.transaction.rejectPaymentRequest,(function(){return i.rejectPaymentRequest()}))),l.cancel&&r.push(new Yt.c("cancel",this.i18n.transaction.cancelPaymentRequest,(function(){return i.cancelPaymentRequest()}))),l.reschedule&&r.push(new Yt.c("schedule",this.i18n.transaction.reschedulePaymentRequest,(function(){return i.reschedulePaymentRequest()}))),l.changeExpiration&&r.push(new Yt.c("schedule",this.i18n.transaction.changePaymentRequestExpiration,(function(){return i.changePaymentRequestExpiration()}))),(null===(a=e.transfer)||void 0===a?void 0:a.canChargeback)&&r.push(new Yt.c("undo",this.i18n.transaction.chargebackTransfer,(function(){return i.chargeback()})));var s,b=t((e.transfer||{}).operations||[]);try{for(b.s();!(s=b.n()).done;){var f=s.value;r.push(this.operationHelper.headingAction(f,e.transfer.id))}}catch(d){b.e(d)}finally{b.f()}return r}},{key:"authDeviceConfirmation",value:function(e){var t=this;return function(){return{type:u.s.MANAGE_AUTHORIZATION,transaction:t.transaction.id,authorizationAction:e}}}},{key:"authorize",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.authorizePending,labelPosition:"above",customFields:this.authorizationFields,passwordInput:this.transaction.confirmationPasswordInput,createDeviceConfirmation:this.authDeviceConfirmation(u.h.AUTHORIZE),callback:function(t){e.addSub(e.pendingPaymentsService.authorizePendingPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments}}).subscribe((function(t){t?e.notification.warning(e.i18n.transaction.authorizePendingDoneStillPending):e.notification.snackBar(e.i18n.transaction.authorizePendingDone),e.reload()})))}})}},{key:"deny",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.denyPending,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(u.h.DENY),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.pendingPaymentsService.denyPendingPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments}}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.denyPendingDone)})))}})}},{key:"cancelAuthorization",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.cancelAuthorization,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(u.h.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.pendingPaymentsService.cancelPendingPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments}}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.cancelAuthorizationDone)})))}})}},{key:"schedDeviceConfirmation",value:function(e){var t=this;return function(){return{type:u.s.MANAGE_SCHEDULED_PAYMENT,transaction:t.transaction.id,scheduledPaymentAction:e}}}},{key:"blockScheduled",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.blockScheduling,message:this.i18n.transaction.blockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(u.lb.BLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.scheduledPaymentsService.blockScheduledPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.blockSchedulingDone)})))}})}},{key:"unblockScheduled",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.unblockScheduling,message:this.i18n.transaction.unblockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(u.lb.UNBLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.scheduledPaymentsService.unblockScheduledPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.unblockSchedulingDone)})))}})}},{key:"cancelScheduled",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.cancelScheduled,message:this.i18n.transaction.cancelScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(u.lb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.scheduledPaymentsService.cancelScheduledPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.cancelScheduledDone)})))}})}},{key:"settleScheduled",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.settleScheduled,message:this.i18n.transaction.settleScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(u.lb.SETTLE),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.scheduledPaymentsService.settleScheduledPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.settleScheduledDone)})))}})}},{key:"recurringDeviceConfirmation",value:function(e){var t=this;return function(){return{type:u.s.MANAGE_RECURRING_PAYMENT,transaction:t.transaction.id,recurringPaymentAction:e}}}},{key:"cancelRecurring",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.cancelRecurring,message:this.i18n.transaction.cancelRecurringMessage,createDeviceConfirmation:this.recurringDeviceConfirmation(u.fb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.recurringPaymentsService.cancelRecurringPayment({key:e.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.cancelRecurringDone)})))}})}},{key:"paymentRequestDeviceConfirmation",value:function(e){var t=this;return function(){return{type:u.s.MANAGE_PAYMENT_REQUEST,transaction:t.transaction.id,paymentRequestAction:e}}}},{key:"cancelPaymentRequest",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.cancelPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(u.V.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"comments",name:this.i18n.general.comments,type:u.p.TEXT}],callback:function(t){e.addSub(e.paymentRequestsService.cancelPaymentRequest({key:e.transaction.id,body:t.customValues.comments,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.cancelPaymentRequestDone)})))}})}},{key:"rejectPaymentRequest",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.rejectPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(u.V.DENY),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"comments",name:this.i18n.general.comments,type:u.p.TEXT}],callback:function(t){e.addSub(e.paymentRequestsService.rejectPaymentRequest({key:e.transaction.id,body:t.customValues.comments,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.rejectPaymentRequestDone)})))}})}},{key:"changePaymentRequestExpiration",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.changePaymentRequestExpiration,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(u.V.CHANGE_EXPIRATION),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:u.p.DATE,required:!0},{internalName:"comments",defaultValue:this.data.changeExpirationDateComments,name:this.i18n.general.comments,type:u.p.TEXT}],callback:function(t){e.addSub(e.paymentRequestsService.changePaymentRequestExpirationDate({key:e.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments,newExpirationDate:g.a.shiftToDayEnd(t.customValues.expiry)}}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.changePaymentRequestExpirationDone)})))}})}},{key:"reschedulePaymentRequest",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.reschedulePaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(u.V.RESCHEDULE),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:u.p.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:u.p.TEXT}],callback:function(t){e.addSub(e.paymentRequestsService.reschedulePaymentRequest({key:e.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments,processDate:t.customValues.expiry}}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.reschedulePaymentRequestDone)})))}})}},{key:"acceptPaymentRequest",value:function(){this.router.navigate(["/banking","payment-request",this.data.id,"accept"])}},{key:"chargebackDeviceConfirmation",value:function(){var e=this;return function(){return{type:u.s.CHARGEBACK,transfer:e.transaction.transfer.id}}}},{key:"chargeback",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transaction.confirmationPasswordInput,callback:function(t){e.addSub(e.transfersService.chargebackTransfer({key:e.transaction.transfer.id,confirmationPassword:t.confirmationPassword}).subscribe((function(){return e.sendNotificationAndReload(e.i18n.transaction.chargebackTransferDone)})))}})}},{key:"titles",value:function(e){switch(e){case u.zb.SCHEDULED_PAYMENT:return[this.i18n.transaction.title.detailsScheduled,this.i18n.transaction.mobileTitle.detailsScheduled];case u.zb.RECURRING_PAYMENT:return[this.i18n.transaction.title.detailsRecurring,this.i18n.transaction.mobileTitle.detailsRecurring];case u.zb.PAYMENT_REQUEST:return[this.i18n.transaction.title.detailsRequest,this.i18n.transaction.mobileTitle.detailsRequest];case u.zb.CHARGEBACK:return[this.i18n.transaction.title.detailsChargeback,this.i18n.transaction.mobileTitle.detailsChargeback];case u.zb.TICKET:return[this.i18n.transaction.title.detailsTicket,this.i18n.transaction.mobileTitle.detailsTicket];case u.zb.EXTERNAL_PAYMENT:return[this.i18n.transaction.title.detailsExternal,this.i18n.transaction.mobileTitle.detailsExternal];default:return[this.i18n.transaction.title.detailsPayment,this.i18n.transaction.mobileTitle.detailsPayment]}}},{key:"installmentStatus",value:function(e){return this.apiI18n.installmentStatus(e)}},{key:"path",value:function(e){var t=e.transferTransactionNumber||e.transferId;if(t)return["/banking","transfer",t]}},{key:"installmentDeviceConfirmation",value:function(e,t){return function(){return{type:u.s.MANAGE_INSTALLMENT,installment:t.id,installmentAction:e}}}},{key:"settleInstallment",value:function(e){var t=this;this.notification.confirm({title:this.i18n.transaction.settleInstallment,message:this.i18n.transaction.settleInstallmentMessage(String(e.number)),createDeviceConfirmation:this.installmentDeviceConfirmation(u.F.SETTLE,e),passwordInput:this.transaction.confirmationPasswordInput,callback:function(n){t.addSub(t.installmentsService.settleInstallment({key:e.id,confirmationPassword:n.confirmationPassword}).subscribe((function(){return t.sendNotificationAndReload(t.i18n.transaction.settleInstallmentDone)})))}})}},{key:"isScheduledPayment",value:function(){return this.data.kind===u.zb.SCHEDULED_PAYMENT}},{key:"isPaymentRequest",value:function(){return this.data.kind===u.zb.PAYMENT_REQUEST}},{key:"processInstallment",value:function(e){this.notification.confirm({title:this.i18n.transaction.processInstallment,message:this.i18n.transaction.processInstallmentMessage(e.number),createDeviceConfirmation:this.installmentDeviceConfirmation(u.F.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processInstallmentDone)})}},{key:"processOccurrence",value:function(e){this.notification.confirm({title:this.i18n.transaction.processFailedOccurrence,message:this.i18n.transaction.processFailedOccurrenceMessage(e.number),createDeviceConfirmation:this.failedOccurreneceDeviceConfirmation(u.x.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processFailedOccurrenceDone)})}},{key:"processScheduled",value:function(e){this.notification.confirm({title:this.i18n.transaction.processScheduled,message:this.i18n.transaction.processScheduledMessage,createDeviceConfirmation:this.installmentDeviceConfirmation(u.F.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processScheduledDone)})}},{key:"processCallback",value:function(e,t){var n=this;return function(a){return n.addSub(n.installmentsService.processInstallment({key:e,confirmationPassword:a.confirmationPassword}).subscribe((function(){return n.sendNotificationAndReload(t)})))}}},{key:"sendNotificationAndReload",value:function(e){this.notification.snackBar(e),this.reload()}},{key:"failedOccurreneceDeviceConfirmation",value:function(e,t){return function(){return{type:u.s.MANAGE_FAILED_OCCURRENCE,failedOccurrence:t.id,failedOccurrenceAction:e}}}},{key:"resolveMenu",value:function(e){return this.menu.accountMenu(e.from,e.to)}},{key:"status",get:function(){return this.apiI18n.transactionStatus(this.transaction)}},{key:"transaction",get:function(){return this.data}},{key:"key",get:function(){return this.route.snapshot.paramMap.get("key")}},{key:"authorizationFields",get:function(){return[{internalName:"comments",name:this.i18n.general.comments,type:u.p.TEXT}]}}]),i}(uc.a)).\u0275fac=function(e){return new(e||So)(P.Kb(P.r),P.Kb(sr.a),P.Kb(Gi.a),P.Kb(Pc.a),P.Kb(kc.a),P.Kb(Dc.a),P.Kb(Jn.a),P.Kb(xc.a),P.Kb(Lc.a))},So.\u0275cmp=P.Eb({type:So,selectors:[["view-transaction"]],features:[P.ub],decls:5,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["transactionFields",""],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"transfer",4,"ngIf","ngIfElse"],[3,"transfer"],[3,"label",4,"ngIf"],[3,"label","value"],[3,"label"],[3,"user",4,"ngIf","ngIfElse"],["fromSystem",""],["toSystem",""],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"border-0","mt-4"],[1,"table","table-hover"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"amount"],["class","actions",4,"ngIf"],[1,"actions"],[3,"ngClass","click"],[3,"link"],[1,"text-right"],["class","actions actions-multiple",4,"ngIf"],[1,"actions","actions-multiple"],["class","btn btn-icon align-items-center",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon align-items-center",3,"tooltip","ngClass","click",4,"ngIf"],[1,"btn","btn-icon","align-items-center",3,"tooltip","click"],["icon","play_circle_outline"],[1,"btn","btn-icon","align-items-center",3,"tooltip","ngClass","click"],["icon","thumb_up"],[1,"table","table-hover","cursor-pointer"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,_c,3,7,"page-content",1),P.Pb(),P.Bc(3,To,33,38,"ng-template",null,2,P.Cc)),2&e&&(P.gc("ready",P.bc(1,2,t.data$)),P.xb(2),P.gc("ngIf",t.data))},directives:[D.a,k.t,L.a,jc,F.a,k.s,T.a,aa.a,k.q,zc.a,ta.b,Ra.a],pipes:[k.b,bc.a,M.a,te.a],encapsulation:2,changeDetection:0}),So);function No(e,t){1&e&&P.Mb(0)}function Bo(e,t){if(1&e&&P.Lb(0,"field-option",15),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n)("text",n.name)}}function Ao(e,t){if(1&e&&(P.Qb(0,"div",12),P.Qb(1,"single-selection-field",13),P.Bc(2,Bo,1,3,"field-option",14),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.period),P.xb(1),P.gc("ngForOf",n.data.preselectedPeriods)}}function Eo(e,t){if(1&e&&P.Lb(0,"field-option",18),2&e){var n=t.$implicit,a=P.Zb(3);P.gc("value",a.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function $o(e,t){if(1&e&&(P.Qb(0,"div",12),P.Qb(1,"multi-selection-field",16),P.Bc(2,Eo,1,5,"field-option",17),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.user.groupFilter),P.xb(1),P.gc("ngForOf",n.data.groups)}}function Ro(e,t){if(1&e&&P.Lb(0,"field-option",21),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function Zo(e,t){if(1&e&&(P.Qb(0,"div",12),P.Qb(1,"single-selection-field",19),P.Bc(2,Ro,1,2,"field-option",20),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.currency)("emptyOption",n.i18n.general.notApplied),P.xb(1),P.gc("ngForOf",n.data.currencies)}}function Mo(e,t){if(1&e&&P.Lb(0,"field-option",39),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function Ho(e,t){if(1&e&&P.Lb(0,"field-option",39),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function qo(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"div",22),P.Qb(2,"div",12),P.Qb(3,"single-selection-field",36),P.Bc(4,Mo,1,4,"field-option",37),P.Pb(),P.Pb(),P.Qb(5,"div",12),P.Qb(6,"single-selection-field",38),P.Bc(7,Ho,1,4,"field-option",37),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(3),P.gc("emptyOption",n.i18n.general.notApplied)("label",n.i18n.transaction.fromAccount),P.xb(1),P.gc("ngForOf",n.accountTypes()),P.xb(2),P.gc("emptyOption",n.i18n.general.notApplied)("label",n.i18n.transaction.toAccount),P.xb(1),P.gc("ngForOf",n.accountTypes())}}function Uo(e,t){if(1&e&&P.Lb(0,"field-option",42),2&e){var n=t.$implicit,a=P.Zb(4);P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)("category",a.singleAccount||null==n.accountType?null:n.accountType.name)}}function Vo(e,t){if(1&e&&(P.Qb(0,"div",12),P.Qb(1,"multi-selection-field",40),P.Bc(2,Uo,1,5,"field-option",41),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.account.transferFilter),P.xb(1),P.gc("ngForOf",n.transferFilters())}}function jo(e,t){if(1&e&&P.Lb(0,"field-option",45),2&e){var n=t.$implicit;P.gc("id",n.id)("internalName",n.internalName)("value",n.internalName)("text",n.name)}}function zo(e,t){if(1&e&&(P.Qb(0,"div",12),P.Qb(1,"multi-selection-field",43),P.Bc(2,jo,1,4,"field-option",44),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.transaction.channel),P.xb(1),P.gc("ngForOf",n.data.channels)}}function Go(e,t){if(1&e&&(P.Qb(0,"div",12),P.Lb(1,"date-field",46),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.general.beginDate)}}function _o(e,t){if(1&e&&(P.Qb(0,"div",12),P.Lb(1,"date-field",47),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.general.endDate)}}function Ko(e,t){if(1&e&&(P.Qb(0,"div",12),P.Lb(1,"input-field",48),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("mask",n.transactionNumberPattern)("label",n.i18n.transaction.number)}}function Xo(e,t){if(1&e&&(P.Ob(0),P.Bc(1,qo,8,6,"ng-container",8),P.Bc(2,Vo,3,3,"div",7),P.Bc(3,zo,3,3,"div",7),P.Lb(4,"div",22),P.Bc(5,Go,2,1,"div",7),P.ac(6,"async"),P.Bc(7,_o,2,1,"div",7),P.ac(8,"async"),P.Qb(9,"div",12),P.Lb(10,"decimal-field",23),P.Pb(),P.Qb(11,"div",12),P.Lb(12,"decimal-field",24),P.Pb(),P.Qb(13,"div",12),P.Lb(14,"user-field",25),P.Pb(),P.Bc(15,Ko,2,2,"div",7),P.Qb(16,"div",12),P.Lb(17,"user-field",26),P.Pb(),P.Qb(18,"div",12),P.Lb(19,"multi-selection-field",27),P.Pb(),P.Qb(20,"div",12),P.Qb(21,"single-selection-field",28),P.Lb(22,"field-option",29),P.Lb(23,"field-option",30),P.Pb(),P.Pb(),P.Qb(24,"div",12),P.Qb(25,"single-selection-field",31),P.Lb(26,"field-option",32),P.Lb(27,"field-option",33),P.Lb(28,"field-option",34),P.Lb(29,"field-option",35),P.Pb(),P.Pb(),P.Nb()),2&e){var n,a,i=P.Zb(2);P.xb(1),P.gc("ngIf",(null==i.data.accountTypes?null:i.data.accountTypes.length)>1),P.xb(1),P.gc("ngIf",i.transferFilters().length>0),P.xb(1),P.gc("ngIf",(null==i.data.channels?null:i.data.channels.length)>1),P.xb(2),P.gc("ngIf",null==(null==(n=i.form.value||P.bc(6,30,i.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),P.xb(2),P.gc("ngIf",null==(null==(a=i.form.value||P.bc(8,32,i.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.end)),P.xb(3),P.gc("label",i.i18n.account.minAmount)("scale",i.currencyDecimalDigits())("prefix",i.currencyPrefix())("suffix",i.currencySuffix()),P.xb(2),P.gc("label",i.i18n.account.maxAmount)("scale",i.currencyDecimalDigits())("prefix",i.currencyPrefix())("suffix",i.currencySuffix()),P.xb(2),P.gc("label",i.i18n.general.user),P.xb(1),P.gc("ngIf",i.hasTransactionNumber),P.xb(2),P.gc("label",i.i18n.general.usersOfBroker)("filters",i.userSearchFilters())("allowContacts",!1),P.xb(2),P.gc("emptyLabel",i.i18n.general.notApplied)("label",i.i18n.transaction.transferKinds)("fieldOptions",i.kindOptions),P.xb(2),P.gc("label",i.i18n.transaction.chargedBack)("emptyOption",i.i18n.general.all),P.xb(1),P.gc("text",i.i18n.general.yes),P.xb(1),P.gc("text",i.i18n.general.no),P.xb(2),P.gc("label",i.i18n.general.orderBy),P.xb(1),P.gc("text",i.i18n.account.orderBy.dateDesc),P.xb(1),P.gc("text",i.i18n.account.orderBy.dateAsc),P.xb(1),P.gc("text",i.i18n.account.orderBy.amountAsc),P.xb(1),P.gc("text",i.i18n.account.orderBy.amountDesc)}}var Yo=function(e,t){return{from:e,to:t}};function Wo(e,t){if(1&e&&(P.Qb(0,"mobile-result",49),P.Qb(1,"div",50),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("date",n.date)("amount",n.amount)("currency",n.currency),P.xb(2),P.Fc(" ",a.i18n.transaction.fromToText(P.kc(4,Yo,a.bankingHelper.ownerName(n.from),a.bankingHelper.ownerName(n.to))),"")}}function Jo(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",54),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.path(e))})),P.Qb(2,"td"),P.Qb(3,"a",55),P.Dc(4),P.ac(5,"date"),P.Pb(),P.Pb(),P.Qb(6,"td"),P.Qb(7,"a",55),P.Dc(8),P.Pb(),P.Pb(),P.Qb(9,"td"),P.Qb(10,"a",55),P.Dc(11),P.Pb(),P.Pb(),P.Qb(12,"td",52),P.Qb(13,"a",55),P.Dc(14),P.ac(15,"currency"),P.Pb(),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",P.bc(5,8,a.date)," "),P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",i.bankingHelper.ownerName(a.from)," "),P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",i.bankingHelper.ownerName(a.to)," "),P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",P.cc(15,10,i.format.abs(a.amount),a.currency)," ")}}function el(e,t){if(1&e&&(P.Qb(0,"table",51),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th",52),P.Dc(9),P.Pb(),P.Pb(),P.Qb(10,"tbody"),P.Bc(11,Jo,16,13,"ng-container",53),P.ac(12,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.general.date),P.xb(2),P.Ec(a.i18n.transaction.from),P.xb(2),P.Ec(a.i18n.transaction.to),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(12,5,a.results$))?null:n.results)}}function tl(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",4),P.ac(1,"async"),P.Qb(2,"form",5),P.Qb(3,"div",6),P.Bc(4,Ao,3,2,"div",7),P.Bc(5,$o,3,3,"div",7),P.Bc(6,Zo,3,3,"div",7),P.Bc(7,Xo,30,34,"ng-container",8),P.ac(8,"async"),P.Pb(),P.Pb(),P.Pb(),P.Qb(9,"results-layout",9),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(10,"async"),P.Bc(11,Wo,3,7,"mobile-result",10),P.Bc(12,el,13,7,"table",11),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.transaction.title.transfersOverview)("mobileHeading",a.i18n.transaction.mobileTitle.transfersOverview)("headingActions",P.bc(1,11,a.headingActions$)),P.xb(2),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",(null==a.data.preselectedPeriods?null:a.data.preselectedPeriods.length)>1),P.xb(1),P.gc("ngIf",(null==a.data.groups?null:a.data.groups.length)>1),P.xb(1),P.gc("ngIf",(null==a.data.currencies?null:a.data.currencies.length)>1),P.xb(1),P.gc("ngIf",P.bc(8,13,a.moreFilters$)),P.xb(2),P.gc("results",P.bc(10,15,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}function nl(e,t){1&e&&P.Lb(0,"spinner",56)}var al,il=((al=function(e){s(a,e);var t=b(a);function a(e,n,i){var r;return c(this,a),(r=t.call(this,e)).transfersService=n,r.bankingHelper=i,r.filters$=new v.a([]),r}return l(a,[{key:"getFormControlNames",value:function(){return["preselectedPeriod","periodBegin","periodEnd","groups","currency","channels","fromAccountType","toAccountType","transferFilters","kinds","chargedBack","minAmount","maxAmount","transactionNumber","user","by","orderBy","brokers"]}},{key:"getInitialFormValue",value:function(e){var t=r(d(a.prototype),"getInitialFormValue",this).call(this,e);return t.orderBy=t.orderBy||u.wb.DATE_DESC,t}},{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this),this.stateManager.cache("data",this.transfersService.getTransferDataForSearch()).subscribe((function(t){e.data=t}))}},{key:"onDataInitialized",value:function(e){var t=this;r(d(a.prototype),"onDataInitialized",this).call(this,e),this.singleCurrency=1===(e.currencies||[]).length?e.currencies[0]:null,this.singleAccount=1===(e.accountTypes||[]).length?e.accountTypes[0]:null;var i=(e.currencies||[]).map((function(e){return e.transactionNumberPattern})).filter((function(e){return e})).reduce((function(e,t){return e.includes(t)?e:[].concat(n(e),[t])}),[]);this.hasTransactionNumber=i.length>0,this.transactionNumberPattern=1===i.length?i[0]:null,this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.form.controls.fromAccountType.valueChanges.subscribe((function(e){return t.updateTransferFilters(e)}))),this.addSub(this.form.controls.currency.valueChanges.subscribe((function(e){return t.updateAccountTypes(e)}))),this.headingActions=[this.moreFiltersAction],this.exportHelper.headingActions(e.exportFormats,(function(e){return t.transfersService.exportTransfers$Response(Object.assign({format:e.internalName},t.toSearchParams(t.form.value)))})).forEach((function(e){return t.headingActions.push(e)}))}},{key:"updateTransferFilters",value:function(e){var t=this,n=this.form.controls.transferFilters.value;e&&n&&this.form.controls.transferFilters.setValue(n.filter((function(n){return t.data.transferFilters.find((function(e){return e.id===n})).accountType.id===e})))}},{key:"updateAccountTypes",value:function(e){var t=this.form.controls.fromAccountType.value,n=this.form.controls.toAccountType.value;if(e&&t){var a=this.data.accountTypes.find((function(e){return e.id===t})).currency;this.form.controls.fromAccountType.setValue(a&&a.id!==e?null:t)}if(e&&n){var i=this.data.accountTypes.find((function(e){return e.id===n})).currency;this.form.controls.toAccountType.setValue(i&&i.id!==e?null:n)}}},{key:"userSearchFilters",value:function(){return{roles:[u.kb.BROKER]}}},{key:"findCurrency",value:function(e){var t;if(this.singleCurrency)return this.singleCurrency;var n=this.form.controls.currency.value;if(n)return this.data.currencies.find((function(e){return e.id===n}));var a=this.form.controls.fromAccountType.value;return e&&a?null===(t=this.data.accountTypes.find((function(e){return e.id===a})))||void 0===t?void 0:t.currency:null}},{key:"transferFilters",value:function(){var e=this.form.controls.fromAccountType.value,t=this.data.transferFilters||[];if(e)return t.filter((function(t){return t.accountType.id===e}));if(this.findCurrency(!0)){var n=this.accountTypes().map((function(e){return e.id}));return t.filter((function(e){return n.includes(e.accountType.id)}))}return t}},{key:"accountTypes",value:function(){var e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter((function(t){return!t.currency||t.currency.id===e.id})):t}},{key:"currencyDecimalDigits",value:function(){var e=this.findCurrency(!0);return e?e.decimalDigits:2}},{key:"currencyPrefix",value:function(){var e=this.findCurrency(!0);return e?e.prefix:null}},{key:"currencySuffix",value:function(){var e=this.findCurrency(!0);return e?e.suffix:null}},{key:"toSearchParams",value:function(e){var t=e;return t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=g.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],e.chargedBack&&(t.chargedBack="yes"===e.chargedBack),t}},{key:"doSearch",value:function(e){return this.transfersService.searchTransfers$Response(e)}},{key:"path",value:function(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.moreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.lessFilters}},{key:"resolveMenu",value:function(){return this.dataForUiHolder.role===u.kb.ADMINISTRATOR?y.b.ADMIN_TRANSFERS_OVERVIEW:y.b.BROKER_TRANSFERS_OVERVIEW}},{key:"preselectedPeriods",get:function(){return null==this.data?null:this.data.preselectedPeriods}},{key:"kindOptions",get:function(){var e=this;return Object.values(u.Bb).map((function(t){return{value:t,text:e.apiI18n.transferKind(t)}}))}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),a}(p.a)).\u0275fac=function(e){return new(e||al)(P.Kb(P.r),P.Kb(xc.a),P.Kb(m.a))},al.\u0275cmp=P.Eb({type:al,selectors:[["search-transfers-overview"]],features:[P.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","brokers",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","kinds",3,"emptyLabel","label","fieldOptions"],["labelPosition","side","formControlName","chargedBack",3,"label","emptyOption"],["value","yes",3,"text"],["value","no",3,"text"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["labelPosition","side","formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","transferFilters",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["labelPosition","side","formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["forceSign","",3,"date","amount","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,No,1,0,"ng-container",1),P.Pb(),P.Bc(3,tl,13,17,"ng-template",null,2,P.Cc),P.Bc(5,nl,1,0,"ng-template",null,3,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,w.a,C.a,Q.a,S.a,I.v,I.l,k.s,O.a,N.a,A.a,$.a,B.a,E.a,R.a,W.a,ee.h,Y.a],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),al);function rl(e,t){if(1&e&&(P.Qb(0,"page-content",2),P.ac(1,"async"),P.Lb(2,"transfer-details",3),P.ac(3,"async"),P.Pb()),2&e){var n=P.Zb();P.gc("heading",n.i18n.transaction.title.detailsTransfer)("mobileHeading",n.i18n.transaction.mobileTitle.detailsTransfer)("headingActions",P.bc(1,5,n.headingActions$)),P.xb(2),P.gc("headingActions",P.bc(3,7,n.headingActions$))("transfer",n.transfer)}}var cl,ol=((cl=function(e){s(a,e);var n=b(a);function a(e,t,i,r){var o;return c(this,a),(o=n.call(this,e)).bankingHelper=t,o.transfersService=i,o.operationHelper=r,o}return l(a,[{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot;this.accountId=t.params.account,this.addSub(this.transfersService.viewTransfer({key:t.params.key}).subscribe((function(t){e.headingActions=e.initActions(t),e.data=t})))}},{key:"initActions",value:function(e){var n=this,a=this.exportHelper.headingActions(e.exportFormats,(function(t){return n.transfersService.exportTransfer$Response({format:t.internalName,key:e.id})})),i=e.transaction||{};Object(h.h)(i.authorizations)||a.push(new Yt.c("check_circle_outline",this.i18n.transaction.viewAuthorizations,(function(){n.router.navigate(["banking","transaction",n.bankingHelper.transactionNumberOrId(i),"authorization-history"])}))),e.canChargeback&&a.push(new Yt.c("undo",this.i18n.transaction.chargebackTransfer,(function(){n.chargeback()})));var r,c=t(e.operations||[]);try{for(c.s();!(r=c.n()).done;){var o=r.value;a.push(this.operationHelper.headingAction(o,e.id))}}catch(l){c.e(l)}finally{c.f()}return a}},{key:"chargebackDeviceConfirmation",value:function(){var e=this;return function(){return{type:u.s.CHARGEBACK,transfer:e.transfer.id}}}},{key:"chargeback",value:function(){var e=this;this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transfer.confirmationPasswordInput,callback:function(t){e.addSub(e.transfersService.chargebackTransfer({key:e.transfer.id,confirmationPassword:t.confirmationPassword}).subscribe((function(){e.notification.snackBar(e.i18n.transaction.chargebackTransferDone),e.reload()})))}})}},{key:"resolveMenu",value:function(e){return this.menu.transferMenu(e,this.accountId)}},{key:"transfer",get:function(){return this.data}}]),a}(uc.a)).\u0275fac=function(e){return new(e||cl)(P.Kb(P.r),P.Kb(m.a),P.Kb(xc.a),P.Kb(Lc.a))},cl.\u0275cmp=P.Eb({type:cl,selectors:[["view-transfer"]],features:[P.ub],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"headingActions","transfer"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,rl,4,9,"page-content",1),P.Pb()),2&e&&(P.gc("ready",P.bc(1,2,t.data$)),P.xb(2),P.gc("ngIf",t.data))},directives:[D.a,k.t,L.a,jc],pipes:[k.b],encapsulation:2,changeDetection:0}),cl),ll=o("xVDN");function sl(e,t){if(1&e&&P.Lb(0,"user-info",5),2&e){var n=P.Zb();P.gc("user",n.user)}}function ul(e,t){if(1&e&&(P.Qb(0,"mobile-result",6),P.Qb(1,"div",7),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit;P.gc("avatarImage",n.image),P.xb(2),P.Fc(" ",n.voucherTitle," ")}}function bl(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",10),P.Xb("click",(function(){P.sc(n);var e=t.$implicit;return P.Zb(2).selectType(e)})),P.Qb(2,"td",11),P.Lb(3,"avatar",12),P.Pb(),P.Qb(4,"td"),P.Qb(5,"div"),P.Qb(6,"a",13),P.Xb("click",(function(){P.sc(n);var e=t.$implicit;return P.Zb(2).selectType(e)})),P.Dc(7),P.Pb(),P.Qb(8,"div"),P.Dc(9),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit;P.xb(3),P.gc("image",a.image),P.xb(4),P.Fc(" ",a.voucherTitle," "),P.xb(2),P.Fc(" ",a.voucherDescription," ")}}function fl(e,t){if(1&e&&(P.Qb(0,"table",8),P.Qb(1,"tbody"),P.Bc(2,bl,10,3,"ng-container",9),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.xb(2),P.gc("ngForOf",n.types)}}var dl,ml=((dl=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).typeSelected=new P.n,a}return l(n,[{key:"selectType",get:function(){var e=this;return function(t){return e.typeSelected.emit(t)}}}]),n}(Z.a)).\u0275fac=function(e){return new(e||dl)(P.Kb(P.r))},dl.\u0275cmp=P.Eb({type:dl,selectors:[["buy-vouchers-step-list-types"]],inputs:{types:"types",user:"user"},outputs:{typeSelected:"typeSelected"},features:[P.ub],decls:5,vars:6,consts:[[3,"mode","heading","mobileHeading"],["labelCols","2",3,"user",4,"ngIf"],["resultType","list",3,"results","onClick"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelCols","2",3,"user"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar"],["icon","shopping_cart","size","xlarge","roundBorders","false",3,"image"],["ngClass","font-weight-bold",3,"click"]],template:function(e,t){1&e&&(P.Qb(0,"page-content",0),P.Bc(1,sl,1,1,"user-info",1),P.Pb(),P.Qb(2,"results-layout",2),P.Bc(3,ul,3,2,"mobile-result",3),P.Bc(4,fl,3,1,"table",4),P.Pb()),2&e&&(P.gc("mode",t.user&&!t.authHelper.isSelf(t.user)?"normal":"empty")("heading",t.i18n.voucher.title.buy)("mobileHeading",t.i18n.voucher.mobileTitle.buy),P.xb(1),P.gc("ngIf",t.user&&!t.authHelper.isSelf(t.user)),P.xb(1),P.gc("results",t.types)("onClick",t.selectType))},directives:[L.a,k.t,w.a,C.a,Q.a,St.a,W.a,k.s,J.a,k.q],encapsulation:2,changeDetection:0}),dl);function gl(e,t){if(1&e&&P.Lb(0,"user-info",8),2&e){var n=P.Zb();P.gc("user",n.data.user)}}function pl(e,t){if(1&e&&(P.Qb(0,"label-value",2),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.voucher.buy.minTimeToRedeem),P.xb(1),P.Fc(" ",n.i18n.voucher.buy.minTimeToRedeemAfterBuy(n.format.formatTimeInterval(n.data.minimumTimeToRedeem))," ")}}var hl=function(e,t){return{min:e,max:t}};function yl(e,t){if(1&e&&(P.Lb(0,"label-value",9),P.ac(1,"currency"),P.ac(2,"currency")),2&e){var n=P.Zb();P.gc("label",n.i18n.voucher.buy.amountRange)("value",n.format.formatRange(P.kc(8,hl,P.cc(1,2,n.data.amountRange.min,n.currency),P.cc(2,5,n.data.amountRange.max,n.currency))))}}function vl(e,t){if(1&e&&P.Lb(0,"custom-field-input",10),2&e){var n=t.$implicit,a=P.Zb();P.gc("field",n)("formControl",a.customFieldControlsMap.get(n.internalName))}}var xl,Pl=((xl=function(e){s(n,e);var t=b(n);function n(e){return c(this,n),t.call(this,e)}return l(n,[{key:"currency",get:function(){return this.data.account.currency}}]),n}(Z.a)).\u0275fac=function(e){return new(e||xl)(P.Kb(P.r))},xl.\u0275cmp=P.Eb({type:xl,selectors:[["buy-vouchers-step-form"]],inputs:{data:"data",form:"form",customFieldControlsMap:"customFieldControlsMap"},features:[P.ub],decls:12,vars:17,consts:[[3,"formGroup"],[3,"user",4,"ngIf"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["kind","fieldView",3,"label","value",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],[3,"user"],["kind","fieldView",3,"label","value"],[3,"field","formControl"]],template:function(e,t){1&e&&(P.Ob(0,0),P.Bc(1,gl,1,1,"user-info",1),P.Qb(2,"label-value",2),P.Dc(3),P.Pb(),P.Qb(4,"label-value",2),P.Dc(5),P.ac(6,"currency"),P.Pb(),P.Bc(7,pl,2,2,"label-value",3),P.Lb(8,"input-field",4),P.Lb(9,"decimal-field",5),P.Bc(10,yl,3,11,"label-value",6),P.Bc(11,vl,1,2,"custom-field-input",7),P.Nb()),2&e&&(P.gc("formGroup",t.form),P.xb(1),P.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),P.xb(1),P.gc("label",t.i18n.voucher.originAccount),P.xb(1),P.Fc(" ",t.data.account.type.name," "),P.xb(1),P.gc("label",t.i18n.account.availableBalance),P.xb(1),P.Fc(" ",P.cc(6,14,t.data.account.status.availableBalance,t.currency)," "),P.xb(2),P.gc("ngIf",t.data.minimumTimeToRedeem),P.xb(1),P.gc("label",t.i18n.voucher.numberOfVouchers),P.xb(1),P.gc("label",t.i18n.voucher.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),P.xb(1),P.gc("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)||(null==t.data.amountRange?null:t.data.amountRange.max)),P.xb(1),P.gc("ngForOf",t.data.customFields))},directives:[I.w,I.n,k.t,F.a,E.a,I.v,I.l,I.D,A.a,k.s,St.a,Ya.a,I.k],pipes:[M.a],encapsulation:2,changeDetection:0}),xl),Dl=o("5Wk5");function kl(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"user-info",3),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("user",n.data.user)}}function Ll(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"label-value",4),P.ac(2,"async"),P.Lb(3,"format-field-value",5,6),P.Pb(),P.Nb()),2&e){var n=t.$implicit,a=P.qc(4),i=P.Zb();P.xb(1),P.gc("hidden",!a.hasValue)("label",n.name)("labelPosition",i.labelOnTop(P.bc(2,6,i.layout.ltsm$),n)?"top":"auto"),P.xb(2),P.gc("object",i.buyVoucher)("fields",i.data.customFields)("fieldName",n.internalName)}}function wl(e,t){1&e&&P.Lb(0,"hr")}function Cl(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Bc(1,wl,1,0,"hr",0),P.ac(2,"async"),P.Qb(3,"form",7),P.Qb(4,"confirmation-password",8),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationModeChanged.emit(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().confirmed.emit(e)})),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=P.Zb();P.xb(1),P.gc("ngIf",P.bc(2,4,a.layout.gtxxs$)),P.xb(2),P.gc("formGroup",a.form),P.xb(1),P.gc("passwordInput",a.confirmationPasswordInput)("createDeviceConfirmation",a.createDeviceConfirmation)}}var Ql,Il=((Ql=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).confirmationModeChanged=new P.n,a.confirmed=new P.n,a}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=function(){return{type:u.s.BUY_VOUCHERS,amount:e.buyVoucher.amount,voucherType:e.data.type.id,numberOfVouchers:e.buyVoucher.count}},this.confirmationPasswordInput||this.addShortcut(ea.k,(function(){return e.confirmed.emit()}))}},{key:"labelOnTop",value:function(e,t){return!!e&&[u.p.RICH_TEXT,u.p.TEXT].includes(t?t.type:null)}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Ql)(P.Kb(P.r))},Ql.\u0275cmp=P.Eb({type:Ql,selectors:[["buy-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",buyVoucher:"buyVoucher",data:"data"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[P.ub],decls:10,vars:12,consts:[[4,"ngIf"],[3,"label"],[4,"ngFor","ngForOf"],[3,"user"],[3,"hidden","label","labelPosition"],[3,"object","fields","fieldName"],["formatFieldValue",""],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(P.Bc(0,kl,2,1,"ng-container",0),P.Qb(1,"label-value",1),P.Dc(2),P.Pb(),P.Qb(3,"label-value",1),P.Dc(4),P.Pb(),P.Qb(5,"label-value",1),P.Dc(6),P.ac(7,"currency"),P.Pb(),P.Bc(8,Ll,5,8,"ng-container",2),P.Bc(9,Cl,5,6,"ng-container",0)),2&e&&(P.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),P.xb(1),P.gc("label",t.i18n.general.type),P.xb(1),P.Fc(" ",t.data.type.voucherTitle,"\n"),P.xb(1),P.gc("label",t.i18n.voucher.numberOfVouchers),P.xb(1),P.Fc(" ",t.buyVoucher.count,"\n"),P.xb(1),P.gc("label",t.i18n.voucher.amountPerVoucher),P.xb(1),P.Fc(" ",P.cc(7,9,t.buyVoucher.amount,t.data.account.currency),"\n"),P.xb(2),P.gc("ngForOf",t.data.customFields),P.xb(1),P.gc("ngIf",t.confirmationPasswordInput))},directives:[k.t,F.a,k.s,St.a,Dl.a,I.I,I.w,I.n,ia.a,ra.a,I.v,I.l],pipes:[M.a,k.b],encapsulation:2,changeDetection:0}),Ql);function Fl(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"buy-vouchers-step-list-types",4),P.Xb("typeSelected",(function(e){return P.sc(n),P.Zb().toForm(e)})),P.Pb(),P.Nb()}if(2&e){var a=P.Zb();P.xb(1),P.gc("user",a.data.user)("types",a.data.types)}}function Tl(e,t){if(1&e){var n=P.Rb();P.Qb(0,"action-button",10),P.Xb("action",(function(){return P.sc(n),P.Zb(2).backToSelectType()})),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("label",a.i18n.general.previous)}}function Sl(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",5),P.ac(1,"async"),P.Lb(2,"buy-vouchers-step-form",6),P.Qb(3,"actions",7),P.Qb(4,"action-button",8),P.Xb("action",(function(){return P.sc(n),P.Zb().toConfirm()})),P.ac(5,"async"),P.Pb(),P.Bc(6,Tl,1,1,"action-button",9),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.dataTypeForBuy.type.voucherTitle)("mobileHeading",a.dataTypeForBuy.type.voucherTitle)("mode",P.bc(1,9,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("data",a.dataTypeForBuy)("form",a.form)("customFieldControlsMap",a.customFieldControlsMap),P.xb(2),P.gc("disabled",P.bc(5,11,a.requesting$))("label",a.i18n.general.next),P.xb(2),P.gc("ngIf",!a.singleType)}}function Ol(e,t){if(1&e){var n=P.Rb();P.Qb(0,"action-button",8),P.Xb("action",(function(){return P.sc(n),P.Zb(2).buy()})),P.ac(1,"async"),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("disabled",!a.canConfirm||P.bc(1,2,a.requesting$))("label",a.i18n.general.confirm)}}function Nl(e,t){1&e&&P.Dc(0,"\xa0")}function Bl(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",5),P.ac(1,"async"),P.Qb(2,"buy-vouchers-step-confirm",11),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationMode$.next(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().buy(e)})),P.Pb(),P.Qb(3,"actions",7),P.Bc(4,Ol,2,4,"action-button",12),P.ac(5,"async"),P.Bc(6,Nl,1,0,"ng-template",null,13,P.Cc),P.Qb(8,"action-button",10),P.Xb("action",(function(){return P.sc(n),P.Zb().backToForm()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.qc(7),i=P.Zb();P.gc("heading",i.i18n.voucher.title.buyConfirmation)("mobileHeading",i.i18n.voucher.mobileTitle.buyConfirmation)("mode",P.bc(1,10,i.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("buyVoucher",i.form.value)("data",i.dataTypeForBuy)("confirmationPasswordInput",i.dataTypeForBuy.confirmationPasswordInput)("confirmationPassword",i.confirmationPassword),P.xb(2),P.gc("ngIf",P.bc(5,12,i.confirmationMode$)!=i.ConfirmationMode.Device)("ngIfElse",a),P.xb(4),P.gc("label",i.i18n.general.previous)}}function Al(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var El,$l=((El=function(e){s(a,e);var n=b(a);function a(e,t){var i;return c(this,a),(i=n.call(this,e)).voucherService=t,i.ConfirmationMode=Rn.a,i.step$=new v.a(null),i.singleType=!1,i.confirmationMode$=new v.a(null),i}return l(a,[{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot.params;this.user=this.authHelper.isSelf(t.user)?this.ApiHelper.SELF:t.user,this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=e.types||[];1===t.length?(this.singleType=!0,this.toForm(t[0])):this.step="select-type"}},{key:"buy",value:function(e){var t=this;if(e&&this.confirmationPassword.setValue(e),!this.confirmationPasswordInput||Object(h.F)(this.confirmationPassword)){var n=this.form.value;n.type=this.dataTypeForBuy.type.id,this.addSub(this.voucherService.buyVouchers({user:this.user,confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:n}).subscribe((function(e){t.router.navigate(1===e.length?["banking","vouchers","view",e[0]]:["banking",t.user,"vouchers","bought"]),t.notification.snackBar(t.i18n.voucher.buy.done)})))}}},{key:"backToSelectType",value:function(){this.step="select-type"}},{key:"backToForm",value:function(){this.step="form"}},{key:"toForm",value:function(e){var t=this;this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user,type:e.id}).subscribe((function(e){t.dataTypeForBuy=e,t.buildForm(),t.step="form"})))}},{key:"toConfirm",value:function(){Object(h.F)(this.form)&&(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),this.canConfirm?(this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(I.G.required))),this.step="confirm"):this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput)))}},{key:"buildForm",value:function(){if(this.form)this.form.reset();else if(this.customFieldControlsMap=this.fieldHelper.customValuesFormControlMap(this.dataTypeForBuy.customFields),this.form=this.formBuilder.group({count:new I.j(""),amount:new I.j("")}),this.customFieldControlsMap.size>0){var e,n=new I.m({}),a=t(this.customFieldControlsMap);try{for(a.s();!(e=a.n()).done;){var i=e.value;n.addControl(i[0],i[1])}}catch(r){a.e(r)}finally{a.f()}this.form.setControl("customValues",n)}this.form.get("count").setValue(1)}},{key:"resolveMenu",value:function(e){return this.menu.userMenu(e.user,y.b.BUY_VOUCHER)}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}},{key:"currency",get:function(){return this.dataTypeForBuy.account.currency}},{key:"confirmationPasswordInput",get:function(){return this.dataTypeForBuy.confirmationPasswordInput}}]),a}(kt.a)).\u0275fac=function(e){return new(e||El)(P.Kb(P.r),P.Kb(ll.a))},El.\u0275cmp=P.Eb({type:El,selectors:[["buy-vouchers"]],features:[P.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"user","types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form","customFieldControlsMap"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"buyVoucher","data","confirmationPasswordInput","confirmationPassword","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Fl,2,2,"ng-container",1),P.Bc(4,Sl,7,13,"page-content",2),P.Bc(5,Bl,9,14,"page-content",2),P.Bc(6,Al,2,0,"page-content",3),P.Pb()),2&e&&(P.gc("ready",P.bc(1,5,t.data$))("ngSwitch",P.bc(2,7,t.step$)),P.xb(3),P.gc("ngSwitchCase","select-type"),P.xb(1),P.gc("ngSwitchCase","form"),P.xb(1),P.gc("ngSwitchCase","confirm"))},directives:[D.a,k.x,k.y,k.z,ml,L.a,Pl,wt.a,Ct.a,k.t,Il,Y.a],pipes:[k.b],encapsulation:2,changeDetection:0}),El),Rl=o("5pUo"),Zl=o("LqlI"),Ml=o("pBnU"),Hl=["inputField"];function ql(e,t){if(1&e){var n=P.Rb();P.Qb(0,"button",14,15),P.Xb("click",(function(){return P.sc(n),P.Zb(3).showScanQrCode()})),P.Lb(2,"icon",16),P.Pb()}if(2&e){var a=P.Zb(3);P.gc("tooltip",a.i18n.field.user.scanQrCodeTooltip)}}function Ul(e,t){if(1&e){var n=P.Rb();P.Qb(0,"div"),P.Mb(1,6),P.Qb(2,"div",7),P.Qb(3,"div",8),P.Qb(4,"label-value",9),P.Lb(5,"input-field",10,11),P.Bc(7,ql,3,1,"button",12),P.Pb(),P.Pb(),P.Pb(),P.Qb(8,"actions"),P.Qb(9,"action-button",13),P.Xb("action",(function(){return P.sc(n),P.Zb(2).submit()})),P.ac(10,"async"),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.Zb(2),i=P.qc(6);P.xb(1),P.gc("ngTemplateOutlet",i),P.xb(3),P.gc("label",a.i18n.voucher.token),P.xb(1),P.gc("mask",a.mask)("formControl",a.token)("placeholder",a.mask),P.xb(4),P.gc("disabled",P.bc(10,7,a.requesting$))("label",a.i18n.general.submit)}}function Vl(e,t){if(1&e&&(P.Qb(0,"page-content",4),P.ac(1,"async"),P.Bc(2,Ul,11,9,"div",5),P.ac(3,"async"),P.Pb()),2&e){var n=P.Zb(),a=P.qc(8);P.gc("heading",n.i18n.voucher.title.redeem)("mobileHeading",n.i18n.voucher.mobileTitle.redeem)("mode",P.bc(1,5,n.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("ngIf",P.bc(3,7,n.data$))("ngIfElse",a)}}var jl=function(e){return{"flex-grow-1":e}};function zl(e,t){if(1&e&&(P.Qb(0,"div",27),P.Lb(1,"avatar",28),P.Pb()),2&e){var n=P.Zb(3);P.gc("ngClass",P.jc(2,jl,!n.dataForRedeem.type.voucherDescription)),P.xb(1),P.gc("image",n.dataForRedeem.type.image)}}function Gl(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",29),P.Dc(2),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(2),P.Fc("",n.dataForRedeem.type.voucherDescription," ")}}function _l(e,t){if(1&e&&(P.Qb(0,"label-value",23),P.Lb(1,"user-link",30),P.Pb()),2&e){var n=P.Zb(3);P.gc("label",n.i18n.voucher.buy.buyer),P.xb(1),P.gc("user",n.dataForRedeem.buyer)}}function Kl(e,t){if(1&e&&P.Lb(0,"custom-field-input",31),2&e){var n=t.$implicit,a=P.Zb(3);P.gc("field",n)("formControl",a.form.get(n.internalName))}}var Xl=function(e){return{"d-flex flex-row-reverse justify-content-between":e}};function Yl(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Mb(1,6),P.Qb(2,"notification",17),P.Dc(3),P.Pb(),P.Qb(4,"div",18),P.Qb(5,"div",19),P.ac(6,"async"),P.Bc(7,zl,2,4,"div",20),P.Bc(8,Gl,3,1,"ng-container",21),P.Pb(),P.Lb(9,"hr",22),P.Qb(10,"label-value",23),P.Dc(11),P.Pb(),P.Qb(12,"label-value",23),P.Dc(13),P.Pb(),P.Bc(14,_l,2,2,"label-value",24),P.Qb(15,"label-value",23),P.Dc(16),P.ac(17,"currency"),P.Pb(),P.Bc(18,Kl,1,2,"custom-field-input",25),P.Pb(),P.Qb(19,"actions"),P.Qb(20,"action-button",13),P.Xb("action",(function(){return P.sc(n),P.Zb(2).submit()})),P.ac(21,"async"),P.Pb(),P.Qb(22,"action-button",26),P.Xb("action",(function(){return P.sc(n),P.Zb(2).backToForm()})),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=P.Zb(2),i=P.qc(6);P.xb(1),P.gc("ngTemplateOutlet",i),P.xb(2),P.Fc(" ",a.i18n.voucher.redeem.confirm," "),P.xb(2),P.gc("ngClass",P.jc(23,Xl,P.bc(6,16,a.layout.gtsm$)&&a.dataForRedeem.type.image)),P.xb(2),P.gc("ngIf",a.dataForRedeem.type.image),P.xb(1),P.gc("ngIf",a.dataForRedeem.type.voucherDescription),P.xb(2),P.gc("label",a.i18n.general.type),P.xb(1),P.Fc(" ",a.dataForRedeem.type.name," "),P.xb(1),P.gc("label",a.i18n.voucher.token),P.xb(1),P.Fc(" ",a.dataForRedeem.token," "),P.xb(1),P.gc("ngIf",a.dataForRedeem.buyer),P.xb(1),P.gc("label",a.i18n.transaction.amount),P.xb(1),P.Fc(" ",P.cc(17,18,a.dataForRedeem.amount,a.dataForRedeem.type.configuration.currency)," "),P.xb(2),P.gc("ngForOf",a.dataForRedeem.customFields),P.xb(2),P.gc("disabled",P.bc(21,21,a.requesting$))("label",a.i18n.general.submit),P.xb(2),P.gc("label",a.i18n.general.previous)}}function Wl(e,t){if(1&e&&(P.Qb(0,"page-content",4),P.ac(1,"async"),P.Bc(2,Yl,23,25,"ng-container",5),P.ac(3,"async"),P.Pb()),2&e){var n=P.Zb(),a=P.qc(8);P.gc("heading",n.i18n.voucher.title.redeem)("mobileHeading",n.i18n.voucher.mobileTitle.redeem)("mode",P.bc(1,5,n.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("ngIf",P.bc(3,7,n.dataForRedeem$))("ngIfElse",a)}}function Jl(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"user-info",30),P.Lb(2,"hr"),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("user",n.data.user)}}function es(e,t){if(1&e&&P.Bc(0,Jl,3,1,"ng-container",21),2&e){var n=P.Zb();P.gc("ngIf",!n.self)}}function ts(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var ns,as=((ns=function(e){s(n,e);var t=b(n);function n(e,a,i){var r;return c(this,n),(r=t.call(this,e)).voucherService=a,r.modal=i,r.step$=new v.a(null),r.token=new I.j("",I.G.required),r.mask="",r.dataForRedeem$=new v.a(null),r}return l(n,[{key:"submit",value:function(){var e=this;if("form"===this.step){if(!Object(h.F)(this.token))return;this.addSub(this.voucherService.getVoucherDataForRedeem({user:this.userId,token:this.token.value}).subscribe((function(t){e.dataForRedeem=t,e.form=e.fieldHelper.customValuesFormGroup(e.dataForRedeem.customFields),e.step="confirm"})))}else this.addSub(this.voucherService.redeemVoucher({user:this.userId,token:this.token.value,body:{customValues:this.form.value}}).subscribe((function(t){e.router.navigate(["banking","vouchers","view",t.voucherId]),e.notification.info(e.i18n.voucher.redeem.done)})))}},{key:"backToForm",value:function(){this.step="form"}},{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.userId=this.route.snapshot.paramMap.get("user"),this.addSub(this.voucherService.getVoucherInitialDataForRedeem({user:this.userId}).subscribe((function(t){e.data=t,e.mask=e.data.mask?e.data.mask:"",e.self=e.authHelper.isSelf(t.user)}))),this.step="form"}},{key:"reload",value:function(){this.step="form",r(d(n.prototype),"reload",this).call(this)}},{key:"resolveMenu",value:function(e){return this.menu.userMenu(e.user,y.b.REDEEM_VOUCHER)}},{key:"showScanQrCode",value:function(){var e=this;this.modal.show(Rl.a,{class:"modal-form"}).content.select.pipe(Object(Mn.a)()).subscribe((function(t){e.token.setValue(t),e.submit()})),this.modal.onHide.pipe(Object(Mn.a)()).subscribe((function(){return Object(h.j)(e.inputField,!0)}))}},{key:"dataForRedeem",get:function(){return this.dataForRedeem$.value},set:function(e){this.dataForRedeem$.next(e)}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}}]),n}(kt.a)).\u0275fac=function(e){return new(e||ns)(P.Kb(P.r),P.Kb(ll.a),P.Kb(Zl.b))},ns.\u0275cmp=P.Eb({type:ns,selectors:[["app-redeem-voucher"]],viewQuery:function(e,t){var n;1&e&&P.Hc(Hl,!0),2&e&&P.pc(n=P.Yb())&&(t.inputField=n.first)},features:[P.ub],decls:9,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["active_user",""],["loading",""],[3,"heading","mobileHeading","mode"],[4,"ngIf","ngIfElse"],[3,"ngTemplateOutlet"],[1,"d-flex","flex-grow-1"],[1,"flex-grow-1"],["kind","field",3,"label"],["type","text","focused","","required","",3,"mask","formControl","placeholder"],["inputField",""],["class","btn btn-icon",3,"tooltip","click",4,"extraCell"],[3,"disabled","label","action"],[1,"btn","btn-icon",3,"tooltip","click"],["scanQrCodeButton",""],["icon","scan_qr_code"],["ngClass","mb-3","type","warning"],[1,"d-flex","flex-grow-1","flex-column"],[3,"ngClass"],["class","image d-flex justify-content-center mt-2 mb-4",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"mt-3"],[3,"label"],[3,"label",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],["outline","",3,"label","action"],[1,"image","d-flex","justify-content-center","mt-2","mb-4",3,"ngClass"],["size","160","imageSize","200","useLightbox","",3,"image"],[1,"break-nl"],[3,"user"],[3,"field","formControl"]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Vl,4,9,"page-content",1),P.Bc(4,Wl,4,9,"page-content",1),P.Pb(),P.Bc(5,es,1,1,"ng-template",null,2,P.Cc),P.Bc(7,ts,2,0,"ng-template",null,3,P.Cc)),2&e&&(P.gc("ready",P.bc(1,4,t.data$))("ngSwitch",P.bc(2,6,t.step$)),P.xb(3),P.gc("ngSwitchCase","form"),P.xb(1),P.gc("ngSwitchCase","confirm"))},directives:[D.a,k.x,k.y,L.a,k.t,k.A,F.a,E.a,ra.a,I.D,R.a,I.v,I.k,Ml.a,wt.a,Ct.a,ta.b,Ra.a,na.a,k.q,k.s,J.a,T.a,Ya.a,St.a,Y.a],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),ns);function is(e,t){1&e&&P.Mb(0)}function rs(e,t){1&e&&P.Lb(0,"div",7)}function cs(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",7),P.Qb(2,"label-value",14),P.Lb(3,"user-link",15),P.Pb(),P.Pb(),P.Bc(4,rs,1,0,"div",16),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("ngIf",n.layout.gtsm$)}}function os(e,t){if(1&e&&P.Lb(0,"field-option",17),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function ls(e,t){if(1&e&&(P.Qb(0,"mobile-result",18),P.Qb(1,"div",19),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit;P.gc("date",n.creationDate)("amount",n.amount)("amountColor",!1)("currency",n.type.configuration.currency),P.xb(2),P.Fc(" ",n.type.name," ")}}function ss(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",23),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.path(e))})),P.Qb(2,"td"),P.Qb(3,"a",24),P.Dc(4),P.ac(5,"date"),P.Pb(),P.Pb(),P.Qb(6,"td"),P.Qb(7,"a",24),P.Dc(8),P.ac(9,"date"),P.Pb(),P.Pb(),P.Qb(10,"td"),P.Qb(11,"a",24),P.Dc(12),P.Pb(),P.Pb(),P.Qb(13,"td"),P.Qb(14,"a",24),P.Dc(15),P.Pb(),P.Pb(),P.Qb(16,"td",21),P.Qb(17,"a",24),P.Dc(18),P.ac(19,"currency"),P.Pb(),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.Ec(P.bc(5,10,a.creationDate)),P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.Ec(P.bc(9,12,a.expirationDate)),P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.Ec(i.voucherStatus(a.status)),P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.Ec(a.type.name),P.xb(2),P.gc("routerLink",i.path(a)),P.xb(1),P.Ec(P.cc(19,14,a.amount,a.type.configuration.currency))}}function us(e,t){if(1&e&&(P.Qb(0,"table",20),P.Qb(1,"tbody"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Qb(10,"th",21),P.Dc(11),P.Pb(),P.Bc(12,ss,20,17,"ng-container",22),P.ac(13,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.general.creationDate),P.xb(2),P.Ec(a.i18n.general.expirationDate),P.xb(2),P.Ec(a.i18n.general.status),P.xb(2),P.Ec(a.i18n.general.type),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(1),P.gc("ngForOf",null==(n=P.bc(13,6,a.results$))?null:n.results)}}function bs(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.Qb(1,"form",4),P.Qb(2,"div",5),P.Bc(3,cs,5,3,"ng-container",6),P.Qb(4,"div",7),P.Qb(5,"multi-selection-field",8),P.Bc(6,os,1,4,"field-option",9),P.Pb(),P.Pb(),P.Qb(7,"div",7),P.Lb(8,"multi-selection-field",10),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Qb(9,"results-layout",11),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(10,"async"),P.Bc(11,ls,3,5,"mobile-result",12),P.Bc(12,us,14,8,"table",13),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.voucher.title.searchBought)("mobileHeading",a.i18n.voucher.mobileTitle.bought),P.xb(1),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",a.data.user&&!a.self),P.xb(2),P.gc("emptyLabel",a.i18n.general.notApplied)("label",a.i18n.general.type),P.xb(1),P.gc("ngForOf",a.data.types),P.xb(2),P.gc("emptyLabel",a.i18n.general.notApplied)("label",a.i18n.general.status)("fieldOptions",a.statusOptions),P.xb(1),P.gc("results",P.bc(10,13,a.results$))("rendering$",a.rendering$)("toLink",a.toLink)}}var fs,ds=((fs=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).vouchersService=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot.params;this.self=this.authHelper.isSelf(t.user),this.user=this.self?this.ApiHelper.SELF:t.user,this.addSub(this.vouchersService.getUserVouchersDataForSearch({user:this.user,relation:u.Sb.BOUGHT}).subscribe((function(t){e.form.patchValue(t.query),e.data=t})))}},{key:"getFormControlNames",value:function(){return["types","statuses"]}},{key:"toSearchParams",value:function(e){var t=Object(Lt.a)(e);return t.user=this.user,t}},{key:"doSearch",value:function(e){return this.vouchersService.searchUserVouchers$Response(e)}},{key:"path",value:function(e){return["/banking/vouchers/view/",e.id]}},{key:"voucherStatus",value:function(e){switch(e){case u.Tb.CANCELED:return this.i18n.voucher.status.canceled;case u.Tb.EXPIRED:return this.i18n.voucher.status.expired;case u.Tb.OPEN:return this.i18n.voucher.status.open;case u.Tb.PENDING:return this.i18n.voucher.status.pending;case u.Tb.REDEEMED:return this.i18n.voucher.status.redeemed}}},{key:"resolveMenu",value:function(e){return this.menu.userMenu(e.user,y.b.SEARCH_BOUGHT_VOUCHERS)}},{key:"statusOptions",get:function(){var e=this;return Object.values(u.Tb).map((function(t){return{value:t,text:e.voucherStatus(t)}}))}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(p.a)).\u0275fac=function(e){return new(e||fs)(P.Kb(P.r),P.Kb(ll.a))},fs.\u0275cmp=P.Eb({type:fs,selectors:[["search-bought-vouchers"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","types",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[3,"value","internalName","id","text"],[3,"date","amount","amountColor","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,is,1,0,"ng-container",1),P.Pb(),P.Bc(3,bs,13,15,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,N.a,I.v,I.l,k.s,w.a,C.a,Q.a,F.a,T.a,O.a,W.a,ee.h],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),fs);function ms(e,t){1&e&&P.Mb(0)}function gs(e,t){1&e&&P.Lb(0,"div",9)}function ps(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",9),P.Qb(2,"label-value",15),P.Lb(3,"user-link",16),P.Pb(),P.Pb(),P.Bc(4,gs,1,0,"div",7),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.data.user),P.xb(1),P.gc("ngIf",n.layout.gtsm$)}}function hs(e,t){if(1&e&&P.Lb(0,"field-option",19),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function ys(e,t){if(1&e&&(P.Qb(0,"div",9),P.Qb(1,"multi-selection-field",17),P.Bc(2,hs,1,4,"field-option",18),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.general.type),P.xb(1),P.gc("ngForOf",n.data.types)}}function vs(e,t){if(1&e&&P.Lb(0,"field-option",22),2&e){var n=t.$implicit;P.gc("value",n.id)("id",n.id)("text",n.display)}}function xs(e,t){if(1&e&&(P.Qb(0,"div",9),P.Qb(1,"single-selection-field",20),P.Bc(2,vs,1,3,"field-option",21),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("emptyOption",n.i18n.general.notApplied)("label",n.i18n.general.operator),P.xb(1),P.gc("ngForOf",n.data.operators)}}function Ps(e,t){if(1&e&&(P.Qb(0,"mobile-result",23),P.Qb(1,"div",24),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit;P.gc("date",n.redeemDate)("amount",n.amount)("currency",n.type.configuration.currency)("amountColor",!1),P.xb(2),P.Fc(" ",n.type.name," ")}}function Ds(e,t){if(1&e&&(P.Qb(0,"th"),P.Dc(1),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.Ec(n.i18n.general.operator)}}function ks(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.Nb()),2&e){var n=P.Zb(2).$implicit;P.xb(1),P.Fc(" ",null!=n.redeemBy&&n.redeemBy.user?n.redeemBy.display:""," ")}}function Ls(e,t){if(1&e&&(P.Qb(0,"td"),P.Bc(1,ks,2,1,"ng-container",6),P.Pb()),2&e){var n=P.Zb().$implicit;P.xb(1),P.gc("ngIf",n.redeemBy)}}function ws(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",28),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.path(e))})),P.Qb(2,"td"),P.Qb(3,"a",29),P.Dc(4),P.ac(5,"date"),P.Pb(),P.Pb(),P.Bc(6,Ls,2,1,"td",6),P.Qb(7,"td"),P.Dc(8),P.Pb(),P.Qb(9,"td",26),P.Dc(10),P.ac(11,"currency"),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.gc("routerLink",i.path(a)),P.xb(1),P.Fc(" ",P.bc(5,5,a.redeemDate)," "),P.xb(2),P.gc("ngIf",i.data.operators.length>0),P.xb(2),P.Fc(" ",a.type.name," "),P.xb(2),P.Fc(" ",P.cc(11,7,a.amount,a.type.configuration.currency)," ")}}function Cs(e,t){if(1&e&&(P.Qb(0,"table",25),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Bc(4,Ds,2,1,"th",6),P.Qb(5,"th"),P.Dc(6),P.Pb(),P.Qb(7,"th",26),P.Dc(8),P.Pb(),P.Pb(),P.Qb(9,"tbody"),P.Bc(10,ws,12,10,"ng-container",27),P.ac(11,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.voucher.redeem.date),P.xb(1),P.gc("ngIf",a.data.operators.length>0),P.xb(2),P.Ec(a.i18n.general.type),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(11,5,a.results$))?null:n.results)}}function Qs(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.Qb(1,"form",4),P.Qb(2,"div",5),P.Bc(3,ps,5,3,"ng-container",6),P.Bc(4,ys,3,2,"div",7),P.Bc(5,xs,3,3,"div",7),P.Qb(6,"div",8),P.Qb(7,"div",9),P.Lb(8,"date-field",10),P.Pb(),P.Qb(9,"div",9),P.Lb(10,"date-field",11),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Qb(11,"results-layout",12),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(12,"async"),P.Bc(13,Ps,3,5,"mobile-result",13),P.Bc(14,Cs,12,7,"table",14),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.voucher.title.redeemed)("mobileHeading",a.i18n.voucher.mobileTitle.redeemed),P.xb(1),P.gc("formGroup",a.form),P.xb(2),P.gc("ngIf",a.data.user&&!a.self),P.xb(1),P.gc("ngIf",(null==a.data.types?null:a.data.types.length)>1),P.xb(1),P.gc("ngIf",(null==a.data.operators?null:a.data.operators.length)>0),P.xb(3),P.gc("label",a.i18n.general.beginDate),P.xb(2),P.gc("label",a.i18n.general.endDate),P.xb(1),P.gc("results",P.bc(12,11,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}var Is,Fs=((Is=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).voucherService=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot.paramMap.get("user");this.addSub(this.voucherService.getUserVouchersDataForSearch({user:t,relation:u.Sb.REDEEMED}).subscribe((function(t){e.data=t,e.self=e.authHelper.isSelf(t.user)})))}},{key:"getFormControlNames",value:function(){return["types","periodBegin","periodEnd","operator"]}},{key:"toSearchParams",value:function(e){var t=e;return t.user=this.route.snapshot.paramMap.get("user"),t.relation=u.Sb.REDEEMED,t.redeemBy=e.operator,(e.periodBegin||e.periodEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.periodBegin,e.periodEnd)),t}},{key:"doSearch",value:function(e){return this.voucherService.searchUserVouchers$Response(e)}},{key:"path",value:function(e){return["/banking/vouchers/view/",e.id]}},{key:"resolveMenu",value:function(e){return this.menu.userMenu(e.user,y.b.SEARCH_REDEEMED)}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(p.a)).\u0275fac=function(e){return new(e||Is)(P.Kb(P.r),P.Kb(ll.a))},Is.\u0275cmp=P.Eb({type:Is,selectors:[["app-search-redeemed-vouchers"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[4,"ngIf"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","periodBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency","amountColor",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","operator",3,"emptyOption","label"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],[3,"date","amount","currency","amountColor"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,ms,1,0,"ng-container",1),P.Pb(),P.Bc(3,Qs,15,13,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,B.a,I.v,I.l,w.a,C.a,Q.a,F.a,T.a,N.a,k.s,O.a,S.a,W.a,ee.h],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),Is);function Ts(e,t){if(1&e&&P.Lb(0,"field-option",15),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function Ss(e,t){if(1&e&&(P.Qb(0,"div",4),P.Qb(1,"multi-selection-field",13),P.Bc(2,Ts,1,4,"field-option",14),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.xb(1),P.gc("label",n.i18n.general.type),P.xb(1),P.gc("ngForOf",n.data.types)}}function Os(e,t){if(1&e&&P.Lb(0,"field-option",31),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function Ns(e,t){if(1&e&&(P.Qb(0,"div",4),P.Qb(1,"multi-selection-field",29),P.Bc(2,Os,1,5,"field-option",30),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.voucher.buyerGroups),P.xb(1),P.gc("ngForOf",n.data.userGroups)}}function Bs(e,t){if(1&e&&P.Lb(0,"field-option",31),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function As(e,t){if(1&e&&(P.Qb(0,"div",4),P.Qb(1,"multi-selection-field",32),P.Bc(2,Bs,1,5,"field-option",30),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("label",n.i18n.voucher.redeemerGroups),P.xb(1),P.gc("ngForOf",n.data.userGroups)}}function Es(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"div",16),P.Qb(2,"div",4),P.Lb(3,"date-field",17),P.Pb(),P.Qb(4,"div",4),P.Lb(5,"date-field",18),P.Pb(),P.Pb(),P.Qb(6,"div",16),P.Qb(7,"div",4),P.Lb(8,"date-field",19),P.Pb(),P.Qb(9,"div",4),P.Lb(10,"date-field",20),P.Pb(),P.Pb(),P.Qb(11,"div",16),P.Qb(12,"div",4),P.Lb(13,"date-field",21),P.Pb(),P.Qb(14,"div",4),P.Lb(15,"date-field",22),P.Pb(),P.Pb(),P.Qb(16,"div",16),P.Qb(17,"div",4),P.Lb(18,"decimal-field",23,24),P.Pb(),P.Qb(20,"div",4),P.Lb(21,"decimal-field",25,24),P.Pb(),P.Pb(),P.Bc(23,Ns,3,2,"div",3),P.Qb(24,"div",4),P.Qb(25,"label-value",26),P.Lb(26,"user-field",27),P.Pb(),P.Pb(),P.Bc(27,As,3,2,"div",3),P.Qb(28,"div",4),P.Qb(29,"label-value",26),P.Lb(30,"user-field",28),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(3),P.gc("label",n.i18n.general.creationDate),P.xb(2),P.gc("label",n.i18n.general.to),P.xb(3),P.gc("label",n.i18n.general.expirationDate),P.xb(2),P.gc("label",n.i18n.general.to),P.xb(3),P.gc("label",n.i18n.voucher.redeem.date),P.xb(2),P.gc("label",n.i18n.general.to),P.xb(3),P.gc("label",n.i18n.transaction.amount)("scale",n.maxScale),P.xb(3),P.gc("label",n.i18n.general.to)("scale",n.maxScale),P.xb(2),P.gc("ngIf",(null==n.data.userGroups?null:n.data.userGroups.length)>1),P.xb(2),P.gc("label",n.i18n.voucher.buy.buyer),P.xb(1),P.gc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1),P.xb(1),P.gc("ngIf",(null==n.data.userGroups?null:n.data.userGroups.length)>1),P.xb(2),P.gc("label",n.i18n.voucher.redeem.redeemer),P.xb(1),P.gc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1)}}function $s(e,t){if(1&e&&P.Lb(0,"field-option",9),2&e){var n=t.$implicit,a=P.Zb();P.gc("value",n)("text",a.orderBy(n))}}var Rs,Zs=((Rs=function(e){s(n,e);var t=b(n);function n(e){return c(this,n),t.call(this,e)}return l(n,[{key:"ngOnInit",value:function(){r(d(n.prototype),"ngOnInit",this).call(this),this.mask=this.data.mask?this.data.mask:"",this.form.patchValue({creationType:null,printed:null})}},{key:"orderByOptions",value:function(){return Object.values(u.Rb)}},{key:"orderBy",value:function(e){switch(e){case u.Rb.CREATION_DATE_ASC:return this.i18n.voucher.sort.creationDateAsc;case u.Rb.CREATION_DATE_DESC:return this.i18n.voucher.sort.creationDateDesc;case u.Rb.EXPIRATION_DATE_ASC:return this.i18n.voucher.sort.expirationDateAsc;case u.Rb.EXPIRATION_DATE_DESC:return this.i18n.voucher.sort.expirationDateDesc;case u.Rb.REDEEM_DATE_ASC:return this.i18n.voucher.sort.redeemDateAsc;case u.Rb.REDEEM_DATE_DESC:return this.i18n.voucher.sort.redeemDateDesc}}},{key:"statusOptions",get:function(){var e=this;return Object.values(u.Tb).map((function(t){return{value:t,text:e.apiI18n.voucherStatus(t)}}))}},{key:"creationTypeOptions",get:function(){var e=this,t=Object.values(u.Qb);return[].concat(t.map((function(t){return{value:t,text:e.apiI18n.voucherCreationType(t)}})))}},{key:"maxScale",get:function(){return this.data.types.map((function(e){return e.configuration.currency.decimalDigits})).reduce((function(e,t,n,a){return e>t?e:t}))}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Rs)(P.Kb(P.r))},Rs.\u0275cmp=P.Eb({type:Rs,selectors:[["voucher-filters"]],inputs:{data:"data",heading:"heading",mobileHeading:"mobileHeading",form:"form",moreFilters:"moreFilters",headingActions:"headingActions"},features:[P.ub],decls:18,vars:23,consts:[["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions","emptyLabel"],["type","text","formControlName","token",3,"label","mask","placeholder"],["labelPosition","side","formControlName","creationType",3,"label","fieldOptions","emptyOption"],["labelPosition","side","formControlName","printed",3,"label","emptyOption"],[3,"value","text"],[4,"ngIf"],["labelPosition","side","formControlName","orderBy",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","creationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","creationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expirationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","expirationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","redeemBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","redeemEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","amountMin",3,"label","scale"],["amount",""],["formControlName","amountMax",3,"label","scale"],["kind","field",3,"label"],["formControlName","buyer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["formControlName","redeemer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","buyerGroups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","redeemerGroups",3,"label"]],template:function(e,t){1&e&&(P.Qb(0,"page-content",0),P.Qb(1,"form",1),P.Qb(2,"div",2),P.Bc(3,Ss,3,2,"div",3),P.Qb(4,"div",4),P.Lb(5,"multi-selection-field",5),P.Pb(),P.Qb(6,"div",4),P.Lb(7,"input-field",6),P.Pb(),P.Qb(8,"div",4),P.Lb(9,"single-selection-field",7),P.Pb(),P.Qb(10,"div",4),P.Qb(11,"single-selection-field",8),P.Lb(12,"field-option",9),P.Lb(13,"field-option",9),P.Pb(),P.Pb(),P.Bc(14,Es,31,22,"ng-container",10),P.Qb(15,"div",4),P.Qb(16,"single-selection-field",11),P.Bc(17,$s,1,2,"field-option",12),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Pb()),2&e&&(P.gc("heading",t.heading)("mobileHeading",t.mobileHeading)("headingActions",t.headingActions),P.xb(1),P.gc("formGroup",t.form),P.xb(2),P.gc("ngIf",(null==t.data.types?null:t.data.types.length)>1),P.xb(2),P.gc("label",t.i18n.general.status)("fieldOptions",t.statusOptions)("emptyLabel",t.i18n.general.notApplied),P.xb(2),P.gc("label",t.i18n.voucher.token)("mask",t.mask)("placeholder",t.mask),P.xb(2),P.gc("label",t.i18n.voucher.creationType)("fieldOptions",t.creationTypeOptions)("emptyOption",t.i18n.general.all),P.xb(2),P.gc("label",t.i18n.general.printed)("emptyOption",t.i18n.general.all),P.xb(1),P.gc("value","true")("text",t.i18n.general.yes),P.xb(1),P.gc("value","false")("text",t.i18n.general.no),P.xb(1),P.gc("ngIf",t.moreFilters),P.xb(2),P.gc("label",t.i18n.general.orderBy),P.xb(1),P.gc("ngForOf",t.orderByOptions()))},directives:[L.a,I.I,I.w,I.n,k.t,N.a,I.v,I.l,E.a,R.a,S.a,O.a,k.s,B.a,A.a,F.a,$.a],encapsulation:2,changeDetection:0}),Rs);function Ms(e,t){1&e&&P.Mb(0)}function Hs(e,t){if(1&e&&(P.Qb(0,"mobile-result"),P.Qb(1,"div"),P.Qb(2,"div",7),P.Qb(3,"div",8),P.Dc(4),P.Pb(),P.Qb(5,"div",8),P.Dc(6),P.Pb(),P.Pb(),P.Qb(7,"div",9),P.Dc(8),P.ac(9,"currency"),P.Pb(),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.xb(4),P.Fc(" ",n.type.name," "),P.xb(2),P.Fc(" ",a.apiI18n.voucherStatus(n.status)," "),P.xb(2),P.Fc(" ",P.cc(9,3,n.amount,n.type.configuration.currency)," ")}}function qs(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",13),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.path(e))})),P.Qb(2,"td"),P.Dc(3),P.ac(4,"date"),P.Pb(),P.Qb(5,"td"),P.Dc(6),P.ac(7,"date"),P.Pb(),P.Qb(8,"td"),P.Dc(9),P.Pb(),P.Qb(10,"td"),P.Dc(11),P.Pb(),P.Qb(12,"td",11),P.Dc(13),P.ac(14,"currency"),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.Ec(P.bc(4,5,a.creationDate)),P.xb(3),P.Fc(" ",P.bc(7,7,a.expirationDate),""),P.xb(3),P.Fc(" ",i.apiI18n.voucherStatus(a.status)," "),P.xb(2),P.Fc(" ",a.type.name," "),P.xb(2),P.Fc(" ",P.cc(14,9,a.amount,a.type.configuration.currency)," ")}}function Us(e,t){if(1&e&&(P.Qb(0,"table",10),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Qb(10,"th",11),P.Dc(11),P.Pb(),P.Pb(),P.Qb(12,"tbody"),P.Bc(13,qs,15,12,"ng-container",12),P.ac(14,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.general.creationDate),P.xb(2),P.Ec(a.i18n.general.expirationDate),P.xb(2),P.Ec(a.i18n.general.status),P.xb(2),P.Ec(a.i18n.general.type),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(14,6,a.results$))?null:n.results)}}function Vs(e,t){if(1&e){var n=P.Rb();P.Lb(0,"voucher-filters",3),P.ac(1,"async"),P.ac(2,"async"),P.Qb(3,"results-layout",4),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(4,"async"),P.Bc(5,Hs,10,6,"mobile-result",5),P.Bc(6,Us,15,8,"table",6),P.Pb()}if(2&e){var a=P.Zb();P.gc("data",a.data)("form",a.form)("heading",a.i18n.voucher.title.search)("mobileHeading",a.i18n.voucher.mobileTitle.search)("moreFilters",P.bc(1,9,a.moreFilters$))("headingActions",P.bc(2,11,a.headingActions$)),P.xb(3),P.gc("results",P.bc(4,13,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}var js,zs=((js=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).voucherService=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.addSub(this.voucherService.getVouchersDataForSearch({}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){r(d(n.prototype),"onDataInitialized",this).call(this,e),this.headingActions=[this.moreFiltersAction],this.form.patchValue(e.query)}},{key:"getFormControlNames",value:function(){return["types","creationBegin","creationEnd","statuses","token","creationType","printed","amountMin","amountMax","expirationBegin","expirationEnd","redeemBegin","redeemEnd","buyer","redeemer","buyerGroups","redeemerGroups","orderBy"]}},{key:"toSearchParams",value:function(e){var t=e;return(e.redeemBegin||e.redeemEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.redeemBegin,e.redeemEnd)),(e.creationBegin||e.creationEnd)&&(t.creationPeriod=this.ApiHelper.dateRangeFilter(e.creationBegin,e.creationEnd)),(e.expirationBegin||e.expirationEnd)&&(t.expirationPeriod=this.ApiHelper.dateRangeFilter(e.expirationBegin,e.expirationEnd)),(e.amountMin||e.amountMax)&&(t.amountRange=this.ApiHelper.rangeFilter(e.amountMin,e.amountMax)),t}},{key:"doSearch",value:function(e){return this.voucherService.searchVouchers$Response(e)}},{key:"path",value:function(e){return["/banking/vouchers/view/",e.id]}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.moreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.lessFilters}},{key:"resolveMenu",value:function(e){return y.b.SEARCH_VOUCHERS}},{key:"statusOptions",get:function(){var e=this;return Object.values(u.Tb).map((function(t){return{value:t,text:e.apiI18n.voucherStatus(t)}}))}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(p.a)).\u0275fac=function(e){return new(e||js)(P.Kb(P.r),P.Kb(ll.a))},js.\u0275cmp=P.Eb({type:js,selectors:[["search-vouchers"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"data","form","heading","mobileHeading","moreFilters","headingActions"],["resultType","list",3,"results","toLink","rendering$","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"cell-main","float-left"],[1,"cell-text"],[1,"float-right"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,Ms,1,0,"ng-container",1),P.Pb(),P.Bc(3,Vs,7,15,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,Zs,w.a,C.a,Q.a,W.a,k.s],pipes:[k.b,M.a,te.a],encapsulation:2,changeDetection:0}),js),Gs=o("cyUc");function _s(e,t){if(1&e&&(P.Qb(0,"div",14),P.Lb(1,"avatar",15),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("image",n.data.type.image)}}function Ks(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.creationType),P.xb(1),P.Fc(" ",n.apiI18n.voucherCreationType(n.data.creationType)," ")}}function Xs(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Lb(1,"user-link",16),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.owner),P.xb(1),P.gc("user",n.data.owner)}}function Ys(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Lb(1,"user-link",16),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.buy.buyer),P.xb(1),P.gc("user",n.data.buyer)}}function Ws(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Qb(1,"a",17),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.buy.payment),P.xb(1),P.gc("routerLink",n.transferPath(n.data.buy)),P.xb(1),P.Fc(" ",n.bankingHelper.transactionNumberOrId(n.data.buy)," ")}}function Js(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"dateTime"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.redeem.date),P.xb(1),P.Fc(" ",P.bc(2,2,n.data.redeemDate)," ")}}function eu(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Lb(1,"user-link",16),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.redeem.redeemer),P.xb(1),P.gc("user",n.data.redeemer)}}function tu(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Lb(1,"user-link",16),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.general.operator),P.xb(1),P.gc("user",n.data.redeemBy)}}function nu(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Qb(1,"a",17),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.redeem.payment),P.xb(1),P.gc("routerLink",n.transferPath(n.data.redeem)),P.xb(1),P.Fc(" ",n.bankingHelper.transactionNumberOrId(n.data.redeem)," ")}}function au(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.general.status),P.xb(1),P.Fc(" ",n.data.redeemAfterDate," ")}}function iu(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"dateTime"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.general.expirationDate),P.xb(1),P.Fc(" ",P.bc(2,2,n.data.expirationDate)," ")}}function ru(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Dc(1),P.ac(2,"dateTime"),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.refundDate),P.xb(1),P.Fc(" ",P.bc(2,2,n.data.refund.date)," ")}}function cu(e,t){if(1&e&&(P.Qb(0,"label-value",8),P.Qb(1,"a",17),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",n.i18n.voucher.refundPayment),P.xb(1),P.gc("routerLink",n.transferPath(n.data.refund)),P.xb(1),P.Fc(" ",n.bankingHelper.transactionNumberOrId(n.data.refund)," ")}}function ou(e,t){if(1&e&&(P.Ob(0,18),P.Qb(1,"h2",11),P.Dc(2),P.Pb(),P.Qb(3,"div",19),P.Dc(4),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(2),P.Fc(" ",n.i18n.general.description," "),P.xb(2),P.Fc(" ",n.data.description," ")}}function lu(e,t){1&e&&(P.Lb(0,"img",20),P.ac(1,"trust")),2&e&&P.gc("src",P.cc(1,1,t.ngIf,"url"),P.uc)}function su(e,t){if(1&e&&(P.Qb(0,"page-content",3),P.ac(1,"async"),P.Qb(2,"div",4),P.Qb(3,"div",5),P.Bc(4,_s,2,1,"div",6),P.Qb(5,"div",7),P.Qb(6,"label-value",8),P.Dc(7),P.Pb(),P.Qb(8,"label-value",8),P.Dc(9),P.Pb(),P.Qb(10,"label-value",8),P.Dc(11),P.ac(12,"currency"),P.Pb(),P.Bc(13,Ks,2,2,"label-value",9),P.Qb(14,"label-value",8),P.Dc(15),P.ac(16,"dateTime"),P.Pb(),P.Bc(17,Xs,2,2,"label-value",9),P.Bc(18,Ys,2,2,"label-value",9),P.Bc(19,Ws,3,3,"label-value",9),P.Qb(20,"label-value",8),P.Dc(21),P.Pb(),P.Bc(22,Js,3,4,"label-value",9),P.Bc(23,eu,2,2,"label-value",9),P.Bc(24,tu,2,2,"label-value",9),P.Bc(25,nu,3,3,"label-value",9),P.Bc(26,au,2,2,"label-value",9),P.Bc(27,iu,3,4,"label-value",9),P.Bc(28,ru,3,4,"label-value",9),P.Bc(29,cu,3,3,"label-value",9),P.Pb(),P.Pb(),P.Bc(30,ou,5,2,"ng-container",10),P.Lb(31,"hr",11),P.Qb(32,"div",12),P.Bc(33,lu,2,4,"img",13),P.ac(34,"async"),P.Pb(),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.gc("heading",n.data.title)("mobileHeading",n.data.title)("headingActions",P.bc(1,28,n.headingActions$)),P.xb(4),P.gc("ngIf",n.data.type.image),P.xb(2),P.gc("label",n.i18n.general.type),P.xb(1),P.Fc(" ",n.data.type.name," "),P.xb(1),P.gc("label",n.i18n.voucher.token),P.xb(1),P.Fc(" ",n.data.token," "),P.xb(1),P.gc("label",n.i18n.transaction.amount),P.xb(1),P.Fc(" ",P.cc(12,30,n.data.amount,n.data.type.configuration.currency)," "),P.xb(2),P.gc("ngIf",n.data.creationType),P.xb(1),P.gc("label",n.i18n.general.creationDate),P.xb(1),P.Fc(" ",P.bc(16,33,n.data.creationDate)," "),P.xb(2),P.gc("ngIf",n.data.owner),P.xb(1),P.gc("ngIf",n.data.buyer),P.xb(1),P.gc("ngIf",n.data.buy),P.xb(1),P.gc("label",n.i18n.general.status),P.xb(1),P.Fc(" ",n.apiI18n.voucherStatus(n.data.status)," "),P.xb(1),P.gc("ngIf",n.data.redeemDate),P.xb(1),P.gc("ngIf",n.data.redeemer),P.xb(1),P.gc("ngIf",null==n.data.redeemBy?null:n.data.redeemBy.user),P.xb(1),P.gc("ngIf",n.data.redeem),P.xb(1),P.gc("ngIf",!n.data.redeemAfterDateReached),P.xb(1),P.gc("ngIf",n.data.expirationDate),P.xb(1),P.gc("ngIf",n.data.refund),P.xb(1),P.gc("ngIf",n.data.refund),P.xb(1),P.gc("ngIf",n.data.description),P.xb(3),P.gc("ngIf",P.bc(34,35,n.qrCodeUrl$))}}function uu(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var bu,fu=((bu=function(e){s(n,e);var t=b(n);function n(e,a,i){var r;return c(this,n),(r=t.call(this,e)).voucherService=a,r.bankingHelper=i,r.qrCodeUrl$=new v.a(null),r}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot.paramMap.get("key");this.addSub(this.voucherService.viewVoucher({key:t}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;this.addSub(this.voucherService.getVoucherQrCode({key:e.id,size:u.D.MEDIUM}).subscribe((function(e){return t.qrCodeUrl$.next(URL.createObjectURL(e))}))),this.createCancelDeviceConfirmation=function(){return{type:u.s.MANAGE_VOUCHER,voucher:e.id,voucherAction:u.Ob.CANCEL}},this.createChangeExpirationDeviceConfirmation=function(){return{type:u.s.MANAGE_VOUCHER,voucher:e.id,voucherAction:u.Ob.CHANGE_EXPIRATION}},this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),e.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("confirmationPassword",I.G.required)),this.headingActions=this.initActions(e)}},{key:"initActions",value:function(e){var t=this,n=this.exportHelper.headingActions(e.exportFormats,(function(n){return t.voucherService.exportVoucher$Response({format:n.internalName,key:e.id})}));return e.cancelAction&&n.push(new Yt.c("cancel",e.cancelAction===u.Pb.CANCEL_AND_REFUND?this.i18n.voucher.cancelAndRefund:this.i18n.general.cancel,(function(){t.canConfirm||t.notification.warning(t.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),t.notification.confirm({title:t.cancelConfirmationTitle(e.cancelAction),passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:t.createCancelDeviceConfirmation,callback:function(e){return t.cancel(e.confirmationPassword)}})}))),e.canChangeExpirationDate&&n.push(new Yt.c("update",this.i18n.voucher.changeExpirationDate,(function(){t.canConfirm||t.notification.warning(t.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),t.notification.confirm({passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:t.createChangeExpirationDeviceConfirmation,customFields:t.changeExpirationFields,callback:function(n){t.addSub(t.voucherService.changeVoucherExpirationDate({key:e.id,confirmationPassword:n.confirmationPassword,body:{comments:n.customValues.comments,newExpirationDate:n.customValues.newExpirationDate}}).subscribe((function(){t.notification.snackBar(t.i18n.voucher.expirationDateChanged),t.reload()})))}})}))),n}},{key:"cancel",value:function(e){var t=this;!e&&this.confirmationPassword&&(e=this.confirmationPassword.value),Object(h.F)(this.confirmationPassword)&&this.addSub(this.voucherService.cancelVoucher({key:this.data.id,confirmationPassword:e}).subscribe((function(){t.reload(),t.notification.snackBar(t.i18n.voucher.cancel.done)})))}},{key:"cancelConfirmationTitle",value:function(e){switch(e){case u.Pb.CANCEL_AND_REFUND:return this.i18n.voucher.cancel.refundConfirmation;case u.Pb.CANCEL_PENDING_PACK:return this.i18n.voucher.cancel.packConfirmation;case u.Pb.CANCEL_GENERATED:case u.Pb.CANCEL_PENDING_SINGLE:return this.i18n.voucher.cancel.confirmation}}},{key:"transferPath",value:function(e){return null===e.authorizationStatus||e.authorizationStatus===u.yb.AUTHORIZED?["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]:["/banking","transaction",this.bankingHelper.transactionNumberOrId(e)]}},{key:"resolveMenu",value:function(e){return e.redeemer&&this.authHelper.isSelfOrOwner(e.redeemer)?y.b.SEARCH_REDEEMED:e.buyer&&this.authHelper.isSelfOrOwner(e.buyer)?y.b.SEARCH_BOUGHT_VOUCHERS:this.menu.searchUsersMenu()}},{key:"changeExpirationFields",get:function(){return[{internalName:"newExpirationDate",name:this.i18n.general.newExpirationDate,type:u.p.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:u.p.TEXT}]}}]),n}(uc.a)).\u0275fac=function(e){return new(e||bu)(P.Kb(P.r),P.Kb(ll.a),P.Kb(m.a))},bu.\u0275cmp=P.Eb({type:bu,selectors:[["app-view-voucher"]],features:[P.ub],decls:6,vars:7,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf","ngIfElse"],["loading",""],[3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column"],[1,"d-flex","flex-column","flex-sm-row-reverse","justify-content-sm-between"],["class","image d-flex justify-content-center mt-2 mb-4 align-self-center",4,"ngIf"],[1,"d-flex","flex-column","flex-grow-1"],[3,"label"],[3,"label",4,"ngIf"],["class","d-flex justify-content-start",4,"ngIf"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4","align-self-center"],["size","160","imageSize","200","useLightbox","",3,"image"],[3,"user"],[3,"routerLink"],[1,"d-flex","justify-content-start"],[1,"break-nl"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,su,35,37,"page-content",1),P.ac(3,"async"),P.Pb(),P.Bc(4,uu,2,0,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(5);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",P.bc(3,5,t.data$))("ngIfElse",n)}},directives:[D.a,k.t,L.a,F.a,J.a,T.a,ee.h,Y.a],pipes:[k.b,M.a,bc.a,Gs.a],encapsulation:2,changeDetection:0}),bu),du=o("IbW5");function mu(e,t){1&e&&P.Mb(0)}function gu(e,t){if(1&e&&P.Lb(0,"field-option",16),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function pu(e,t){if(1&e&&P.Lb(0,"field-option",16),2&e){var n=t.$implicit;P.gc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function hu(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"div",12),P.Qb(2,"div",6),P.Qb(3,"single-selection-field",13),P.Bc(4,gu,1,4,"field-option",14),P.Pb(),P.Pb(),P.Qb(5,"div",6),P.Qb(6,"single-selection-field",15),P.Bc(7,pu,1,4,"field-option",14),P.Pb(),P.Pb(),P.Nb()),2&e){var n=P.Zb(2);P.xb(3),P.gc("emptyOption",n.i18n.general.notApplied)("label",n.i18n.transaction.fromAccount),P.xb(1),P.gc("ngForOf",n.data.accountTypes),P.xb(2),P.gc("emptyOption",n.i18n.general.notApplied)("label",n.i18n.transaction.toAccount),P.xb(1),P.gc("ngForOf",n.data.accountTypes)}}function yu(e,t){if(1&e&&(P.Qb(0,"div",6),P.Lb(1,"input-field",19),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("mask",n.transactionNumberPattern)("label",n.i18n.transaction.number)}}function vu(e,t){if(1&e&&P.Lb(0,"field-option",22),2&e){var n=t.$implicit;P.gc("id",n.id)("value",n)("text",n.name)}}function xu(e,t){if(1&e&&(P.Qb(0,"div",6),P.Qb(1,"single-selection-field",20),P.Bc(2,vu,1,3,"field-option",21),P.Pb(),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.general.period),P.xb(1),P.gc("ngForOf",n.data.preselectedPeriods)}}function Pu(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"div",12),P.Qb(2,"div",6),P.Lb(3,"date-field",23),P.Pb(),P.Nb()),2&e){var n=P.Zb(3);P.xb(3),P.gc("label",n.i18n.general.beginDate)}}function Du(e,t){if(1&e&&(P.Qb(0,"div",6),P.Lb(1,"date-field",24),P.Pb()),2&e){var n=P.Zb(3);P.xb(1),P.gc("label",n.i18n.general.endDate)}}function ku(e,t){if(1&e&&(P.Ob(0),P.Bc(1,yu,2,2,"div",17),P.Qb(2,"div",6),P.Lb(3,"user-field",18),P.Pb(),P.Ob(4),P.Bc(5,xu,3,2,"div",17),P.Bc(6,Pu,4,1,"ng-container",8),P.ac(7,"async"),P.Bc(8,Du,2,1,"div",17),P.ac(9,"async"),P.Nb(),P.Nb()),2&e){var n,a,i=P.Zb(2);P.xb(1),P.gc("ngIf",i.hasTransactionNumber),P.xb(2),P.gc("label",i.i18n.general.user),P.xb(2),P.gc("ngIf",(null==i.data.preselectedPeriods?null:i.data.preselectedPeriods.length)>0),P.xb(1),P.gc("ngIf",null==(null==(n=i.form.value||P.bc(7,5,i.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),P.xb(2),P.gc("ngIf",null==(null==(a=i.form.value||P.bc(9,7,i.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.end))}}function Lu(e,t){if(1&e&&(P.Qb(0,"mobile-result",25),P.Qb(1,"div",26),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.gc("date",n.date)("amount",n.amount)("avatarImage",a.bankingHelper.avatarImage(n.transaction.related))("avatarIcon",a.bankingHelper.avatarIcon(n.transaction.related))("currency",a.currencies.get(n.currency)),P.xb(2),P.Fc(" ",a.bankingHelper.subjectName(n.transaction.related)," ")}}function wu(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",30),P.Xb("click",(function(){P.sc(n);var e=t.$implicit,a=P.Zb(3);return a.router.navigate(a.bankingHelper.transactionPath(e.transaction))})),P.Qb(2,"td"),P.Dc(3),P.ac(4,"date"),P.Pb(),P.Qb(5,"td"),P.Dc(6),P.Pb(),P.Qb(7,"td"),P.Dc(8),P.Pb(),P.Qb(9,"td"),P.Dc(10),P.Pb(),P.Qb(11,"td",28),P.Dc(12),P.ac(13,"currency"),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit,i=P.Zb(3);P.xb(3),P.Ec(P.bc(4,5,a.dueDate)),P.xb(3),P.Ec(i.bankingHelper.subjectName(a.transaction.from)),P.xb(2),P.Ec(i.bankingHelper.subjectName(a.transaction.to)),P.xb(2),P.Ec(i.number(a)),P.xb(2),P.Fc(" ",P.cc(13,7,a.amount,i.currencies.get(a.transaction.currency))," ")}}function Cu(e,t){if(1&e&&(P.Qb(0,"table",27),P.Qb(1,"thead"),P.Qb(2,"th"),P.Dc(3),P.Pb(),P.Qb(4,"th"),P.Dc(5),P.Pb(),P.Qb(6,"th"),P.Dc(7),P.Pb(),P.Qb(8,"th"),P.Dc(9),P.Pb(),P.Qb(10,"th",28),P.Dc(11),P.Pb(),P.Pb(),P.Qb(12,"tbody"),P.Bc(13,wu,14,10,"ng-container",29),P.ac(14,"async"),P.Pb(),P.Pb()),2&e){var n,a=P.Zb(2);P.xb(3),P.Ec(a.i18n.transaction.dueDate),P.xb(2),P.Ec(a.i18n.transaction.from),P.xb(2),P.Ec(a.i18n.transaction.to),P.xb(2),P.Ec(a.i18n.transaction.installmentNumber),P.xb(2),P.Ec(a.i18n.transaction.amount),P.xb(2),P.gc("ngForOf",null==(n=P.bc(14,6,a.results$))?null:n.results)}}function Qu(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",3),P.ac(1,"async"),P.Qb(2,"form",4),P.Qb(3,"div",5),P.Qb(4,"div",6),P.Lb(5,"single-selection-field",7),P.Pb(),P.Bc(6,hu,8,6,"ng-container",8),P.Bc(7,ku,10,9,"ng-container",8),P.ac(8,"async"),P.Pb(),P.Pb(),P.Pb(),P.Qb(9,"results-layout",9),P.Xb("update",(function(e){return P.sc(n),P.Zb().update(e)})),P.ac(10,"async"),P.Bc(11,Lu,3,6,"mobile-result",10),P.Bc(12,Cu,15,8,"table",11),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.i18n.transaction.title.scheduled)("mobileHeading",a.i18n.transaction.mobileTitle.scheduled)("headingActions",P.bc(1,11,a.headingActions$)),P.xb(2),P.gc("formGroup",a.form),P.xb(3),P.gc("label",a.i18n.general.status)("fieldOptions",a.statusOptions),P.xb(1),P.gc("ngIf",(null==a.data.accountTypes?null:a.data.accountTypes.length)>1),P.xb(1),P.gc("ngIf",P.bc(8,13,a.moreFilters$)),P.xb(2),P.gc("results",P.bc(10,15,a.results$))("toLink",a.toLink)("rendering$",a.rendering$)}}var Iu,Fu=((Iu=function(e){s(a,e);var t=b(a);function a(e,n,i){var r;return c(this,a),(r=t.call(this,e)).installmentsService=n,r.bankingHelper=i,r.currencies=new Map,r}return l(a,[{key:"ngOnInit",value:function(){var e=this;r(d(a.prototype),"ngOnInit",this).call(this),this.stateManager.cache("data",this.installmentsService.getInstallmentsOverviewDataForSearch({fields:["accountTypes","preselectedPeriods","query"]})).subscribe((function(t){e.bankingHelper.preProcessPreselectedPeriods(t,e.form),(t.accountTypes||[]).forEach((function(t){var n=t.currency;e.currencies.set(n.id,n),Object(h.h)(n.internalName)||e.currencies.set(n.internalName,n)})),e.data=t}))}},{key:"onDataInitialized",value:function(e){r(d(a.prototype),"onDataInitialized",this).call(this,e);var t=(e.accountTypes||[]).map((function(e){var t;return null===(t=e.currency)||void 0===t?void 0:t.transactionNumberPattern})).filter((function(e){return e})).reduce((function(e,t){return e.includes(t)?e:[].concat(n(e),[t])}),[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=[this.moreFiltersAction]}},{key:"getFormControlNames",value:function(){return["status","fromAccountType","toAccountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}},{key:"getInitialFormValue",value:function(e){var t=r(d(a.prototype),"getInitialFormValue",this).call(this,e);return t.status=u.G.SCHEDULED,t}},{key:"toSearchParams",value:function(e){var t=e;return t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.statuses=[e.status],t}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.moreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.lessFilters}},{key:"resolveMenu",value:function(){return y.b.SCHEDULED_PAYMENTS_OVERVIEW}},{key:"doSearch",value:function(e){return this.installmentsService.searchInstallmentsOverview$Response(e)}},{key:"number",value:function(e){return e.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:e.number,total:e.totalInstallments}):String(e.number)}},{key:"statusOptions",get:function(){var e=this;return Object.values(u.G).map((function(t){return{value:t,text:e.apiI18n.installmentStatus(t)}}))}},{key:"toLink",get:function(){var e=this;return function(t){return e.bankingHelper.transactionPath(t.transaction)}}}]),a}(p.a)).\u0275fac=function(e){return new(e||Iu)(P.Kb(P.r),P.Kb(Gi.a),P.Kb(m.a))},Iu.\u0275cmp=P.Eb({type:Iu,selectors:[["search-installments"]],features:[P.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.Bc(2,mu,1,0,"ng-container",1),P.Pb(),P.Bc(3,Qu,13,17,"ng-template",null,2,P.Cc)),2&e){var n=P.qc(4);P.gc("ready",P.bc(1,3,t.data$)),P.xb(2),P.gc("ngIf",t.data)("ngIfThen",n)}},directives:[D.a,k.t,L.a,I.I,I.w,I.n,S.a,I.v,I.l,w.a,C.a,Q.a,k.s,O.a,$.a,E.a,R.a,B.a,W.a],pipes:[k.b,te.a,M.a],encapsulation:2,changeDetection:0}),Iu);function Tu(e,t){if(1&e&&(P.Qb(0,"mobile-result",4),P.Qb(1,"div",5),P.Dc(2),P.Pb(),P.Pb()),2&e){var n=t.$implicit;P.gc("avatarImage",n.image),P.xb(2),P.Fc(" ",n.voucherTitle," ")}}function Su(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"tr",8),P.Xb("click",(function(){P.sc(n);var e=t.$implicit;return P.Zb(2).selectType(e)})),P.Qb(2,"td",9),P.Lb(3,"avatar",10),P.Pb(),P.Qb(4,"td"),P.Qb(5,"div"),P.Qb(6,"a",11),P.Xb("click",(function(){P.sc(n);var e=t.$implicit;return P.Zb(2).selectType(e)})),P.Dc(7),P.Pb(),P.Qb(8,"div"),P.Dc(9),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=t.$implicit;P.xb(3),P.gc("image",a.image),P.xb(4),P.Fc(" ",a.voucherTitle," "),P.xb(2),P.Fc(" ",a.voucherDescription," ")}}function Ou(e,t){if(1&e&&(P.Qb(0,"table",6),P.Qb(1,"tbody"),P.Bc(2,Su,10,3,"ng-container",7),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.xb(2),P.gc("ngForOf",n.types)}}var Nu,Bu=((Nu=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).typeSelected=new P.n,a}return l(n,[{key:"selectType",get:function(){var e=this;return function(t){return e.typeSelected.emit(t)}}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Nu)(P.Kb(P.r))},Nu.\u0275cmp=P.Eb({type:Nu,selectors:[["generate-vouchers-step-list-types"]],inputs:{types:"types"},outputs:{typeSelected:"typeSelected"},features:[P.ub],decls:4,vars:5,consts:[[3,"mode","heading","mobileHeading"],["resultType","list",3,"results","onClick"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar"],["icon","shopping_cart","size","xlarge","roundBorders","false",3,"image"],["ngClass","font-weight-bold",3,"click"]],template:function(e,t){1&e&&(P.Lb(0,"page-content",0),P.Qb(1,"results-layout",1),P.Bc(2,Tu,3,2,"mobile-result",2),P.Bc(3,Ou,3,1,"table",3),P.Pb()),2&e&&(P.gc("mode","empty")("heading",t.i18n.voucher.title.generate)("mobileHeading",t.i18n.voucher.mobileTitle.generate),P.xb(1),P.gc("results",t.types)("onClick",t.selectType))},directives:[L.a,w.a,C.a,Q.a,W.a,k.s,J.a,k.q],encapsulation:2,changeDetection:0}),Nu);function Au(e,t){if(1&e&&(P.Qb(0,"label-value",1),P.Dc(1),P.ac(2,"currency"),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.account.availableBalance),P.xb(1),P.Fc(" ",P.cc(2,2,n.data.account.status.availableBalance,n.currency)," ")}}var Eu,$u=((Eu=function(e){s(n,e);var t=b(n);function n(e){return c(this,n),t.call(this,e)}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.addSub(this.form.get("user").valueChanges.subscribe((function(){return e.saveUserData()})))}},{key:"saveUserData",value:function(){this.userField.user&&this.form.get("userData").setValue(this.userField.user)}},{key:"currency",get:function(){return this.data.account.currency}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Eu)(P.Kb(P.r))},Eu.\u0275cmp=P.Eb({type:Eu,selectors:[["generate-vouchers-step-form"]],viewQuery:function(e,t){var n;1&e&&P.Hc($.a,!0),2&e&&P.pc(n=P.Yb())&&(t.userField=n.first)},inputs:{data:"data",form:"form"},features:[P.ub],decls:8,vars:11,consts:[[3,"formGroup"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["formControlName","user",3,"label","allowContacts"],["user",""]],template:function(e,t){1&e&&(P.Ob(0,0),P.Qb(1,"label-value",1),P.Dc(2),P.Pb(),P.Bc(3,Au,3,5,"label-value",2),P.Lb(4,"input-field",3),P.Lb(5,"decimal-field",4),P.Lb(6,"user-field",5,6),P.Nb()),2&e&&(P.gc("formGroup",t.form),P.xb(1),P.gc("label",t.i18n.voucher.originAccount),P.xb(1),P.Fc(" ",t.data.account.type.name," "),P.xb(1),P.gc("ngIf",t.data.account.status.availableBalance),P.xb(1),P.gc("label",t.i18n.voucher.numberOfVouchers),P.xb(1),P.gc("label",t.i18n.voucher.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),P.xb(1),P.gc("label",t.i18n.general.user)("allowContacts",!1))},directives:[I.w,I.n,F.a,k.t,E.a,I.v,I.l,I.D,A.a,$.a],pipes:[M.a],encapsulation:2,changeDetection:0}),Eu);function Ru(e,t){if(1&e&&(P.Qb(0,"label-value",0),P.Lb(1,"user-link",3),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.general.user),P.xb(1),P.gc("user",n.user)}}function Zu(e,t){1&e&&P.Lb(0,"hr")}function Mu(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Bc(1,Zu,1,0,"hr",2),P.ac(2,"async"),P.Qb(3,"form",4),P.Qb(4,"confirmation-password",5),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationModeChanged.emit(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().confirmed.emit(e)})),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=P.Zb();P.xb(1),P.gc("ngIf",P.bc(2,4,a.layout.gtxxs$)),P.xb(2),P.gc("formGroup",a.form),P.xb(1),P.gc("passwordInput",a.confirmationPasswordInput)("createDeviceConfirmation",a.createDeviceConfirmation)}}var Hu,qu=((Hu=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).confirmationModeChanged=new P.n,a.confirmed=new P.n,a}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=function(){return{type:u.s.GENERATE_VOUCHERS,amount:e.generateVoucher.amount,voucherType:e.data.type.id,numberOfVouchers:e.generateVoucher.count}},this.confirmationPasswordInput||this.addShortcut(ea.k,(function(){return e.confirmed.emit()}))}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Hu)(P.Kb(P.r))},Hu.\u0275cmp=P.Eb({type:Hu,selectors:[["generate-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",generateVoucher:"generateVoucher",data:"data",user:"user"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[P.ub],decls:9,vars:11,consts:[[3,"label"],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(P.Qb(0,"label-value",0),P.Dc(1),P.Pb(),P.Qb(2,"label-value",0),P.Dc(3),P.Pb(),P.Qb(4,"label-value",0),P.Dc(5),P.ac(6,"currency"),P.Pb(),P.Bc(7,Ru,2,2,"label-value",1),P.Bc(8,Mu,5,6,"ng-container",2)),2&e&&(P.gc("label",t.i18n.general.type),P.xb(1),P.Fc(" ",t.data.type.voucherTitle,"\n"),P.xb(1),P.gc("label",t.i18n.voucher.numberOfVouchers),P.xb(1),P.Fc(" ",t.generateVoucher.count,"\n"),P.xb(1),P.gc("label",t.i18n.voucher.amountPerVoucher),P.xb(1),P.Fc(" ",P.cc(6,8,t.generateVoucher.amount,t.data.account.currency),"\n"),P.xb(2),P.gc("ngIf",t.user),P.xb(1),P.gc("ngIf",t.confirmationPasswordInput))},directives:[F.a,k.t,T.a,I.I,I.w,I.n,ia.a,ra.a,I.v,I.l],pipes:[M.a,k.b],encapsulation:2,changeDetection:0}),Hu);function Uu(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Qb(1,"generate-vouchers-step-list-types",4),P.Xb("typeSelected",(function(e){return P.sc(n),P.Zb().toForm(e)})),P.Pb(),P.Nb()}if(2&e){var a=P.Zb();P.xb(1),P.gc("types",a.data.types)}}function Vu(e,t){if(1&e){var n=P.Rb();P.Qb(0,"action-button",10),P.Xb("action",(function(){return P.sc(n),P.Zb(2).backToSelectType()})),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("label",a.i18n.general.previous)}}function ju(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",5),P.ac(1,"async"),P.Lb(2,"generate-vouchers-step-form",6),P.Qb(3,"actions",7),P.Qb(4,"action-button",8),P.Xb("action",(function(){return P.sc(n),P.Zb().toConfirm()})),P.ac(5,"async"),P.Pb(),P.Bc(6,Vu,1,1,"action-button",9),P.Pb(),P.Pb()}if(2&e){var a=P.Zb();P.gc("heading",a.dataTypeForGenerate.type.voucherTitle)("mobileHeading",a.dataTypeForGenerate.type.voucherTitle)("mode",P.bc(1,8,a.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("data",a.dataTypeForGenerate)("form",a.form),P.xb(2),P.gc("disabled",P.bc(5,10,a.requesting$))("label",a.i18n.general.next),P.xb(2),P.gc("ngIf",!a.singleType)}}function zu(e,t){if(1&e){var n=P.Rb();P.Qb(0,"action-button",8),P.Xb("action",(function(){return P.sc(n),P.Zb(2).generate()})),P.ac(1,"async"),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("disabled",!a.canConfirm||P.bc(1,2,a.requesting$))("label",a.i18n.general.confirm)}}function Gu(e,t){1&e&&P.Dc(0,"\xa0")}function _u(e,t){if(1&e){var n=P.Rb();P.Qb(0,"page-content",5),P.ac(1,"async"),P.Qb(2,"generate-vouchers-step-confirm",11),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationMode$.next(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().generate(e)})),P.Pb(),P.Qb(3,"actions",7),P.Bc(4,zu,2,4,"action-button",12),P.ac(5,"async"),P.Bc(6,Gu,1,0,"ng-template",null,13,P.Cc),P.Qb(8,"action-button",10),P.Xb("action",(function(){return P.sc(n),P.Zb().backToForm()})),P.Pb(),P.Pb(),P.Pb()}if(2&e){var a=P.qc(7),i=P.Zb();P.gc("heading",i.i18n.voucher.title.generateConfirmation)("mobileHeading",i.i18n.voucher.mobileTitle.generateConfirmation)("mode",P.bc(1,11,i.layout.ltsm$)?"fullHeight":"normal"),P.xb(2),P.gc("generateVoucher",i.form.value)("data",i.dataTypeForGenerate)("user",i.form.get("userData").value)("confirmationPasswordInput",i.dataTypeForGenerate.confirmationPasswordInput)("confirmationPassword",i.confirmationPassword),P.xb(2),P.gc("ngIf",P.bc(5,13,i.confirmationMode$)!=i.ConfirmationMode.Device)("ngIfElse",a),P.xb(4),P.gc("label",i.i18n.general.previous)}}function Ku(e,t){1&e&&(P.Qb(0,"page-content"),P.Lb(1,"spinner"),P.Pb())}var Xu,Yu,Wu=((Xu=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).voucherService=a,i.ConfirmationMode=Rn.a,i.step$=new v.a(null),i.singleType=!1,i.confirmationMode$=new v.a(null),i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.addSub(this.voucherService.getVoucherDataForGenerate().subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=e.types||[];1===t.length?(this.singleType=!0,this.toForm(t[0])):this.step="select-type"}},{key:"generate",value:function(e){var t=this;if(e&&this.confirmationPassword.setValue(e),!this.confirmationPasswordInput||Object(h.F)(this.confirmationPassword)){var n=this.form.value;n.type=this.dataTypeForGenerate.type.id,delete n.userData,this.addSub(this.voucherService.generateVouchers({confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:n}).subscribe((function(){t.reload(),t.notification.snackBar(t.i18n.voucher.generate.done)})))}}},{key:"backToSelectType",value:function(){this.step="select-type"}},{key:"backToForm",value:function(){this.step="form"}},{key:"toForm",value:function(e){var t=this;this.addSub(this.voucherService.getVoucherDataForGenerate({type:e.id}).subscribe((function(e){t.dataTypeForGenerate=e,t.buildForm(),t.step="form"})))}},{key:"toConfirm",value:function(){Object(h.F)(this.form)&&(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),this.canConfirm?(this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(I.G.required))),this.step="confirm"):this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput)))}},{key:"buildForm",value:function(){this.form?this.form.reset():this.form=this.formBuilder.group({count:new I.j(""),amount:new I.j(""),user:new I.j(""),userData:new I.j("")}),this.form.get("count").setValue(1)}},{key:"resolveMenu",value:function(){return y.b.GENERATE_VOUCHER}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}},{key:"currency",get:function(){return this.dataTypeForGenerate.account.currency}},{key:"confirmationPasswordInput",get:function(){return this.dataTypeForGenerate.confirmationPasswordInput}}]),n}(kt.a)).\u0275fac=function(e){return new(e||Xu)(P.Kb(P.r),P.Kb(ll.a))},Xu.\u0275cmp=P.Eb({type:Xu,selectors:[["generate-vouchers"]],features:[P.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"generateVoucher","data","user","confirmationPasswordInput","confirmationPassword","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(e,t){1&e&&(P.Qb(0,"page-layout",0),P.ac(1,"async"),P.ac(2,"async"),P.Bc(3,Uu,2,1,"ng-container",1),P.Bc(4,ju,7,12,"page-content",2),P.Bc(5,_u,9,15,"page-content",2),P.Bc(6,Ku,2,0,"page-content",3),P.Pb()),2&e&&(P.gc("ready",P.bc(1,5,t.data$))("ngSwitch",P.bc(2,7,t.step$)),P.xb(3),P.gc("ngSwitchCase","select-type"),P.xb(1),P.gc("ngSwitchCase","form"),P.xb(1),P.gc("ngSwitchCase","confirm"))},directives:[D.a,k.x,k.y,k.z,Bu,L.a,$u,wt.a,Ct.a,k.t,qu,Y.a],pipes:[k.b],encapsulation:2,changeDetection:0}),Xu),Ju=[{path:"",canActivateChild:[du.a],children:[{path:":owner/account/:type",component:Ee},{path:"transfer/:key",component:ol},{path:"transfer/:account/:key",component:ol},{path:"transaction/:key",component:Oo},{path:"transfers-overview",component:il},{path:"transaction/:key/authorization-history",component:vc},{path:":from/payment",component:Wn},{path:":from/payment/:to",component:Wn},{path:":from/payment-request",component:Ei},{path:"payment-request/:key/accept",component:za},{path:":from/payment-request/:to",component:Ei},{path:":owner/payment-requests",component:Or,data:{kind:"payment-request"}},{path:"payment-requests",component:sc,data:{kind:"payment-request"}},{path:"pos",component:Wn},{path:"qr",component:zi},{path:":owner/installments",component:lr},{path:"installments-overview",component:Fu},{path:":owner/authorized-payments",component:Or,data:{kind:"authorized"}},{path:"authorized-payments",component:sc,data:{kind:"authorized"}},{path:"pending-my-authorization",component:sc,data:{kind:"myAuth"}},{path:":user/vouchers/redeem",component:as},{path:":user/vouchers/redeemed",component:Fs},{path:":user/vouchers/buy",component:$l},{path:":user/vouchers/bought",component:ds},{path:"vouchers/view/:key",component:fu},{path:"vouchers",component:zs},{path:":user/account-balance-limits",component:Et},{path:":user/account-balance-limits/:accountType",component:rn},{path:":user/account-balance-limits/:accountType/edit",component:Tt},{path:"account-balance-limits-overview",component:Xt},{path:":user/account-payment-limits",component:mn},{path:":user/account-payment-limits/:accountType",component:An},{path:":user/account-payment-limits/:accountType/edit",component:sn},{path:"account-payment-limits-overview",component:In},{path:"user-balances-overview",component:Pt},{path:"vouchers/generate",component:Wu}]}],eb=((Yu=function e(){c(this,e)}).\u0275mod=P.Ib({type:Yu}),Yu.\u0275inj=P.Hb({factory:function(e){return new(e||Yu)},imports:[[ee.i.forChild(Ju)],ee.i]}),Yu);function tb(e,t){if(1&e&&(P.Qb(0,"notification",6),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.xb(1),P.Fc(" ",n.i18n.transaction.requiresAuthorization,"\n")}}function nb(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Lb(1,"user-link",8),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.fromUser),P.xb(1),P.gc("user",n.fromUser)}}function ab(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.fromAccount),P.xb(1),P.Fc(" ",n.preview.fromAccount.type.name,"\n")}}function ib(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Lb(1,"user-link",8),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.toUser),P.xb(1),P.gc("user",n.toUser)}}function rb(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.toAccount),P.xb(1),P.Fc(" ",n.preview.toAccount.type.name,"\n")}}function cb(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Dc(1),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.type),P.xb(1),P.Fc(" ",n.preview.paymentType.name,"\n")}}function ob(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Dc(1),P.ac(2,"currency"),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.amount),P.xb(1),P.Fc(" ",P.cc(2,2,n.preview.mainAmount,n.preview.currency),"\n")}}function lb(e,t){if(1&e&&(P.Qb(0,"div"),P.Dc(1),P.ac(2,"currency"),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.xb(1),P.Gc(" ",n.fee.name,": ",P.cc(2,2,n.amount,a.preview.currency)," ")}}function sb(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Bc(1,lb,3,5,"div",9),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.appliedFees),P.xb(1),P.gc("ngForOf",n.fees)}}function ub(e,t){1&e&&P.Lb(0,"custom-field-value",10),2&e&&P.gc("fieldValue",t.$implicit)}function bb(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Dc(1),P.ac(2,"date"),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.dueDate),P.xb(1),P.Fc(" ",P.bc(2,2,n.preview.installments[0].dueDate),"\n")}}function fb(e,t){if(1&e&&(P.Qb(0,"thead"),P.Qb(1,"th"),P.Dc(2),P.Pb(),P.Qb(3,"th"),P.Dc(4),P.Pb(),P.Qb(5,"th",12),P.Dc(6),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.xb(2),P.Ec(n.i18n.transaction.installmentNumber),P.xb(2),P.Ec(n.i18n.transaction.dueDate),P.xb(2),P.Ec(n.i18n.transaction.amount)}}function db(e,t){if(1&e&&(P.Qb(0,"tr"),P.Qb(1,"td"),P.Dc(2),P.Pb(),P.Qb(3,"td"),P.Dc(4),P.ac(5,"date"),P.Pb(),P.Qb(6,"td",12),P.Dc(7),P.ac(8,"currency"),P.Pb(),P.Pb()),2&e){var n=t.$implicit,a=P.Zb(2);P.xb(2),P.Fc(" ",n.number," "),P.xb(2),P.Fc(" ",P.bc(5,3,n.dueDate)," "),P.xb(3),P.Fc(" ",P.cc(8,5,n.mainAmount,a.preview.currency)," ")}}function mb(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Qb(1,"table",11),P.Bc(2,fb,7,3,"thead",4),P.ac(3,"async"),P.Qb(4,"tbody"),P.Bc(5,db,9,8,"tr",9),P.Pb(),P.Pb(),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.installments),P.xb(2),P.gc("ngIf",P.bc(3,3,n.layout.gtxs$)),P.xb(3),P.gc("ngForOf",n.preview.installments)}}function gb(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentNowManual," ")}}function pb(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentNowFixed(n.preview.payment.occurrencesCount)," ")}}function hb(e,t){if(1&e&&(P.Ob(0),P.Bc(1,gb,2,1,"ng-container",4),P.Bc(2,pb,2,1,"ng-container",4),P.Nb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngIf",null==n.preview.payment.occurrencesCount),P.xb(1),P.gc("ngIf",null!=n.preview.payment.occurrencesCount)}}function yb(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.ac(2,"date"),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentDateManual(P.bc(2,1,n.preview.payment.firstOccurrenceDate))," ")}}var vb=function(e,t){return{date:e,count:t}};function xb(e,t){if(1&e&&(P.Ob(0),P.Dc(1),P.ac(2,"date"),P.Nb()),2&e){var n=P.Zb(3);P.xb(1),P.Fc(" ",n.i18n.transaction.recurringPaymentDateFixed(P.kc(3,vb,P.bc(2,1,n.preview.payment.firstOccurrenceDate),n.preview.payment.occurrencesCount))," ")}}function Pb(e,t){if(1&e&&(P.Bc(0,yb,3,3,"ng-container",4),P.Bc(1,xb,3,6,"ng-container",4)),2&e){var n=P.Zb(2);P.gc("ngIf",null==n.preview.payment.occurrencesCount),P.xb(1),P.gc("ngIf",null!=n.preview.payment.occurrencesCount)}}function Db(e,t){if(1&e&&(P.Qb(0,"label-value",7),P.Bc(1,hb,3,2,"ng-container",13),P.Bc(2,Pb,2,2,"ng-template",null,14,P.Cc),P.Pb()),2&e){var n=P.qc(3),a=P.Zb();P.gc("label",a.i18n.transaction.recurringPayment),P.xb(1),P.gc("ngIf",null==a.preview.payment.firstOccurrenceDate)("ngIfElse",n)}}function kb(e,t){if(1&e&&P.Lb(0,"label-value",15),2&e){var n=P.Zb();P.gc("label",n.i18n.general.description)("value",n.preview.payment.description)}}function Lb(e,t){1&e&&P.Lb(0,"hr")}function wb(e,t){1&e&&P.Lb(0,"hr")}function Cb(e,t){if(1&e&&(P.Ob(0),P.Bc(1,wb,1,0,"hr",4),P.ac(2,"async"),P.Qb(3,"div",16),P.Dc(4),P.Pb(),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("ngIf",P.bc(2,2,n.layout.gtxxs$)),P.xb(3),P.Ec(n.preview.confirmationMessage)}}function Qb(e,t){1&e&&P.Lb(0,"hr")}function Ib(e,t){if(1&e){var n=P.Rb();P.Ob(0),P.Bc(1,Qb,1,0,"hr",4),P.ac(2,"async"),P.Qb(3,"form",17),P.Qb(4,"confirmation-password",18),P.Xb("confirmationModeChanged",(function(e){return P.sc(n),P.Zb().confirmationModeChanged.emit(e)}))("confirmed",(function(e){return P.sc(n),P.Zb().confirmed.emit(e)})),P.Pb(),P.Pb(),P.Nb()}if(2&e){var a=P.Zb();P.xb(1),P.gc("ngIf",P.bc(2,5,a.layout.gtxxs$)),P.xb(2),P.gc("formGroup",a.form),P.xb(1),P.gc("pos",a.pos)("passwordInput",a.preview.confirmationPasswordInput)("createDeviceConfirmation",a.createDeviceConfirmation)}}var Fb,Tb,Sb=((Tb=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).bankingHelper=a,i.confirmationModeChanged=new P.n,i.confirmed=new P.n,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===u.a.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===u.a.SYSTEM,this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,Object(h.h)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=function(){return e.pos?e.preview.payment:{type:u.s.PERFORM_PAYMENT,from:g.a.accountOwner(e.preview.fromAccount),to:g.a.accountOwner(e.preview.toAccount),paymentType:e.preview.paymentType.id,amount:e.preview.payment.amount}},this.preview.confirmationPasswordInput||this.addShortcut(ea.k,(function(){return e.confirmed.emit()}))}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Tb)(P.Kb(P.r),P.Kb(m.a))},Tb.\u0275cmp=P.Eb({type:Tb,selectors:[["payment-step-confirm"]],inputs:{pos:"pos",preview:"preview",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[P.ub],decls:20,vars:23,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[3,"fieldValue"],[1,"table","table-hover"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"pos","passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(P.Bc(0,tb,2,1,"notification",0),P.Bc(1,nb,2,2,"label-value",1),P.Bc(2,ab,2,2,"label-value",1),P.Bc(3,ib,2,2,"label-value",1),P.Bc(4,rb,2,2,"label-value",1),P.Bc(5,cb,2,2,"label-value",1),P.Bc(6,ob,3,5,"label-value",1),P.Bc(7,sb,2,2,"label-value",1),P.Bc(8,ub,1,1,"custom-field-value",2),P.Bc(9,bb,3,4,"label-value",1),P.Bc(10,mb,6,5,"label-value",1),P.Bc(11,Db,4,3,"label-value",1),P.Bc(12,kb,1,2,"label-value",3),P.Bc(13,Lb,1,0,"hr",4),P.ac(14,"async"),P.Qb(15,"label-value",5),P.Dc(16),P.ac(17,"currency"),P.Pb(),P.Bc(18,Cb,5,4,"ng-container",4),P.Bc(19,Ib,5,7,"ng-container",4)),2&e&&(P.gc("ngIf",t.preview.pendingAuthorization),P.xb(1),P.gc("ngIf",!t.fromSelf&&t.fromUser),P.xb(1),P.gc("ngIf",t.fromSystem),P.xb(1),P.gc("ngIf",t.toUser),P.xb(1),P.gc("ngIf",t.toSystem),P.xb(1),P.gc("ngIf",t.showPaymentType),P.xb(1),P.gc("ngIf",null!=t.preview.mainAmount&&t.preview.totalAmount!==t.preview.mainAmount),P.xb(1),P.gc("ngIf",(null==t.fees?null:t.fees.length)>0),P.xb(1),P.gc("ngForOf",t.preview.customValues),P.xb(1),P.gc("ngIf",1===(null==t.preview.installments?null:t.preview.installments.length)),P.xb(1),P.gc("ngIf",(null==t.preview.installments?null:t.preview.installments.length)>1),P.xb(1),P.gc("ngIf","recurring"===t.preview.payment.scheduling),P.xb(1),P.gc("ngIf",t.preview.payment.description),P.xb(1),P.gc("ngIf",P.bc(14,18,t.layout.gtxxs$)),P.xb(2),P.gc("label",t.i18n.transaction.totalAmount),P.xb(1),P.Fc(" ",P.cc(17,20,t.preview.totalAmount,t.preview.currency),"\n"),P.xb(2),P.gc("ngIf",(t.preview.confirmationMessage||"").length>0),P.xb(1),P.gc("ngIf",t.preview.confirmationPasswordInput))},directives:[k.t,k.s,F.a,na.a,T.a,aa.a,I.I,I.w,I.n,ia.a,ra.a,I.v,I.l],pipes:[k.b,M.a,te.a],encapsulation:2,changeDetection:0}),Tb),Ob=((Fb=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).performPayment=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.performed.authorizationStatus===u.yb.PENDING?(this.icon="scheduled",this.message=this.performed.transactionNumber?this.i18n.transaction.pendingWithNumber(this.performed.transactionNumber):this.i18n.transaction.pending):(this.icon="done",this.message=this.performed.transactionNumber?this.i18n.transaction.processedWithNumber(this.performed.transactionNumber):this.i18n.transaction.processed),this.addShortcut(ea.k,(function(){return e.performPayment.viewPerformed()}))}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Fb)(P.Kb(P.r),P.Kb(Wn))},Fb.\u0275cmp=P.Eb({type:Fb,selectors:[["payment-step-done"]],inputs:{performed:"performed"},features:[P.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(P.Qb(0,"div",0),P.Qb(1,"div",1),P.Qb(2,"div",2),P.Lb(3,"icon",3),P.Pb(),P.Qb(4,"div",4),P.Dc(5),P.Pb(),P.Pb(),P.Pb()),2&e&&(P.xb(3),P.gc("icon",t.icon),P.xb(2),P.Ec(t.message))},directives:[Ra.a],encapsulation:2,changeDetection:0}),Fb),Nb=["toUser"],Bb=["amount"];function Ab(e,t){if(1&e&&(P.Qb(0,"label-value",15),P.Lb(1,"user-link",16),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.fromUser),P.xb(1),P.gc("user",n.fromUser)}}var Eb=function(e,t,n){return{positive:e,negative:t,"text-right":n}};function $b(e,t){if(1&e&&(P.Qb(0,"label-value",18),P.ac(1,"async"),P.Qb(2,"div",19),P.ac(3,"async"),P.Dc(4),P.ac(5,"currency"),P.Pb(),P.Pb()),2&e){var n=P.Zb(2);P.gc("label",P.bc(1,3,n.accountBalanceLabel$)),P.xb(2),P.gc("ngClass",P.lc(10,Eb,n.format.isPositive(n.singleAccount.status.balance),n.format.isNegative(n.singleAccount.status.balance),P.bc(3,5,n.layout.ltsm$))),P.xb(2),P.Fc(" ",P.cc(5,7,n.singleAccount.status.balance,n.singleAccount.currency)," ")}}function Rb(e,t){if(1&e&&(P.Ob(0),P.Bc(1,$b,6,14,"label-value",17),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("ngIf",n.singleAccount.status)}}function Zb(e,t){1&e&&P.Lb(0,"br")}function Mb(e,t){1&e&&P.Dc(0," - ")}function Hb(e,t){if(1&e&&(P.Ob(0),P.Bc(1,Zb,1,0,"br",2),P.ac(2,"async"),P.Bc(3,Mb,1,0,"ng-template",null,30,P.Cc),P.Dc(5),P.Nb()),2&e){var n=P.qc(4),a=P.Zb().$implicit,i=P.Zb(2);P.xb(1),P.gc("ngIf",P.bc(2,3,i.layout.ltsm$))("ngIfElse",n),P.xb(4),P.Fc(" ",a.number," ")}}var qb=function(e,t){return{positive:e,negative:t}};function Ub(e,t){if(1&e&&(P.Qb(0,"div",31),P.Dc(1),P.ac(2,"currency"),P.Pb()),2&e){var n=P.Zb().$implicit,a=P.Zb(2);P.gc("ngClass",P.kc(5,qb,a.format.isPositive(n.status.balance),a.format.isNegative(n.status.balance))),P.xb(1),P.Fc(" ",P.cc(2,2,n.status.balance,n.currency)," ")}}function Vb(e,t){if(1&e){var n=P.Rb();P.Qb(0,"div",23),P.Qb(1,"div"),P.Qb(2,"div",24),P.Qb(3,"input",25,26),P.Xb("keyup.enter",(function(){return P.sc(n),P.qc(4).click()})),P.Pb(),P.Qb(5,"label",27),P.Qb(6,"div",28),P.Dc(7),P.Bc(8,Hb,6,5,"ng-container",14),P.Pb(),P.Pb(),P.Pb(),P.Pb(),P.Bc(9,Ub,3,8,"div",29),P.Pb()}if(2&e){var a=t.$implicit,i=P.Zb(2);P.xb(1),P.zb(i.pos?"col":"col-7 col-sm-8 col-md-5"),P.xb(2),P.gc("id","from_"+a.id)("value",a.type.id),P.xb(2),P.gc("for","from_"+a.id),P.xb(2),P.Fc(" ",a.type.name," "),P.xb(1),P.gc("ngIf",a.number),P.xb(1),P.gc("ngIf",!i.pos&&a.status)}}function jb(e,t){if(1&e&&(P.Qb(0,"label-value",20),P.Bc(1,Vb,10,8,"div",21),P.Lb(2,"field-errors",22),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.pos?n.i18n.transaction.toAccount:n.i18n.transaction.fromAccount),P.xb(1),P.gc("ngForOf",n.data.accounts),P.xb(1),P.gc("control",n.form.get("account"))}}function zb(e,t){if(1&e&&P.Lb(0,"field-option",37),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.display)}}function Gb(e,t){if(1&e&&(P.Qb(0,"single-selection-field",35),P.Bc(1,zb,1,2,"field-option",36),P.Pb()),2&e){var n=P.Zb(2);P.xb(1),P.gc("ngForOf",n.data.allowedUsers)}}var _b=function(e){return[e]},Kb=function(e){return{usersToExclude:e}};function Xb(e,t){if(1&e){var n=P.Rb();P.Qb(0,"user-field",38,39),P.Xb("selected",(function(e){P.sc(n),P.Zb(2);var t=P.qc(10);return e?t.focus():null})),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("autoSearch",!a.allowPrincipal)("filters",P.jc(9,Kb,a.fromUser&&!a.fromSelf?P.jc(7,_b,a.fromParam):null))("allowContacts",a.allowContacts)("allowSearch",a.allowSearch)("allowPrincipal",a.allowPrincipal)("allowQrCode",a.allowQrCode)("principalTypes",a.data.principalTypes)}}function Yb(e,t){if(1&e&&(P.Qb(0,"label-value",32),P.Bc(1,Gb,2,1,"single-selection-field",33),P.Bc(2,Xb,2,11,"ng-template",null,34,P.Cc),P.Pb()),2&e){var n=P.qc(3),a=P.Zb();P.gc("label",a.pos?a.i18n.transaction.fromUser:a.i18n.transaction.toUser),P.xb(1),P.gc("ngIf",a.fixedUsersList)("ngIfElse",n)}}function Wb(e,t){if(1&e&&(P.Qb(0,"label-value",40),P.Lb(1,"user-link",16),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.toUser),P.xb(1),P.gc("user",n.toUser)}}function Jb(e,t){if(1&e&&P.Lb(0,"field-option",37),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function ef(e,t){if(1&e&&(P.Qb(0,"single-selection-field",41,42),P.Bc(2,Jb,1,2,"field-option",36),P.ac(3,"async"),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.type),P.xb(2),P.gc("ngForOf",P.bc(3,2,n.paymentTypes$))}}function tf(e,t){if(1&e&&P.Lb(0,"custom-field-input",43),2&e){var n=t.$implicit,a=P.Zb();P.gc("field",n)("formControl",a.customValuesControlGetter(n))}}function nf(e,t){if(1&e&&P.Lb(0,"field-option",49),2&e){var n=P.Zb(2);P.gc("text",n.i18n.transaction.schedulingSingle)}}function af(e,t){if(1&e&&P.Lb(0,"field-option",50),2&e){var n=P.Zb(2);P.gc("text",n.i18n.transaction.schedulingInstallments)}}function rf(e,t){if(1&e&&P.Lb(0,"field-option",51),2&e){var n=P.Zb(2);P.gc("text",n.i18n.transaction.schedulingRecurring)}}function cf(e,t){if(1&e&&(P.Qb(0,"single-selection-field",44),P.Lb(1,"field-option",45),P.Bc(2,nf,1,1,"field-option",46),P.Bc(3,af,1,1,"field-option",47),P.Bc(4,rf,1,1,"field-option",48),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.scheduling),P.xb(1),P.gc("text",n.i18n.transaction.schedulingDirect),P.xb(1),P.gc("ngIf",(null==n.paymentTypeData$.value?null:n.paymentTypeData$.value.maxInstallments)>0),P.xb(1),P.gc("ngIf",(null==n.paymentTypeData$.value?null:n.paymentTypeData$.value.maxInstallments)>1),P.xb(1),P.gc("ngIf",null==n.paymentTypeData$.value?null:n.paymentTypeData$.value.allowsRecurringPayments)}}function of(e,t){if(1&e&&P.Lb(0,"date-field",52),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.dueDate)}}function lf(e,t){if(1&e&&P.Lb(0,"date-field",52),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.firstInstallmentDate)}}function sf(e,t){if(1&e&&(P.Ob(0),P.Lb(1,"input-field",53),P.Qb(2,"radio-group-field",54),P.Lb(3,"field-option",37),P.Lb(4,"field-option",37),P.Pb(),P.Bc(5,lf,1,1,"date-field",55),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("label",n.i18n.transaction.installmentsCount),P.xb(1),P.gc("label",n.i18n.transaction.firstInstallment),P.xb(1),P.gc("value",!0)("text",n.i18n.general.now),P.xb(1),P.gc("value",!1)("text",n.i18n.general.futureDate),P.xb(1),P.gc("ngIf",!1===n.form.value.firstInstallmentIsNow)}}function uf(e,t){if(1&e&&P.Lb(0,"date-field",60),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.firstOccurrenceDate)}}function bf(e,t){if(1&e&&P.Lb(0,"input-field",61),2&e){var n=P.Zb(2);P.gc("label",n.i18n.transaction.occurrencesCount)}}function ff(e,t){if(1&e&&(P.Ob(0),P.Qb(1,"radio-group-field",56),P.Lb(2,"field-option",37),P.Lb(3,"field-option",37),P.Pb(),P.Bc(4,uf,1,1,"date-field",57),P.Qb(5,"radio-group-field",58),P.Lb(6,"field-option",37),P.Lb(7,"field-option",37),P.Pb(),P.Bc(8,bf,1,1,"input-field",59),P.Nb()),2&e){var n=P.Zb();P.xb(1),P.gc("label",n.i18n.transaction.firstOccurrence),P.xb(1),P.gc("value",!0)("text",n.i18n.general.now),P.xb(1),P.gc("value",!1)("text",n.i18n.general.futureDate),P.xb(1),P.gc("ngIf",!1===n.form.value.firstOccurrenceIsNow),P.xb(1),P.gc("label",n.i18n.transaction.repeatUntil),P.xb(1),P.gc("value",!0)("text",n.i18n.transaction.repeatUntilManual),P.xb(1),P.gc("value",!1)("text",n.i18n.transaction.repeatUntilFixed),P.xb(1),P.gc("ngIf",!1===n.form.value.repeatUntilCanceled)}}function df(e,t){if(1&e&&P.Lb(0,"textarea-field",63),2&e){var n=P.Zb().ngIf,a=P.Zb();P.gc("required","required"===n)("label",a.i18n.general.description)}}function mf(e,t){if(1&e&&(P.Ob(0),P.Bc(1,df,1,2,"textarea-field",62),P.Nb()),2&e){var n=t.ngIf;P.xb(1),P.gc("ngIf","disabled"!==n)}}var gf,pf,hf=[Ga.a.FORBIDDEN,Ga.a.UNAUTHORIZED,Ga.a.NOT_FOUND],yf=((pf=function(e){s(n,e);var t=b(n);function n(e,a,i,r){var o;return c(this,n),(o=t.call(this,e)).bankingHelper=a,o.paymentsService=i,o.posService=r,o.availablePaymentTypes=new P.n,o.accountBalanceLabel$=new v.a(null),o.fixedDestination=!1,o.paymentTypes$=new v.a(null),o}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",(function(){return new Map})),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe(Object(_a.a)(),Object(Ka.a)(g.a.DEBOUNCE_TIME)).subscribe((function(){return e.fetchPaymentTypes()}))),this.addSub(this.form.get("account").valueChanges.pipe(Object(_a.a)(),Object(Ka.a)(g.a.DEBOUNCE_TIME)).subscribe((function(){return e.adjustPaymentTypes()}))),this.addSub(this.form.get("type").valueChanges.pipe(Object(_a.a)(),Object(Ka.a)(g.a.DEBOUNCE_TIME)).subscribe((function(t){return e.fetchPaymentTypeData(t)}))),this.addSub(this.layout.xxs$.subscribe((function(){return e.updateAccountBalanceLabel()}))),this.updateAccountBalanceLabel()}},{key:"updateAccountBalanceLabel",value:function(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}},{key:"fetchPaymentTypes",value:function(){var e=this;this.dataCache.clear(),this.fetchedPaymentTypes=null;var t=g.a.escapeNumeric(this.form.value.subject);""!==t&&this.errorHandler.requestWithCustomErrorHandler((function(n){(e.pos?e.posService.dataForReceivePayment({from:t,fields:["fromUser","paymentTypes","paymentTypeData"]}):e.paymentsService.dataForPerformPayment({owner:e.fromParam,to:t,fields:["toUser","paymentTypes","paymentTypeData"]})).pipe(Object(Mn.a)()).subscribe((function(t){e.setFetchedPaymentTypes(t)}),(function(t){if(e.allowPrincipal&&e.userField&&t.status===Ga.a.NOT_FOUND){var a=t.error;if("string"==typeof a)try{a=JSON.parse(a)}catch(r){a={}}var i=a.entityType;if(!Object(h.a)(i)&&i.endsWith("User"))return void e.userField.search()}hf.includes(t.status)||n(t)}))}))}},{key:"adjustPaymentTypes",value:function(){var e=this.form.value;if(0!==(e.subject||"").trim().length){var t=this.fetchedPaymentTypes||[];Object(h.h)(t)&&this.notification.error(this.i18n.transaction.noTypes);var n=t.filter((function(t){return t.from.id===e.account})),a=this.form.value.type,i=null;Object(h.h)(n)?i={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(n),n.find((function(e){return e.id===a}))||(a=n[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:a}),this.form.get("account").setErrors(i),this.form.get("account").markAsTouched(),Object(h.h)(a)||this.fetchPaymentTypeData(a),this.availablePaymentTypes.emit(n)}}},{key:"setFetchedPaymentTypes",value:function(e){this.userField&&(this.userField.user=this.pos?e.fromUser:e.toUser),this.fetchedPaymentTypes=e.paymentTypes;var t=e.paymentTypeData;t&&this.dataCache.set(t.id,t),this.adjustPaymentTypes()}},{key:"fetchPaymentTypeData",value:function(e){var t=this,n=this.form.value;if(!Object(h.h)(n.subject)&&!Object(h.h)(e)){var a=this.dataCache.get(e);a?this.setPaymentTypeData(a):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler((function(a){(t.pos?t.posService.dataForReceivePayment({from:n.subject,type:e,fields:["paymentTypeData"]}):t.paymentsService.dataForPerformPayment({owner:t.fromParam,to:n.subject,type:e,fields:["paymentTypeData"]})).pipe(Object(Mn.a)()).subscribe((function(e){t.setPaymentTypeData(e.paymentTypeData)}),(function(e){hf.includes(e.status)||a(e)}))})))}}},{key:"setPaymentTypeData",value:function(e){((this.paymentTypeData$.value||{}).id||null)!==((e||{}).id||null)&&(e&&(this.dataCache.set(e.id,e),Object(h.j)(this.amountField)),this.paymentTypeData$.next(e))}},{key:"fixedUsersList",get:function(){return!Object(h.h)(this.data.allowedUsers)}},{key:"allowQrCode",get:function(){return this.allowPrincipal&&this.data.allowScanQrCode}},{key:"allowPrincipal",get:function(){return!Object(h.h)(this.data.principalTypes)}},{key:"allowSearch",get:function(){return this.data.allowAutocomplete}},{key:"allowContacts",get:function(){return this.data.allowContacts}},{key:"singleAccount",get:function(){var e=this.data.accounts||[];return 1===e.length?e[0]:null}}]),n}(Z.a)).\u0275fac=function(e){return new(e||pf)(P.Kb(P.r),P.Kb(m.a),P.Kb(En.a),P.Kb($n.a))},pf.\u0275cmp=P.Eb({type:pf,selectors:[["payment-step-form"]],viewQuery:function(e,t){var n;1&e&&(P.Hc(Nb,!0),P.yc(Bb,!0)),2&e&&(P.pc(n=P.Yb())&&(t.userField=n.first),P.pc(n=P.Yb())&&(t.amountField=n.first))},inputs:{data:"data",pos:"pos",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[P.ub],decls:22,vars:29,consts:[[3,"formGroup"],["kind","field",3,"label",4,"ngIf"],[4,"ngIf","ngIfElse"],["multipleAccounts",""],["kind","field","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngSwitchCase"],[4,"ngSwitchCase"],[4,"ngIf"],["kind","field",3,"label"],[3,"user"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label",4,"ngIf"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label"],[1,"w-100","text-nowrap","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],["class","col-5 col-sm-4 col-md-7 pl-2 text-right text-xs-left font-weight-bold",3,"ngClass",4,"ngIf"],["separator",""],[1,"col-5","col-sm-4","col-md-7","pl-2","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["kind","fieldView",3,"label"],["formControlName","type","required","",3,"label"],["type",""],[3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsNow",3,"label"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","firstOccurrenceIsNow",3,"label"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(e,t){if(1&e&&(P.Ob(0,0),P.Bc(1,Ab,2,2,"label-value",1),P.Bc(2,Rb,2,1,"ng-container",2),P.Bc(3,jb,3,3,"ng-template",null,3,P.Cc),P.Bc(5,Yb,4,3,"label-value",4),P.Bc(6,Wb,2,2,"label-value",5),P.Bc(7,ef,4,4,"single-selection-field",6),P.ac(8,"async"),P.Lb(9,"decimal-field",7,8),P.Bc(11,tf,1,2,"custom-field-input",9),P.ac(12,"async"),P.Bc(13,cf,5,5,"single-selection-field",10),P.ac(14,"async"),P.ac(15,"async"),P.Ob(16,11),P.Bc(17,of,1,1,"date-field",12),P.Bc(18,sf,6,7,"ng-container",13),P.Bc(19,ff,9,12,"ng-container",13),P.Nb(),P.Bc(20,mf,2,1,"ng-container",14),P.ac(21,"async"),P.Nb()),2&e){var n,a,i,r=P.qc(4),c=null;P.gc("formGroup",t.form),P.xb(1),P.gc("ngIf",t.fromUser&&!t.fromSelf),P.xb(1),P.gc("ngIf",t.singleAccount)("ngIfElse",r),P.xb(3),P.gc("ngIf",!t.fixedDestination),P.xb(1),P.gc("ngIf",t.fixedDestination&&t.toUser),P.xb(1),P.gc("ngIf",(null==(n=P.bc(8,19,t.paymentTypes$))?null:n.length)>1),P.xb(2),P.gc("focused",t.fixedDestination)("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix),P.xb(2),P.gc("ngForOf",null==(a=P.bc(12,21,t.paymentTypeData$))?null:a.customFields),P.xb(2),P.gc("ngIf",(null==(c=P.bc(14,23,t.paymentTypeData$))?null:c.allowsRecurringPayments)||(null==(c=P.bc(15,25,t.paymentTypeData$))?null:c.maxInstallments)>0),P.xb(3),P.gc("ngSwitch",t.form.value.scheduling),P.xb(1),P.gc("ngSwitchCase","futureDate"),P.xb(1),P.gc("ngSwitchCase","scheduled"),P.xb(1),P.gc("ngSwitchCase","recurring"),P.xb(1),P.gc("ngIf",(null==(i=P.bc(21,27,t.paymentTypeData$))?null:i.descriptionAvailability)||"disabled")}},directives:[I.w,I.n,k.t,A.a,I.v,I.l,I.D,ra.a,k.s,k.x,k.y,F.a,T.a,k.q,Xa.a,I.A,I.e,S.a,O.a,$.a,Ya.a,I.k,B.a,E.a,Wa.a,ei.a,Qt.a],pipes:[k.b,M.a],encapsulation:2,changeDetection:0}),pf),vf=((gf=function(e){s(n,e);var t=b(n);function n(e,a){var i;return c(this,n),(i=t.call(this,e)).receiveQrPayment=a,i}return l(n,[{key:"ngOnInit",value:function(){var e=this;r(d(n.prototype),"ngOnInit",this).call(this),this.payment.authorizationStatus===u.yb.PENDING?(this.icon="scheduled",this.message=this.payment.transactionNumber?this.i18n.transaction.pendingWithNumber(this.payment.transactionNumber):this.i18n.transaction.pending):(this.icon="done",this.message=this.payment.transactionNumber?this.i18n.transaction.processedWithNumber(this.payment.transactionNumber):this.i18n.transaction.processed),this.addShortcut(ea.k,(function(){return e.receiveQrPayment.viewPerformed()}))}}]),n}(Z.a)).\u0275fac=function(e){return new(e||gf)(P.Kb(P.r),P.Kb(zi))},gf.\u0275cmp=P.Eb({type:gf,selectors:[["receive-qr-payment-step-done"]],inputs:{payment:"payment"},features:[P.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4","positive"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(P.Qb(0,"div",0),P.Qb(1,"div",1),P.Qb(2,"div",2),P.Lb(3,"icon",3),P.Pb(),P.Qb(4,"div",4),P.Dc(5),P.Pb(),P.Pb(),P.Pb()),2&e&&(P.xb(3),P.gc("icon",t.icon),P.xb(2),P.Ec(t.message))},directives:[Ra.a],encapsulation:2,changeDetection:0}),gf),xf=["amount"];function Pf(e,t){if(1&e&&P.Lb(0,"field-option",8),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.type.name)}}function Df(e,t){if(1&e&&(P.Qb(0,"radio-group-field",6),P.Bc(1,Pf,1,2,"field-option",7),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.toAccount),P.xb(1),P.gc("ngForOf",n.data.accounts)}}function kf(e,t){if(1&e&&P.Lb(0,"field-option",8),2&e){var n=t.$implicit;P.gc("value",n.id)("text",n.name)}}function Lf(e,t){if(1&e&&(P.Qb(0,"single-selection-field",9),P.Bc(1,kf,1,2,"field-option",7),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.type),P.xb(1),P.gc("ngForOf",n.transferTypes)}}function wf(e,t){if(1&e&&P.Lb(0,"custom-field-input",11),2&e){var n=t.$implicit;P.gc("formControlName",n.internalName)("field",n)}}function Cf(e,t){if(1&e&&(P.Ob(0,0),P.Bc(1,wf,1,2,"custom-field-input",10),P.Nb()),2&e){var n=P.Zb();P.gc("formGroup",n.form.controls.customValues),P.xb(1),P.gc("ngForOf",n.typeData.customFields)}}function Qf(e,t){if(1&e&&P.Lb(0,"textarea-field",12),2&e){var n=P.Zb();P.gc("label",n.i18n.general.description)("required","required"===(null==n.typeData?null:n.typeData.descriptionAvailability))}}var If,Ff=((If=function(e){s(n,e);var t=b(n);function n(e){return c(this,n),t.call(this,e)}return l(n,[{key:"singleAccount",get:function(){return 1===this.data.accounts.length}},{key:"currency",get:function(){return null==this.typeData?null:this.typeData.currency}}]),n}(Z.a)).\u0275fac=function(e){return new(e||If)(P.Kb(P.r))},If.\u0275cmp=P.Eb({type:If,selectors:[["receive-qr-payment-step-form"]],viewQuery:function(e,t){var n;1&e&&P.yc(xf,!0),2&e&&P.pc(n=P.Yb())&&(t.amountField=n.first)},inputs:{data:"data",form:"form",transferTypes:"transferTypes",type:"type",typeData:"typeData"},features:[P.ub],decls:6,vars:9,consts:[[3,"formGroup"],["formControlName","account","required","","asColumn","",3,"label",4,"ngIf"],["formControlName","type",3,"label",4,"ngIf"],["formControlName","amount","focused","","required","",3,"label","prefix","suffix","scale"],[3,"formGroup",4,"ngIf"],["formControlName","description",3,"label","required",4,"ngIf"],["formControlName","account","required","","asColumn","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","type",3,"label"],[3,"formControlName","field",4,"ngFor","ngForOf"],[3,"formControlName","field"],["formControlName","description",3,"label","required"]],template:function(e,t){1&e&&(P.Ob(0,0),P.Bc(1,Df,2,2,"radio-group-field",1),P.Bc(2,Lf,2,2,"single-selection-field",2),P.Lb(3,"decimal-field",3),P.Bc(4,Cf,2,2,"ng-container",4),P.Bc(5,Qf,1,2,"textarea-field",5),P.Nb()),2&e&&(P.gc("formGroup",t.form),P.xb(1),P.gc("ngIf",!t.singleAccount),P.xb(1),P.gc("ngIf",(null==t.transferTypes?null:t.transferTypes.length)>1),P.xb(1),P.gc("label",t.i18n.transaction.amount)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix)("scale",null==t.currency?null:t.currency.decimalDigits),P.xb(1),P.gc("ngIf",(null==t.typeData||null==t.typeData.customFields?null:t.typeData.customFields.length)>0),P.xb(1),P.gc("ngIf","disabled"!==(null==t.typeData?null:t.typeData.descriptionAvailability)))},directives:[I.w,I.n,k.t,A.a,I.v,I.l,ra.a,I.D,ei.a,k.s,O.a,S.a,Ya.a,Qt.a],encapsulation:2,changeDetection:0}),If);function Tf(e,t){if(1&e){var n=P.Rb();P.Qb(0,"button",10),P.Xb("click",(function(){return P.sc(n),P.Zb(2).copyUrl()})),P.Lb(1,"icon",11),P.Pb()}if(2&e){var a=P.Zb(2);P.gc("tooltip",a.i18n.general.copyToClipboard)}}function Sf(e,t){if(1&e&&(P.Qb(0,"label-value",3),P.Qb(1,"div",8),P.Dc(2),P.Pb(),P.Bc(3,Tf,2,1,"button",9),P.Pb()),2&e){var n=P.Zb();P.gc("label",n.i18n.transaction.ticketShareUrl),P.xb(2),P.Ec(n.ticket.approveUrl)}}var Of,Nf,Bf=((Of=function(e){s(n,e);var t=b(n);function n(e){var a;return c(this,n),(a=t.call(this,e)).supportsShare=Object(h.C)(),a}return l(n,[{key:"copyUrl",value:function(){Object(h.f)(this.ticket.approveUrl),this.notification.snackBar(this.i18n.general.copyToClipboardDone)}}]),n}(Z.a)).\u0275fac=function(e){return new(e||Of)(P.Kb(P.r))},Of.\u0275cmp=P.Eb({type:Of,selectors:[["receive-qr-payment-step-pending"]],inputs:{ticket:"ticket",qrCodeUrl:"qrCodeUrl"},features:[P.ub],decls:10,vars:9,consts:[[1,"d-flex","justify-content-center","align-items-center"],[1,"mb-3",3,"src"],[3,"label","value"],[3,"label"],[1,"d-flex"],[1,"flex-grow-1"],["bootstrap","","size","1.5rem",1,"p-0","ml-2"],[3,"label",4,"ngIf"],[1,"w-100"],["class","btn btn-icon","type","button",3,"tooltip","click",4,"extraCell"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],["icon","link"]],template:function(e,t){1&e&&(P.Qb(0,"div",0),P.Lb(1,"img",1),P.ac(2,"trust"),P.Pb(),P.Lb(3,"label-value",2),P.Qb(4,"label-value",3),P.Qb(5,"div",4),P.Qb(6,"div",5),P.Dc(7),P.Pb(),P.Lb(8,"spinner",6),P.Pb(),P.Pb(),P.Bc(9,Sf,4,2,"label-value",7)),2&e&&(P.xb(1),P.gc("src",P.cc(2,6,t.qrCodeUrl,"url"),P.uc),P.xb(2),P.gc("label",t.i18n.transaction.amount)("value",t.format.formatAsCurrency(t.ticket.currency,t.ticket.amount)),P.xb(1),P.gc("label",t.i18n.general.status),P.xb(3),P.Ec(t.i18n.transaction.status.pending),P.xb(2),P.gc("ngIf",!t.supportsShare))},directives:[F.a,Y.a,k.t,Ml.a,ta.b,Ra.a],pipes:[Gs.a],encapsulation:2,changeDetection:0}),Of),Af=o("Se2V"),Ef=o("CNMR"),$f=o("aHM3"),Rf=o("6No5"),Zf=o("38Bd"),Mf=o("p4Ho"),Hf=o("FE24"),qf=o("GTjh"),Uf=o("7Ub2"),Vf=o("yThH"),jf=o("vdzA"),zf=o("o/nJ"),Gf=o("AH7H"),_f=o("lrfU"),Kf=o("aVfl"),Xf=o("G1xJ"),Yf=o("VpKs"),Wf=o("yk18"),Jf=o("nGVv"),ed=o("559x"),td=o("0C6t"),nd=o("z332"),ad=o("pz1b"),id=o("bER3"),rd=o("ZJXG"),cd=o("wUcZ"),od=o("yRWz"),ld=o("/edM"),sd=o("vHbw"),ud=o("USuC"),bd=o("Y49Y"),fd=o("2V/7"),dd=o("HZ9B"),md=o("g9Ug"),gd=o("jOM4"),pd=o("DFH8"),hd=o("csas"),yd=o("p60g"),vd=o("8pf7"),xd=o("UnhA"),Pd=o("N7zh"),Dd=o("sGzL"),kd=o("eNTF"),Ld=o("Kiu2"),wd=o("vOpc"),Cd=o("T6RQ"),Qd=o("U4Kh"),Id=o("ugYG"),Fd=o("MNyf"),Td=o("CyT4"),Sd=o("x741"),Od=o("BTg0"),Nd=o("BUNh"),Bd=o("podT"),Ad=o("oOvo"),Ed=o("L/K/"),$d=o("7nZW"),Rd=o("9uOH"),Zd=o("dCJh"),Md=o("g1uo"),Hd=o("cLCZ"),qd=o("kmyw"),Ud=o("/NTq"),Vd=((Nf=function e(){c(this,e)}).\u0275mod=P.Ib({type:Nf}),Nf.\u0275inj=P.Hb({factory:function(e){return new(e||Nf)},imports:[[eb,Af.a]]}),Nf);P.vc(Wn,[ee.j,ee.f,ee.h,ee.g,ee.k,k.q,k.r,k.s,k.t,k.A,k.w,k.x,k.y,k.z,k.u,k.v,I.I,I.x,I.H,I.e,I.y,I.B,I.b,I.E,I.F,I.A,I.v,I.w,I.D,I.r,I.q,I.z,I.c,I.f,I.k,I.n,I.l,I.o,I.h,Ef.a,Zl.c,Zl.d,$f.a,$f.b,$f.c,Rf.a,Rf.b,Zf.a,Zf.b,Mf.a,ta.b,Hf.b,Hf.d,Hf.a,qf.b,Uf.a,Vf.a,na.a,jf.a,Ra.a,zc.a,J.a,Y.a,wt.a,zf.a,ia.a,F.a,Ml.a,Gf.a,Dl.a,aa.a,Ja.a,E.a,_f.a,Kf.a,Xf.a,Yf.a,Wf.a,Qt.a,Xa.a,O.a,S.a,N.a,Jf.a,ei.a,ed.a,B.a,td.a,A.a,Ya.a,qe.a,He.a,nd.a,ad.a,id.a,rd.a,cd.a,od.a,ld.a,$.a,sd.a,ud.a,bd.a,fd.a,dd.a,md.a,Rl.a,gd.a,pd.a,hd.a,Ct.a,ra.a,Wa.a,R.a,yd.a,vd.a,xd.a,Pd.a,Dd.a,kd.a,Ld.a,T.a,St.a,wd.a,Cd.a,Qd.a,Id.a,Fd.a,Td.a,Ge.a,W.a,Sd.a,D.a,L.a,Od.a,Nd.a,Bd.a,w.a,Ad.a,Ed.a,Q.a,C.a,$d.a,Ze.a,Rd.a,Me.a,Re.a,Zd.a,Ee,X,ol,jc,vc,il,Pt,ze,Or,sc,lr,Fu,Oo,Wn,yf,Sb,Ob,zi,Ff,Bf,vf,$l,ds,ml,Pl,Il,as,fu,Fs,zs,Zs,Wu,Bu,$u,qu,rn,Tt,Et,Xt,An,sn,mn,In,Ei,Ti,Za,za,$a],[k.b,k.G,k.p,k.k,k.E,k.g,k.C,k.F,k.d,k.f,k.i,k.j,k.l,Gs.a,te.a,bc.a,Md.a,Hd.a,M.a,qd.a,Ud.a]),P.vc(zi,[ee.j,ee.f,ee.h,ee.g,ee.k,k.q,k.r,k.s,k.t,k.A,k.w,k.x,k.y,k.z,k.u,k.v,I.I,I.x,I.H,I.e,I.y,I.B,I.b,I.E,I.F,I.A,I.v,I.w,I.D,I.r,I.q,I.z,I.c,I.f,I.k,I.n,I.l,I.o,I.h,Ef.a,Zl.c,Zl.d,$f.a,$f.b,$f.c,Rf.a,Rf.b,Zf.a,Zf.b,Mf.a,ta.b,Hf.b,Hf.d,Hf.a,qf.b,Uf.a,Vf.a,na.a,jf.a,Ra.a,zc.a,J.a,Y.a,wt.a,zf.a,ia.a,F.a,Ml.a,Gf.a,Dl.a,aa.a,Ja.a,E.a,_f.a,Kf.a,Xf.a,Yf.a,Wf.a,Qt.a,Xa.a,O.a,S.a,N.a,Jf.a,ei.a,ed.a,B.a,td.a,A.a,Ya.a,qe.a,He.a,nd.a,ad.a,id.a,rd.a,cd.a,od.a,ld.a,$.a,sd.a,ud.a,bd.a,fd.a,dd.a,md.a,Rl.a,gd.a,pd.a,hd.a,Ct.a,ra.a,Wa.a,R.a,yd.a,vd.a,xd.a,Pd.a,Dd.a,kd.a,Ld.a,T.a,St.a,wd.a,Cd.a,Qd.a,Id.a,Fd.a,Td.a,Ge.a,W.a,Sd.a,D.a,L.a,Od.a,Nd.a,Bd.a,w.a,Ad.a,Ed.a,Q.a,C.a,$d.a,Ze.a,Rd.a,Me.a,Re.a,Zd.a,Ee,X,ol,jc,vc,il,Pt,ze,Or,sc,lr,Fu,Oo,Wn,yf,Sb,Ob,zi,Ff,Bf,vf,$l,ds,ml,Pl,Il,as,fu,Fs,zs,Zs,Wu,Bu,$u,qu,rn,Tt,Et,Xt,An,sn,mn,In,Ei,Ti,Za,za,$a],[k.b,k.G,k.p,k.k,k.E,k.g,k.C,k.F,k.d,k.f,k.i,k.j,k.l,Gs.a,te.a,bc.a,Md.a,Hd.a,M.a,qd.a,Ud.a])},v4xg:function(e,n,a){"use strict";a.d(n,"a",(function(){return P}));var i=a("s7LF"),o=a("mwYl"),u=a("tAww"),f=a("rCAV"),m=a("uuU0"),g=a("Ky6R"),p=a("TFmz"),h=a("Muja"),y=a("2Vo4"),v=a("Kj3r"),x=a("8Y7J"),P=function(){var e=function(e){s(a,e);var n=b(a);function a(e){var r;c(this,a),(r=n.call(this,e)).ResultType=p.a,r.resultType$=new y.a(null),r.resultTypeControl=new i.j(null),r.results$=new y.a(null),r.allowedResultTypes$=new y.a([p.a.LIST]),r.rendering$=new y.a(!1),r.moreFilters$=new y.a(!1),r.ignoreNextUpdate=!1,r.nextRequestState=e.get(o.a);var l={page:0};l.resultType=r.getInitialResultType();var s,u=t(r.getFormControlNames()||[]);try{for(u.s();!(s=u.n()).done;){l[s.value]=null}}catch(b){u.e(b)}finally{u.f()}return r.form=r.formBuilder.group(l),r}return l(a,[{key:"getInitialFormValue",value:function(e){return e.query||{}}},{key:"onDataInitialized",value:function(e){var t=this;this.form.patchValue(this.getInitialFormValue(e)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe((function(e){var n=t.previousResultType;t.previousResultType=e,t.resultType$.next(e),t.shouldUpdateOnResultTypeChange(e,n)&&t.update(),null!=n&&n===e||(t.rendering=!0,t.stateManager.set("resultType",e),t.onResultTypeChanged(e,n))}))),setTimeout((function(){t.addSub(t.form.valueChanges.pipe(Object(v.a)(f.a.DEBOUNCE_TIME)).subscribe((function(e){t.shouldUpdateOnChange(e)&&t.update(),t.previousValue=e})),!0),t.previousResultType!==p.a.CATEGORIES&&t.update()}),1)}},{key:"shouldUpdateOnResultTypeChange",value:function(e,t){return e!==p.a.CATEGORIES&&([p.a.LIST,p.a.TILES].includes(t)!==[p.a.LIST,p.a.TILES].includes(e)||t===p.a.MAP!=(e===p.a.MAP))}},{key:"shouldUpdateOnChange",value:function(e){return!Object(h.a)(this.previousValue,e)}},{key:"ngOnInit",value:function(){r(d(a.prototype),"ngOnInit",this).call(this),this.resultType=this.getInitialResultType()}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.showMoreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.showLessFilters}},{key:"showMoreFiltersIcon",value:function(){return"filter_list"}},{key:"showLessFiltersIcon",value:function(){return"filter_list"}},{key:"onResultTypeChanged",value:function(e,t){}},{key:"getInitialResultType",value:function(){return p.a.LIST}},{key:"update",value:function(e){var t=this;if(!this.ignoreNextUpdate){e&&(this.form.patchValue(e,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;var n=this.form.value;n.pageSize=this.uiLayout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(n)).subscribe((function(e){t.resultType===p.a.CATEGORIES&&(t.resultType=t.allowedResultTypes.find((function(e){return e!==p.a.CATEGORIES}))),t.results=g.a.from(e)})))}}},{key:"resetPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.form.patchValue({page:0},{emitEvent:e})}},{key:"doIgnoringUpdate",value:function(e){this.ignoreNextUpdate=!0;try{e()}finally{this.ignoreNextUpdate=!1}}},{key:"results",get:function(){return this.results$.value},set:function(e){this.results$.next(e)}},{key:"rendering",get:function(){return this.rendering$.value},set:function(e){this.rendering$.next(e)}},{key:"allowedResultTypes",get:function(){return this.allowedResultTypes$.value},set:function(e){this.allowedResultTypes$.next(e)}},{key:"moreFilters",get:function(){return this.moreFilters$.value},set:function(e){this.moreFilters$.next(e)}},{key:"pageData",get:function(){var e=this.form.value;return{page:e.page,pageSize:e.pageSize}},set:function(e){this.form.patchValue(e)}},{key:"resultType",get:function(){return this.resultTypeControl.value},set:function(e){null==e&&(e=this.getInitialResultType()),this.resultTypeControl.setValue(e)}},{key:"moreFiltersAction",get:function(){var e=this;return this._moreFiltersAction||(this._moreFiltersAction=new u.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),(function(){e.moreFilters=!e.moreFilters,e._moreFiltersAction.icon=e.moreFilters?e.showLessFiltersIcon():e.showMoreFiltersIcon(),e._moreFiltersAction.label=e.moreFilters?e.showLessFiltersLabel():e.showMoreFiltersLabel()}),!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}}]),a}(m.a);return e.\u0275fac=function(t){return new(t||e)(x.Kb(x.r))},e.\u0275dir=x.Fb({type:e,features:[x.ub]}),e}()}}])}();