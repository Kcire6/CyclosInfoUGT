(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{oBd1:function(e,t,n){"use strict";n.r(t),n.d(t,"BankingModule",(function(){return Rd}));var i=n("XDzf"),a=n("VeBv"),c=n("t+Rn"),r=n("rCAV"),o=n("v4xg"),s=n("ObUu"),l=n("QH++"),u=n("2Vo4"),b=n("vkgz"),d=n("8Y7J"),m=n("3qho"),f=n("SVse"),g=n("I0FJ"),p=n("Zilp"),h=n("IbGL"),y=n("Ae/X"),x=n("s7LF"),v=n("JFlR"),P=n("Ls5z"),D=n("WYBn"),L=n("chz4"),w=n("4APx"),C=n("6g1M"),Q=n("iXUt"),I=n("DIHi"),F=n("JbOn"),T=n("Aw04"),S=n("qCwG"),O=n("I9hm");function N(e,t){1&e&&d.Lb(0,"hr",7)}function k(e,t){if(1&e&&(d.Qb(0,"div",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.Fc(" ",e.account.type.name," ")}}function B(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",9),d.Dc(2),d.Pb(),d.Qb(3,"div",10),d.Lb(4,"user-link",11),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.Fc(" ",e.i18n.general.user," "),d.xb(2),d.gc("user",e.account.user)}}function A(e,t){1&e&&d.Lb(0,"hr")}function E(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.ac(2,"currency"),d.Nb()),2&e){const e=d.Zb().$implicit,t=d.Zb(2);d.xb(1),d.Fc(" ",d.cc(2,1,e.amount,t.currency)," ")}}const $=function(e,t,n){return{negative:e,positive:t,"status-value-last":n}};function R(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",12),d.Qb(2,"span",13),d.Dc(3),d.Pb(),d.Pb(),d.Qb(4,"div",14),d.Bc(5,E,3,4,"ng-container",5),d.Pb(),d.Nb()),2&e){const e=t.$implicit,n=t.last,i=d.Zb(2);d.xb(1),d.gc("ngClass",n?"status-label-last":""),d.xb(2),d.Ec(e.label),d.xb(1),d.gc("ngClass",d.lc(4,$,e.alwaysNegative||i.format.isNegative(e.amount),!e.alwaysNegative&&i.format.isPositive(e.amount),n)),d.xb(1),d.gc("ngIf",e.amount)}}function Z(e,t){if(1&e&&(d.Qb(0,"div",1),d.Bc(1,N,1,0,"hr",2),d.Qb(2,"div",3),d.Bc(3,k,2,1,"div",4),d.Bc(4,B,5,2,"ng-container",5),d.Bc(5,A,1,0,"hr",5),d.Bc(6,R,6,8,"ng-container",6),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",e.showSeparator),d.xb(2),d.gc("ngIf",e.showAccount),d.xb(1),d.gc("ngIf",e.account.user&&e.showUser),d.xb(1),d.gc("ngIf",e.showAccount||e.account.user&&e.showUser),d.xb(1),d.gc("ngForOf",e.indicators$.value)}}let M=(()=>{class e extends S.a{constructor(e){super(e),this.mode="current",this._showAccount=!1,this._showUser=!1,this._showSeparator=!1,this.indicators$=new u.a(null)}get showAccount(){return this._showAccount}set showAccount(e){this._showAccount=Object(s.E)(e)}get showUser(){return this._showUser}set showUser(e){this._showUser=Object(s.E)(e)}get showSeparator(){return this._showSeparator}set showSeparator(e){this._showSeparator=Object(s.E)(e)}ngOnInit(){this.updateIndicators()}get status(){return this.account.status}get currency(){return this.account.currency}updateIndicators(){const e=[],t=this.status,n=(t,n,i=!1)=>{t&&e.push({label:n,amount:t,alwaysNegative:!this.format.isZero(t)&&i})};if("current"===this.mode)n(t.balance,this.i18n.account.balance),t.availableBalance!==t.balance&&n(t.availableBalance,this.i18n.account.availableBalance),t.reservedAmount&&!this.format.isZero(t.reservedAmount)&&n(t.reservedAmount,this.i18n.account.reservedAmount,!0),t.creditLimit&&!this.format.isZero(t.creditLimit)&&n(t.creditLimit,this.i18n.account.negativeLimit),t.upperCreditLimit&&!this.format.isZero(t.upperCreditLimit)&&n(t.upperCreditLimit,this.i18n.account.positiveLimit);else{if(this.layout.gtxxs&&null!=t.balanceAtBegin&&n(t.balanceAtBegin,this.i18n.account.balanceOn(this.format.formatAsDate(t.beginDate))),this.layout.gtxxs&&null!=t.balanceAtEnd&&n(t.balanceAtEnd,this.i18n.account.balanceOn(this.format.formatAsDate(t.endDate))),null!=t.incoming&&t.incoming.sum&&n(t.incoming.sum,this.i18n.account.totalIncome),null!=t.outgoing&&t.outgoing.sum){let e=t.outgoing.sum;this.format.isZero(e)||(e="-"+e),n(e,this.i18n.account.totalOutflow)}null!=t.netInflow&&n(t.netInflow,this.i18n.account.netInflow)}this.indicators$.next(e)}ngOnChanges(e){(e.mode||e.account||e.showAccount)&&this.updateIndicators()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["account-status-view"]],inputs:{account:"account",mode:"mode",showAccount:"showAccount",showUser:"showUser",showSeparator:"showSeparator"},features:[d.ub,d.vb],decls:2,vars:3,consts:[["class","container mw-100 px-0",4,"ngIf"],[1,"container","mw-100","px-0"],["class","mt-0",4,"ngIf"],[1,"row","no-gutters"],["class","status-label col-12",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"mt-0"],[1,"status-label","col-12"],[1,"status-label","col-6","col-md-3","mb-0"],[1,"status-label","col-6","col-md-9","mb-0"],[3,"user"],[1,"status-label","col-6","col-sm-3",3,"ngClass"],[1,"ellipsis"],[1,"status-value","col-6","col-sm-3",3,"ngClass"]],template:function(e,t){var n;1&e&&(d.Bc(0,Z,7,5,"div",0),d.ac(1,"async")),2&e&&d.gc("ngIf",(null==(n=d.bc(1,1,t.indicators$))?null:n.length)>0)},directives:[f.t,f.s,P.a,f.q],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();var H=n("oj/z"),q=n("iM3x"),U=n("sifq"),V=n("iInd"),z=n("yL40");function j(e,t){1&e&&d.Mb(0)}function G(e,t){1&e&&d.Lb(0,"div",15)}function _(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",15),d.Qb(2,"label-value",16),d.Lb(3,"user-link",17),d.Pb(),d.Pb(),d.Bc(4,G,1,0,"div",12),d.Nb()),2&e){const e=d.Zb(3);d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.account.user),d.xb(1),d.gc("ngIf",e.layout.gtsm$)}}function K(e,t){if(1&e&&d.Lb(0,"field-option",20),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e)("text",e.name)}}function X(e,t){if(1&e&&(d.Qb(0,"div",15),d.Qb(1,"single-selection-field",18),d.Bc(2,K,1,3,"field-option",19),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.general.period),d.xb(1),d.gc("ngForOf",e.data.preselectedPeriods)}}function Y(e,t){if(1&e&&d.Lb(0,"field-option",20),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e.id)("text",e.name)}}function W(e,t){if(1&e&&(d.Qb(0,"div",15),d.Qb(1,"multi-selection-field",21),d.Bc(2,Y,1,3,"field-option",19),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.account.transferFilter),d.xb(1),d.gc("ngForOf",e.data.transferFilters)}}function J(e,t){1&e&&d.Lb(0,"div",15)}function ee(e,t){if(1&e&&d.Bc(0,J,1,0,"div",12),2&e){const e=d.Zb(3);d.gc("ngIf",e.layout.gtsm$)}}function te(e,t){if(1&e&&(d.Qb(0,"div",15),d.Lb(1,"date-field",22),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.general.beginDate)}}function ne(e,t){if(1&e&&(d.Qb(0,"div",15),d.Lb(1,"date-field",23),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.general.endDate)}}function ie(e,t){if(1&e&&d.Lb(0,"field-option",38),2&e){const e=t.$implicit,n=d.Zb(5);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function ae(e,t){if(1&e&&(d.Qb(0,"div",15),d.Qb(1,"multi-selection-field",36),d.Bc(2,ie,1,5,"field-option",37),d.Pb(),d.Pb()),2&e){const e=d.Zb(4);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.groupFilter),d.xb(1),d.gc("ngForOf",e.data.groups)}}function ce(e,t){if(1&e&&d.Lb(0,"field-option",41),2&e){const e=t.$implicit;d.gc("id",e.id)("internalName",e.internalName)("value",e.internalName)("text",e.name)}}function re(e,t){if(1&e&&(d.Qb(0,"div",15),d.Qb(1,"multi-selection-field",39),d.Bc(2,ce,1,4,"field-option",40),d.Pb(),d.Pb()),2&e){const e=d.Zb(4);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.transaction.channel),d.xb(1),d.gc("ngForOf",e.data.channels)}}function oe(e,t){if(1&e&&(d.Qb(0,"div",15),d.Lb(1,"input-field",42),d.Pb()),2&e){const e=d.Zb(4);d.xb(1),d.gc("mask",e.data.transactionNumberMask)("label",e.i18n.transaction.number)}}function se(e,t){if(1&e&&d.Lb(0,"field-option",45),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.display)}}function le(e,t){if(1&e&&(d.Qb(0,"div",15),d.Qb(1,"single-selection-field",43),d.Bc(2,se,1,2,"field-option",44),d.Pb(),d.Pb()),2&e){const e=d.Zb(4);d.xb(1),d.gc("label",e.i18n.general.operator)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.data.operators)}}function ue(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",15),d.Lb(2,"decimal-field",24),d.Pb(),d.Qb(3,"div",15),d.Lb(4,"decimal-field",25),d.Pb(),d.Qb(5,"div",15),d.Lb(6,"input-field",26),d.Pb(),d.Qb(7,"div",15),d.Qb(8,"single-selection-field",27),d.Lb(9,"field-option",28),d.Lb(10,"field-option",29),d.Pb(),d.Pb(),d.Bc(11,ae,3,3,"div",12),d.Bc(12,re,3,3,"div",12),d.Qb(13,"div",15),d.Lb(14,"user-field",30),d.Pb(),d.Bc(15,oe,2,2,"div",12),d.Bc(16,le,3,3,"div",12),d.Qb(17,"div",15),d.Qb(18,"single-selection-field",31),d.Lb(19,"field-option",32),d.Lb(20,"field-option",33),d.Lb(21,"field-option",34),d.Lb(22,"field-option",35),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(2),d.gc("label",e.i18n.account.minAmount)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("scale",e.currency.decimalDigits),d.xb(2),d.gc("label",e.i18n.account.maxAmount)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("scale",e.currency.decimalDigits),d.xb(2),d.gc("label",e.i18n.general.description),d.xb(2),d.gc("label",e.i18n.account.direction)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("text",e.i18n.account.incoming),d.xb(1),d.gc("text",e.i18n.account.outgoing),d.xb(1),d.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),d.xb(1),d.gc("ngIf",(null==e.data.channels?null:e.data.channels.length)>1),d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("ngIf",e.data.transactionNumberMask),d.xb(1),d.gc("ngIf",(null==e.data.operators?null:e.data.operators.length)>0),d.xb(2),d.gc("label",e.i18n.general.orderBy),d.xb(1),d.gc("text",e.i18n.account.orderBy.dateDesc),d.xb(1),d.gc("text",e.i18n.account.orderBy.dateAsc),d.xb(1),d.gc("text",e.i18n.account.orderBy.amountAsc),d.xb(1),d.gc("text",e.i18n.account.orderBy.amountDesc)}}const be=function(e){return{"border-0":e}};function de(e,t){if(1&e&&(d.Qb(0,"form",10),d.ac(1,"async"),d.Qb(2,"div",11),d.Bc(3,_,5,3,"ng-container",6),d.Bc(4,X,3,2,"div",12),d.Bc(5,W,3,2,"div",13),d.ac(6,"async"),d.Bc(7,ee,1,1,"ng-template",null,14,d.Cc),d.Bc(9,te,2,1,"div",12),d.ac(10,"async"),d.Bc(11,ne,2,1,"div",12),d.ac(12,"async"),d.Bc(13,ue,23,23,"ng-container",6),d.ac(14,"async"),d.Pb(),d.Pb()),2&e){const e=d.qc(8),t=d.Zb(2);var n,i;d.gc("formGroup",t.form)("ngClass",d.jc(19,be,d.bc(1,9,t.noStatus$))),d.xb(3),d.gc("ngIf",t.data.account.user&&!t.self),d.xb(1),d.gc("ngIf",(null==t.data.preselectedPeriods?null:t.data.preselectedPeriods.length)>1),d.xb(1),d.gc("ngIf",d.bc(6,11,t.layout.gtxxs$)&&(null==t.data.transferFilters?null:t.data.transferFilters.length)>1)("ngIfElse",e),d.xb(4),d.gc("ngIf",null==(null==(n=t.form.value||d.bc(10,13,t.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),d.xb(2),d.gc("ngIf",null==(null==(i=t.form.value||d.bc(12,15,t.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end)),d.xb(2),d.gc("ngIf",d.bc(14,17,t.layout.gtxxs$))}}function me(e,t){if(1&e&&(d.Lb(0,"account-status-view",47),d.ac(1,"async"),d.ac(2,"async"),d.ac(3,"async"),d.ac(4,"async")),2&e){const e=d.Zb(3);d.gc("account",e.status$.value)("mode",d.bc(1,5,e.moreFilters$)?"period":"current")("showSeparator",d.bc(2,7,e.showForm$))("showAccount",d.bc(3,9,e.layout.ltsm$)&&e.multipleAccounts)("showUser",!e.self&&!1===d.bc(4,11,e.showForm$))}}function fe(e,t){1&e&&d.Lb(0,"spinner")}function ge(e,t){if(1&e&&(d.Ob(0),d.Bc(1,me,5,13,"account-status-view",46),d.ac(2,"async"),d.ac(3,"async"),d.Bc(4,fe,1,0,"spinner",6),d.ac(5,"async"),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngIf",d.bc(2,2,e.status$)&&(d.bc(3,4,e.layout.gtxxs$)||0===(null==e.results?null:e.results.page))),d.xb(3),d.gc("ngIf",null===d.bc(5,6,e.status$))}}function pe(e,t){if(1&e&&(d.Qb(0,"mobile-result",48),d.Qb(1,"div",49),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("avatarImage",n.avatarImage(e))("avatarIcon",n.avatarIcon(e))("date",e.date)("amount",e.amount)("currency",n.currency),d.xb(2),d.Fc(" ",n.subjectName(e)," ")}}function he(e,t){if(1&e&&(d.Qb(0,"th",55),d.Dc(1),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.Ec(e.i18n.general.description)}}function ye(e,t){if(1&e&&(d.Qb(0,"a",61),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2).$implicit,t=d.Zb(3);d.gc("routerLink",t.path(e)),d.xb(1),d.Fc(" ",e.description," ")}}function xe(e,t){if(1&e&&(d.Qb(0,"td"),d.Bc(1,ye,2,2,"a",60),d.Pb()),2&e){const e=d.Zb().$implicit;d.xb(1),d.gc("ngIf",e.description)}}const ve=function(e,t){return{positive:e,negative:t}};function Pe(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",56),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.path(n))})),d.Qb(2,"td",51),d.Lb(3,"avatar",57),d.Pb(),d.Qb(4,"td"),d.Qb(5,"a",58),d.Dc(6),d.ac(7,"date"),d.Pb(),d.Pb(),d.Qb(8,"td"),d.Qb(9,"a",58),d.Dc(10),d.Pb(),d.Pb(),d.Bc(11,xe,2,1,"td",6),d.ac(12,"async"),d.Qb(13,"td",53),d.Qb(14,"a",59),d.Dc(15),d.ac(16,"currency"),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.gc("image",n.avatarImage(e))("icon",n.avatarIcon(e)),d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",d.bc(7,10,e.date)," "),d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",n.subjectName(e)," "),d.xb(1),d.gc("ngIf",d.bc(12,12,n.layout.gtsm$)),d.xb(3),d.gc("routerLink",n.path(e))("ngClass",d.kc(18,ve,n.format.isPositive(e.amount),n.format.isNegative(e.amount))),d.xb(1),d.Fc(" ",d.dc(16,14,e.amount,n.currency,!0)," ")}}function De(e,t){if(1&e&&(d.Qb(0,"table",50),d.Qb(1,"thead"),d.Lb(2,"th",51),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Bc(7,he,2,1,"th",52),d.ac(8,"async"),d.Qb(9,"th",53),d.Dc(10),d.Pb(),d.Pb(),d.Qb(11,"tbody"),d.Bc(12,Pe,17,21,"ng-container",54),d.ac(13,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(4),d.Ec(e.i18n.general.date),d.xb(2),d.Ec(e.i18n.transaction.fromTo),d.xb(1),d.gc("ngIf",d.bc(8,5,e.layout.gtsm$)),d.xb(3),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(13,7,e.results$))?null:n.results)}}function Le(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",4),d.ac(1,"async"),d.Bc(2,de,15,21,"form",5),d.ac(3,"async"),d.Bc(4,ge,6,8,"ng-container",6),d.ac(5,"async"),d.Pb(),d.Qb(6,"results-layout",7),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(7,"async"),d.Bc(8,pe,3,6,"mobile-result",8),d.Bc(9,De,14,9,"table",9),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.title)("mobileHeading",e.i18n.account.mobileTitle)("headingActions",d.bc(1,8,e.headingActions$)),d.xb(2),d.gc("ngIf",d.bc(3,10,e.showForm$)),d.xb(2),d.gc("ngIf",!1===d.bc(5,12,e.noStatus$)),d.xb(2),d.gc("results",d.bc(7,14,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}function we(e,t){1&e&&d.Lb(0,"spinner",62)}let Ce=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.accountsService=t,this.bankingHelper=n,this.status$=new u.a(null),this.noStatus$=new u.a(!1),this.showForm$=new u.a(!1)}get type(){return null==this.data?null:this.data.account.type}get number(){return null==this.data?null:this.data.account.number}get currency(){return null==this.data?null:this.data.account.currency}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}get transferFilters(){return null==this.data?null:this.data.transferFilters}get title(){const e=this.type;if(null==e)return null;const t=this.layout.ltsm?null:this.number;return null==t?e.name:e.name+" - "+t}getFormControlNames(){return["transferFilters","preselectedPeriod","periodBegin","periodEnd","minAmount","maxAmount","transactionNumber","direction","user","by","orderBy","groups","channels","description"]}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.ownerParam=e.owner,this.typeParam=e.type,this.self=this.authHelper.isSelf(this.ownerParam),this.multipleAccounts=this.accountTypes.length>1,this.stateManager.cache("data",this.accountsService.getAccountHistoryDataByOwnerAndType({owner:this.ownerParam,accountType:this.typeParam})).subscribe(e=>{this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.exportActions=this.exportHelper.headingActions(e.exportFormats,e=>this.accountsService.exportAccountHistory$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))),this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.layout.xxs$.subscribe(()=>this.updateShowForm(e))),this.addSub(this.moreFilters$.subscribe(()=>this.updateShowForm(e))),this.updateShowForm(e)}updateShowForm(e){this.showForm$.next(this.layout.xxs&&!Object(s.h)(e.preselectedPeriods)||this.moreFilters)}toSearchParams(e){const t=e;return t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=r.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],t.owner=this.ownerParam,t.accountType=this.typeParam,t}doSearch(e){return this.accountsService.searchAccountHistory$Response(e).pipe(Object(b.a)(()=>{e.fields=["status"],this.addSub(this.accountsService.getAccountStatusByOwnerAndType(e).subscribe(e=>{const t=Object.assign(Object.assign({},this.data.account),{status:(e||{}).status});null==t.status?(this.noStatus$.next(!0),this.moreFilters=!0,this.headingActions=this.exportActions):this.headingActions=[this.moreFiltersAction,...this.exportActions],this.status$.next(t)}))}))}get accountTypes(){return(((this.login.auth||{}).permissions||{}).banking.accounts.filter(e=>!1!==e.visible)||[]).map(e=>e.account.type)}subjectName(e){return this.bankingHelper.subjectName(e.relatedAccount)}path(e){return["/banking","transfer",this.data.account.id,this.bankingHelper.transactionNumberOrId(e)]}avatarIcon(e){return"user"===e.relatedAccount.kind?"user":"account_balance_circle"}avatarImage(e){return"user"===e.relatedAccount.kind?e.relatedAccount.user.image:null}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}get toLink(){return e=>this.path(e)}resolveMenu(e){const t=new l.a(l.b.ACCOUNT_HISTORY,{accountType:e.account.type});return e.account.kind===i.a.SYSTEM?t:this.menu.userMenu(e.account.user,t)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(a.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["account-history"]],features:[d.ub],decls:8,vars:7,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],["class","filters-form",3,"formGroup","ngClass",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"filters-form",3,"formGroup","ngClass"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-12 col-md-6",4,"ngIf","ngIfElse"],["noTransferFilters",""],[1,"col-12","col-md-6"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","transferFilters",3,"label"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["type","text","formControlName","description",3,"label"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","by",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[3,"account","mode","showSeparator","showAccount","showUser",4,"ngIf"],[3,"account","mode","showSeparator","showAccount","showUser"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","30%",4,"ngIf"],[1,"amount"],[4,"ngFor","ngForOf"],["width","30%"],[3,"click"],[3,"image","icon"],[3,"routerLink"],[3,"routerLink","ngClass"],["class","d-inline-block",3,"routerLink",4,"ngIf"],[1,"d-inline-block",3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,j,1,0,"ng-container",1),d.Pb(),d.Bc(4,Le,10,16,"ng-template",null,2,d.Cc),d.Bc(6,we,1,0,"ng-template",null,3,d.Cc)),2&e){const e=d.qc(5);d.gc("ready",d.bc(1,3,t.noStatus$)||d.bc(2,5,t.status$)),d.xb(3),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,p.a,h.a,y.a,x.I,x.w,x.n,f.q,v.a,P.a,D.a,x.v,x.l,f.s,L.a,w.a,C.a,Q.a,I.a,F.a,T.a,M,H.a,q.a,U.a,V.h],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();var Qe=n("TFmz"),Ie=n("+HmS"),Fe=n("XvX2"),Te=n("9AzD"),Se=n("fe3a"),Oe=n("uao2");function Ne(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",4),d.Dc(2),d.Pb(),d.Qb(3,"div",5),d.Dc(4),d.ac(5,"currency"),d.Pb(),d.Qb(6,"div",6),d.Dc(7),d.ac(8,"currency"),d.Pb(),d.Qb(9,"div",7),d.Dc(10),d.ac(11,"currency"),d.Pb(),d.Qb(12,"div",4),d.Dc(13),d.ac(14,"currency"),d.Pb(),d.Qb(15,"div",4),d.Dc(16),d.Pb(),d.Qb(17,"div",5),d.Dc(18),d.ac(19,"currency"),d.Pb(),d.Qb(20,"div",6),d.Dc(21),d.ac(22,"currency"),d.Pb(),d.Qb(23,"div",7),d.Dc(24),d.ac(25,"currency"),d.Pb(),d.Qb(26,"div",4),d.Dc(27),d.ac(28,"currency"),d.Pb(),d.Qb(29,"div",4),d.Dc(30),d.Pb(),d.Qb(31,"div",5),d.Dc(32),d.Pb(),d.Qb(33,"div",6),d.Dc(34),d.Pb(),d.Qb(35,"div",7),d.Dc(36),d.Pb(),d.Qb(37,"div",4),d.Dc(38),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(2),d.Fc(" ",e.i18n.account.userBalances.balancesSum," "),d.xb(2),d.Fc(" ",d.cc(5,15,e.summary.low.sum,e.currency)," "),d.xb(3),d.Fc(" ",d.cc(8,18,e.summary.medium.sum,e.currency)," "),d.xb(3),d.Fc(" ",d.cc(11,21,e.summary.high.sum,e.currency)," "),d.xb(3),d.Fc(" ",e.totalSum(d.cc(14,24,e.summary.total.sum,e.currency))," "),d.xb(3),d.Fc(" ",e.i18n.account.userBalances.balancesAverage," "),d.xb(2),d.Fc(" ",d.cc(19,27,e.summary.low.average,e.currency)," "),d.xb(3),d.Fc(" ",d.cc(22,30,e.summary.medium.average,e.currency)," "),d.xb(3),d.Fc(" ",d.cc(25,33,e.summary.high.average,e.currency)," "),d.xb(3),d.Fc(" ",e.totalSum(d.cc(28,36,e.summary.total.average,e.currency))," "),d.xb(3),d.Fc(" ",e.i18n.account.userBalances.balancesCount," "),d.xb(2),d.Fc(" ",e.summary.low.count," "),d.xb(2),d.Fc(" ",e.summary.medium.count," "),d.xb(2),d.Fc(" ",e.summary.high.count," "),d.xb(2),d.Fc(" ",e.totalSum(e.summary.total.count)," ")}}function ke(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",8),d.Dc(2),d.Pb(),d.Qb(3,"div",9),d.Dc(4),d.ac(5,"currency"),d.Pb(),d.Qb(6,"div",8),d.Dc(7),d.Pb(),d.Qb(8,"div",9),d.Dc(9),d.ac(10,"currency"),d.Pb(),d.Qb(11,"div",8),d.Dc(12),d.Pb(),d.Qb(13,"div",9),d.Dc(14),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(2),d.Fc(" ",e.i18n.account.userBalances.balancesSum," "),d.xb(2),d.Fc(" ",d.cc(5,6,e.summary.total.sum,e.currency)," "),d.xb(3),d.Fc(" ",e.i18n.account.userBalances.balancesAverage," "),d.xb(2),d.Fc(" ",d.cc(10,9,e.summary.total.average,e.currency)," "),d.xb(3),d.Fc(" ",e.i18n.account.userBalances.balancesCount," "),d.xb(2),d.Fc(" ",e.summary.total.count," ")}}let Be=(()=>{class e extends S.a{constructor(e){super(e),this.hasYellowRange$=new u.a(!1)}get summary(){return this.summary$.value}ngOnInit(){this.summary$.subscribe(e=>this.hasYellowRange$.next(!!e.low))}totalSum(e){return this.i18n.account.userBalances.total+": "+e}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["balances-summary"]],inputs:{summary$:"summary$",currency:"currency"},features:[d.ub],decls:7,vars:6,consts:[[1,"p-1"],[1,"mt-0","mb-0"],[1,"row","no-gutters","pt-1"],[4,"ngIf"],[1,"col-12","col-sm-3"],[1,"col-12","col-sm-2","low-balance"],[1,"col-12","col-sm-2","medium-balance"],[1,"col-12","col-sm-2","high-balance"],[1,"col-6","col-sm-3"],[1,"col-6","col-sm-9"]],template:function(e,t){1&e&&(d.Qb(0,"div",0),d.Lb(1,"hr",1),d.Qb(2,"div",2),d.Bc(3,Ne,39,39,"ng-container",3),d.ac(4,"async"),d.Bc(5,ke,15,12,"ng-container",3),d.ac(6,"async"),d.Pb(),d.Pb()),2&e&&(d.xb(3),d.gc("ngIf",d.bc(4,2,t.hasYellowRange$)),d.xb(2),d.gc("ngIf",!d.bc(6,4,t.hasYellowRange$)))},directives:[f.t],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();var Ae=n("IJ5G");function Ee(e,t){1&e&&d.Mb(0)}function $e(e,t){if(1&e&&d.Lb(0,"field-option",19),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e.id)("internalName",e.internalName)("text",e.name)}}function Re(e,t){if(1&e&&(d.Qb(0,"div",7),d.Lb(1,"max-distance-field",37),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("data",e.data.searchByDistanceData)("label",e.i18n.general.distanceFilter)}}function Ze(e,t){if(1&e&&d.Lb(0,"field-option",40),2&e){const e=t.$implicit,n=d.Zb(4);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function Me(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"multi-selection-field",38),d.Bc(2,Ze,1,5,"field-option",39),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.groupFilter),d.xb(1),d.gc("ngForOf",e.data.groups)}}function He(e,t){if(1&e&&d.Lb(0,"field-option",43),2&e){const e=t.$implicit,n=d.Zb(4);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function qe(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"multi-selection-field",41),d.Bc(2,He,1,4,"field-option",42),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.assignedProducts),d.xb(1),d.gc("ngForOf",e.data.products)}}function Ue(e,t){if(1&e&&d.Lb(0,"field-option",43),2&e){const e=t.$implicit,n=d.Zb(4);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ve(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"multi-selection-field",44),d.Bc(2,Ue,1,4,"field-option",42),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.acceptedAgreements),d.xb(1),d.gc("ngForOf",e.data.agreements)}}function ze(e,t){if(1&e&&d.Lb(0,"field-option",43),2&e){const e=t.$implicit,n=d.Zb(4);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function je(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"multi-selection-field",45),d.Bc(2,ze,1,4,"field-option",42),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.notAcceptedAgreements),d.xb(1),d.gc("ngForOf",e.data.agreements)}}function Ge(e,t){if(1&e&&(d.Qb(0,"div",7),d.Lb(1,"basic-profile-field-filter",46),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(3);d.xb(1),d.gc("field",e)("formControl",n.form.get("profileFields").get(e.field))}}function _e(e,t){if(1&e&&(d.Qb(0,"div",7),d.Lb(1,"custom-field-filter",46),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(3);d.xb(1),d.gc("field",e)("formControl",n.form.get("profileFields").get(e.internalName))}}function Ke(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"div",20),d.Qb(2,"div",7),d.Lb(3,"decimal-field",21),d.Pb(),d.Qb(4,"div",7),d.Lb(5,"decimal-field",22),d.Pb(),d.Qb(6,"div",7),d.Lb(7,"decimal-field",23),d.Pb(),d.Qb(8,"div",7),d.Lb(9,"decimal-field",24),d.Pb(),d.Bc(10,Re,2,2,"div",25),d.Bc(11,Me,3,3,"div",25),d.Bc(12,qe,3,3,"div",25),d.Bc(13,Ve,3,3,"div",25),d.Bc(14,je,3,3,"div",25),d.Qb(15,"div",26),d.Qb(16,"div",7),d.Lb(17,"date-field",27),d.Pb(),d.Qb(18,"div",7),d.Lb(19,"date-field",28),d.Pb(),d.Pb(),d.Qb(20,"div",26),d.Qb(21,"div",7),d.Lb(22,"date-field",29),d.Pb(),d.Qb(23,"div",7),d.Lb(24,"date-field",30),d.Pb(),d.Pb(),d.Qb(25,"div",26),d.Qb(26,"div",7),d.Lb(27,"date-field",31),d.Pb(),d.Qb(28,"div",7),d.Lb(29,"date-field",32),d.Pb(),d.Pb(),d.Qb(30,"div",26),d.Qb(31,"div",7),d.Lb(32,"date-field",33),d.Pb(),d.Qb(33,"div",7),d.Lb(34,"date-field",34),d.Pb(),d.Pb(),d.Qb(35,"div",7),d.Lb(36,"user-field",35),d.Pb(),d.Bc(37,Ge,2,2,"div",36),d.Bc(38,_e,2,2,"div",36),d.Nb()),2&e){const e=d.Zb(2);d.xb(3),d.gc("label",e.i18n.account.userBalances.minBalance)("scale",0),d.xb(2),d.gc("label",e.i18n.account.userBalances.maxBalance)("scale",0),d.xb(2),d.gc("label",e.i18n.account.userBalances.fromYellowBalance)("scale",0),d.xb(2),d.gc("label",e.i18n.account.userBalances.toYellowBalance)("scale",0),d.xb(1),d.gc("ngIf",e.data.searchByDistanceData),d.xb(1),d.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),d.xb(1),d.gc("ngIf",(null==e.data.products?null:e.data.products.length)>1),d.xb(1),d.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>1),d.xb(1),d.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>1),d.xb(3),d.gc("label",e.i18n.user.creationBegin),d.xb(2),d.gc("label",e.i18n.user.creationEnd),d.xb(3),d.gc("label",e.i18n.user.beginUserActivationDate),d.xb(2),d.gc("label",e.i18n.user.endUserActivationDate),d.xb(3),d.gc("label",e.i18n.user.beginLastLoginDate),d.xb(2),d.gc("label",e.i18n.user.endLastLoginDate),d.xb(3),d.gc("label",e.i18n.account.userBalances.beginNegativeSince),d.xb(2),d.gc("label",e.i18n.account.userBalances.endNegativeSince),d.xb(2),d.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters()),d.xb(1),d.gc("ngForOf",e.data.basicFields),d.xb(1),d.gc("ngForOf",e.customFieldsInSearch)}}function Xe(e,t){if(1&e&&(d.Qb(0,"div",47),d.Qb(1,"single-selection-field",48),d.Lb(2,"field-option",49),d.Lb(3,"field-option",50),d.Lb(4,"field-option",51),d.Lb(5,"field-option",52),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("formControl",e.form.get("orderBy"))("display",e.i18n.general.orderBy),d.xb(1),d.gc("text",e.i18n.account.userBalances.orderBy.alphabeticallyDesc),d.xb(1),d.gc("text",e.i18n.account.userBalances.orderBy.alphabeticallyAsc),d.xb(1),d.gc("text",e.i18n.account.userBalances.orderBy.balanceDesc),d.xb(1),d.gc("text",e.i18n.account.userBalances.orderBy.balanceAsc)}}function Ye(e,t){if(1&e&&(d.Lb(0,"balances-summary",53),d.ac(1,"async")),2&e){const e=d.Zb(2);d.gc("summary$",e.summary$)("currency",d.bc(1,2,e.currency$))}}function We(e,t){1&e&&d.Lb(0,"spinner")}function Je(e,t){if(1&e&&(d.Qb(0,"mobile-result",54),d.Qb(1,"div",55),d.Qb(2,"div",56),d.Dc(3),d.Pb(),d.Qb(4,"div",57),d.Dc(5),d.ac(6,"currency"),d.Pb(),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("avatarImage",e.image)("avatarIcon","user"),d.xb(3),d.Fc(" ",e.name," "),d.xb(2),d.Fc(" ",d.cc(6,4,e.balance,n.findCurrency())," ")}}function et(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",62),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.path(n))})),d.Qb(2,"td",59),d.Lb(3,"avatar",63),d.Pb(),d.Qb(4,"td"),d.Dc(5),d.Pb(),d.Qb(6,"td"),d.Dc(7),d.Pb(),d.Qb(8,"td"),d.Dc(9),d.ac(10,"date"),d.Pb(),d.Qb(11,"td",60),d.Dc(12),d.ac(13,"currency"),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.gc("image",e.image)("icon","user"),d.xb(2),d.Ec(e.name),d.xb(2),d.Ec(e.accountNumber),d.xb(2),d.Ec(d.bc(10,6,e.negativeSince)),d.xb(3),d.Fc(" ",d.cc(13,8,e.balance,n.findCurrency())," ")}}function tt(e,t){if(1&e&&(d.Qb(0,"table",58),d.Qb(1,"thead"),d.Lb(2,"th",59),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Qb(7,"th"),d.Dc(8),d.Pb(),d.Qb(9,"th",60),d.Dc(10),d.Pb(),d.Pb(),d.Qb(11,"tbody"),d.Bc(12,et,14,11,"ng-container",61),d.ac(13,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(4),d.Ec(e.i18n.general.user),d.xb(2),d.Ec(e.i18n.account.number),d.xb(2),d.Ec(e.i18n.account.userBalances.negativeSince),d.xb(2),d.Ec(e.i18n.account.balance),d.xb(2),d.gc("ngForOf",null==(n=d.bc(13,5,e.results$))?null:n.results)}}function nt(e,t){if(1&e&&(d.Qb(0,"div",66),d.Dc(1),d.Pb()),2&e){const e=d.Zb().$implicit;d.xb(1),d.Fc(" ",e.name,"")}}function it(e,t){if(1&e&&(d.Qb(0,"div"),d.Dc(1),d.Pb()),2&e){const e=d.Zb().$implicit;d.xb(1),d.Fc(" ",e.username,"")}}function at(e,t){if(1&e&&(d.Qb(0,"map-result",64),d.Bc(1,nt,2,1,"div",65),d.Bc(2,it,2,1,"div",10),d.Qb(3,"div",66),d.Dc(4),d.ac(5,"currency"),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("image",e.image)("address",e.address),d.xb(1),d.gc("ngIf",e.name),d.xb(1),d.gc("ngIf",e.username),d.xb(2),d.Fc(" ",d.cc(5,5,e.balance,n.findCurrency()),"")}}const ct=function(e){return{"mb-0":e}};function rt(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",4),d.ac(1,"async"),d.Qb(2,"form",5),d.Qb(3,"div",6),d.Qb(4,"div",7),d.Qb(5,"single-selection-field",8),d.Bc(6,$e,1,4,"field-option",9),d.Pb(),d.Pb(),d.Bc(7,Ke,39,25,"ng-container",10),d.ac(8,"async"),d.Pb(),d.Pb(),d.Qb(9,"div",6),d.Qb(10,"div",11),d.ac(11,"async"),d.Lb(12,"result-type-field",12),d.ac(13,"async"),d.Pb(),d.Bc(14,Xe,6,6,"div",13),d.ac(15,"async"),d.Pb(),d.Ob(16),d.Bc(17,Ye,2,4,"balances-summary",14),d.ac(18,"async"),d.Bc(19,We,1,0,"spinner",10),d.ac(20,"async"),d.Nb(),d.Pb(),d.Qb(21,"results-layout",15),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(22,"async"),d.Bc(23,Je,7,7,"mobile-result",16),d.Bc(24,tt,14,7,"table",17),d.Bc(25,at,6,8,"map-result",18),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.account.userBalances.title)("mobileHeading",e.i18n.account.userBalances.mobileTitle)("headingActions",d.bc(1,18,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(3),d.gc("label",e.i18n.account.account),d.xb(1),d.gc("ngForOf",e.data.accountTypes),d.xb(1),d.gc("ngIf",d.bc(8,20,e.moreFilters$)),d.xb(3),d.gc("ngClass",d.jc(34,ct,d.bc(11,22,e.layout.xs$))),d.xb(2),d.gc("allowedResultTypes",d.bc(13,24,e.allowedResultTypes$))("formControl",e.resultTypeControl),d.xb(2),d.gc("ngIf","map"!==d.bc(15,26,e.resultType$)),d.xb(3),d.gc("ngIf",d.bc(18,28,e.summary$)),d.xb(2),d.gc("ngIf",null===d.bc(20,30,e.summary$)),d.xb(2),d.gc("resultType",e.resultType)("results",d.bc(22,32,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)("toAddress",e.toAddress)}}function ot(e,t){1&e&&d.Lb(0,"spinner",67)}let st=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.accountsService=t,this.bankingHelper=n,this.summary$=new u.a(null),this.currency$=new u.a(null)}getFormControlNames(){return["accountType","minMediumRange","maxMediumRange","minBalance","maxBalance","orderBy","groups","distanceFilter","brokers","beginActivationPeriod","endActivationPeriod","beginCreationPeriod","endCreationPeriod","beginLastLoginPeriod","customValues","endLastLoginPeriod","beginNegativeSincePeriod","endNegativeSincePeriod","notAcceptedAgreements","acceptedAgreements","products"]}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.accountsService.getUserBalancesData()).subscribe(e=>this.data=e),this.allowedResultTypes=(((this.login.auth||{}).permissions||{}).users||{}).map?[Qe.a.LIST,Qe.a.MAP]:[Qe.a.LIST]}onDataInitialized(e){super.onDataInitialized(e),this.customFieldsInSearch=e.customFields.filter(t=>e.fieldsInSearch.includes(t.internalName)),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(e.basicFields,this.customFieldsInSearch));const t=this.moreFiltersAction;t.breakpoint=null,this.headingActions=[t],this.exportHelper.headingActions(e.exportFormats,e=>this.accountsService.exportUsersWithBalances$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))).forEach(e=>this.headingActions.push(e)),this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.form.controls.accountType.valueChanges.subscribe(e=>{const t=this.data.accountTypes.find(t=>t.id===e);this.updateYellowRange(t),this.currency$.next(t.currency)}));const n=e.accountTypes[0];this.currency$.next(n.currency),this.updateYellowRange(n)}onResultTypeChanged(e,t){super.onResultTypeChanged(e,t),this.resetPage()}updateYellowRange(e){null!=e.defaultMediumBalanceRange?(this.form.controls.minMediumRange.patchValue(e.defaultMediumBalanceRange.min),this.form.controls.maxMediumRange.patchValue(e.defaultMediumBalanceRange.max)):(this.form.controls.minMediumRange.patchValue(null),this.form.controls.maxMediumRange.patchValue(null))}userSearchFilters(){return{roles:[i.kb.BROKER]}}mapBalance(e){return this.i18n.account.balance+": "+e}toAddress(e){return e.address}getInitialResultType(){return Qe.a.LIST}toSearchParams(e){const t=e;t.activationPeriod=r.a.dateRangeFilter(e.beginActivationPeriod,e.endActivationPeriod),t.creationPeriod=r.a.dateRangeFilter(e.beginCreationPeriod,e.endCreationPeriod),t.lastLoginPeriod=r.a.dateRangeFilter(e.beginLastLoginPeriod,e.endLastLoginPeriod),t.negativeSincePeriod=r.a.dateRangeFilter(e.beginNegativeSincePeriod,e.endNegativeSincePeriod),e.minBalance&&e.maxBalance&&(t.balanceRange=[e.minBalance,e.maxBalance]),null!=e.minMediumRange&&null!=e.maxMediumRange&&(t.mediumBalanceRange=[e.minMediumRange,e.maxMediumRange]),t.addressResult=this.resultType===Qe.a.MAP?i.Eb.ALL:null,t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields);const n=e.distanceFilter;return n&&(t.maxDistance=n.maxDistance,t.latitude=n.latitude,t.longitude=n.longitude),t.fields=[],t}doSearch(e){return this.accountsService.searchUsersWithBalances$Response(e).pipe(Object(b.a)(()=>{this.addSub(this.accountsService.getUserBalancesSummary(e).subscribe(e=>this.summary$.next(e)))}))}findCurrency(){const e=this.form.controls.accountType.value;return e?this.data.accountTypes.find(t=>t.id===e).currency:this.currency$.value}currencyDecimalDigits(){const e=this.findCurrency();return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency();return e?e.prefix:null}currencySuffix(){const e=this.findCurrency();return e?e.suffix:null}path(e){return["/users",e.id,"profile"]}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}get toLink(){return e=>this.path(e)}resolveMenu(){return l.b.USER_BALANCES_OVERVIEW}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(a.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-user-balances"]],features:[d.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","filters-row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","accountType",3,"label"],[3,"id","value","internalName","text",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12","col-md-9","col-xs-5","mb-1",3,"ngClass"],[3,"allowedResultTypes","formControl"],["class","col-12 col-md-3 col-xs-7",4,"ngIf"],[3,"summary$","currency",4,"ngIf"],[3,"resultType","results","toLink","rendering$","toAddress","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"image","address",4,"resultInfoWindow"],[3,"id","value","internalName","text"],[1,"w-100"],["labelPosition","side","formControlName","minBalance","fieldSize","full","allowNegative","",3,"label","scale"],["labelPosition","side","formControlName","maxBalance","fieldSize","full","allowNegative","",3,"label","scale"],["labelPosition","side","formControlName","minMediumRange","fieldSize","full",3,"label","scale"],["labelPosition","side","formControlName","maxMediumRange","fieldSize","full",3,"label","scale"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","brokers",3,"label","filters"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","products",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","acceptedAgreements",3,"emptyLabel","label"],["labelPosition","side","formControlName","notAcceptedAgreements",3,"emptyLabel","label"],["labelPosition","side",3,"field","formControl"],[1,"col-12","col-md-3","col-xs-7"],[3,"formControl","display"],["value","alphabeticallyDesc",3,"text"],["value","alphabeticallyAsc",3,"text"],["value","balanceDesc",3,"text"],["value","balanceAsc",3,"text"],[3,"summary$","currency"],[3,"avatarImage","avatarIcon"],[1,"cell-text","cell-main","row"],[1,"col-6","align-text-start"],[1,"col-6","align-text-end","amount"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[3,"image","address"],["class","font-weight-bold",4,"ngIf"],[1,"font-weight-bold"],[1,"p-3"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Ee,1,0,"ng-container",1),d.Pb(),d.Bc(3,rt,26,36,"ng-template",null,2,d.Cc),d.Bc(5,ot,1,0,"ng-template",null,3,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,D.a,x.v,x.l,f.s,f.q,Ie.a,x.k,p.a,h.a,y.a,Fe.a,L.a,Q.a,C.a,F.a,Te.a,w.a,Se.a,Oe.a,Be,H.a,q.a,U.a,Ae.a],pipes:[f.b,O.a,z.a],encapsulation:2,changeDetection:0}),e})();var lt=n("ZXJw"),ut=n("uuU0"),bt=n("XIp8"),dt=n("UXR7"),mt=n("OTwK"),ft=n("YG2p");function gt(e,t){if(1&e&&(d.Ob(0,4),d.Qb(1,"label-value",5),d.Lb(2,"user-link",6),d.Pb(),d.Qb(3,"label-value",7),d.Dc(4),d.Pb(),d.Qb(5,"div",8),d.Qb(6,"h3"),d.Dc(7),d.Pb(),d.Lb(8,"single-selection-field",9),d.Lb(9,"decimal-field",10),d.ac(10,"async"),d.ac(11,"async"),d.Qb(12,"label-value",11),d.ac(13,"async"),d.Dc(14),d.ac(15,"currency"),d.Pb(),d.Pb(),d.Qb(16,"div",8),d.Qb(17,"h3"),d.Dc(18),d.Pb(),d.Lb(19,"single-selection-field",12),d.Lb(20,"decimal-field",13),d.ac(21,"async"),d.ac(22,"async"),d.ac(23,"async"),d.ac(24,"async"),d.Qb(25,"label-value",11),d.ac(26,"async"),d.Dc(27),d.ac(28,"currency"),d.Pb(),d.Pb(),d.Lb(29,"textarea-field",14),d.Nb()),2&e){const e=d.Zb();d.gc("formGroup",e.form),d.xb(1),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("label",e.i18n.account.account),d.xb(1),d.Fc(" ",e.data.account.type.name," "),d.xb(3),d.Ec(e.i18n.account.balanceLimits.negativeLimit),d.xb(1),d.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.negativeModeOptions),d.xb(1),d.gc("hidden",d.bc(10,30,e.isDefaultCreditLimit$))("required",!d.bc(11,32,e.isDefaultCreditLimit$))("label",e.i18n.account.balanceLimits.negativeLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),d.xb(3),d.gc("hidden",!d.bc(13,34,e.isDefaultCreditLimit$))("label",e.i18n.account.balanceLimits.negativeLimit),d.xb(2),d.Fc(" ",d.cc(15,36,e.data.defaultCreditLimit?e.data.defaultCreditLimit:0,e.data.account.currency)," "),d.xb(4),d.Ec(e.i18n.account.balanceLimits.positiveLimit),d.xb(1),d.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.positiveModeOptions),d.xb(1),d.gc("hidden",d.bc(21,39,e.isDefaultUpperCreditLimit$)||d.bc(22,41,e.isUnlimitedUpperCreditLimit$))("required",!(d.bc(23,43,e.isDefaultUpperCreditLimit$)||d.bc(24,45,e.isUnlimitedUpperCreditLimit$)))("label",e.i18n.account.balanceLimits.positiveLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),d.xb(5),d.gc("hidden",!d.bc(26,47,e.isDefaultUpperCreditLimit$))("label",e.i18n.account.balanceLimits.positiveLimit),d.xb(2),d.Fc(" ",e.data.defaultUpperCreditLimit?d.cc(28,49,e.data.defaultUpperCreditLimit,e.data.account.currency):e.i18n.account.limits.unlimited," "),d.xb(2),d.gc("label",e.i18n.general.comments)}}let pt=(()=>{class e extends ut.a{constructor(e,t){super(e),this.balanceLimitsService=t,this.isDefaultCreditLimit$=new u.a(null),this.isDefaultUpperCreditLimit$=new u.a(null),this.isUnlimitedUpperCreditLimit$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}get positiveModeOptions(){const e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e.push({value:"unlimited",text:this.i18n.account.limits.unlimited}),e}get negativeModeOptions(){const e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e}onDataInitialized(e){super.onDataInitialized(e);const t=e.customCreditLimit?"personalized":"default",n=e.customUpperCreditLimit?e.upperCreditLimit?"personalized":"unlimited":"default";this.form=this.formBuilder.group({creditLimitMode:t,creditLimit:e.creditLimit,upperCreditLimitMode:n,upperCreditLimit:e.upperCreditLimit,comment:null}),this.formControl("creditLimitMode").valueChanges.subscribe(e=>this.onCreditLimitModeChange(e)),this.formControl("upperCreditLimitMode").valueChanges.subscribe(e=>this.onUpperCreditLimitModeChange(e)),this.isDefaultCreditLimit$.next("default"===t),this.isDefaultUpperCreditLimit$.next("default"===n),this.isUnlimitedUpperCreditLimit$.next("unlimited"===n)}onCreditLimitModeChange(e){this.isDefaultCreditLimit$.next("default"===e)}onUpperCreditLimitModeChange(e){this.isDefaultUpperCreditLimit$.next("default"===e),this.isUnlimitedUpperCreditLimit$.next("unlimited"===e)}save(){if(Object(s.F)(this.form),!this.form.valid)return;const e=Object(bt.a)(this.form.value);e.customCreditLimit="default"!==e.creditLimitMode,e.customCreditLimit||delete e.creditLimit,e.customUpperCreditLimit="default"!==e.upperCreditLimitMode,"unlimited"!==e.upperCreditLimitMode&&e.customUpperCreditLimit||delete e.upperCreditLimit,delete e.creditLimitMode,delete e.upperCreditLimitMode,this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.account.balanceLimits.confirm,createDeviceConfirmation:this.balanceLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:t=>this.doSave(e,t.confirmationPassword)}):this.doSave(e)}doSave(e,t){this.addSub(this.balanceLimitsService.setAccountBalanceLimits({user:this.user,accountType:this.accountType,confirmationPassword:t,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.account.balanceLimits.saved),this.reload()}))}balanceLimitsDeviceConfirmation(){return()=>({type:i.s.CHANGE_ACCOUNT_LIMITS,account:this.data.account.id})}formControl(e){return this.form.get(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(lt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["edit-account-balance-limits"]],features:[d.ub],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mt-3"],["labelPosition","side","formControlName","creditLimitMode",3,"label","fieldOptions"],["formControlName","creditLimit","negative","",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","upperCreditLimitMode",3,"label","fieldOptions"],["formControlName","upperCreditLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Qb(2,"page-content",1),d.ac(3,"async"),d.Bc(4,gt,30,52,"ng-container",2),d.Qb(5,"actions"),d.Qb(6,"action-button",3),d.Xb("action",(function(){return t.save()})),d.ac(7,"async"),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.gc("ready",d.bc(1,7,t.data$)),d.xb(2),d.gc("heading",t.i18n.account.balanceLimits.title.edit)("mobileHeading",t.i18n.account.balanceLimits.mobileTitle.edit)("headingActions",d.bc(3,9,t.headingActions$)),d.xb(2),d.gc("ngIf",t.data),d.xb(2),d.gc("disabled",d.bc(7,11,t.requesting$))("label",t.i18n.general.save))},directives:[m.a,g.a,f.t,dt.a,mt.a,x.w,x.n,v.a,P.a,D.a,x.v,x.l,Q.a,x.D,ft.a],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();var ht=n("s7Af");function yt(e,t){if(1&e){const e=d.Rb();d.Qb(0,"tr",8),d.Xb("click",(function(n){d.sc(e);const i=t.$implicit,a=d.Zb(3);return a.router.navigate(a.path(i.account.type)),n.stopPropagation()})),d.Qb(1,"td",9),d.Dc(2),d.Pb(),d.Qb(3,"td"),d.Dc(4),d.ac(5,"currency"),d.Pb(),d.Qb(6,"td"),d.Dc(7),d.ac(8,"currency"),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.Ec(e.account.type.name),d.xb(2),d.Ec(d.cc(5,3,e.creditLimit,e.account.currency)),d.xb(3),d.Fc(" ",e.upperCreditLimit?d.cc(8,6,e.upperCreditLimit,e.account.currency):n.i18n.account.limits.unlimited," ")}}function xt(e,t){if(1&e&&(d.Qb(0,"table",6),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Pb(),d.Qb(8,"tbody"),d.Bc(9,yt,9,9,"tr",7),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(3),d.Ec(e.i18n.account.account),d.xb(2),d.Ec(e.i18n.account.balanceLimits.negativeLimit),d.xb(2),d.Ec(e.i18n.account.balanceLimits.positiveLimit),d.xb(2),d.gc("ngForOf",e.data.accountLimits)}}function vt(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"page-content",2),d.ac(2,"async"),d.Lb(3,"user-info",3),d.Pb(),d.Qb(4,"results-layout",4),d.Bc(5,xt,10,4,"table",5),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("mode","normal")("heading",e.i18n.account.balanceLimits.title.list)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.list)("headingActions",d.bc(2,6,e.headingActions$)),d.xb(2),d.gc("user",e.data.user),d.xb(1),d.gc("results",e.data.accountLimits)}}let Pt=(()=>{class e extends ut.a{constructor(e,t){super(e),this.balanceLimitsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.balanceLimitsService.getDataForUserBalanceLimits({user:this.user}).subscribe(e=>{1===e.accountLimits.length&&this.router.navigate(this.path(e.accountLimits[0].account.type)),this.data=e}))}path(e){return["/banking",this.user,"account-balance-limits",e.id]}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(lt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["list-accounts-balance-limits"]],features:[d.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,vt,6,8,"ng-container",1),d.Pb()),2&e&&(d.gc("ready",d.bc(1,2,t.data$)),d.xb(2),d.gc("ngIf",t.data))},directives:[m.a,f.t,g.a,ht.a,p.a,y.a,f.s],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();function Dt(e,t){1&e&&d.Mb(0)}function Lt(e,t){if(1&e&&d.Lb(0,"field-option",14),2&e){const e=t.$implicit,n=d.Zb(3);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function wt(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"multi-selection-field",12),d.Bc(2,Lt,1,5,"field-option",13),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.user.groupFilter),d.xb(1),d.gc("ngForOf",e.data.groups)}}function Ct(e,t){if(1&e&&d.Lb(0,"field-option",17),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function Qt(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"single-selection-field",15),d.Bc(2,Ct,1,2,"field-option",16),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.currencies)}}function It(e,t){if(1&e&&d.Lb(0,"field-option",31),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e.id)("text",e.name)}}function Ft(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"single-selection-field",29),d.Bc(2,It,1,3,"field-option",30),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.account.account)("emptyOption",e.i18n.general.all),d.xb(1),d.gc("ngForOf",e.accountTypes())}}function Tt(e,t){if(1&e&&(d.Ob(0),d.Bc(1,Ft,3,3,"div",6),d.Qb(2,"div",11),d.Lb(3,"single-selection-field",18),d.Pb(),d.Lb(4,"div",19),d.ac(5,"async"),d.Qb(6,"div",20),d.ac(7,"async"),d.Lb(8,"decimal-field",21),d.Pb(),d.Qb(9,"div",20),d.ac(10,"async"),d.Lb(11,"decimal-field",22),d.Pb(),d.Qb(12,"div",11),d.Lb(13,"single-selection-field",23),d.Pb(),d.Lb(14,"div",19),d.ac(15,"async"),d.Qb(16,"div",20),d.ac(17,"async"),d.Lb(18,"decimal-field",24),d.Pb(),d.Qb(19,"div",20),d.ac(20,"async"),d.Lb(21,"decimal-field",25),d.Pb(),d.Qb(22,"div",11),d.Lb(23,"user-field",26),d.Pb(),d.Qb(24,"div",11),d.Lb(25,"user-field",27),d.Pb(),d.Qb(26,"div",11),d.Lb(27,"user-field",28),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.xb(2),d.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.balanceLimits.personalizedNegativeLimit),d.xb(1),d.gc("hidden",!d.bc(5,37,e.isCustomLimit$)),d.xb(2),d.gc("hidden",!d.bc(7,39,e.isCustomLimit$)),d.xb(2),d.gc("label",e.i18n.account.balanceLimits.fromNegativeLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(1),d.gc("hidden",!d.bc(10,41,e.isCustomLimit$)),d.xb(2),d.gc("label",e.i18n.account.balanceLimits.toNegativeLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.balanceLimits.personalizedPositiveLimit),d.xb(1),d.gc("hidden",!d.bc(15,43,e.isCustomUpperLimit$)),d.xb(2),d.gc("hidden",!d.bc(17,45,e.isCustomUpperLimit$)),d.xb(2),d.gc("label",e.i18n.account.balanceLimits.fromPositiveLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(1),d.gc("hidden",!d.bc(20,47,e.isCustomUpperLimit$)),d.xb(2),d.gc("label",e.i18n.account.balanceLimits.toPositiveLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("label",e.i18n.general.user)("allowContacts",!1),d.xb(2),d.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters(!0))("allowContacts",!1),d.xb(2),d.gc("label",e.i18n.general.changedBy)("filters",e.userSearchFilters(!1))("allowContacts",!1)}}function St(e,t){if(1&e){const e=d.Rb();d.Qb(0,"mobile-result",32),d.Xb("click",(function(n){d.sc(e);const i=t.$implicit,a=d.Zb(2);return a.router.navigate(a.view(i)),n.stopPropagation()})),d.Qb(1,"div",33),d.Qb(2,"div",34),d.Qb(3,"label-value",35),d.Dc(4),d.Pb(),d.Qb(5,"label-value",35),d.Dc(6),d.Pb(),d.Qb(7,"label-value",35),d.Dc(8),d.ac(9,"currency"),d.Pb(),d.Qb(10,"label-value",35),d.Dc(11),d.ac(12,"currency"),d.Pb(),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(2);d.xb(3),d.gc("label",n.i18n.general.user),d.xb(1),d.Fc(" ",e.user.display," "),d.xb(1),d.gc("label",n.i18n.account.account),d.xb(1),d.Fc(" ",e.account.type.name," "),d.xb(1),d.gc("label",n.i18n.account.balanceLimits.negative),d.xb(1),d.Fc(" ",e.customCreditLimit?d.cc(9,8,e.creditLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(2),d.gc("label",n.i18n.account.balanceLimits.positive),d.xb(1),d.Fc(" ",e.customUpperCreditLimit?e.upperCreditLimit?d.cc(12,11,e.upperCreditLimit,e.account.currency):n.i18n.account.limits.unlimited:n.i18n.account.limits.productDefault," ")}}function Ot(e,t){if(1&e){const e=d.Rb();d.Qb(0,"tr",32),d.Xb("click",(function(n){d.sc(e);const i=t.$implicit,a=d.Zb(3);return a.router.navigate(a.view(i)),n.stopPropagation()})),d.Qb(1,"td",38),d.Dc(2),d.Pb(),d.Qb(3,"td",38),d.Dc(4),d.Pb(),d.Qb(5,"td"),d.Dc(6),d.ac(7,"currency"),d.Pb(),d.Qb(8,"td"),d.Dc(9),d.ac(10,"currency"),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.Ec(e.user.display),d.xb(2),d.Ec(e.account.type.name),d.xb(2),d.Fc(" ",e.customCreditLimit?d.cc(7,4,e.creditLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customUpperCreditLimit?e.upperCreditLimit?d.cc(10,7,e.upperCreditLimit,e.account.currency):n.i18n.account.limits.unlimited:n.i18n.account.limits.productDefault," ")}}function Nt(e,t){if(1&e&&(d.Qb(0,"table",36),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Pb(),d.Qb(10,"tbody"),d.Bc(11,Ot,11,10,"tr",37),d.ac(12,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.general.user),d.xb(2),d.Ec(e.i18n.account.account),d.xb(2),d.Ec(e.i18n.account.balanceLimits.negativeLimit),d.xb(2),d.Ec(e.i18n.account.balanceLimits.positiveLimit),d.xb(2),d.gc("ngForOf",null==(n=d.bc(12,5,e.results$))?null:n.results)}}function kt(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.ac(1,"async"),d.Qb(2,"form",4),d.Qb(3,"div",5),d.Bc(4,wt,3,2,"div",6),d.Bc(5,Qt,3,3,"div",6),d.Bc(6,Tt,28,49,"ng-container",7),d.ac(7,"async"),d.Pb(),d.Pb(),d.Pb(),d.Qb(8,"results-layout",8),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(9,"async"),d.Bc(10,St,13,14,"mobile-result",9),d.Bc(11,Nt,13,7,"table",10),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.account.balanceLimits.title.overview)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.overview)("headingActions",d.bc(1,9,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),d.xb(1),d.gc("ngIf",(null==e.currencies?null:e.currencies.length)>1),d.xb(1),d.gc("ngIf",d.bc(7,11,e.moreFilters$)),d.xb(2),d.gc("results",d.bc(9,13,e.results$))("rendering$",e.rendering$)}}let Bt=(()=>{class e extends o.a{constructor(e,t){super(e),this.balanceLimitsService=t,this.isCustomLimit$=new u.a(!1),this.isCustomUpperLimit$=new u.a(!1),this.currencies=[]}getFormControlNames(){return["accountType","broker","brokers","by","currency","customLimit","limitFrom","limitTo","customUpperLimit","upperLimitFrom","upperLimitTo","groups","user"]}ngOnInit(){super.ngOnInit(),this.addSub(this.balanceLimitsService.getAccountBalanceLimitsData().subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),(e.accountTypes||[]).forEach(e=>this.currencies.push(e.currency)),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customUpperLimit").valueChanges.subscribe(e=>this.isCustomUpperLimit$.next("yes"===e)),this.form.get("customLimit").valueChanges.subscribe(e=>this.isCustomLimit$.next("yes"===e)),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e))),this.headingActions=[this.moreFiltersAction]}doSearch(e){return this.balanceLimitsService.searchAccountBalanceLimits$Response(e)}toSearchParams(e){const t=e;return this.isCustomLimit$.value?(t.customLimit=!0,t.customLimitRange=r.a.rangeFilter(e.limitFrom,e.limitTo)):t.customLimit=!e.customLimit&&null,this.isCustomUpperLimit$.value?(t.customUpperLimit=!0,t.customUpperLimitRange=r.a.rangeFilter(e.upperLimitFrom,e.upperLimitTo)):t.customUpperLimit=!e.customUpperLimit&&null,t}get customLimitOptions(){const e=[{value:"yes",text:this.i18n.general.yes}];return e.push({value:"no",text:this.i18n.general.no}),e}userSearchFilters(e){const t={roles:[i.kb.BROKER]};return e||t.roles.push(i.kb.ADMINISTRATOR),t}updateAccountTypes(e){const t=this.form.controls.accountType.value;e&&t&&this.data.accountTypes.find(e=>e.id===t).currency.id!==e&&this.form.controls.accountType.setValue(null)}accountTypes(){const e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter(t=>t.currency.id===e.id):t}findCurrency(e){if(this.singleCurrency)return this.singleCurrency;const t=this.form.controls.currency.value;if(t)return this.currencies.find(e=>e.id===t);const n=this.form.controls.accountType.value;return e&&n?this.data.accountTypes.find(e=>e.id===n).currency:null}currencyDecimalDigits(){const e=this.findCurrency(!0);return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency(!0);return e?e.prefix:null}currencySuffix(){const e=this.findCurrency(!0);return e?e.suffix:null}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}view(e){return["/banking",e.user.id,"account-balance-limits",e.account.type.id]}resolveMenu(){return new l.a(l.b.ACCOUNT_BALANCE_LIMITS_OVERVIEW)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(lt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-balance-limits-overview"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","customLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","limitFrom","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","limitTo","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customUpperLimit",3,"fieldOptions","emptyOption","label"],["formControlName","upperLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","upperLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label","allowContacts"],["labelPosition","side","formControlName","broker",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","by",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","25%"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Dt,1,0,"ng-container",1),d.Pb(),d.Bc(3,kt,12,15,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,p.a,h.a,y.a,w.a,x.v,x.l,f.s,L.a,D.a,Q.a,F.a,q.a,v.a],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();var At=n("tAww");function Et(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"label-value",5),d.Lb(2,"user-link",6),d.Pb(),d.Qb(3,"label-value",7),d.Dc(4),d.Pb(),d.Qb(5,"h3"),d.Dc(6),d.Pb(),d.Qb(7,"label-value",7),d.Dc(8),d.ac(9,"currency"),d.Pb(),d.Qb(10,"label-value",7),d.Dc(11),d.Pb(),d.Qb(12,"h3"),d.Dc(13),d.Pb(),d.Qb(14,"label-value",7),d.Dc(15),d.ac(16,"currency"),d.Pb(),d.Qb(17,"label-value",7),d.Dc(18),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("label",e.i18n.account.account),d.xb(1),d.Fc(" ",e.data.account.type.name," "),d.xb(2),d.Ec(e.i18n.account.balanceLimits.negativeLimit),d.xb(1),d.gc("label",e.i18n.account.balanceLimits.negativeLimit),d.xb(1),d.Fc(" ",d.cc(9,14,e.data.creditLimit,e.data.account.currency)," "),d.xb(2),d.gc("label",e.i18n.account.limits.mode),d.xb(1),d.Fc(" ",e.data.customCreditLimit?e.i18n.account.limits.personalized:e.i18n.account.limits.productDefault," "),d.xb(2),d.Ec(e.i18n.account.balanceLimits.positiveLimit),d.xb(1),d.gc("label",e.i18n.account.balanceLimits.positiveLimit),d.xb(1),d.Fc(" ",e.data.upperCreditLimit?d.cc(16,17,e.data.upperCreditLimit,e.data.account.currency):e.i18n.account.limits.unlimited," "),d.xb(2),d.gc("label",e.i18n.account.limits.mode),d.xb(1),d.Fc(" ",e.upperCreditLimitMode()," ")}}function $t(e,t){if(1&e&&(d.Qb(0,"page-content",3),d.ac(1,"async"),d.Bc(2,Et,19,20,"ng-container",4),d.Pb()),2&e){const e=d.Zb();d.gc("heading",e.i18n.account.balanceLimits.title.view)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.view)("headingActions",d.bc(1,4,e.headingActions$)),d.xb(2),d.gc("ngIf",e.data)}}function Rt(e,t){if(1&e&&(d.Qb(0,"tr"),d.Qb(1,"td"),d.Dc(2),d.ac(3,"date"),d.Pb(),d.Qb(4,"td"),d.Dc(5),d.Pb(),d.Qb(6,"td"),d.Dc(7),d.ac(8,"currency"),d.Pb(),d.Qb(9,"td"),d.Dc(10),d.ac(11,"currency"),d.Pb(),d.Qb(12,"td"),d.Dc(13),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.Ec(d.bc(3,5,e.date)),d.xb(3),d.Ec(e.by.display),d.xb(2),d.Fc(" ",e.customCreditLimit?d.cc(8,7,e.creditLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customUpperCreditLimit?e.upperCreditLimit?d.cc(11,10,e.upperCreditLimit,n.data.account.currency):n.i18n.account.limits.unlimited:n.i18n.account.limits.productDefault," "),d.xb(3),d.Ec(e.comment)}}function Zt(e,t){if(1&e&&(d.Qb(0,"table",11),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Qb(10,"th"),d.Dc(11),d.Pb(),d.Pb(),d.Qb(12,"tbody"),d.Bc(13,Rt,14,13,"tr",12),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(3),d.Ec(e.i18n.general.date),d.xb(2),d.Ec(e.i18n.general.performedBy),d.xb(2),d.Ec(e.i18n.account.balanceLimits.negative),d.xb(2),d.Ec(e.i18n.account.balanceLimits.positive),d.xb(2),d.Ec(e.i18n.general.comments),d.xb(2),d.gc("ngForOf",e.data.history)}}function Mt(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"page-content",8),d.ac(2,"async"),d.Lb(3,"user-info",6),d.Pb(),d.Qb(4,"results-layout",9),d.Bc(5,Zt,14,6,"table",10),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("mode","empty")("heading",e.i18n.account.balanceLimits.title.history)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.history)("headingActions",d.bc(2,6,e.headingActions$)),d.xb(2),d.gc("user",e.data.user),d.xb(1),d.gc("results",e.data.history)}}let Ht=(()=>{class e extends ut.a{constructor(e,t){super(e),this.balanceLimitsService=t,this.step$=new u.a("details")}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.detailsHeadingActions=e.editable?[new At.c("edit",this.i18n.general.edit,()=>this.navigateToEdit())]:[],this.detailsHeadingActions.push(new At.c("history",this.i18n.general.viewHistory,()=>this.showHistory())),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=e.editable?[new At.c("edit",this.i18n.general.edit,()=>this.navigateToEdit())]:[],this.historyHeadingActions.push(new At.c("arrow_back",this.i18n.general.details,()=>this.showView()))}upperCreditLimitMode(){return this.data.upperCreditLimit?this.data.customUpperCreditLimit?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault:this.data.customUpperCreditLimit?this.i18n.account.limits.unlimited:this.i18n.account.limits.productDefault}showHistory(){this.headingActions=this.historyHeadingActions,this.step="history"}showView(){this.headingActions=this.detailsHeadingActions,this.step="details"}navigateToEdit(){this.router.navigate(["/banking",this.user,"account-balance-limits",this.accountType,"edit"])}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(lt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["view-account-balance-limits"]],features:[d.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],["class","table",4,"resultTable"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,$t,3,6,"page-content",1),d.Bc(4,Mt,6,8,"ng-container",2),d.Pb()),2&e&&(d.gc("ready",d.bc(1,4,t.data$))("ngSwitch",d.bc(2,6,t.step$)),d.xb(3),d.gc("ngSwitchCase","details"),d.xb(1),d.gc("ngSwitchCase","history"))},directives:[m.a,f.x,f.y,g.a,f.t,v.a,P.a,ht.a,p.a,y.a,f.s],pipes:[f.b,O.a,z.a],encapsulation:2,changeDetection:0}),e})();var qt=n("TJod");function Ut(e,t){if(1&e&&(d.Ob(0,4),d.Qb(1,"label-value",5),d.Lb(2,"user-link",6),d.Pb(),d.Qb(3,"label-value",7),d.Dc(4),d.Pb(),d.Qb(5,"div",8),d.Qb(6,"h3"),d.Dc(7),d.Pb(),d.Lb(8,"single-selection-field",9),d.Lb(9,"decimal-field",10),d.ac(10,"async"),d.ac(11,"async"),d.Qb(12,"label-value",11),d.ac(13,"async"),d.Dc(14),d.ac(15,"currency"),d.Pb(),d.Pb(),d.Qb(16,"div",8),d.Qb(17,"h3"),d.Dc(18),d.Pb(),d.Lb(19,"single-selection-field",12),d.Lb(20,"decimal-field",13),d.ac(21,"async"),d.ac(22,"async"),d.Qb(23,"label-value",11),d.ac(24,"async"),d.Dc(25),d.ac(26,"currency"),d.Pb(),d.Pb(),d.Qb(27,"div",8),d.Qb(28,"h3"),d.Dc(29),d.Pb(),d.Lb(30,"single-selection-field",14),d.Lb(31,"decimal-field",15),d.ac(32,"async"),d.ac(33,"async"),d.Qb(34,"label-value",11),d.ac(35,"async"),d.Dc(36),d.ac(37,"currency"),d.Pb(),d.Pb(),d.Qb(38,"div",8),d.Qb(39,"h3"),d.Dc(40),d.Pb(),d.Lb(41,"single-selection-field",16),d.Lb(42,"decimal-field",17),d.ac(43,"async"),d.ac(44,"async"),d.Qb(45,"label-value",11),d.ac(46,"async"),d.Dc(47),d.ac(48,"currency"),d.Pb(),d.Pb(),d.Lb(49,"textarea-field",18),d.Nb()),2&e){const e=d.Zb();d.gc("formGroup",e.form),d.xb(1),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("label",e.i18n.account.account),d.xb(1),d.Fc(" ",e.data.account.type.name," "),d.xb(3),d.Ec(e.i18n.account.paymentLimits.paymentLimit),d.xb(1),d.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),d.xb(1),d.gc("hidden",d.bc(10,54,e.isDefaultPaymentLimit$))("required",!d.bc(11,56,e.isDefaultPaymentLimit$))("label",e.i18n.account.paymentLimits.paymentLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),d.xb(3),d.gc("hidden",!d.bc(13,58,e.isDefaultPaymentLimit$))("label",e.i18n.account.paymentLimits.paymentLimit),d.xb(2),d.Fc(" ",d.cc(15,60,e.data.productAmountLimit?e.data.productAmountLimit:0,e.data.account.currency)," "),d.xb(4),d.Ec(e.i18n.account.paymentLimits.dailyLimit),d.xb(1),d.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),d.xb(1),d.gc("hidden",d.bc(21,63,e.isDefaultDailyLimit$))("required",!d.bc(22,65,e.isDefaultDailyLimit$))("label",e.i18n.account.paymentLimits.dailyLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),d.xb(3),d.gc("hidden",!d.bc(24,67,e.isDefaultDailyLimit$))("label",e.i18n.account.paymentLimits.dailyLimit),d.xb(2),d.Fc(" ",d.cc(26,69,e.data.productAmountPerDayLimit?e.data.productAmountPerDayLimit:0,e.data.account.currency)," "),d.xb(4),d.Ec(e.i18n.account.paymentLimits.weeklyLimit),d.xb(1),d.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),d.xb(1),d.gc("hidden",d.bc(32,72,e.isDefaultWeeklyLimit$))("required",!d.bc(33,74,e.isDefaultWeeklyLimit$))("label",e.i18n.account.paymentLimits.weeklyLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),d.xb(3),d.gc("hidden",!d.bc(35,76,e.isDefaultWeeklyLimit$))("label",e.i18n.account.paymentLimits.weeklyLimit),d.xb(2),d.Fc(" ",d.cc(37,78,e.data.productAmountPerWeekLimit?e.data.productAmountPerWeekLimit:0,e.data.account.currency)," "),d.xb(4),d.Ec(e.i18n.account.paymentLimits.monthlyLimit),d.xb(1),d.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),d.xb(1),d.gc("hidden",d.bc(43,81,e.isDefaultMonthlyLimit$))("required",!d.bc(44,83,e.isDefaultMonthlyLimit$))("label",e.i18n.account.paymentLimits.monthlyLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),d.xb(3),d.gc("hidden",!d.bc(46,85,e.isDefaultMonthlyLimit$))("label",e.i18n.account.paymentLimits.monthlyLimit),d.xb(2),d.Fc(" ",d.cc(48,87,e.data.productAmountPerMonthLimit?e.data.productAmountPerMonthLimit:0,e.data.account.currency)," "),d.xb(2),d.gc("label",e.i18n.general.comments)}}let Vt=(()=>{class e extends ut.a{constructor(e,t){super(e),this.paymentLimitsService=t,this.isDefaultPaymentLimit$=new u.a(null),this.isDefaultDailyLimit$=new u.a(null),this.isDefaultWeeklyLimit$=new u.a(null),this.isDefaultMonthlyLimit$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}get modeOptions(){const e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e}mode(e){return e?"personalized":"default"}onDataInitialized(e){super.onDataInitialized(e);const t=this.mode(e.customAmountLimit),n=this.mode(e.customAmountPerDayLimit),i=this.mode(e.customAmountPerWeekLimit),a=this.mode(e.customAmountPerMonthLimit);this.form=this.formBuilder.group({paymentLimitMode:t,amountLimit:e.amountLimit,dailyLimitMode:n,amountPerDayLimit:e.amountPerDayLimit,weeklyLimitMode:i,amountPerWeekLimit:e.amountPerWeekLimit,monthlyLimitMode:a,amountPerMonthLimit:e.amountPerMonthLimit,comment:null}),this.formControl("paymentLimitMode").valueChanges.subscribe(e=>this.isDefaultPaymentLimit$.next("default"===e)),this.isDefaultPaymentLimit$.next("default"===t),this.formControl("dailyLimitMode").valueChanges.subscribe(e=>this.isDefaultDailyLimit$.next("default"===e)),this.isDefaultDailyLimit$.next("default"===n),this.formControl("weeklyLimitMode").valueChanges.subscribe(e=>this.isDefaultWeeklyLimit$.next("default"===e)),this.isDefaultWeeklyLimit$.next("default"===i),this.formControl("monthlyLimitMode").valueChanges.subscribe(e=>this.isDefaultMonthlyLimit$.next("default"===e)),this.isDefaultMonthlyLimit$.next("default"===a)}save(){if(Object(s.F)(this.form),!this.form.valid)return;const e=Object(bt.a)(this.form.value);e.customAmountLimit="default"!==e.paymentLimitMode,e.customAmountLimit||delete e.amountLimit,e.customAmountPerDayLimit="default"!==e.dailyLimitMode,e.customAmountPerDayLimit||delete e.amountPerDayLimit,e.customAmountPerWeekLimit="default"!==e.weeklyLimitMode,e.customAmountPerWeekLimit||delete e.amountPerWeekLimit,e.customAmountPerMonthLimit="default"!==e.monthlyLimitMode,e.customAmountPerMonthLimit||delete e.amountPerMonthLimit,delete e.creditLimitMode,delete e.upperCreditLimitMode,this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.account.paymentLimits.confirm,createDeviceConfirmation:this.paymentLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:t=>this.doSave(e,t.confirmationPassword)}):this.doSave(e)}doSave(e,t){this.addSub(this.paymentLimitsService.setAccountPaymentLimits({user:this.user,accountType:this.accountType,confirmationPassword:t,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.account.paymentLimits.saved),this.reload()}))}paymentLimitsDeviceConfirmation(){return()=>({type:i.s.CHANGE_ACCOUNT_LIMITS,account:this.data.account.id})}formControl(e){return this.form.get(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(qt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["edit-account-payment-limits"]],features:[d.ub],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mt-3"],["labelPosition","side","formControlName","paymentLimitMode",3,"label","fieldOptions"],["formControlName","amountLimit",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","dailyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerDayLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","weeklyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerWeekLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","monthlyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerMonthLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Qb(2,"page-content",1),d.ac(3,"async"),d.Bc(4,Ut,50,90,"ng-container",2),d.Qb(5,"actions"),d.Qb(6,"action-button",3),d.Xb("action",(function(){return t.save()})),d.ac(7,"async"),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.gc("ready",d.bc(1,7,t.data$)),d.xb(2),d.gc("heading",t.i18n.account.paymentLimits.title.edit)("mobileHeading",t.i18n.account.paymentLimits.mobileTitle.edit)("headingActions",d.bc(3,9,t.headingActions$)),d.xb(2),d.gc("ngIf",t.data),d.xb(2),d.gc("disabled",d.bc(7,11,t.requesting$))("label",t.i18n.general.save))},directives:[m.a,g.a,f.t,dt.a,mt.a,x.w,x.n,v.a,P.a,D.a,x.v,x.l,Q.a,x.D,ft.a],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();function zt(e,t){if(1&e){const e=d.Rb();d.Qb(0,"tr",8),d.Xb("click",(function(n){d.sc(e);const i=t.$implicit,a=d.Zb(3);return a.router.navigate(a.path(i.account.type)),n.stopPropagation()})),d.Qb(1,"td",9),d.Dc(2),d.Pb(),d.Qb(3,"td"),d.Dc(4),d.ac(5,"currency"),d.Pb(),d.Qb(6,"td"),d.Dc(7),d.ac(8,"currency"),d.Pb(),d.Qb(9,"td"),d.Dc(10),d.ac(11,"currency"),d.Pb(),d.Qb(12,"td"),d.Dc(13),d.ac(14,"currency"),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.Ec(e.account.type.name),d.xb(2),d.Fc(" ",e.amountLimit?d.cc(5,5,e.amountLimit,e.account.currency):n.i18n.account.limits.unlimited," "),d.xb(3),d.Fc(" ",e.amountPerDayLimit?d.cc(8,8,e.amountPerDayLimit,e.account.currency):n.i18n.account.limits.unlimited," "),d.xb(3),d.Fc(" ",e.amountPerWeekLimit?d.cc(11,11,e.amountPerWeekLimit,e.account.currency):n.i18n.account.limits.unlimited," "),d.xb(3),d.Fc(" ",e.amountPerMonthLimit?d.cc(14,14,e.amountPerMonthLimit,e.account.currency):n.i18n.account.limits.unlimited," ")}}function jt(e,t){if(1&e&&(d.Qb(0,"table",6),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Qb(10,"th"),d.Dc(11),d.Pb(),d.Pb(),d.Qb(12,"tbody"),d.Bc(13,zt,15,17,"tr",7),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(3),d.Ec(e.i18n.account.account),d.xb(2),d.Ec(e.i18n.account.paymentLimits.paymentLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.dailyLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.weeklyLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.monthlyLimit),d.xb(2),d.gc("ngForOf",e.data.accountLimits)}}function Gt(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"page-content",2),d.ac(2,"async"),d.Lb(3,"user-info",3),d.Pb(),d.Qb(4,"results-layout",4),d.Bc(5,jt,14,6,"table",5),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("mode","normal")("heading",e.i18n.account.paymentLimits.title.list)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.list)("headingActions",d.bc(2,6,e.headingActions$)),d.xb(2),d.gc("user",e.data.user),d.xb(1),d.gc("results",e.data.accountLimits)}}let _t=(()=>{class e extends ut.a{constructor(e,t){super(e),this.paymentLimitsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.paymentLimitsService.getDataForUserPaymentLimits({user:this.user}).subscribe(e=>{1===e.accountLimits.length&&this.router.navigate(this.path(e.accountLimits[0].account.type)),this.data=e}))}path(e){return["/banking",this.user,"account-payment-limits",e.id]}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(qt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["list-accounts-payment-limits"]],features:[d.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Gt,6,8,"ng-container",1),d.Pb()),2&e&&(d.gc("ready",d.bc(1,2,t.data$)),d.xb(2),d.gc("ngIf",t.data))},directives:[m.a,f.t,g.a,ht.a,p.a,y.a,f.s],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();function Kt(e,t){1&e&&d.Mb(0)}function Xt(e,t){if(1&e&&d.Lb(0,"field-option",14),2&e){const e=t.$implicit,n=d.Zb(3);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function Yt(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"multi-selection-field",12),d.Bc(2,Xt,1,5,"field-option",13),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.user.groupFilter),d.xb(1),d.gc("ngForOf",e.data.groups)}}function Wt(e,t){if(1&e&&d.Lb(0,"field-option",17),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function Jt(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"single-selection-field",15),d.Bc(2,Wt,1,2,"field-option",16),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.currencies)}}function en(e,t){if(1&e&&d.Lb(0,"field-option",37),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e.id)("text",e.name)}}function tn(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"single-selection-field",35),d.Bc(2,en,1,3,"field-option",36),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.account.account)("emptyOption",e.i18n.general.all),d.xb(1),d.gc("ngForOf",e.accountTypes())}}function nn(e,t){if(1&e&&(d.Ob(0),d.Bc(1,tn,3,3,"div",6),d.Qb(2,"div",11),d.Lb(3,"single-selection-field",18),d.Pb(),d.Lb(4,"div",19),d.ac(5,"async"),d.Qb(6,"div",20),d.ac(7,"async"),d.Lb(8,"decimal-field",21),d.Pb(),d.Qb(9,"div",20),d.ac(10,"async"),d.Lb(11,"decimal-field",22),d.Pb(),d.Qb(12,"div",11),d.Lb(13,"single-selection-field",23),d.Pb(),d.Lb(14,"div",19),d.ac(15,"async"),d.Qb(16,"div",20),d.ac(17,"async"),d.Lb(18,"decimal-field",24),d.Pb(),d.Qb(19,"div",20),d.ac(20,"async"),d.Lb(21,"decimal-field",25),d.Pb(),d.Qb(22,"div",11),d.Lb(23,"single-selection-field",26),d.Pb(),d.Lb(24,"div",19),d.ac(25,"async"),d.Qb(26,"div",20),d.ac(27,"async"),d.Lb(28,"decimal-field",27),d.Pb(),d.Qb(29,"div",20),d.ac(30,"async"),d.Lb(31,"decimal-field",28),d.Pb(),d.Qb(32,"div",11),d.Lb(33,"single-selection-field",29),d.Pb(),d.Lb(34,"div",19),d.ac(35,"async"),d.Qb(36,"div",20),d.ac(37,"async"),d.Lb(38,"decimal-field",30),d.Pb(),d.Qb(39,"div",20),d.ac(40,"async"),d.Lb(41,"decimal-field",31),d.Pb(),d.Qb(42,"div",11),d.Lb(43,"user-field",32),d.Pb(),d.Qb(44,"div",11),d.Lb(45,"user-field",33),d.Pb(),d.Qb(46,"div",11),d.Lb(47,"user-field",34),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.xb(2),d.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedPaymentLimit),d.xb(1),d.gc("hidden",!d.bc(5,65,e.isCustomPaymentLimit$)),d.xb(2),d.gc("hidden",!d.bc(7,67,e.isCustomPaymentLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.fromPaymentLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(1),d.gc("hidden",!d.bc(10,69,e.isCustomPaymentLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.toPaymentLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedDailyLimit),d.xb(1),d.gc("hidden",!d.bc(15,71,e.isCustomDailyLimit$)),d.xb(2),d.gc("hidden",!d.bc(17,73,e.isCustomDailyLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.fromDailyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(1),d.gc("hidden",!d.bc(20,75,e.isCustomDailyLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.toDailyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedWeeklyLimit),d.xb(1),d.gc("hidden",!d.bc(25,77,e.isCustomWeeklyLimit$)),d.xb(2),d.gc("hidden",!d.bc(27,79,e.isCustomWeeklyLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.fromWeeklyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(1),d.gc("hidden",!d.bc(30,81,e.isCustomWeeklyLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.toWeeklyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedMonthlyLimit),d.xb(1),d.gc("hidden",!d.bc(35,83,e.isCustomMonthlyLimit$)),d.xb(2),d.gc("hidden",!d.bc(37,85,e.isCustomMonthlyLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.fromMonthlyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(1),d.gc("hidden",!d.bc(40,87,e.isCustomMonthlyLimit$)),d.xb(2),d.gc("label",e.i18n.account.paymentLimits.toMonthlyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("label",e.i18n.general.user)("allowContacts",!1),d.xb(2),d.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters(!0))("allowContacts",!1),d.xb(2),d.gc("label",e.i18n.general.changedBy)("filters",e.userSearchFilters(!1))("allowContacts",!1)}}function an(e,t){if(1&e){const e=d.Rb();d.Qb(0,"mobile-result",38),d.Xb("click",(function(n){d.sc(e);const i=t.$implicit,a=d.Zb(2);return a.router.navigate(a.view(i)),n.stopPropagation()})),d.Qb(1,"div",39),d.Qb(2,"div",40),d.Qb(3,"label-value",41),d.Dc(4),d.Pb(),d.Qb(5,"label-value",41),d.Dc(6),d.Pb(),d.Qb(7,"label-value",41),d.Dc(8),d.ac(9,"currency"),d.Pb(),d.Qb(10,"label-value",41),d.Dc(11),d.ac(12,"currency"),d.Pb(),d.Qb(13,"label-value",41),d.Dc(14),d.ac(15,"currency"),d.Pb(),d.Qb(16,"label-value",41),d.Dc(17),d.ac(18,"currency"),d.Pb(),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(2);d.xb(3),d.gc("label",n.i18n.general.user),d.xb(1),d.Fc(" ",e.user.display," "),d.xb(1),d.gc("label",n.i18n.account.account),d.xb(1),d.Fc(" ",e.account.type.name," "),d.xb(1),d.gc("label",n.i18n.account.paymentLimits.paymentLimit),d.xb(1),d.Fc(" ",e.customAmountLimit?d.cc(9,12,e.amountLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(2),d.gc("label",n.i18n.account.paymentLimits.dailyLimit),d.xb(1),d.Fc(" ",e.customAmountPerDayLimit?d.cc(12,15,e.amountPerDayLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(2),d.gc("label",n.i18n.account.paymentLimits.weeklyLimit),d.xb(1),d.Fc(" ",e.customAmountPerWeekLimit?d.cc(15,18,e.amountPerWeekLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(2),d.gc("label",n.i18n.account.paymentLimits.monthlyLimit),d.xb(1),d.Fc(" ",e.customAmountPerMonthLimit?d.cc(18,21,e.amountPerMonthLimit,e.account.currency):n.i18n.account.limits.productDefault," ")}}function cn(e,t){if(1&e){const e=d.Rb();d.Qb(0,"tr",38),d.Xb("click",(function(n){d.sc(e);const i=t.$implicit,a=d.Zb(3);return a.router.navigate(a.view(i)),n.stopPropagation()})),d.Qb(1,"td"),d.Dc(2),d.Pb(),d.Qb(3,"td"),d.Dc(4),d.Pb(),d.Qb(5,"td"),d.Dc(6),d.ac(7,"currency"),d.Pb(),d.Qb(8,"td"),d.Dc(9),d.ac(10,"currency"),d.Pb(),d.Qb(11,"td"),d.Dc(12),d.ac(13,"currency"),d.Pb(),d.Qb(14,"td"),d.Dc(15),d.ac(16,"currency"),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.Ec(e.user.display),d.xb(2),d.Ec(e.account.type.name),d.xb(2),d.Fc(" ",e.customAmountLimit?d.cc(7,6,e.amountLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customAmountPerDayLimit?d.cc(10,9,e.amountPerDayLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customAmountPerWeekLimit?d.cc(13,12,e.amountPerWeekLimit,e.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customAmountPerMonthLimit?d.cc(16,15,e.amountPerMonthLimit,e.account.currency):n.i18n.account.limits.productDefault," ")}}function rn(e,t){if(1&e&&(d.Qb(0,"table",42),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Qb(10,"th"),d.Dc(11),d.Pb(),d.Qb(12,"th"),d.Dc(13),d.Pb(),d.Pb(),d.Qb(14,"tbody"),d.Bc(15,cn,17,18,"tr",43),d.ac(16,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.general.user),d.xb(2),d.Ec(e.i18n.account.account),d.xb(2),d.Ec(e.i18n.account.paymentLimits.paymentLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.dailyLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.weeklyLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.monthlyLimit),d.xb(2),d.gc("ngForOf",null==(n=d.bc(16,7,e.results$))?null:n.results)}}function on(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.ac(1,"async"),d.Qb(2,"form",4),d.Qb(3,"div",5),d.Bc(4,Yt,3,2,"div",6),d.Bc(5,Jt,3,3,"div",6),d.Bc(6,nn,48,89,"ng-container",7),d.ac(7,"async"),d.Pb(),d.Pb(),d.Pb(),d.Qb(8,"results-layout",8),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(9,"async"),d.Bc(10,an,19,24,"mobile-result",9),d.Bc(11,rn,17,9,"table",10),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.account.paymentLimits.title.overview)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.overview)("headingActions",d.bc(1,9,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),d.xb(1),d.gc("ngIf",(null==e.currencies?null:e.currencies.length)>1),d.xb(1),d.gc("ngIf",d.bc(7,11,e.moreFilters$)),d.xb(2),d.gc("results",d.bc(9,13,e.results$))("rendering$",e.rendering$)}}let sn=(()=>{class e extends o.a{constructor(e,t){super(e),this.paymentLimitsService=t,this.isCustomPaymentLimit$=new u.a(!1),this.isCustomDailyLimit$=new u.a(!1),this.isCustomWeeklyLimit$=new u.a(!1),this.isCustomMonthlyLimit$=new u.a(!1),this.currencies=[]}getFormControlNames(){return["accountType","broker","brokers","by","currency","customAmountLimit","paymentLimitFrom","paymentLimitTo","dailyLimitFrom","dailyLimitTo","customAmountPerDayLimit","customAmountPerWeekLimit","weeklyLimitFrom","weeklyLimitTo","customAmountPerMonthLimit","monthlyLimitFrom","monthlyLimitTo","groups","user"]}ngOnInit(){super.ngOnInit(),this.addSub(this.paymentLimitsService.getAccountPaymentLimitsData().subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),(e.accountTypes||[]).forEach(e=>this.currencies.push(e.currency)),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customAmountLimit").valueChanges.subscribe(e=>this.isCustomPaymentLimit$.next("yes"===e)),this.form.get("customAmountPerDayLimit").valueChanges.subscribe(e=>this.isCustomDailyLimit$.next("yes"===e)),this.form.get("customAmountPerWeekLimit").valueChanges.subscribe(e=>this.isCustomWeeklyLimit$.next("yes"===e)),this.form.get("customAmountPerMonthLimit").valueChanges.subscribe(e=>this.isCustomMonthlyLimit$.next("yes"===e)),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e))),this.headingActions=[this.moreFiltersAction]}doSearch(e){return this.paymentLimitsService.searchAccountPaymentLimits$Response(e)}toSearchParams(e){const t=e;return this.isCustomPaymentLimit$.value?(t.customAmountLimit=!0,t.customAmountLimitRange=r.a.rangeFilter(e.paymentLimitFrom,e.paymentLimitTo)):t.customAmountLimit=!e.customAmountLimit&&null,this.isCustomDailyLimit$.value?(t.customAmountPerDayLimit=!0,t.customAmountPerDayLimitRange=r.a.rangeFilter(e.dailyLimitFrom,e.dailyLimitTo)):t.customAmountPerDayLimit=!e.customAmountPerDayLimit&&null,this.isCustomWeeklyLimit$.value?(t.customAmountPerWeekLimit=!0,t.customAmountPerWeekLimitRange=r.a.rangeFilter(e.weeklyLimitFrom,e.weeklyLimitTo)):t.customAmountPerWeekLimit=!e.customAmountPerWeekLimit&&null,this.isCustomMonthlyLimit$.value?(t.customAmountPerMonthLimit=!0,t.customAmountPerMonthLimitRange=r.a.rangeFilter(e.monthlyLimitFrom,e.monthlyLimitTo)):t.customAmountPerMonthLimit=!e.customAmountPerMonthLimit&&null,t}get customLimitOptions(){const e=[{value:"yes",text:this.i18n.general.yes}];return e.push({value:"no",text:this.i18n.general.no}),e}userSearchFilters(e){const t={roles:[i.kb.BROKER]};return e||t.roles.push(i.kb.ADMINISTRATOR),t}updateAccountTypes(e){const t=this.form.controls.accountType.value;e&&t&&this.data.accountTypes.find(e=>e.id===t).currency.id!==e&&this.form.controls.accountType.setValue(null)}accountTypes(){const e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter(t=>t.currency.id===e.id):t}findCurrency(e){if(this.singleCurrency)return this.singleCurrency;const t=this.form.controls.currency.value;if(t)return this.currencies.find(e=>e.id===t);const n=this.form.controls.accountType.value;return e&&n?this.data.accountTypes.find(e=>e.id===n).currency:null}currencyDecimalDigits(){const e=this.findCurrency(!0);return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency(!0);return e?e.prefix:null}currencySuffix(){const e=this.findCurrency(!0);return e?e.suffix:null}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}view(e){return["/banking",e.user.id,"account-payment-limits",e.account.type.id]}resolveMenu(){return new l.a(l.b.ACCOUNT_PAYMENT_LIMITS_OVERVIEW)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(qt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-payment-limits-overview"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","customAmountLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","paymentLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","paymentLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerDayLimit",3,"fieldOptions","emptyOption","label"],["formControlName","dailyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","dailyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerWeekLimit",3,"fieldOptions","emptyOption","label"],["formControlName","weeklyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","weeklyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerMonthLimit",3,"fieldOptions","emptyOption","label"],["formControlName","monthlyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","monthlyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label","allowContacts"],["labelPosition","side","formControlName","broker",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","by",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Kt,1,0,"ng-container",1),d.Pb(),d.Bc(3,on,12,15,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,p.a,h.a,y.a,w.a,x.v,x.l,f.s,L.a,D.a,Q.a,F.a,q.a,v.a],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();function ln(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"label-value",5),d.Lb(2,"user-link",6),d.Pb(),d.Qb(3,"label-value",7),d.Dc(4),d.Pb(),d.Qb(5,"h3"),d.Dc(6),d.Pb(),d.Qb(7,"label-value",7),d.Dc(8),d.ac(9,"currency"),d.Pb(),d.Qb(10,"label-value",7),d.Dc(11),d.Pb(),d.Qb(12,"h3"),d.Dc(13),d.Pb(),d.Qb(14,"label-value",7),d.Dc(15),d.ac(16,"currency"),d.Pb(),d.Qb(17,"label-value",7),d.Dc(18),d.Pb(),d.Qb(19,"h3"),d.Dc(20),d.Pb(),d.Qb(21,"label-value",7),d.Dc(22),d.ac(23,"currency"),d.Pb(),d.Qb(24,"label-value",7),d.Dc(25),d.Pb(),d.Qb(26,"h3"),d.Dc(27),d.Pb(),d.Qb(28,"label-value",7),d.Dc(29),d.ac(30,"currency"),d.Pb(),d.Qb(31,"label-value",7),d.Dc(32),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("label",e.i18n.account.account),d.xb(1),d.Fc(" ",e.data.account.type.name," "),d.xb(2),d.Ec(e.i18n.account.paymentLimits.paymentLimit),d.xb(1),d.gc("label",e.i18n.account.paymentLimits.paymentLimit),d.xb(1),d.Fc(" ",d.cc(9,24,e.data.amountLimit,e.data.account.currency)," "),d.xb(2),d.gc("label",e.i18n.account.limits.mode),d.xb(1),d.Fc(" ",e.limitMode(e.data.customAmountLimit)," "),d.xb(2),d.Ec(e.i18n.account.paymentLimits.dailyLimit),d.xb(1),d.gc("label",e.i18n.account.paymentLimits.dailyLimit),d.xb(1),d.Fc(" ",d.cc(16,27,e.data.amountLimit,e.data.account.currency)," "),d.xb(2),d.gc("label",e.i18n.account.limits.mode),d.xb(1),d.Fc(" ",e.limitMode(e.data.customAmountLimit)," "),d.xb(2),d.Ec(e.i18n.account.paymentLimits.weeklyLimit),d.xb(1),d.gc("label",e.i18n.account.paymentLimits.weeklyLimit),d.xb(1),d.Fc(" ",d.cc(23,30,e.data.amountLimit,e.data.account.currency)," "),d.xb(2),d.gc("label",e.i18n.account.limits.mode),d.xb(1),d.Fc(" ",e.limitMode(e.data.customAmountLimit)," "),d.xb(2),d.Ec(e.i18n.account.paymentLimits.monthlyLimit),d.xb(1),d.gc("label",e.i18n.account.paymentLimits.monthlyLimit),d.xb(1),d.Fc(" ",d.cc(30,33,e.data.amountLimit,e.data.account.currency)," "),d.xb(2),d.gc("label",e.i18n.account.limits.mode),d.xb(1),d.Fc(" ",e.limitMode(e.data.customAmountLimit)," ")}}function un(e,t){if(1&e&&(d.Qb(0,"page-content",3),d.ac(1,"async"),d.Bc(2,ln,33,36,"ng-container",4),d.Pb()),2&e){const e=d.Zb();d.gc("heading",e.i18n.account.paymentLimits.title.view)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.view)("headingActions",d.bc(1,4,e.headingActions$)),d.xb(2),d.gc("ngIf",e.data)}}function bn(e,t){if(1&e&&(d.Qb(0,"tr"),d.Qb(1,"td"),d.Dc(2),d.ac(3,"date"),d.Pb(),d.Qb(4,"td"),d.Dc(5),d.Pb(),d.Qb(6,"td"),d.Dc(7),d.ac(8,"currency"),d.Pb(),d.Qb(9,"td"),d.Dc(10),d.ac(11,"currency"),d.Pb(),d.Qb(12,"td"),d.Dc(13),d.ac(14,"currency"),d.Pb(),d.Qb(15,"td"),d.Dc(16),d.ac(17,"currency"),d.Pb(),d.Qb(18,"td"),d.Dc(19),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.Ec(d.bc(3,7,e.date)),d.xb(3),d.Ec(e.by.display),d.xb(2),d.Fc(" ",e.customAmountLimit?d.cc(8,9,e.amountLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customAmountPerDayLimit?d.cc(11,12,e.amountPerDayLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customAmountPerWeekLimit?d.cc(14,15,e.amountPerWeekLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Fc(" ",e.customAmountPerMonthLimit?d.cc(17,18,e.amountPerMonthLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),d.xb(3),d.Ec(e.comment)}}function dn(e,t){if(1&e&&(d.Qb(0,"table",11),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Qb(10,"th"),d.Dc(11),d.Pb(),d.Qb(12,"th"),d.Dc(13),d.Pb(),d.Qb(14,"th"),d.Dc(15),d.Pb(),d.Pb(),d.Qb(16,"tbody"),d.Bc(17,bn,20,21,"tr",12),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(3),d.Ec(e.i18n.general.date),d.xb(2),d.Ec(e.i18n.general.performedBy),d.xb(2),d.Ec(e.i18n.account.paymentLimits.paymentLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.dailyLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.weeklyLimit),d.xb(2),d.Ec(e.i18n.account.paymentLimits.monthlyLimit),d.xb(2),d.Ec(e.i18n.general.comments),d.xb(2),d.gc("ngForOf",e.data.history)}}function mn(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"page-content",8),d.ac(2,"async"),d.Lb(3,"user-info",6),d.Pb(),d.Qb(4,"results-layout",9),d.Bc(5,dn,18,8,"table",10),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("mode","empty")("heading",e.i18n.account.paymentLimits.title.history)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.history)("headingActions",d.bc(2,6,e.headingActions$)),d.xb(2),d.gc("user",e.data.user),d.xb(1),d.gc("results",e.data.history)}}let fn=(()=>{class e extends ut.a{constructor(e,t){super(e),this.paymentLimitsService=t,this.step$=new u.a("details")}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.detailsHeadingActions=e.editable?[new At.c("edit",this.i18n.general.edit,()=>this.navigateToEdit())]:[],this.detailsHeadingActions.push(new At.c("history",this.i18n.general.viewHistory,()=>this.showHistory())),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=e.editable?[new At.c("edit",this.i18n.general.edit,()=>this.navigateToEdit())]:[],this.historyHeadingActions.push(new At.c("arrow_back",this.i18n.general.details,()=>this.showView()))}limitMode(e){return e?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault}showHistory(){this.headingActions=this.historyHeadingActions,this.step="history"}showView(){this.headingActions=this.detailsHeadingActions,this.step="details"}navigateToEdit(){this.router.navigate(["/banking",this.user,"account-payment-limits",this.accountType,"edit"])}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(qt.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["view-account-payment-limits"]],features:[d.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],["class","table",4,"resultTable"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,un,3,6,"page-content",1),d.Bc(4,mn,6,8,"ng-container",2),d.Pb()),2&e&&(d.gc("ready",d.bc(1,4,t.data$))("ngSwitch",d.bc(2,6,t.step$)),d.xb(3),d.gc("ngSwitchCase","details"),d.xb(1),d.gc("ngSwitchCase","history"))},directives:[m.a,f.x,f.y,g.a,f.t,v.a,P.a,ht.a,p.a,y.a,f.s],pipes:[f.b,O.a,z.a],encapsulation:2,changeDetection:0}),e})();var gn=n("PmQH"),pn=n("dVyd"),hn=n("9d5G"),yn=n("Muja"),xn=n("SxV6");function vn(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",4),d.ac(1,"async"),d.Qb(2,"payment-step-form",5),d.Xb("availablePaymentTypes",(function(t){return d.sc(e),d.Zb().availablePaymentTypes=t})),d.ac(3,"async"),d.Pb(),d.Qb(4,"actions",6),d.Qb(5,"action-button",7),d.Xb("action",(function(){return d.sc(e),d.Zb().toConfirm()})),d.ac(6,"async"),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.title)("mobileHeading",e.mobileTitle)("mode",d.bc(1,11,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("data",e.data)("pos",e.pos)("form",e.form)("currency",d.bc(3,13,e.currency$))("paymentTypeData$",e.paymentTypeData$)("customValuesControlGetter",e.customValuesControlGetter),d.xb(3),d.gc("disabled",d.bc(6,15,e.requesting$))("label",e.i18n.general.next)}}function Pn(e,t){if(1&e){const e=d.Rb();d.Qb(0,"action-button",7),d.Xb("action",(function(){return d.sc(e),d.Zb(2).perform()})),d.ac(1,"async"),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("disabled",!e.canConfirm||d.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function Dn(e,t){1&e&&d.Dc(0,"\xa0")}const Ln=function(){return[]};function wn(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",8),d.ac(1,"async"),d.Qb(2,"payment-step-confirm",9),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().perform(t)})),d.Pb(),d.Qb(3,"actions",6),d.Bc(4,Pn,2,4,"action-button",10),d.ac(5,"async"),d.Bc(6,Dn,1,0,"ng-template",null,11,d.Cc),d.Qb(8,"action-button",12),d.Xb("action",(function(){return d.sc(e),d.Zb().backToForm()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.qc(7),t=d.Zb();d.gc("heading",t.i18n.transaction.title.paymentConfirmation)("mobileHeading",t.i18n.transaction.mobileTitle.paymentConfirmation)("mode",d.bc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("pos",t.pos)("preview",t.preview)("confirmationPassword",t.confirmationPassword)("showPaymentType",(t.availablePaymentTypes||d.ic(14,Ln)).length>1),d.xb(2),d.gc("ngIf",d.bc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),d.xb(4),d.gc("label",t.i18n.general.previous)}}function Cn(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",8),d.ac(1,"async"),d.Lb(2,"payment-step-done",13),d.Qb(3,"actions",6),d.Qb(4,"action-button",14),d.Xb("action",(function(){return d.sc(e),d.Zb().viewPerformed()})),d.Pb(),d.Qb(5,"action-button",12),d.Xb("action",(function(){return d.sc(e),d.Zb().reload()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.doneTitle)("mobileHeading",e.doneMobileTitle)("mode",d.bc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("performed",e.performed),d.xb(2),d.gc("label",e.i18n.transaction.doneView),d.xb(1),d.gc("label",e.i18n.transaction.doneNew)}}function Qn(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}const In=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("firstInstallmentIsNow").value;if(Object(s.h)(e.value)&&("futureDate"===n||n===i.Y.SCHEDULED&&!a))return{required:!0}}return null},Fn=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("repeatUntilCanceled").value;if(n===i.Y.RECURRING&&!a){const t=parseInt(e.value,10);return isNaN(t)?{required:!0}:x.G.min(2)(e)}}return null},Tn=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("firstOccurrenceIsNow").value;if(Object(s.h)(e.value)&&n===i.Y.RECURRING&&!a)return{required:!0}}return null};let Sn=(()=>{class e extends ut.a{constructor(e,t,n,i,a){super(e),this.bankingHelper=t,this.paymentsService=n,this.posService=i,this.changeDetector=a,this.ConfirmationMode=hn.a,this.steps=["form","confirm","done"],this.step$=new u.a(null),this.currency$=new u.a(null),this.paymentTypeData$=new u.a(null),this.customValuesControls=new Map,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(e){this.paymentTypeData$.next(e),this.updatePaymentTypeData(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.pos="pos"===e.url[e.url.length-1].path,this.pos||(this.fromParam=e.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=e.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam)),this.pos?(this.title=this.i18n.transaction.title.pos,this.mobileTitle=this.i18n.transaction.mobileTitle.pos):this.fromSystem?this.toSystem?(this.title=this.i18n.transaction.title.paymentSystemToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToSystem):(this.title=this.i18n.transaction.title.paymentSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToUser):this.toSelf?(this.title=this.i18n.transaction.title.paymentToSelf,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSelf):this.toSystem?(this.title=this.i18n.transaction.title.paymentToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSystem):(this.title=this.i18n.transaction.title.paymentToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToUser),this.form=this.buildForm(),this.confirmationPassword=this.formBuilder.control(null),this.addSub(this.pos?this.posService.dataForReceivePayment({}).subscribe(e=>this.data=e):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:this.toParam}).subscribe(e=>this.data=e)),this.addSub(this.form.get("account").valueChanges.subscribe(e=>this.updateCurrency(this.data,e))),this.addSub(this.paymentTypeData$.subscribe(e=>{null!=this.lastPaymentTypeData&&Object(yn.a)(this.lastPaymentTypeData,e)||this.adjustForm(e),this.lastPaymentTypeData=e})),this.addSub(this.form.valueChanges.subscribe(e=>this.adjustFormValidators(e)))}buildForm(){return this.formBuilder.group({account:null,subject:[this.pos?null:this.toParam,x.G.required],type:[null,x.G.required],amount:[null,x.G.required],description:null,scheduling:[i.Y.DIRECT,x.G.required],installmentsCount:null,firstInstallmentIsNow:!0,firstInstallmentDate:[null,In],repeatUntilCanceled:!0,occurrencesCount:[null,Fn],firstOccurrenceIsNow:!0,firstOccurrenceDate:[null,Tn]})}updateCurrency(e,t){let n=null;!Object(s.h)(t)&&e&&e.accounts&&(n=e.accounts.find(e=>e.type.id===t)),this.currency=n?n.currency:null}adjustForm(e){const t=this.form.get("description");(e||{}).descriptionAvailability===i.i.REQUIRED?t.setValidators(x.G.required):Object(s.c)(t)}adjustFormValidators(e){if(this.lastValue&&Object(yn.a)(this.lastValue,e))return;this.lastValue=e;const t=this.form.get("firstInstallmentDate");"futureDate"===e.scheduling||e.scheduling===i.Y.SCHEDULED&&!e.firstInstallmentIsNow?t.setValidators(x.G.required):Object(s.c)(t);const n=this.form.get("installmentsCount");e.scheduling===i.Y.SCHEDULED?n.setValidators(x.G.compose([x.G.required,x.G.min(2)])):Object(s.c)(n);const a=this.form.get("occurrencesCount"),c=this.form.get("firstOccurrenceDate");e.scheduling===i.Y.RECURRING?(e.repeatUntilCanceled?Object(s.c)(a):a.setValidators(x.G.compose([x.G.required,x.G.min(2)])),e.firstOccurrenceIsNow?Object(s.c)(c):c.setValidators(x.G.required)):(Object(s.c)(a),Object(s.c)(c)),this.changeDetector.detectChanges()}onDataInitialized(e){if(Object(s.h)(e.accounts))this.notification.error(this.i18n.transaction.noAccounts);else{this.step="form";const t=e.accounts[0].type.id;this.form.patchValue({account:t},{emitEvent:!1}),this.updateCurrency(e,t)}}updatePaymentTypeData(e){const t=this.form.get("amount");e&&e.fixedAmount?(t.setValue(e.fixedAmount),t.disable()):t.disabled&&t.enable()}backToForm(){this.step="form"}toConfirm(){const e={},t=this.paymentTypeData;if(t&&t.customFields)for(const n of t.customFields)e[n.internalName]=this.customValuesControlGetter(n);this.form.setControl("customValues",new x.m(e)),Object(s.F)(this.form)&&this.addSub(this.confirmDataRequest().subscribe(e=>{this.preview=e,this.step="confirm",this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.confirmationPassword.setValidators(e.confirmationPasswordInput?x.G.required:null),Object(s.y)()}))}perform(e){if(e&&this.confirmationPassword.setValue(e),!Object(s.F)(this.confirmationPassword))return;let t;t=this.pos?this.posService.receivePayment({body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}):this.paymentsService.performPayment({owner:this.fromParam,body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}),t.pipe(Object(xn.a)()).subscribe(e=>{this.performed=e,this.step="done",Object(s.y)()})}confirmDataRequest(){const e=Object(bt.a)(this.form.value),t=e;switch(e.scheduling){case"futureDate":t.scheduling=i.Y.SCHEDULED,t.installmentsCount=1;break;case i.Y.SCHEDULED:e.firstInstallmentIsNow&&(t.firstInstallmentDate=null);break;case i.Y.RECURRING:e.repeatUntilCanceled&&(t.occurrencesCount=null),e.firstOccurrenceIsNow&&(t.firstOccurrenceDate=null)}return delete e.firstInstallmentIsNow,delete e.repeatUntilCanceled,delete e.firstOccurrenceIsNow,this.pos?this.posService.previewReceivePayment({body:t}):this.paymentsService.previewPayment({owner:this.fromParam,body:t})}get doneTitle(){if(this.performed)return this.performed.authorizationStatus===i.yb.PENDING?this.i18n.transaction.title.pendingPayment:this.i18n.transaction.title.processedPayment}get doneMobileTitle(){if(this.performed)return this.performed.authorizationStatus===i.yb.PENDING?this.i18n.transaction.mobileTitle.pendingPayment:this.i18n.transaction.mobileTitle.processedPayment}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}reload(){this.step=null,this.currency=null,this.paymentTypeData=null,super.reload()}locateControl(e){return Object(s.t)(this.form,e)}get customValuesControlGetter(){return e=>{const t=e.internalName;let n=this.customValuesControls.get(t);return null==n&&(n=this.formBuilder.control(e.defaultValue,e.required?x.G.required:null),this.customValuesControls.set(t,n)),n}}resolveMenu(e){return this.pos?l.b.POS:this.fromSystem?this.toSystem?l.b.PAYMENT_TO_SYSTEM:l.b.PAYMENT_TO_USER:this.menu.userMenu(e.fromUser,this.toSystem?l.b.PAYMENT_TO_SYSTEM:this.toSelf?l.b.PAYMENT_TO_SELF:l.b.PAYMENT_TO_USER)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a),d.Kb(gn.a),d.Kb(pn.a),d.Kb(d.h))},e.\u0275cmp=d.Eb({type:e,selectors:[["payment"]],features:[d.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","pos","form","currency","paymentTypeData$","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"pos","preview","confirmationPassword","showPaymentType","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],["outline","",3,"label","action"],[1,"flex-grow-1","d-flex","flex-column",3,"performed"],[3,"label","action"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,vn,7,17,"page-content",1),d.Bc(4,wn,9,15,"page-content",2),d.Bc(5,Cn,6,8,"page-content",2),d.Bc(6,Qn,2,0,"page-content",3),d.Pb()),2&e&&(d.gc("ready",d.bc(1,5,t.data$))("ngSwitch",d.bc(2,7,t.step$)),d.xb(3),d.gc("ngSwitchCase","form"),d.xb(1),d.gc("ngSwitchCase","confirm"),d.xb(1),d.gc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),e})();var On=n("DvBi"),Nn=n("+MtR"),kn=n("978R"),Bn=n("cvAk"),An=n("nznZ"),En=n("lS/A"),$n=n("bBjs");function Rn(e,t){if(1&e&&(d.Qb(0,"notification",9),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.xb(1),d.Fc(" ",e.i18n.transaction.requiresAuthorization,"\n")}}function Zn(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Lb(1,"user-link",11),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.fromUser),d.xb(1),d.gc("user",e.fromUser)}}function Mn(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.fromAccount),d.xb(1),d.Fc(" ",e.preview.fromAccount.type.name,"\n")}}function Hn(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Lb(1,"user-link",11),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.toUser),d.xb(1),d.gc("user",e.toUser)}}function qn(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.toAccount),d.xb(1),d.Fc(" ",e.preview.toAccount.type.name,"\n")}}function Un(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.type),d.xb(1),d.Fc(" ",e.preview.paymentType.name,"\n")}}function Vn(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Dc(1),d.ac(2,"currency"),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.amount),d.xb(1),d.Fc(" ",d.cc(2,2,e.preview.mainAmount,e.preview.currency),"\n")}}function zn(e,t){if(1&e&&(d.Qb(0,"div"),d.Dc(1),d.ac(2,"currency"),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.xb(1),d.Gc(" ",e.fee.name,": ",d.cc(2,2,e.amount,n.preview.currency)," ")}}function jn(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Bc(1,zn,3,5,"div",12),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.appliedFees),d.xb(1),d.gc("ngForOf",e.fees)}}function Gn(e,t){1&e&&d.Lb(0,"custom-field-value",13),2&e&&d.gc("fieldValue",t.$implicit)}function _n(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Dc(1),d.ac(2,"date"),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.dueDate),d.xb(1),d.Fc(" ",d.bc(2,2,e.preview.installments[0].dueDate),"\n")}}function Kn(e,t){if(1&e&&(d.Qb(0,"thead"),d.Qb(1,"th"),d.Dc(2),d.Pb(),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th",15),d.Dc(6),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(2),d.Ec(e.i18n.transaction.installmentNumber),d.xb(2),d.Ec(e.i18n.transaction.dueDate),d.xb(2),d.Ec(e.i18n.transaction.amount)}}function Xn(e,t){if(1&e&&(d.Qb(0,"tr"),d.Qb(1,"td"),d.Dc(2),d.Pb(),d.Qb(3,"td"),d.Dc(4),d.ac(5,"date"),d.Pb(),d.Qb(6,"td",15),d.Dc(7),d.ac(8,"currency"),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.xb(2),d.Fc(" ",e.number," "),d.xb(2),d.Fc(" ",d.bc(5,3,e.dueDate)," "),d.xb(3),d.Fc(" ",d.cc(8,5,e.mainAmount,n.preview.currency)," ")}}function Yn(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Qb(1,"table",14),d.Bc(2,Kn,7,3,"thead",4),d.ac(3,"async"),d.Qb(4,"tbody"),d.Bc(5,Xn,9,8,"tr",12),d.Pb(),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.installments),d.xb(2),d.gc("ngIf",d.bc(3,3,e.layout.gtxs$)),d.xb(3),d.gc("ngForOf",e.preview.installments)}}function Wn(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentNowManual," ")}}function Jn(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentNowFixed(e.preview.payment.occurrencesCount)," ")}}function ei(e,t){if(1&e&&(d.Ob(0),d.Bc(1,Wn,2,1,"ng-container",4),d.Bc(2,Jn,2,1,"ng-container",4),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngIf",null==e.preview.payment.occurrencesCount),d.xb(1),d.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function ti(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.ac(2,"date"),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentDateManual(d.bc(2,1,e.preview.payment.firstOccurrenceDate))," ")}}const ni=function(e,t){return{date:e,count:t}};function ii(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.ac(2,"date"),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentDateFixed(d.kc(3,ni,d.bc(2,1,e.preview.payment.firstOccurrenceDate),e.preview.payment.occurrencesCount))," ")}}function ai(e,t){if(1&e&&(d.Bc(0,ti,3,3,"ng-container",4),d.Bc(1,ii,3,6,"ng-container",4)),2&e){const e=d.Zb(2);d.gc("ngIf",null==e.preview.payment.occurrencesCount),d.xb(1),d.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function ci(e,t){if(1&e&&(d.Qb(0,"label-value",10),d.Bc(1,ei,3,2,"ng-container",16),d.Bc(2,ai,2,2,"ng-template",null,17,d.Cc),d.Pb()),2&e){const e=d.qc(3),t=d.Zb();d.gc("label",t.i18n.transaction.recurringPayment),d.xb(1),d.gc("ngIf",null==t.preview.payment.firstOccurrenceDate)("ngIfElse",e)}}function ri(e,t){if(1&e&&d.Lb(0,"label-value",18),2&e){const e=d.Zb();d.gc("label",e.i18n.general.description)("value",e.preview.payment.description)}}function oi(e,t){1&e&&d.Lb(0,"hr")}function si(e,t){1&e&&d.Lb(0,"hr")}function li(e,t){if(1&e&&(d.Ob(0),d.Bc(1,si,1,0,"hr",4),d.ac(2,"async"),d.Qb(3,"div",19),d.Dc(4),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",d.bc(2,2,e.layout.gtxxs$)),d.xb(3),d.Ec(e.preview.confirmationMessage)}}function ui(e,t){1&e&&d.Lb(0,"hr")}function bi(e,t){1&e&&d.Lb(0,"hr")}function di(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Bc(1,bi,1,0,"hr",4),d.ac(2,"async"),d.Qb(3,"confirmation-password",20),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().confirmed.emit(t)})),d.Pb(),d.Nb()}if(2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",d.bc(2,3,e.layout.gtxxs$)),d.xb(2),d.gc("passwordInput",e.preview.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let mi=(()=>{class e extends S.a{constructor(e){super(e),this.confirmationModeChanged=new d.n,this.confirmed=new d.n}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===i.a.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===i.a.SYSTEM,this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,Object(s.h)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=()=>({type:i.s.MANAGE_PAYMENT_REQUEST,transaction:this.transaction,paymentRequestAction:i.V.ACCEPT}),this.preview.confirmationPasswordInput||this.addShortcut(Nn.k,()=>this.confirmed.emit())}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["accept-payment-request-step-confirm"]],inputs:{form:"form",preview:"preview",transaction:"transaction",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[d.ub],decls:25,vars:30,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],[3,"formGroup"],["labelPosition","side","formControlName","processDate","minDate","tomorrow","maxDate","future100","fieldSize","full",3,"label","tooltip"],["formControlName","comments",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[3,"fieldValue"],[1,"table","table-hover"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(d.Bc(0,Rn,2,1,"notification",0),d.Bc(1,Zn,2,2,"label-value",1),d.Bc(2,Mn,2,2,"label-value",1),d.Bc(3,Hn,2,2,"label-value",1),d.Bc(4,qn,2,2,"label-value",1),d.Bc(5,Un,2,2,"label-value",1),d.Bc(6,Vn,3,5,"label-value",1),d.Bc(7,jn,2,2,"label-value",1),d.Bc(8,Gn,1,1,"custom-field-value",2),d.Bc(9,_n,3,4,"label-value",1),d.Bc(10,Yn,6,5,"label-value",1),d.Bc(11,ci,4,3,"label-value",1),d.Bc(12,ri,1,2,"label-value",3),d.Bc(13,oi,1,0,"hr",4),d.ac(14,"async"),d.Qb(15,"label-value",5),d.Dc(16),d.ac(17,"currency"),d.Pb(),d.Bc(18,li,5,4,"ng-container",4),d.Qb(19,"form",6),d.Bc(20,ui,1,0,"hr",4),d.ac(21,"async"),d.Lb(22,"date-field",7),d.Lb(23,"textarea-field",8),d.Bc(24,di,4,5,"ng-container",4),d.Pb()),2&e&&(d.gc("ngIf",t.preview.pendingAuthorization),d.xb(1),d.gc("ngIf",!t.fromSelf&&t.fromUser),d.xb(1),d.gc("ngIf",t.fromSystem),d.xb(1),d.gc("ngIf",t.toUser),d.xb(1),d.gc("ngIf",t.toSystem),d.xb(1),d.gc("ngIf",t.showPaymentType),d.xb(1),d.gc("ngIf",null!=t.preview.mainAmount&&t.preview.totalAmount!==t.preview.mainAmount),d.xb(1),d.gc("ngIf",(null==t.fees?null:t.fees.length)>0),d.xb(1),d.gc("ngForOf",t.preview.customValues),d.xb(1),d.gc("ngIf",1===(null==t.preview.installments?null:t.preview.installments.length)),d.xb(1),d.gc("ngIf",(null==t.preview.installments?null:t.preview.installments.length)>1),d.xb(1),d.gc("ngIf","recurring"===t.preview.payment.scheduling),d.xb(1),d.gc("ngIf",t.preview.payment.description),d.xb(1),d.gc("ngIf",d.bc(14,23,t.layout.gtxxs$)),d.xb(2),d.gc("label",t.i18n.transaction.totalAmount),d.xb(1),d.Fc(" ",d.cc(17,25,t.preview.totalAmount,t.preview.currency),"\n"),d.xb(2),d.gc("ngIf",(t.preview.confirmationMessage||"").length>0),d.xb(1),d.gc("formGroup",t.form),d.xb(1),d.gc("ngIf",d.bc(21,28,t.layout.gtxxs$)),d.xb(2),d.gc("label",t.i18n.transaction.processDate)("tooltip",t.i18n.transaction.processDateTooltip),d.xb(1),d.gc("label",t.i18n.general.comments),d.xb(1),d.gc("ngIf",t.preview.confirmationPasswordInput))},directives:[f.t,f.s,v.a,x.I,x.w,x.n,C.a,x.v,x.l,kn.b,ft.a,Bn.a,P.a,An.a,En.a,$n.a],pipes:[f.b,O.a,z.a],encapsulation:2,changeDetection:0}),e})();var fi=n("H4pW");let gi=(()=>{class e extends S.a{constructor(e,t){super(e),this.bankingHelper=t}ngOnInit(){var e,t;super.ngOnInit();let n=!0;(null===(e=this.performed)||void 0===e?void 0:e.kind)===i.zb.PAYMENT_REQUEST?(this.icon="done",this.message=this.performed.kind?this.i18n.transaction.processedPaymentRequestWithNumber(this.performed.transactionNumber):this.i18n.transaction.processedPaymentRequest):(null===(t=this.performed)||void 0===t?void 0:t.authorizationStatus)===i.yb.PENDING?(this.icon="scheduled",this.message=this.performed.transactionNumber?this.i18n.transaction.pendingWithNumber(this.performed.transactionNumber):this.i18n.transaction.pending):this.performed?(this.icon="done",this.message=this.performed.transactionNumber?this.i18n.transaction.processedWithNumber(this.performed.transactionNumber):this.i18n.transaction.processed):(this.icon="scheduled",this.message=this.i18n.transaction.acceptedScheduledPaymentRequest(this.processDate),n=!1),n&&this.addShortcut(Nn.k,()=>this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)]))}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["request-payment-step-done"]],inputs:{performed:"performed",processDate:"processDate"},features:[d.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(d.Qb(0,"div",0),d.Qb(1,"div",1),d.Qb(2,"div",2),d.Lb(3,"icon",3),d.Pb(),d.Qb(4,"div",4),d.Dc(5),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.xb(3),d.gc("icon",t.icon),d.xb(2),d.Ec(t.message))},directives:[fi.a],encapsulation:2,changeDetection:0}),e})();function pi(e,t){if(1&e){const e=d.Rb();d.Qb(0,"action-button",9),d.Xb("action",(function(){return d.sc(e),d.Zb(2).perform()})),d.ac(1,"async"),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("disabled",!e.canConfirm||d.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function hi(e,t){1&e&&d.Dc(0,"\xa0")}function yi(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",4),d.ac(1,"async"),d.Qb(2,"accept-payment-request-step-confirm",5),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().perform(t)})),d.Pb(),d.Qb(3,"actions",6),d.Bc(4,pi,2,4,"action-button",7),d.ac(5,"async"),d.Bc(6,hi,1,0,"ng-template",null,8,d.Cc),d.Pb(),d.Pb()}if(2&e){const e=d.qc(7),t=d.Zb();d.gc("heading",t.i18n.transaction.title.paymentConfirmation)("mobileHeading",t.i18n.transaction.mobileTitle.paymentConfirmation)("mode",d.bc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("transaction",t.transactionKey)("preview",t.data)("confirmationPassword",t.confirmationPassword)("form",t.form)("showPaymentType",!0),d.xb(2),d.gc("ngIf",d.bc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e)}}function xi(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",10),d.ac(1,"async"),d.Lb(2,"request-payment-step-done",11),d.ac(3,"date"),d.Qb(4,"actions",6),d.Qb(5,"action-button",12),d.Xb("action",(function(){return d.sc(e),d.Zb().viewPerformed()})),d.Pb(),d.Qb(6,"action-button",13),d.Xb("action",(function(){return d.sc(e),d.Zb().reload()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.doneTitle)("mobileHeading",e.doneMobileTitle)("mode",d.bc(1,7,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("performed",e.performed)("processDate",d.bc(3,9,e.form.value.processDate)),d.xb(3),d.gc("label",e.i18n.transaction.doneView),d.xb(1),d.gc("label",e.i18n.transaction.doneNew)}}function vi(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}let Pi=(()=>{class e extends ut.a{constructor(e,t,n){super(e),this.bankingHelper=t,this.paymentRequestsService=n,this.ConfirmationMode=hn.a,this.steps=["confirm","done"],this.step$=new u.a(null),this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.transactionKey=this.route.snapshot.params.key,this.addSub(this.paymentRequestsService.previewPaymentRequest({key:this.transactionKey}).subscribe(e=>this.data=e))}onDataInitialized(e){this.form=this.formBuilder.group({processDate:null,comments:null}),this.confirmationPassword=this.formBuilder.control(null),this.step="confirm",this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.confirmationPassword.setValidators(e.confirmationPasswordInput?x.G.required:null)}perform(e){if(!Object(s.F)(this.form)||!Object(s.F)(this.confirmationPassword))return;e&&this.confirmationPassword.setValue(e);const t=Object(bt.a)(this.form.value);this.addSub(this.paymentRequestsService.acceptPaymentRequest({key:this.transactionKey,confirmationPassword:this.confirmationPassword.value,body:t}).subscribe(e=>{this.performed=e,this.step="done",Object(s.y)()}))}get doneTitle(){if(this.performed)return this.performed.authorizationStatus===i.yb.PENDING?this.i18n.transaction.title.pendingPayment:this.i18n.transaction.title.processedPayment}get doneMobileTitle(){if(this.performed)return this.performed.authorizationStatus===i.yb.PENDING?this.i18n.transaction.mobileTitle.pendingPayment:this.i18n.transaction.mobileTitle.processedPayment}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}locateControl(e){return Object(s.t)(this.form,e)}resolveMenu(){return l.b.PAYMENT_REQUESTS}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a),d.Kb(On.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["accept-payment-request"]],features:[d.ub],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"transaction","preview","confirmationPassword","form","showPaymentType","confirmationModeChanged","confirmed"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"performed","processDate"],[3,"label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,yi,8,14,"page-content",1),d.Bc(4,xi,7,11,"page-content",2),d.Bc(5,vi,2,0,"page-content",3),d.Pb()),2&e&&(d.gc("ready",d.bc(1,4,t.data$))("ngSwitch",d.bc(2,6,t.step$)),d.xb(3),d.gc("ngSwitchCase","confirm"),d.xb(1),d.gc("ngSwitchCase","done"))},directives:[m.a,f.x,f.y,f.z,g.a,mi,dt.a,f.t,mt.a,gi,H.a],pipes:[f.b,z.a],encapsulation:2,changeDetection:0}),e})();var Di=n("a/z7"),Li=n("/uUt"),wi=n("Kj3r"),Ci=n("Xel3"),Qi=n("Y+zs"),Ii=n("Zcpn"),Fi=n("yHfF"),Ti=n("wR2l");const Si=["toUser"],Oi=["amount"];function Ni(e,t){if(1&e&&(d.Qb(0,"label-value",13),d.Lb(1,"user-link",14),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.toSystem?e.i18n.transaction.receiver:e.i18n.transaction.fromUser),d.xb(1),d.gc("user",e.fromUser)}}function ki(e,t){1&e&&d.Lb(0,"br")}function Bi(e,t){1&e&&d.Dc(0," - ")}function Ai(e,t){if(1&e&&(d.Ob(0),d.Bc(1,ki,1,0,"br",24),d.ac(2,"async"),d.Bc(3,Bi,1,0,"ng-template",null,25,d.Cc),d.Dc(5),d.Nb()),2&e){const e=d.qc(4),t=d.Zb().$implicit,n=d.Zb(2);d.xb(1),d.gc("ngIf",d.bc(2,3,n.layout.ltsm$))("ngIfElse",e),d.xb(4),d.Fc(" ",t.number," ")}}function Ei(e,t){if(1&e){const e=d.Rb();d.Qb(0,"div",18),d.Qb(1,"div",19),d.Qb(2,"input",20,21),d.Xb("keyup.enter",(function(){return d.sc(e),d.qc(3).click()})),d.Pb(),d.Qb(4,"label",22),d.Qb(5,"div",23),d.Dc(6),d.Bc(7,Ai,6,5,"ng-container",2),d.Pb(),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit;d.xb(2),d.gc("id","from_"+e.id)("value",e.type.id),d.xb(2),d.gc("for","from_"+e.id),d.xb(2),d.Fc(" ",e.type.name," "),d.xb(1),d.gc("ngIf",e.number)}}function $i(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"label-value",15),d.Bc(2,Ei,8,5,"div",16),d.Lb(3,"field-errors",17),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("label",e.i18n.transaction.toAccount),d.xb(1),d.gc("ngForOf",e.data.accounts),d.xb(1),d.gc("control",e.form.get("account"))}}function Ri(e,t){if(1&e&&d.Lb(0,"field-option",31),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.display)}}function Zi(e,t){if(1&e&&(d.Qb(0,"single-selection-field",29),d.Bc(1,Ri,1,2,"field-option",30),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngForOf",e.data.allowedUsers)}}const Mi=function(e){return[e]},Hi=function(e){return{usersToExclude:e}};function qi(e,t){if(1&e){const e=d.Rb();d.Qb(0,"user-field",32,33),d.Xb("selected",(function(t){d.sc(e),d.Zb(2);const n=d.qc(8);return t?n.focus():null})),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("autoSearch",!e.allowPrincipal)("filters",d.jc(9,Hi,e.fromUser&&!e.fromSelf?d.jc(7,Mi,e.fromParam):null))("allowContacts",e.allowContacts)("allowSearch",e.allowSearch)("allowPrincipal",e.allowPrincipal)("allowQrCode",e.allowQrCode)("principalTypes",e.data.principalTypes)}}function Ui(e,t){if(1&e&&(d.Qb(0,"label-value",26),d.Bc(1,Zi,2,1,"single-selection-field",27),d.Bc(2,qi,2,11,"ng-template",null,28,d.Cc),d.Pb()),2&e){const e=d.qc(3),t=d.Zb();d.gc("label",t.i18n.transaction.receiver),d.xb(1),d.gc("ngIf",t.fixedUsersList)("ngIfElse",e)}}function Vi(e,t){if(1&e&&(d.Qb(0,"label-value",34),d.Lb(1,"user-link",14),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.receiver),d.xb(1),d.gc("user",e.toUser)}}function zi(e,t){if(1&e&&d.Lb(0,"field-option",31),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function ji(e,t){if(1&e&&(d.Qb(0,"single-selection-field",35,36),d.Bc(2,zi,1,2,"field-option",30),d.ac(3,"async"),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.type),d.xb(2),d.gc("ngForOf",d.bc(3,2,e.paymentTypes$))}}function Gi(e,t){if(1&e&&d.Lb(0,"custom-field-input",37),2&e){const e=t.$implicit,n=d.Zb();d.gc("field",e)("formControl",n.customValuesControlGetter(e))}}function _i(e,t){if(1&e&&d.Lb(0,"field-option",43),2&e){const e=d.Zb(2);d.gc("text",e.i18n.transaction.schedulingSingle)}}function Ki(e,t){if(1&e&&d.Lb(0,"field-option",44),2&e){const e=d.Zb(2);d.gc("text",e.i18n.transaction.schedulingInstallments)}}function Xi(e,t){if(1&e&&d.Lb(0,"field-option",45),2&e){const e=d.Zb(2);d.gc("text",e.i18n.transaction.schedulingRecurring)}}function Yi(e,t){if(1&e&&(d.Qb(0,"single-selection-field",38),d.Lb(1,"field-option",39),d.Bc(2,_i,1,1,"field-option",40),d.Bc(3,Ki,1,1,"field-option",41),d.Bc(4,Xi,1,1,"field-option",42),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.scheduling),d.xb(1),d.gc("text",e.i18n.transaction.schedulingDirect),d.xb(1),d.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>0),d.xb(1),d.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>1),d.xb(1),d.gc("ngIf",null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.allowsRecurringPayments)}}function Wi(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"input-field",46),d.Lb(2,"boolean-field",47),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("label",e.i18n.transaction.installmentsCount),d.xb(1),d.gc("label",e.i18n.transaction.firstInstallmentIsImmediate)}}function Ji(e,t){if(1&e&&d.Lb(0,"input-field",51),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.occurrencesCount)}}function ea(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"boolean-field",48),d.Qb(2,"radio-group-field",49),d.Lb(3,"field-option",31),d.Lb(4,"field-option",31),d.Pb(),d.Bc(5,Ji,1,1,"input-field",50),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("label",e.i18n.transaction.firstOccurrenceIsImmediate),d.xb(1),d.gc("label",e.i18n.transaction.repeatUntil),d.xb(1),d.gc("value",!0)("text",e.i18n.transaction.repeatUntilManual),d.xb(1),d.gc("value",!1)("text",e.i18n.transaction.repeatUntilFixed),d.xb(1),d.gc("ngIf",!1===e.form.value.repeatUntilCanceled)}}function ta(e,t){if(1&e&&d.Lb(0,"textarea-field",53),2&e){const e=d.Zb().ngIf,t=d.Zb();d.gc("required","required"===e)("label",t.i18n.general.description)}}function na(e,t){if(1&e&&(d.Ob(0),d.Bc(1,ta,1,2,"textarea-field",52),d.Nb()),2&e){const e=t.ngIf;d.xb(1),d.gc("ngIf","disabled"!==e)}}const ia=[Di.a.FORBIDDEN,Di.a.UNAUTHORIZED,Di.a.NOT_FOUND];let aa=(()=>{class e extends S.a{constructor(e,t,n){super(e),this.bankingHelper=t,this.paymentRequestsService=n,this.availablePaymentTypes=new d.n,this.accountBalanceLabel$=new u.a(null),this.fixedDestination=!1,this.paymentTypes$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe(Object(Li.a)(),Object(wi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.fetchPaymentTypes())),this.addSub(this.form.get("account").valueChanges.pipe(Object(Li.a)(),Object(wi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes())),this.addSub(this.form.get("type").valueChanges.pipe(Object(Li.a)(),Object(wi.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>this.fetchPaymentTypeData(e))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateAccountBalanceLabel())),this.updateAccountBalanceLabel()}updateAccountBalanceLabel(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}fetchPaymentTypes(){this.dataCache.clear(),this.fetchedPaymentTypes=null;const e=r.a.escapeNumeric(this.form.value.subject);""!==e&&this.errorHandler.requestWithCustomErrorHandler(t=>{this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:e,fields:["toUser","paymentTypes","paymentTypeData"]}).subscribe(e=>{this.setFetchedPaymentTypes(e)},e=>{if(this.allowPrincipal&&this.userField&&e.status===Di.a.NOT_FOUND){let t=e.error;if("string"==typeof t)try{t=JSON.parse(t)}catch(n){t={}}const i=t.entityType;if(!Object(s.a)(i)&&i.endsWith("User"))return void this.userField.search()}ia.includes(e.status)||t(e)}))})}adjustPaymentTypes(){const e=this.form.value;if(0===(e.subject||"").trim().length)return;const t=this.fetchedPaymentTypes||[];Object(s.h)(t)&&this.notification.error(this.i18n.transaction.noTypes);const n=t.filter(t=>t.from.id===e.account);let i=this.form.value.type,a=null;Object(s.h)(n)?a={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(n),n.find(e=>e.id===i)||(i=n[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:i}),this.form.get("account").setErrors(a),this.form.get("account").markAsTouched(),Object(s.h)(i)||this.fetchPaymentTypeData(i),this.availablePaymentTypes.emit(n)}setFetchedPaymentTypes(e){this.userField&&(this.userField.user=e.toUser),this.fetchedPaymentTypes=e.paymentTypes;const t=e.paymentTypeData;t&&this.dataCache.set(t.id,t),this.adjustPaymentTypes()}fetchPaymentTypeData(e){const t=this.form.value;if(Object(s.h)(t.subject)||Object(s.h)(e))return;const n=this.dataCache.get(e);n?this.setPaymentTypeData(n):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(n=>{this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:t.subject,type:e,fields:["paymentTypeData"]}).subscribe(e=>{this.setPaymentTypeData(e.paymentTypeData)},e=>{ia.includes(e.status)||n(e)}))}))}setPaymentTypeData(e){((this.paymentTypeData$.value||{}).id||null)!==((e||{}).id||null)&&(e&&(this.dataCache.set(e.id,e),Object(s.j)(this.amountField)),this.paymentTypeData$.next(e))}get fixedUsersList(){return!Object(s.h)(this.data.allowedUsers)}get allowQrCode(){return this.allowPrincipal&&this.data.allowScanQrCode}get allowPrincipal(){return!Object(s.h)(this.data.principalTypes)}get allowSearch(){return this.data.allowAutocomplete}get allowContacts(){return this.data.allowContacts}get singleAccount(){const e=this.data.accounts||[];return 1===e.length?e[0]:null}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a),d.Kb(On.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["request-payment-step-form"]],viewQuery:function(e,t){var n;1&e&&(d.Hc(Si,!0),d.yc(Oi,!0)),2&e&&(d.pc(n=d.Yb())&&(t.userField=n.first),d.pc(n=d.Yb())&&(t.amountField=n.first))},inputs:{data:"data",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",toSystem:"toSystem",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[d.ub],decls:20,vars:28,consts:[[3,"formGroup"],["kind","field",3,"label",4,"ngIf"],[4,"ngIf"],["kind","field","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],["formControlName","expirationDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["kind","field",3,"label"],[3,"user"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],[4,"ngIf","ngIfElse"],["separator",""],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["kind","fieldView",3,"label"],["formControlName","type","required","",3,"label"],["type",""],[3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsImmediate",3,"label"],["formControlName","firstOccurrenceIsImmediate",3,"label"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(e,t){if(1&e&&(d.Ob(0,0),d.Bc(1,Ni,2,2,"label-value",1),d.Bc(2,$i,4,3,"ng-container",2),d.Bc(3,Ui,4,3,"label-value",3),d.Bc(4,Vi,2,2,"label-value",4),d.Bc(5,ji,4,4,"single-selection-field",5),d.ac(6,"async"),d.Lb(7,"decimal-field",6,7),d.Lb(9,"date-field",8),d.Bc(10,Gi,1,2,"custom-field-input",9),d.ac(11,"async"),d.Bc(12,Yi,5,5,"single-selection-field",10),d.ac(13,"async"),d.ac(14,"async"),d.Ob(15,11),d.Bc(16,Wi,3,2,"ng-container",12),d.Bc(17,ea,6,7,"ng-container",12),d.Nb(),d.Bc(18,na,2,1,"ng-container",2),d.ac(19,"async"),d.Nb()),2&e){var n,i,a,c=null;d.gc("formGroup",t.form),d.xb(1),d.gc("ngIf",t.fromUser&&!t.fromSelf),d.xb(1),d.gc("ngIf",!t.singleAccount),d.xb(1),d.gc("ngIf",!t.fixedDestination),d.xb(1),d.gc("ngIf",t.fixedDestination&&t.toUser),d.xb(1),d.gc("ngIf",(null==(n=d.bc(6,18,t.paymentTypes$))?null:n.length)>1),d.xb(2),d.gc("focused",t.fixedDestination)("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix),d.xb(2),d.gc("label",t.i18n.general.expirationDate),d.xb(1),d.gc("ngForOf",null==(i=d.bc(11,20,t.paymentTypeData$))?null:i.customFields),d.xb(2),d.gc("ngIf",(null==(c=d.bc(13,22,t.paymentTypeData$))?null:c.allowsRecurringPayments)||(null==(c=d.bc(14,24,t.paymentTypeData$))?null:c.maxInstallments)>0),d.xb(3),d.gc("ngSwitch",t.form.value.scheduling),d.xb(1),d.gc("ngSwitchCase","scheduled"),d.xb(1),d.gc("ngSwitchCase","recurring"),d.xb(1),d.gc("ngIf",(null==(a=d.bc(19,26,t.paymentTypeData$))?null:a.descriptionAvailability)||"disabled")}},directives:[x.w,x.n,f.t,Q.a,x.v,x.l,x.D,$n.a,C.a,f.s,f.x,f.y,v.a,P.a,Ci.a,x.A,x.e,D.a,L.a,F.a,Qi.a,x.k,I.a,Ii.a,Fi.a,Ti.a,ft.a],pipes:[f.b],encapsulation:2,changeDetection:0}),e})();function ca(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",4),d.ac(1,"async"),d.Qb(2,"request-payment-step-form",5),d.Xb("availablePaymentTypes",(function(t){return d.sc(e),d.Zb().availablePaymentTypes=t})),d.ac(3,"async"),d.Pb(),d.Qb(4,"actions",6),d.Qb(5,"action-button",7),d.Xb("action",(function(){return d.sc(e),d.Zb().perform()})),d.ac(6,"async"),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.title)("mobileHeading",e.mobileTitle)("mode",d.bc(1,11,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("data",e.data)("form",e.form)("currency",d.bc(3,13,e.currency$))("paymentTypeData$",e.paymentTypeData$)("toSystem",e.toSystem)("customValuesControlGetter",e.customValuesControlGetter),d.xb(3),d.gc("disabled",d.bc(6,15,e.requesting$))("label",e.i18n.general.confirm)}}function ra(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",8),d.ac(1,"async"),d.Lb(2,"request-payment-step-done",9),d.Qb(3,"actions",6),d.Qb(4,"action-button",10),d.Xb("action",(function(){return d.sc(e),d.Zb().viewPerformed()})),d.Pb(),d.Qb(5,"action-button",11),d.Xb("action",(function(){return d.sc(e),d.Zb().reload()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.paymentRequestSent)("mobileHeading",e.i18n.transaction.mobileTitle.paymentRequestSent)("mode",d.bc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("performed",e.performed),d.xb(2),d.gc("label",e.i18n.transaction.doneView),d.xb(1),d.gc("label",e.i18n.transaction.doneNew)}}function oa(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}const sa=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("repeatUntilCanceled").value;if(n===i.Y.RECURRING&&!a){const t=parseInt(e.value,10);return isNaN(t)?{required:!0}:x.G.min(2)(e)}}return null};let la=(()=>{class e extends ut.a{constructor(e,t,n,i){super(e),this.bankingHelper=t,this.paymentRequestsService=n,this.changeDetector=i,this.steps=["form","done"],this.step$=new u.a(null),this.currency$=new u.a(null),this.paymentTypeData$=new u.a(null),this.customValuesControls=new Map}get step(){return this.step$.value}set step(e){this.step$.next(e)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(e){this.paymentTypeData$.next(e),this.updatePaymentTypeData(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.fromParam=e.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=e.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam),this.fromSystem?(this.title=this.i18n.transaction.title.paymentRequestSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestSystemToUser):this.toSystem?(this.title=this.i18n.transaction.title.paymentRequestToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToSystem):(this.title=this.i18n.transaction.title.paymentRequestToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToUser),this.form=this.buildForm(),this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:this.toParam}).subscribe(e=>this.data=e)),this.addSub(this.form.get("account").valueChanges.subscribe(e=>this.updateCurrency(this.data,e))),this.addSub(this.paymentTypeData$.subscribe(e=>{null!=this.lastPaymentTypeData&&Object(yn.a)(this.lastPaymentTypeData,e)||this.adjustForm(e),this.lastPaymentTypeData=e})),this.addSub(this.form.valueChanges.subscribe(e=>this.adjustFormValidators(e)))}buildForm(){return this.formBuilder.group({account:null,subject:[this.toParam,x.G.required],type:[null,x.G.required],amount:[null,x.G.required],expirationDate:[null,x.G.required],description:null,scheduling:[i.Y.DIRECT,x.G.required],installmentsCount:null,firstInstallmentIsImmediate:!1,repeatUntilCanceled:!0,occurrencesCount:[null,sa],firstOccurrenceIsImmediate:!1})}updateCurrency(e,t){let n=null;!Object(s.h)(t)&&e&&e.accounts&&(n=e.accounts.find(e=>e.type.id===t)),this.currency=n?n.currency:null}adjustForm(e){const t=this.form.get("description");(e||{}).descriptionAvailability===i.i.REQUIRED?t.setValidators(x.G.required):Object(s.c)(t)}adjustFormValidators(e){if(this.lastValue&&Object(yn.a)(this.lastValue,e))return;this.lastValue=e;const t=this.form.get("installmentsCount");e.scheduling===i.Y.SCHEDULED?t.setValidators(x.G.compose([x.G.required,x.G.min(2)])):Object(s.c)(t);const n=this.form.get("occurrencesCount");e.scheduling===i.Y.RECURRING?e.repeatUntilCanceled?Object(s.c)(n):n.setValidators(x.G.compose([x.G.required,x.G.min(2)])):Object(s.c)(n),this.changeDetector.detectChanges()}onDataInitialized(e){if(Object(s.h)(e.accounts))this.notification.error(this.i18n.transaction.noAccounts);else{this.step="form";const t=e.accounts[0].type.id;this.form.patchValue({account:t},{emitEvent:!1}),this.updateCurrency(e,t)}}updatePaymentTypeData(e){const t=this.form.get("amount");e&&e.fixedAmount?(t.setValue(e.fixedAmount),t.disable()):t.disabled&&t.enable()}perform(){const e={},t=this.paymentTypeData;if(t&&t.customFields)for(const n of t.customFields)e[n.internalName]=this.customValuesControlGetter(n);this.form.setControl("customValues",new x.m(e)),Object(s.F)(this.form)&&this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.transaction.confirmPaymentRequest,callback:()=>this.paymentRequestsService.sendPaymentRequest({owner:this.fromParam,body:this.confirmDataRequest()}).pipe(Object(xn.a)()).subscribe(e=>{this.performed=e,this.step="done",Object(s.y)()})})}confirmDataRequest(){const e=Object(bt.a)(this.form.value),t=e;switch(e.scheduling){case"futureDate":t.scheduling=i.W.SCHEDULED,t.installmentsCount=1;break;case i.W.RECURRING:e.repeatUntilCanceled&&(t.occurrencesCount=null)}return t.expirationDate=r.a.shiftToDayEnd(t.expirationDate),delete e.firstInstallmentIsNow,delete e.repeatUntilCanceled,delete e.firstOccurrenceIsNow,t}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}reload(){this.step=null,this.currency=null,this.paymentTypeData=null,super.reload()}locateControl(e){return Object(s.t)(this.form,e)}get customValuesControlGetter(){return e=>{const t=e.internalName;let n=this.customValuesControls.get(t);return null==n&&(n=this.formBuilder.control(e.defaultValue,e.required?x.G.required:null),this.customValuesControls.set(t,n)),n}}resolveMenu(e){return this.fromSystem?l.b.PAYMENT_REQUEST_TO_USER:this.menu.userMenu(e.fromUser,this.toSystem?l.b.PAYMENT_REQUEST_TO_SYSTEM:l.b.PAYMENT_REQUEST_TO_USER)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a),d.Kb(On.a),d.Kb(d.h))},e.\u0275cmp=d.Eb({type:e,selectors:[["request-payment"]],features:[d.ub],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","currency","paymentTypeData$","toSystem","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"performed"],[3,"label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,ca,7,17,"page-content",1),d.Bc(4,ra,6,8,"page-content",2),d.Bc(5,oa,2,0,"page-content",3),d.Pb()),2&e&&(d.gc("ready",d.bc(1,4,t.data$))("ngSwitch",d.bc(2,6,t.step$)),d.xb(3),d.gc("ngSwitchCase","form"),d.xb(1),d.gc("ngSwitchCase","done"))},directives:[m.a,f.x,f.y,f.z,g.a,aa,dt.a,mt.a,gi,H.a],pipes:[f.b],encapsulation:2,changeDetection:0}),e})();var ua=n("cBGn"),ba=n("/q9M");function da(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",4),d.ac(1,"async"),d.Lb(2,"receive-qr-payment-step-form",5),d.ac(3,"async"),d.ac(4,"async"),d.ac(5,"async"),d.Qb(6,"actions",6),d.Qb(7,"action-button",7),d.Xb("action",(function(){return d.sc(e),d.Zb().toPending()})),d.ac(8,"async"),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.receiveQrPayment)("mobileHeading",e.i18n.transaction.mobileTitle.receiveQrPayment)("mode",d.bc(1,10,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("data",e.data)("form",e.form)("transferTypes",d.bc(3,12,e.paymentTypes$))("type",d.bc(4,14,e.paymentType$))("typeData",d.bc(5,16,e.paymentTypeData$)),d.xb(5),d.gc("disabled",d.bc(8,18,e.requesting$))("label",e.i18n.general.next)}}function ma(e,t){if(1&e){const e=d.Rb();d.Qb(0,"action-button",13),d.Xb("action",(function(){return d.sc(e),d.Zb(2).share()})),d.ac(1,"async"),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.share)("disabled",d.bc(1,2,e.requesting$))}}function fa(e,t){1&e&&d.Lb(0,"span")}function ga(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",8),d.ac(1,"async"),d.Lb(2,"receive-qr-payment-step-pending",9),d.ac(3,"async"),d.ac(4,"async"),d.Qb(5,"actions",6),d.Bc(6,ma,2,4,"action-button",10),d.Bc(7,fa,1,0,"ng-template",null,11,d.Cc),d.Qb(9,"action-button",12),d.Xb("action",(function(){return d.sc(e),d.Zb().reload()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.qc(8),t=d.Zb();d.gc("heading",t.i18n.transaction.title.receiveQrPayment)("mobileHeading",t.i18n.transaction.mobileTitle.receiveQrPayment)("mode",d.bc(1,8,t.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("ticket",d.bc(3,10,t.ticket$))("qrCodeUrl",d.bc(4,12,t.qrCodeUrl$)),d.xb(4),d.gc("ngIf",t.supportsShare)("ngIfElse",e),d.xb(3),d.gc("label",t.i18n.general.previous)}}function pa(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",8),d.ac(1,"async"),d.Lb(2,"receive-qr-payment-step-done",14),d.ac(3,"async"),d.Qb(4,"actions",6),d.Qb(5,"action-button",15),d.Xb("action",(function(){return d.sc(e),d.Zb().viewPerformed()})),d.Pb(),d.Qb(6,"action-button",12),d.Xb("action",(function(){return d.sc(e),d.Zb().reload()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.receiveQrPayment)("mobileHeading",e.i18n.transaction.mobileTitle.receiveQrPayment)("mode",d.bc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("payment",d.bc(3,8,e.payment$)),d.xb(3),d.gc("label",e.i18n.transaction.doneView),d.xb(1),d.gc("label",e.i18n.transaction.doneNew)}}function ha(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}let ya=(()=>{class e extends ut.a{constructor(e,t,n,i){super(e),this.ticketsService=t,this.pushNotifications=n,this.bankingHelper=i,this.step$=new u.a(null),this.ticket$=new u.a(null),this.paymentTypes$=new u.a([]),this.paymentType$=new u.a(null),this.paymentTypeData$=new u.a(null),this.payment$=new u.a(null),this.paymentTypeDataCache=new Map,this.qrCodeUrl$=new u.a(null),this.supportsShare=Object(s.C)()}ngOnInit(){super.ngOnInit(),this.addSub(this.ticketsService.dataForNewTicket().subscribe(e=>this.data=e)),this.addSub(this.step$.subscribe(e=>this.onStepChanged(e)))}ngOnDestroy(){super.ngOnDestroy(),this.unsubscribePush(),this.destroyQrCode()}onDataInitialized(e){Object(s.h)(e.accounts)||Object(s.h)(e.paymentTypes)?this.notification.error(this.i18n.transaction.noAccounts):(this.form=this.formBuilder.group({account:[null,x.G.required],type:[null,x.G.required],amount:[null,x.G.required],description:null}),this.paymentTypeDataCache.set(e.paymentTypes[0].id,e.paymentTypeData),this.addSub(this.form.controls.type.valueChanges.pipe(Object(Li.a)()).subscribe(e=>this.onPaymentTypeChange(e))),this.addSub(this.form.controls.account.valueChanges.pipe(Object(Li.a)()).subscribe(t=>this.onAccountChange(t,e))),this.form.patchValue({account:e.accounts[0].id}),this.step$.next("form"))}onAccountChange(e,t){const n=t.accounts.find(t=>t.id===e),i=n?t.paymentTypes.filter(e=>e.to.id===n.type.id):[];this.paymentTypes$.next(i),this.form.patchValue({type:0===i.length?null:i[0].id})}onPaymentTypeChange(e){const t=(this.paymentTypes$.value||[]).find(t=>t.id===e);if(!t)return void this.notification.error(this.i18n.transaction.noTypes);const n=n=>{(this.paymentType$.value||{}).id!==e&&(this.paymentTypeDataCache.set(e,n),this.paymentType$.next(t),this.paymentTypeData$.next(n),this.form.setControl("customValues",this.fieldHelper.customValuesFormGroup(n.customFields)),this.form.controls.type.setValidators(n.descriptionAvailability===i.i.REQUIRED?x.G.required:null))},a=this.paymentTypeDataCache.get(e);a?n(a):this.addSub(this.ticketsService.dataForNewTicket({type:e}).subscribe(e=>{n(e.paymentTypeData)}))}toPending(){Object(s.F)(this.form)&&this.addSub(this.ticketsService.newTicket({body:this.form.value}).subscribe(e=>{this.ticket$.next(e),this.addSub(this.ticketsService.getTicketQrCode({ticket:e.ticketNumber,size:i.D.MEDIUM}).subscribe(e=>{this.qrCodeUrl$.next(URL.createObjectURL(e))})),this.step$.next("pending")}))}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.payment$.value)])}onStepChanged(e){"pending"===e?this.pushSub=this.pushNotifications.ticket$.subscribe(e=>{const t=this.ticket$.value;t&&t.id===e.id&&(this.payment$.next(e.transaction),this.step$.next("done"))}):(this.unsubscribePush(),this.destroyQrCode())}unsubscribePush(){this.pushSub&&(this.pushSub.unsubscribe(),this.pushSub=null)}destroyQrCode(){this.qrCodeUrl$.value&&(URL.revokeObjectURL(this.qrCodeUrl$.value),this.qrCodeUrl$.next(null))}share(){const e=this.ticket$.value;navigator.share&&navigator.share({url:e.approveUrl,title:this.i18n.transaction.ticketShareTitle,text:this.i18n.transaction.ticketShareText({user:e.to.user.display,amount:this.format.formatAsCurrency(e.currency,e.amount)})})}resolveMenu(){return l.b.RECEIVE_QR_PAYMENT}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(ua.a),d.Kb(ba.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["receive-qr-payment"]],features:[d.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","transferTypes","type","typeData"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[3,"ticket","qrCodeUrl"],[3,"label","disabled","action",4,"ngIf","ngIfElse"],["empty",""],["outline","",3,"label","action"],[3,"label","disabled","action"],[3,"payment"],[3,"label","action"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,da,9,20,"page-content",1),d.Bc(4,ga,10,14,"page-content",2),d.Bc(5,pa,7,10,"page-content",2),d.Bc(6,ha,2,0,"page-content",3),d.Pb()),2&e&&(d.gc("ready",d.bc(1,5,t.data$))("ngSwitch",d.bc(2,7,t.step$)),d.xb(3),d.gc("ngSwitchCase","form"),d.xb(1),d.gc("ngSwitchCase","pending"),d.xb(1),d.gc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),e})();var xa=n("QnlI");function va(e,t){1&e&&d.Mb(0)}function Pa(e,t){1&e&&d.Lb(0,"div",7)}function Da(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",7),d.Qb(2,"label-value",13),d.Lb(3,"user-link",14),d.Pb(),d.Pb(),d.Bc(4,Pa,1,0,"div",9),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("ngIf",e.layout.gtsm$)}}function La(e,t){if(1&e&&d.Lb(0,"field-option",17),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function wa(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"single-selection-field",15),d.Bc(2,La,1,2,"field-option",16),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.transaction.account)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.data.accountTypes)}}function Ca(e,t){if(1&e&&(d.Qb(0,"div",7),d.Lb(1,"input-field",24),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function Qa(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",7),d.Qb(2,"single-selection-field",18),d.Lb(3,"field-option",19),d.Lb(4,"field-option",20),d.Pb(),d.Pb(),d.Bc(5,Ca,2,2,"div",9),d.Qb(6,"div",7),d.Lb(7,"date-field",21),d.Pb(),d.Qb(8,"div",7),d.Lb(9,"date-field",22),d.Pb(),d.Qb(10,"div",7),d.Lb(11,"user-field",23),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.gc("label",e.i18n.account.direction)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("text",e.i18n.account.incoming),d.xb(1),d.gc("text",e.i18n.account.outgoing),d.xb(1),d.gc("ngIf",e.hasTransactionNumber),d.xb(2),d.gc("label",e.i18n.general.beginDate),d.xb(2),d.gc("label",e.i18n.general.endDate),d.xb(2),d.gc("label",e.i18n.general.user)}}function Ia(e,t){if(1&e&&(d.Qb(0,"mobile-result",25),d.Qb(1,"div",26),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("date",e.date)("amount",e.amount)("avatarImage",n.bankingHelper.avatarImage(e.transaction.related))("avatarIcon",n.bankingHelper.avatarIcon(e.transaction.related))("currency",n.currencies.get(e.currency)),d.xb(2),d.Fc(" ",n.bankingHelper.subjectName(e.transaction.related)," ")}}const Fa=function(e){return{"pb-0":e}},Ta=function(e,t){return{positive:e,negative:t}};function Sa(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",31),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n.transaction))})),d.Qb(2,"td",32),d.ac(3,"async"),d.Lb(4,"avatar",33),d.Pb(),d.Qb(5,"td"),d.Qb(6,"a",34),d.Dc(7),d.ac(8,"date"),d.Pb(),d.Pb(),d.Qb(9,"td"),d.Qb(10,"a",34),d.Dc(11),d.Pb(),d.Pb(),d.Qb(12,"td"),d.Qb(13,"a",35),d.Dc(14),d.Pb(),d.Pb(),d.Qb(15,"td",29),d.Qb(16,"a",36),d.Dc(17),d.ac(18,"currency"),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.gc("ngClass",d.jc(20,Fa,d.bc(3,12,n.layout.xxs$))),d.xb(2),d.gc("image",n.bankingHelper.avatarImage(e.transaction.related))("icon",n.bankingHelper.avatarIcon(e.transaction.related)),d.xb(2),d.gc("routerLink",n.bankingHelper.transactionPath(e.transaction)),d.xb(1),d.Fc(" ",d.bc(8,14,e.dueDate)," "),d.xb(3),d.gc("routerLink",n.bankingHelper.transactionPath(e.transaction)),d.xb(1),d.Fc(" ",n.bankingHelper.subjectName(e.transaction.related)," "),d.xb(2),d.gc("routerLink",n.bankingHelper.transactionPath(e.transaction)),d.xb(1),d.Fc(" ",n.number(e)," "),d.xb(2),d.gc("routerLink",n.bankingHelper.transactionPath(e.transaction))("ngClass",d.kc(22,Ta,n.format.isPositive(e.amount),n.format.isNegative(e.amount))),d.xb(1),d.Fc(" ",d.dc(18,16,e.amount,n.currencies.get(e.transaction.currency),!0)," ")}}function Oa(e,t){if(1&e&&(d.Qb(0,"table",27),d.Qb(1,"thead"),d.Lb(2,"th",28),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Qb(7,"th"),d.Dc(8),d.Pb(),d.Qb(9,"th",29),d.Dc(10),d.Pb(),d.Pb(),d.Qb(11,"tbody"),d.Bc(12,Sa,19,25,"ng-container",30),d.ac(13,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(4),d.Ec(e.i18n.transaction.dueDate),d.xb(2),d.Ec(e.i18n.transaction.fromTo),d.xb(2),d.Ec(e.i18n.transaction.installmentNumber),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(13,5,e.results$))?null:n.results)}}function Na(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.ac(1,"async"),d.Qb(2,"form",4),d.Qb(3,"div",5),d.Bc(4,Da,5,3,"ng-container",6),d.Qb(5,"div",7),d.Lb(6,"single-selection-field",8),d.Pb(),d.Bc(7,wa,3,3,"div",9),d.Bc(8,Qa,12,8,"ng-container",6),d.ac(9,"async"),d.Pb(),d.Pb(),d.Pb(),d.Qb(10,"results-layout",10),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(11,"async"),d.Bc(12,Ia,3,6,"mobile-result",11),d.Bc(13,Oa,14,7,"table",12),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.scheduled)("mobileHeading",e.i18n.transaction.mobileTitle.scheduled)("headingActions",d.bc(1,12,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",e.data.user&&!e.self),d.xb(2),d.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),d.xb(1),d.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.xb(1),d.gc("ngIf",d.bc(9,14,e.moreFilters$)),d.xb(2),d.gc("results",d.bc(11,16,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let ka=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.installmentsService=t,this.bankingHelper=n,this.currencies=new Map}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.owner,this.self=this.authHelper.isSelf(this.param),this.stateManager.cache("data",this.installmentsService.getInstallmentsDataForSearch({owner:this.param,fields:["user","accountTypes","query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.h)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e})}onDataInitialized(e){super.onDataInitialized(e);const t=(e.accountTypes||[]).map(e=>{var t;return null===(t=e.currency)||void 0===t?void 0:t.transactionNumberPattern}).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=[this.moreFiltersAction]}getFormControlNames(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.status=i.G.SCHEDULED,t}get statusOptions(){return Object.values(i.G).map(e=>({value:e,text:this.apiI18n.installmentStatus(e)}))}toSearchParams(e){const t=e;return t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.statuses=[e.status],t}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(e){return this.menu.userMenu(e.user,l.b.SCHEDULED_PAYMENTS)}doSearch(e){return this.installmentsService.searchInstallments$Response(e)}get toLink(){return e=>this.bankingHelper.transactionPath(e.transaction)}number(e){return e.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:e.number,total:e.totalInstallments}):String(e.number)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(xa.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-owner-installments"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],[3,"image","icon"],[3,"routerLink"],[1,"d-inline-block",3,"routerLink"],[3,"routerLink","ngClass"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,va,1,0,"ng-container",1),d.Pb(),d.Bc(3,Na,14,18,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,D.a,x.v,x.l,p.a,h.a,y.a,v.a,P.a,f.s,L.a,C.a,F.a,I.a,T.a,q.a,f.q,U.a,V.h],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();var Ba=n("v6Le");function Aa(e,t){1&e&&d.Mb(0)}function Ea(e,t){1&e&&d.Lb(0,"div",7)}function $a(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",7),d.Qb(2,"label-value",14),d.Lb(3,"user-link",15),d.Pb(),d.Pb(),d.Bc(4,Ea,1,0,"div",9),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("ngIf",e.layout.gtsm$)}}function Ra(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"single-selection-field",16),d.Lb(2,"field-option",17),d.Lb(3,"field-option",18),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.transaction.direction)("emptyOption",e.i18n.general.all),d.xb(1),d.gc("text",e.i18n.transaction.sent),d.xb(1),d.gc("text",e.i18n.transaction.received)}}function Za(e,t){if(1&e&&(d.Qb(0,"div",7),d.Lb(1,"input-field",19),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function Ma(e,t){if(1&e&&d.Lb(0,"field-option",22),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function Ha(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"single-selection-field",20),d.Bc(2,Ma,1,2,"field-option",21),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.transaction.account)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.data.accountTypes)}}function qa(e,t){if(1&e&&d.Lb(0,"field-option",25),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e)("text",e.name)}}function Ua(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"single-selection-field",23),d.Bc(2,qa,1,3,"field-option",24),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.period),d.xb(1),d.gc("ngForOf",e.data.preselectedPeriods)}}function Va(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"div",26),d.Qb(2,"div",7),d.Lb(3,"date-field",27),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(3),d.gc("label",e.i18n.general.beginDate)}}function za(e,t){if(1&e&&(d.Qb(0,"div",7),d.Lb(1,"date-field",28),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.endDate)}}function ja(e,t){if(1&e&&d.Lb(0,"field-option",31),2&e){const e=t.$implicit;d.gc("value",e)("id",e.id)("text",e.name)}}function Ga(e,t){if(1&e&&(d.Qb(0,"div",7),d.Qb(1,"single-selection-field",29),d.Bc(2,ja,1,3,"field-option",30),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.account.transferFilter)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.transferFilters$.value)}}function _a(e,t){if(1&e&&(d.Qb(0,"mobile-result",32),d.Qb(1,"div",33),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("avatarImage",n.bankingHelper.avatarImage(e.related))("avatarIcon",n.bankingHelper.avatarIcon(e.related))("date",e.date)("amount",e.amount)("currency",n.currencies.get(e.currency)),d.xb(2),d.Fc(" ",n.bankingHelper.subjectName(e.related)," ")}}function Ka(e,t){if(1&e&&(d.Qb(0,"th"),d.Dc(1),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.Ec(e.i18n.transaction.fromTo)}}function Xa(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"th"),d.Dc(2),d.Pb(),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(2),d.Ec(e.i18n.transaction.senderOrReceiver),d.xb(2),d.Ec(e.i18n.general.status)}}function Ya(e,t){if(1&e&&(d.Qb(0,"td"),d.Dc(1),d.Pb()),2&e){const e=d.Zb().$implicit,t=d.Zb(3);d.xb(1),d.Fc(" ",t.apiI18n.transactionStatus(e)," ")}}const Wa=function(e,t,n){return{"pb-0":e,positive:t,negative:n}};function Ja(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",38),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n))})),d.Qb(2,"td",35),d.Lb(3,"avatar",39),d.Pb(),d.Qb(4,"td"),d.Dc(5),d.ac(6,"date"),d.Pb(),d.Qb(7,"td"),d.Dc(8),d.Pb(),d.Bc(9,Ya,2,1,"td",6),d.Qb(10,"td"),d.Dc(11),d.Pb(),d.Qb(12,"td",40),d.ac(13,"async"),d.Dc(14),d.ac(15,"currency"),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.gc("image",n.bankingHelper.avatarImage(e.related))("icon",n.bankingHelper.avatarIcon(e.related)),d.xb(2),d.Fc(" ",d.bc(6,8,e.date)," "),d.xb(3),d.Fc(" ",n.bankingHelper.subjectName(e.related)," "),d.xb(1),d.gc("ngIf",n.isPaymentRequest()),d.xb(2),d.Fc(" ",n.bankingHelper.scheduling(e)," "),d.xb(1),d.gc("ngClass",d.lc(16,Wa,d.bc(13,10,n.layout.xxs$),n.format.isPositive(e.amount),n.format.isNegative(e.amount))),d.xb(2),d.Fc(" ",d.dc(15,12,e.amount,n.currencies.get(e.currency),!0)," ")}}function ec(e,t){if(1&e&&(d.Qb(0,"table",34),d.Qb(1,"thead"),d.Lb(2,"th",35),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Bc(5,Ka,2,1,"th",6),d.Bc(6,Xa,5,2,"ng-container",6),d.Qb(7,"th"),d.Dc(8),d.Pb(),d.Qb(9,"th",36),d.Dc(10),d.Pb(),d.Pb(),d.Qb(11,"tbody"),d.Bc(12,Ja,16,20,"ng-container",37),d.ac(13,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(4),d.Ec(e.i18n.general.date),d.xb(1),d.gc("ngIf",!e.isPaymentRequest()),d.xb(1),d.gc("ngIf",e.isPaymentRequest()),d.xb(2),d.Ec(e.i18n.transaction.scheduling),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(13,6,e.results$))?null:n.results)}}function tc(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.Qb(1,"form",4),d.Qb(2,"div",5),d.Bc(3,$a,5,3,"ng-container",6),d.Qb(4,"div",7),d.Lb(5,"single-selection-field",8),d.Pb(),d.Bc(6,Ra,4,4,"div",9),d.Bc(7,Za,2,2,"div",9),d.Bc(8,Ha,3,3,"div",9),d.Bc(9,Ua,3,2,"div",9),d.Bc(10,Va,4,1,"ng-container",6),d.ac(11,"async"),d.Bc(12,za,2,1,"div",9),d.ac(13,"async"),d.Bc(14,Ga,3,3,"div",9),d.ac(15,"async"),d.Qb(16,"div",7),d.Lb(17,"user-field",10),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(18,"results-layout",11),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(19,"async"),d.Bc(20,_a,3,6,"mobile-result",12),d.Bc(21,ec,14,8,"table",13),d.Pb()}if(2&e){const e=d.Zb();var n=null,i=null;d.gc("heading",e.heading)("mobileHeading",e.mobileHeading),d.xb(1),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",e.data.user&&!e.self),d.xb(2),d.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngIf",e.isPaymentRequest()),d.xb(1),d.gc("ngIf",e.hasTransactionNumber),d.xb(1),d.gc("ngIf",!e.isPaymentRequest()&&(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.xb(1),d.gc("ngIf",e.usePreselectedPeriods&&(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),d.xb(1),d.gc("ngIf",!e.usePreselectedPeriods||null==(null==(n=e.form.value||d.bc(11,18,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),d.xb(2),d.gc("ngIf",!e.usePreselectedPeriods||null==(null==(i=e.form.value||d.bc(13,20,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end)),d.xb(2),d.gc("ngIf",d.bc(15,22,e.transferFilters$).length>0),d.xb(3),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("results",d.bc(19,24,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let nc=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.transactionsService=t,this.bankingHelper=n,this.transferFilters$=new u.a([]),this.currencies=new Map,this.usePreselectedPeriods=!1}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;switch(this.kind=e.data.kind,this.param=e.params.owner,this.self=this.authHelper.isSelf(this.param),this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations,this.usePreselectedPeriods=!0;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequests,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequests}this.stateManager.cache("data",this.transactionsService.getTransactionsDataForSearch({owner:this.param,fields:["user","accountTypes","visibleKinds","transferFilters",...this.usePreselectedPeriods?["preselectedPeriods"]:[],"query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.h)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e}),this.addSub(this.form.get("accountType").valueChanges.subscribe(e=>{this.form.patchValue({transferFilter:null},{emitEvent:!1});const t=this.data.transferFilters.filter(t=>t.accountType.id===e);this.transferFilters$.next(t)}))}onDataInitialized(e){super.onDataInitialized(e);const t=Array.from(this.currencies.values()).map(e=>e.transactionNumberPattern).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=this.exportHelper.headingActions(e.exportFormats,e=>this.transactionsService.exportTransactions$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value))))}isPaymentRequest(){return"payment-request"===this.kind}doSearch(e){return this.transactionsService.searchTransactions$Response(e)}getFormControlNames(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);switch(this.kind){case"authorized":t.status=i.yb.PENDING;break;case"payment-request":t.status=i.X.OPEN}return t}get statusOptions(){switch(this.kind){case"authorized":return Object.values(i.yb).map(e=>({value:e,text:this.apiI18n.authorizationStatus(e)}));case"payment-request":return Object.values(i.X).map(e=>({value:e,text:this.apiI18n.paymentRequestStatus(e)}))}}toSearchParams(e){const t=e;switch(t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0;break;case"payment-request":t.paymentRequestStatuses=[e.status],t.kinds=[i.zb.PAYMENT_REQUEST]}return t}resolveMenu(e){let t;switch(this.kind){case"authorized":t=l.b.AUTHORIZED_PAYMENTS;break;case"payment-request":t=l.b.PAYMENT_REQUESTS}return this.menu.userMenu(e.user,t)}get toLink(){return e=>this.bankingHelper.transactionPath(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Ba.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-owner-transactions"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions","emptyOption"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transferFilter",3,"label","emptyOption"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[1,"amount",3,"ngClass"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Aa,1,0,"ng-container",1),d.Pb(),d.Bc(3,tc,22,26,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,D.a,x.v,x.l,F.a,p.a,h.a,y.a,v.a,P.a,L.a,I.a,T.a,f.s,C.a,q.a,U.a,f.q],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();function ic(e,t){1&e&&d.Mb(0)}function ac(e,t){if(1&e&&(d.Qb(0,"div",11),d.Lb(1,"single-selection-field",12),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions)("emptyOption",e.i18n.general.notApplied)}}function cc(e,t){if(1&e&&d.Lb(0,"field-option",15),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function rc(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"single-selection-field",13),d.Bc(2,cc,1,2,"field-option",14),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.currencies)}}function oc(e,t){if(1&e&&d.Lb(0,"field-option",21),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function sc(e,t){if(1&e&&d.Lb(0,"field-option",21),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function lc(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"div",17),d.Qb(2,"div",11),d.Qb(3,"single-selection-field",18),d.Bc(4,oc,1,4,"field-option",19),d.Pb(),d.Pb(),d.Qb(5,"div",11),d.Qb(6,"single-selection-field",20),d.Bc(7,sc,1,4,"field-option",19),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(3),d.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.fromAccount),d.xb(1),d.gc("ngForOf",e.accountTypes()),d.xb(2),d.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.toAccount),d.xb(1),d.gc("ngForOf",e.accountTypes())}}function uc(e,t){if(1&e&&(d.Qb(0,"div",11),d.Lb(1,"input-field",22),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function bc(e,t){if(1&e&&d.Lb(0,"field-option",25),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e)("text",e.name)}}function dc(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"single-selection-field",23),d.Bc(2,bc,1,3,"field-option",24),d.Pb(),d.Pb()),2&e){const e=d.Zb(4);d.xb(1),d.gc("label",e.i18n.general.period),d.xb(1),d.gc("ngForOf",e.data.preselectedPeriods)}}function mc(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"div",17),d.Qb(2,"div",11),d.Lb(3,"date-field",26),d.Pb(),d.Nb()),2&e){const e=d.Zb(4);d.xb(3),d.gc("label",e.i18n.general.beginDate)}}function fc(e,t){if(1&e&&(d.Qb(0,"div",11),d.Lb(1,"date-field",27),d.Pb()),2&e){const e=d.Zb(4);d.xb(1),d.gc("label",e.i18n.general.endDate)}}function gc(e,t){if(1&e&&(d.Ob(0),d.Bc(1,dc,3,2,"div",6),d.Bc(2,mc,4,1,"ng-container",7),d.ac(3,"async"),d.Bc(4,fc,2,1,"div",6),d.ac(5,"async"),d.Nb()),2&e){const e=d.Zb(3);var n=null,i=null;d.xb(1),d.gc("ngIf",e.usePreselectedPeriod&&(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),d.xb(1),d.gc("ngIf",!e.usePreselectedPeriod||null==(null==(n=e.form.value||d.bc(3,3,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),d.xb(2),d.gc("ngIf",!e.usePreselectedPeriod||null==(null==(i=e.form.value||d.bc(5,5,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end))}}function pc(e,t){if(1&e&&d.Lb(0,"field-option",30),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("category",e.from.name)}}function hc(e,t){if(1&e&&(d.Qb(0,"div",11),d.Qb(1,"multi-selection-field",28),d.Bc(2,pc,1,5,"field-option",29),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.account.transferFilter),d.xb(1),d.gc("ngForOf",e.data.authorizablePaymentTypes)}}function yc(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",11),d.Lb(2,"date-field",31),d.Pb(),d.Qb(3,"div",11),d.Lb(4,"date-field",32),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(2),d.gc("label",e.i18n.general.expirationBeginDate),d.xb(2),d.gc("label",e.i18n.general.expirationEndDate)}}function xc(e,t){if(1&e&&(d.Qb(0,"div",11),d.Lb(1,"user-field",33),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.transaction.actionPerformedBy)}}function vc(e,t){if(1&e&&(d.Ob(0),d.Bc(1,lc,8,6,"ng-container",7),d.Bc(2,uc,2,2,"div",6),d.Bc(3,gc,6,7,"ng-container",7),d.Bc(4,hc,3,3,"div",6),d.Bc(5,yc,5,2,"ng-container",7),d.Qb(6,"div",11),d.Lb(7,"user-field",16),d.Pb(),d.Bc(8,xc,2,1,"div",6),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngIf",(e.isAuthorized()||e.isPaymentRequest())&&(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.xb(1),d.gc("ngIf",!e.isMyAuth()&&e.hasTransactionNumber),d.xb(1),d.gc("ngIf",e.usePeriod),d.xb(1),d.gc("ngIf",e.isMyAuth()&&(null==e.data.authorizablePaymentTypes?null:e.data.authorizablePaymentTypes.length)>0),d.xb(1),d.gc("ngIf",e.isPaymentRequest()),d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("ngIf",e.isAuthorized())}}const Pc=function(e,t){return{from:e,to:t}};function Dc(e,t){if(1&e&&(d.Qb(0,"mobile-result",34),d.Qb(1,"div",35),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("date",e.date)("amount",e.amount)("currency",n.currenciesByKey.get(e.currency)),d.xb(2),d.Fc(" ",n.i18n.transaction.fromToText(d.kc(4,Pc,n.bankingHelper.subjectName(n.isPaymentRequest()?e.to:e.from),n.bankingHelper.subjectName(n.isPaymentRequest()?e.from:e.to)))," ")}}function Lc(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"th"),d.Dc(2),d.Pb(),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(2),d.Ec(e.i18n.transaction.from),d.xb(2),d.Ec(e.i18n.transaction.to),d.xb(2),d.Ec(e.i18n.transaction.scheduling)}}function wc(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"th"),d.Dc(2),d.Pb(),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Qb(7,"th"),d.Dc(8),d.Pb(),d.Qb(9,"th"),d.Dc(10),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(2),d.Ec(e.i18n.transaction.number),d.xb(2),d.Ec(e.i18n.transaction.sender),d.xb(2),d.Ec(e.i18n.transaction.receiver),d.xb(2),d.Ec(e.i18n.general.status),d.xb(2),d.Ec(e.i18n.general.expirationDate)}}function Cc(e,t){if(1&e&&(d.Qb(0,"td"),d.Qb(1,"a",40),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=d.Zb().$implicit,t=d.Zb(3);d.xb(1),d.gc("routerLink",t.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",e.transactionNumber," ")}}function Qc(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"td"),d.Qb(2,"a",42),d.Dc(3),d.Pb(),d.Pb(),d.Qb(4,"td"),d.Qb(5,"a",40),d.Dc(6),d.ac(7,"date"),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb().$implicit,t=d.Zb(3);d.xb(2),d.gc("routerLink",t.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",t.apiI18n.transactionStatus(e)," "),d.xb(2),d.gc("routerLink",t.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",d.bc(7,4,e.expirationDate)," ")}}function Ic(e,t){if(1&e&&(d.Qb(0,"td"),d.Qb(1,"a",42),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=d.Zb().$implicit,t=d.Zb(3);d.xb(1),d.gc("routerLink",t.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",t.bankingHelper.scheduling(e)," ")}}const Fc=function(e){return{"pb-0":e}};function Tc(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",39),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n))})),d.Qb(2,"td"),d.Qb(3,"a",40),d.Dc(4),d.ac(5,"date"),d.Pb(),d.Pb(),d.Bc(6,Cc,3,2,"td",7),d.Qb(7,"td"),d.Qb(8,"a",40),d.Dc(9),d.Pb(),d.Pb(),d.Qb(10,"td"),d.Qb(11,"a",40),d.Dc(12),d.Pb(),d.Pb(),d.Bc(13,Qc,8,6,"ng-container",7),d.Bc(14,Ic,3,2,"td",7),d.Qb(15,"td",41),d.ac(16,"async"),d.Qb(17,"a",40),d.Dc(18),d.ac(19,"currency"),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.gc("routerLink",n.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",d.bc(5,12,e.date)," "),d.xb(2),d.gc("ngIf",n.isPaymentRequest()),d.xb(2),d.gc("routerLink",n.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",n.bankingHelper.subjectName(n.isPaymentRequest()?e.to:e.from)," "),d.xb(2),d.gc("routerLink",n.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",n.bankingHelper.subjectName(n.isPaymentRequest()?e.from:e.to)," "),d.xb(1),d.gc("ngIf",n.isPaymentRequest()),d.xb(1),d.gc("ngIf",!n.isPaymentRequest()),d.xb(1),d.gc("ngClass",d.jc(19,Fc,d.bc(16,14,n.layout.xxs$))),d.xb(2),d.gc("routerLink",n.bankingHelper.transactionPath(e)),d.xb(1),d.Fc(" ",d.cc(19,16,e.amount,n.currenciesByKey.get(e.currency))," ")}}function Sc(e,t){if(1&e&&(d.Qb(0,"table",36),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Bc(4,Lc,7,3,"ng-container",7),d.Bc(5,wc,11,5,"ng-container",7),d.Qb(6,"th",37),d.Dc(7),d.Pb(),d.Pb(),d.Qb(8,"tbody"),d.Bc(9,Tc,20,21,"ng-container",38),d.ac(10,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.general.date),d.xb(1),d.gc("ngIf",!e.isPaymentRequest()),d.xb(1),d.gc("ngIf",e.isPaymentRequest()),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(10,5,e.results$))?null:n.results)}}function Oc(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.ac(1,"async"),d.Qb(2,"form",4),d.Qb(3,"div",5),d.Bc(4,ac,2,3,"div",6),d.Bc(5,rc,3,3,"div",6),d.Bc(6,vc,9,7,"ng-container",7),d.ac(7,"async"),d.Pb(),d.Pb(),d.Pb(),d.Qb(8,"results-layout",8),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(9,"async"),d.Bc(10,Dc,3,7,"mobile-result",9),d.Bc(11,Sc,11,7,"table",10),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.heading)("mobileHeading",e.mobileHeading)("headingActions",d.bc(1,10,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",(null==e.statusOptions?null:e.statusOptions.length)>0),d.xb(1),d.gc("ngIf",!e.isMyAuth()&&(null==e.currencies?null:e.currencies.length)>1),d.xb(1),d.gc("ngIf",d.bc(7,12,e.moreFilters$)),d.xb(2),d.gc("results",d.bc(9,14,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let Nc=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.transactionsService=t,this.bankingHelper=n,this.usePeriod=!0,this.usePreselectedPeriod=!0,this.currenciesByKey=new Map}ngOnInit(){switch(super.ngOnInit(),this.kind=this.route.snapshot.data.kind,this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations;break;case"myAuth":this.heading=this.i18n.transaction.title.pendingMyAuthorization,this.mobileHeading=this.i18n.transaction.mobileTitle.pendingMyAuthorization;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequestsOverview,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequestsOverview}this.stateManager.cache("data",this.transactionsService.getTransactionsOverviewDataForSearch({fields:["user","accountTypes",...this.usePreselectedPeriod?["preselectedPeriods"]:[],"query"],pendingMyAuthorization:"myAuth"===this.kind})).subscribe(e=>{this.usePeriod&&this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.currencies=[...new Set(e.accountTypes.map(e=>e.currency))],this.currencies.sort((e,t)=>e.name.localeCompare(t.name)),this.currenciesByKey=new Map,this.currencies.forEach(e=>this.currenciesByKey.set(e.id,e));const t=this.currencies.map(e=>e.transactionNumberPattern).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=[this.moreFiltersAction],this.exportHelper.headingActions(e.exportFormats,e=>this.transactionsService.exportTransactionsOverview$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))).forEach(e=>this.headingActions.push(e)),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e)))}updateAccountTypes(e){var t,n;const i=this.form.controls.fromAccountTypes.value,a=this.form.controls.toAccountTypes.value;e&&i&&this.form.controls.fromAccountTypes.setValue((null===(t=this.data.accountTypes.find(e=>e.id===i).currency)||void 0===t?void 0:t.id)===e?i:null),e&&a&&this.form.controls.toAccountTypes.setValue((null===(n=this.data.accountTypes.find(e=>e.id===a).currency)||void 0===n?void 0:n.id)===e?a:null)}doSearch(e){return this.transactionsService.searchTransactionsOverview$Response(e)}getFormControlNames(){return["status","currency","user","preselectedPeriod","periodBegin","periodEnd","transactionNumber","expirationBegin","expirationEnd","transferTypes","authorizationPerformedBy","fromAccountTypes","toAccountTypes"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);switch(this.kind){case"authorized":t.status=i.yb.PENDING;break;case"payment-request":t.status=i.X.OPEN}return t}get statusOptions(){switch(this.kind){case"authorized":return Object.values(i.yb).map(e=>({value:e,text:this.apiI18n.authorizationStatus(e)}));case"payment-request":return Object.values(i.X).map(e=>({value:e,text:this.apiI18n.paymentRequestStatus(e)}));case"myAuth":return null}}toSearchParams(e){const t=e;switch(t.currencies=e.currency?[e.currency]:[],this.usePeriod&&(t.datePeriod=this.bankingHelper.resolveDatePeriod(e)),this.isPaymentRequest()&&(t.paymentRequestExpiration=r.a.dateRangeFilter(e.expirationBegin,e.expirationEnd)),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0;break;case"myAuth":t.pendingMyAuthorization=!0;break;case"payment-request":t.paymentRequestStatuses=[e.status],t.kinds=[i.zb.PAYMENT_REQUEST]}return t}accountTypes(){const e=this.form.controls.currency.value,t=this.data.accountTypes||[];return e?t.filter(t=>t.currency.id===e):t}isPaymentRequest(){return"payment-request"===this.kind}isMyAuth(){return"myAuth"===this.kind}isAuthorized(){return"authorized"===this.kind}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(e){let t;switch(this.kind){case"authorized":t=this.dataForUiHolder.role===i.kb.BROKER?l.b.BROKER_AUTHORIZED_PAYMENTS_OVERVIEW:l.b.AUTHORIZED_PAYMENTS_OVERVIEW;break;case"myAuth":t=l.b.PENDING_MY_AUTHORIZATION;break;case"payment-request":t=l.b.PAYMENT_REQUESTS_OVERVIEW}return this.menu.userMenu(e.user,t)}get toLink(){return e=>this.bankingHelper.transactionPath(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Ba.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-transactions-overview"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions","emptyOption"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","user",3,"label"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","fromAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transferTypes",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["labelPosition","side","formControlName","expirationBegin","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expirationEnd","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","authorizationPerformedBy",3,"label"],[3,"date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"amount",3,"ngClass"],[1,"d-inline-block",3,"routerLink"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,ic,1,0,"ng-container",1),d.Pb(),d.Bc(3,Oc,12,16,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,p.a,h.a,y.a,D.a,x.v,x.l,f.s,L.a,F.a,I.a,T.a,C.a,w.a,q.a,V.h,f.q],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();var kc=n("Pm8L"),Bc=n("/kmK");function Ac(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"label-value",5),d.Dc(2),d.Pb(),d.Lb(3,"hr"),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.transaction.number),d.xb(1),d.Fc(" ",e.transaction.transactionNumber," ")}}function Ec(e,t){1&e&&d.Lb(0,"hr")}function $c(e,t){if(1&e&&(d.Qb(0,"label-value",5),d.Dc(1),d.Pb()),2&e){const e=d.Zb().$implicit,t=d.Zb(2);d.gc("label",t.i18n.general.performedBy),d.xb(1),d.Fc(" ",e.by.display," ")}}function Rc(e,t){if(1&e&&d.Lb(0,"label-value",8),2&e){const e=d.Zb().$implicit,t=d.Zb(2);d.gc("label",t.i18n.general.comments)("value",e.comments)}}function Zc(e,t){if(1&e&&(d.Ob(0),d.Bc(1,Ec,1,0,"hr",3),d.Qb(2,"label-value",5),d.Dc(3),d.Pb(),d.Bc(4,$c,2,2,"label-value",6),d.Qb(5,"label-value",5),d.Dc(6),d.ac(7,"dateTime"),d.Pb(),d.Bc(8,Rc,1,2,"label-value",7),d.Nb()),2&e){const e=t.$implicit,n=t.first,i=d.Zb(2);d.xb(1),d.gc("ngIf",!n),d.xb(1),d.gc("label",i.i18n.general.action),d.xb(1),d.Fc(" ",i.actionLabel(e)," "),d.xb(1),d.gc("ngIf",e.by),d.xb(1),d.gc("label",i.i18n.general.date),d.xb(1),d.Fc(" ",d.bc(7,7,e.date)," "),d.xb(2),d.gc("ngIf",e.comments)}}function Mc(e,t){if(1&e&&(d.Qb(0,"page-content",2),d.Bc(1,Ac,4,2,"ng-container",3),d.Bc(2,Zc,9,9,"ng-container",4),d.Pb()),2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.authorizationHistory)("mobileHeading",e.i18n.transaction.mobileTitle.authorizationHistory),d.xb(1),d.gc("ngIf",e.transaction.transactionNumber),d.xb(1),d.gc("ngForOf",e.transaction.authorizations)}}let Hc=(()=>{class e extends kc.a{constructor(e,t){super(e),this.transactionsService=t}get transaction(){return this.data}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("key");this.addSub(this.transactionsService.viewTransaction({key:e,fields:["transactionNumber","date","amount","kind","type","from","to","authorizations"]}).subscribe(e=>{this.data=e}))}actionLabel(e){return this.apiI18n.authorizationAction(e.action)}resolveMenu(e){return this.menu.accountMenu(e.from,e.to)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Ba.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["view-authorization-history"]],features:[d.ub],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading",4,"ngIf"],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label"],[3,"label",4,"ngIf"],["valueFormat","break",3,"label","value",4,"ngIf"],["valueFormat","break",3,"label","value"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Mc,3,4,"page-content",1),d.Pb()),2&e&&(d.gc("ready",d.bc(1,2,t.data$)),d.xb(2),d.gc("ngIf",t.data))},directives:[m.a,f.t,g.a,f.s,v.a],pipes:[f.b,Bc.a],encapsulation:2,changeDetection:0}),e})();var qc=n("mK/S"),Uc=n("w0j7"),Vc=n("Bp6V"),zc=n("0D+q"),jc=n("Ewue"),Gc=n("R8pA");function _c(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.number),d.xb(1),d.Fc(" ",e.transfer.transactionNumber,"\n")}}function Kc(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Qb(1,"a",7),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.chargedBackBy),d.xb(1),d.gc("routerLink",e.path(e.transfer.chargedBackBy)),d.xb(1),d.Fc(" ",e.transfer.chargedBackBy.display," ")}}function Xc(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Qb(1,"a",7),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.chargebackOf),d.xb(1),d.gc("routerLink",e.path(e.transfer.chargebackOf)),d.xb(1),d.Fc(" ",e.transfer.chargebackOf.display," ")}}function Yc(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.general.performedBy),d.xb(1),d.Fc(" ",e.transfer.transaction.by.display,"\n")}}function Wc(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.receivedBy),d.xb(1),d.Fc(" ",e.transfer.transaction.receivedBy.display,"\n")}}function Jc(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.channel),d.xb(1),d.Fc(" ",e.transfer.transaction.channel.name,"\n")}}function er(e,t){1&e&&d.Lb(0,"custom-field-value",8),2&e&&d.gc("fieldValue",t.$implicit)}function tr(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Dc(1),d.Pb()),2&e){const e=t.$implicit;d.gc("label",e.flow.name),d.xb(1),d.Fc(" ",e.name,"\n")}}function nr(e,t){if(1&e&&d.Lb(0,"label-value",9),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.authorizationComments)("value",e.lastAuthComment)}}function ir(e,t){if(1&e&&d.Lb(0,"label-value",9),2&e){const e=d.Zb();d.gc("label",e.i18n.general.description)("value",e.transfer.transaction.description)}}function ar(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.number),d.xb(1),d.Fc(" ",e.transfer.parent.transactionNumber," ")}}function cr(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"h2",10),d.Dc(2),d.ac(3,"async"),d.Pb(),d.Bc(4,ar,2,2,"label-value",0),d.Qb(5,"label-value",1),d.Dc(6),d.ac(7,"dateTime"),d.Pb(),d.Qb(8,"label-value",1),d.Dc(9),d.ac(10,"currency"),d.Pb(),d.Qb(11,"label-value",1),d.Lb(12,"user-link",2),d.Pb(),d.Qb(13,"label-value",1),d.Lb(14,"user-link",2),d.Pb(),d.Qb(15,"label-value",1),d.Dc(16),d.Pb(),d.Qb(17,"actions"),d.Qb(18,"a",11),d.Dc(19),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(2),d.Ec(d.bc(3,14,e.layout.gtxs$)?e.i18n.transaction.title.parentTransfer:e.i18n.transaction.mobileTitle.parentTransfer),d.xb(2),d.gc("ngIf",e.transfer.parent.transactionNumber),d.xb(1),d.gc("label",e.i18n.general.date),d.xb(1),d.Fc(" ",d.bc(7,16,e.transfer.parent.date)," "),d.xb(2),d.gc("label",e.i18n.transaction.amount),d.xb(1),d.Fc(" ",d.cc(10,18,e.transfer.parent.amount,e.transfer.parent.currency)," "),d.xb(2),d.gc("label",e.i18n.transaction.from),d.xb(1),d.gc("account",e.transfer.parent.from),d.xb(1),d.gc("label",e.i18n.transaction.to),d.xb(1),d.gc("account",e.transfer.parent.to),d.xb(1),d.gc("label",e.i18n.transaction.type),d.xb(1),d.Fc(" ",e.transfer.parent.type.name," "),d.xb(2),d.gc("routerLink",e.path(e.transfer.parent)),d.xb(1),d.Fc(" ",e.i18n.transaction.viewThisTransfer," ")}}function rr(e,t){if(1&e&&(d.Qb(0,"div"),d.Dc(1),d.Lb(2,"user-link",2),d.Pb()),2&e){const e=d.Zb().$implicit,t=d.Zb(2);d.xb(1),d.Fc(" ",t.i18n.transaction.from," "),d.xb(1),d.gc("account",e.from)}}function or(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.to,"")}}function sr(e,t){if(1&e&&(d.Qb(0,"mobile-result",16),d.Qb(1,"div",17),d.Bc(2,rr,3,2,"div",6),d.Qb(3,"div"),d.Bc(4,or,2,1,"ng-container",6),d.Lb(5,"user-link",2),d.Pb(),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("date",e.date)("amount",((null==e.from.user?null:e.from.user.id)===(null==n.login.user?null:n.login.user.id)?"-":"")+e.amount)("amountColor",(null==e.from.user?null:e.from.user.id)===(null==n.login.user?null:n.login.user.id))("currency",e.currency),d.xb(2),d.gc("ngIf",(null==e.from.user?null:e.from.user.id)!==(null==n.login.user?null:n.login.user.id)),d.xb(2),d.gc("ngIf",(null==e.from.user?null:e.from.user.id)!==(null==n.login.user?null:n.login.user.id)),d.xb(1),d.gc("account",e.to)}}function lr(e,t){if(1&e){const e=d.Rb();d.Qb(0,"tr",21),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.path(n))})),d.Qb(1,"td"),d.Qb(2,"a",7),d.Dc(3),d.ac(4,"date"),d.Pb(),d.Pb(),d.Qb(5,"td"),d.Qb(6,"a",7),d.Lb(7,"user-link",2),d.Pb(),d.Pb(),d.Qb(8,"td"),d.Qb(9,"a",7),d.Lb(10,"user-link",2),d.Pb(),d.Pb(),d.Qb(11,"td",19),d.Qb(12,"a",7),d.Dc(13),d.ac(14,"currency"),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",d.bc(4,8,e.date)," "),d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.gc("account",e.from),d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.gc("account",e.to),d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",d.cc(14,10,e.amount,e.currency)," ")}}function ur(e,t){if(1&e&&(d.Qb(0,"table",18),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th",19),d.Dc(9),d.Pb(),d.Pb(),d.Qb(10,"tbody"),d.Bc(11,lr,15,13,"tr",20),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(3),d.Ec(e.i18n.general.date),d.xb(2),d.Ec(e.i18n.transaction.from),d.xb(2),d.Ec(e.i18n.transaction.to),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",e.transfer.children)}}function br(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"h2",12),d.Dc(2),d.ac(3,"async"),d.Pb(),d.Qb(4,"results-layout",13),d.Bc(5,sr,6,7,"mobile-result",14),d.Bc(6,ur,12,5,"table",15),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(2),d.Ec(d.bc(3,3,e.layout.gtxs$)?e.i18n.transaction.title.childTransfers:e.i18n.transaction.mobileTitle.childTransfers),d.xb(2),d.gc("results",e.transfer.children)("toLink",e.toLink)}}let dr=(()=>{class e extends S.a{constructor(e,t,n){super(e),this.login=t,this.bankingHelper=n}ngOnInit(){super.ngOnInit();const e=this.transfer.transaction||{};Object(s.h)(e.authorizations)||(this.lastAuthComment=e.authorizations[0].comments),this.hasAdditionalData=!Object(s.h)(this.lastAuthComment)||!!this.transfer.parent||!Object(s.h)(this.transfer.children)}path(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}get toLink(){return e=>this.path(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Gc.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["transfer-details"]],inputs:{transfer:"transfer",headingActions:"headingActions"},features:[d.ub],decls:24,vars:27,consts:[[3,"label",4,"ngIf"],[3,"label"],[3,"account"],[3,"fieldValue",4,"ngFor","ngForOf"],[3,"label",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"routerLink"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"mt-4"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"mt-4","mb-0"],[3,"results","toLink"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"date","amount","amountColor","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(d.Bc(0,_c,2,2,"label-value",0),d.Qb(1,"label-value",1),d.Dc(2),d.ac(3,"dateTime"),d.Pb(),d.Qb(4,"label-value",1),d.Dc(5),d.ac(6,"currency"),d.Pb(),d.Bc(7,Kc,3,3,"label-value",0),d.Bc(8,Xc,3,3,"label-value",0),d.Bc(9,Yc,2,2,"label-value",0),d.Bc(10,Wc,2,2,"label-value",0),d.Qb(11,"label-value",1),d.Lb(12,"user-link",2),d.Pb(),d.Qb(13,"label-value",1),d.Lb(14,"user-link",2),d.Pb(),d.Qb(15,"label-value",1),d.Dc(16),d.Pb(),d.Bc(17,Jc,2,2,"label-value",0),d.Bc(18,er,1,1,"custom-field-value",3),d.Bc(19,tr,2,2,"label-value",4),d.Bc(20,nr,1,2,"label-value",5),d.Bc(21,ir,1,2,"label-value",5),d.Bc(22,cr,20,21,"ng-container",6),d.Bc(23,br,7,5,"ng-container",6)),2&e&&(d.gc("ngIf",t.transfer.transactionNumber),d.xb(1),d.gc("label",t.i18n.general.date),d.xb(1),d.Fc(" ",d.bc(3,22,t.transfer.date),"\n"),d.xb(2),d.gc("label",t.i18n.transaction.amount),d.xb(1),d.Fc(" ",d.cc(6,24,t.transfer.amount,t.transfer.currency),"\n"),d.xb(2),d.gc("ngIf",t.transfer.chargedBackBy),d.xb(1),d.gc("ngIf",t.transfer.chargebackOf),d.xb(1),d.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.by),d.xb(1),d.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.receivedBy),d.xb(1),d.gc("label",t.i18n.transaction.from),d.xb(1),d.gc("account",t.transfer.from),d.xb(1),d.gc("label",t.i18n.transaction.to),d.xb(1),d.gc("account",t.transfer.to),d.xb(1),d.gc("label",t.i18n.transaction.type),d.xb(1),d.Fc(" ",t.transfer.type.name,"\n"),d.xb(1),d.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.channel),d.xb(1),d.gc("ngForOf",null==t.transfer.transaction?null:t.transfer.transaction.customValues),d.xb(1),d.gc("ngForOf",t.transfer.statuses),d.xb(1),d.gc("ngIf",t.lastAuthComment),d.xb(1),d.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.description),d.xb(1),d.gc("ngIf",t.transfer.parent),d.xb(1),d.gc("ngIf",(null==t.transfer.children?null:t.transfer.children.length)>0))},directives:[f.t,v.a,P.a,f.s,V.h,An.a,dt.a,p.a,h.a,y.a,q.a],pipes:[Bc.a,O.a,f.b,z.a],encapsulation:2,changeDetection:0}),e})();var mr=n("Wpnw");function fr(e,t){if(1&e&&d.Lb(0,"transfer-details",5),2&e){const e=d.Zb(2);d.gc("transfer",e.transaction.transfer)}}function gr(e,t){if(1&e&&(d.Qb(0,"page-content",3),d.ac(1,"async"),d.Bc(2,fr,1,1,"transfer-details",4),d.Pb()),2&e){const e=d.Zb(),t=d.qc(4);d.gc("heading",e.title)("mobileHeading",e.mobileTitle)("headingActions",d.bc(1,5,e.headingActions$)),d.xb(2),d.gc("ngIf",e.transaction.transfer)("ngIfElse",t)}}function pr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.number),d.xb(1),d.Fc(" ",e.transaction.transactionNumber," ")}}function hr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"dateTime"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.expirationDate),d.xb(1),d.Fc(" ",d.bc(2,2,e.transaction.expirationDate)," ")}}function yr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"dateTime"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.processDate),d.xb(1),d.Fc(" ",d.bc(2,2,e.transaction.processDate)," ")}}function xr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"currency"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.dueAmount),d.xb(1),d.Fc(" ",d.cc(2,2,e.transaction.dueAmount,e.transaction.currency)," ")}}function vr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.performedBy),d.xb(1),d.Fc(" ",e.transaction.by.display," ")}}function Pr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.receivedBy),d.xb(1),d.Fc(" ",e.transaction.receivedBy.display," ")}}function Dr(e,t){if(1&e&&d.Lb(0,"user-link",15),2&e){const e=d.Zb(2);d.gc("user",e.transaction.fromUser)}}function Lr(e,t){if(1&e&&d.Dc(0),2&e){const e=d.Zb(2);d.Fc(" ",e.transaction.type.from.name," ")}}function wr(e,t){if(1&e&&d.Lb(0,"user-link",15),2&e){const e=d.Zb(2);d.gc("user",e.transaction.toUser)}}function Cr(e,t){if(1&e&&d.Dc(0),2&e){const e=d.Zb(2);d.Fc(" ",e.transaction.type.to.name," ")}}function Qr(e,t){1&e&&d.Lb(0,"custom-field-value",16),2&e&&d.gc("fieldValue",t.$implicit)}function Ir(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.channel),d.xb(1),d.Fc(" ",e.transaction.channel.name," ")}}function Fr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"date"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.dueDate),d.xb(1),d.Fc(" ",d.bc(2,2,e.transaction.installments[0].dueDate)," ")}}function Tr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"date"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.nextOccurrence),d.xb(1),d.Fc(" ",d.bc(2,2,e.transaction.nextOccurrenceDate)," ")}}function Sr(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.occurrencesCount),d.xb(1),d.Fc(" ",e.transaction.occurrencesCount," ")}}function Or(e,t){if(1&e&&d.Lb(0,"label-value",17),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.authorizationComments)("value",e.lastAuthComment)}}function Nr(e,t){if(1&e&&d.Lb(0,"label-value",17),2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.description)("value",e.transaction.description)}}function kr(e,t){if(1&e&&d.Lb(0,"label-value",17),2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.comments)("value",e.transaction.comments)}}function Br(e,t){1&e&&d.Lb(0,"th",23)}function Ar(e,t){if(1&e&&(d.Qb(0,"thead"),d.Qb(1,"th"),d.Dc(2),d.Pb(),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Qb(7,"th",21),d.Dc(8),d.Pb(),d.Bc(9,Br,1,0,"th",22),d.Pb()),2&e){const e=d.Zb(3);d.xb(2),d.Ec(e.i18n.transaction.installmentNumber),d.xb(2),d.Ec(e.i18n.transaction.dueDate),d.xb(2),d.Ec(e.i18n.general.status),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(1),d.gc("ngIf",e.hasActions)}}function Er(e,t){if(1&e){const e=d.Rb();d.Qb(0,"button",31),d.Xb("click",(function(){d.sc(e);const t=d.Zb(2).$implicit;return d.Zb(3).processInstallment(t)})),d.Lb(1,"icon",32),d.Pb()}if(2&e){const e=d.Zb(5);d.gc("tooltip",e.i18n.transaction.processInstallment)}}const $r=function(e){return{"ml-2":e}};function Rr(e,t){if(1&e){const e=d.Rb();d.Qb(0,"button",33),d.Xb("click",(function(){d.sc(e);const t=d.Zb(2).$implicit;return d.Zb(3).settleInstallment(t)})),d.Lb(1,"icon",34),d.Pb()}if(2&e){const e=d.Zb(2).$implicit,t=d.Zb(3);d.gc("tooltip",t.i18n.transaction.settleInstallment)("ngClass",d.jc(2,$r,e.canProcess))}}function Zr(e,t){if(1&e&&(d.Qb(0,"td",28),d.Bc(1,Er,2,1,"button",29),d.Bc(2,Rr,2,4,"button",30),d.Pb()),2&e){const e=d.Zb().$implicit;d.xb(1),d.gc("ngIf",e.canProcess),d.xb(1),d.gc("ngIf",e.canSettle)}}const Mr=function(e){return{"cursor-pointer":e}};function Hr(e,t){if(1&e){const e=d.Rb();d.Qb(0,"tr",24),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.path(n)?i.router.navigate(i.path(n)):null})),d.Qb(1,"td"),d.Qb(2,"maybe-link",25),d.Dc(3),d.Pb(),d.Pb(),d.Qb(4,"td"),d.Qb(5,"maybe-link",25),d.Dc(6),d.ac(7,"date"),d.Pb(),d.Pb(),d.Qb(8,"td"),d.Qb(9,"maybe-link",25),d.Dc(10),d.Pb(),d.Pb(),d.Qb(11,"td",26),d.Qb(12,"maybe-link",25),d.Dc(13),d.ac(14,"currency"),d.Pb(),d.Pb(),d.Bc(15,Zr,3,2,"td",27),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.gc("ngClass",d.jc(15,Mr,n.path(e))),d.xb(2),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",e.number," "),d.xb(2),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",d.bc(7,10,e.dueDate)," "),d.xb(3),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",n.installmentStatus(e.status)," "),d.xb(2),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",d.cc(14,12,e.amount,n.transaction.currency)," "),d.xb(2),d.gc("ngIf",n.hasActions)}}function qr(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"h2",18),d.Dc(2),d.Pb(),d.Qb(3,"table",19),d.Bc(4,Ar,10,5,"thead",14),d.ac(5,"async"),d.Qb(6,"tbody"),d.Bc(7,Hr,16,17,"tr",20),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.Ec(e.i18n.transaction.installments),d.xb(2),d.gc("ngIf",d.bc(5,3,e.layout.gtxs$)),d.xb(3),d.gc("ngForOf",e.transaction.installments)}}function Ur(e,t){1&e&&d.Lb(0,"th",23)}function Vr(e,t){if(1&e&&(d.Qb(0,"thead"),d.Qb(1,"th"),d.Dc(2),d.Pb(),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Qb(7,"th",26),d.Dc(8),d.Pb(),d.Bc(9,Ur,1,0,"th",22),d.Pb()),2&e){const e=d.Zb(3);d.xb(2),d.Ec(e.i18n.transaction.installmentNumber),d.xb(2),d.Ec(e.i18n.general.date),d.xb(2),d.Ec(e.i18n.general.status),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(1),d.gc("ngIf",e.hasActions)}}function zr(e,t){if(1&e){const e=d.Rb();d.Qb(0,"button",31),d.Xb("click",(function(){d.sc(e);const t=d.Zb(2).$implicit;return d.Zb(3).processOccurrence(t)})),d.Lb(1,"icon",32),d.Pb()}if(2&e){const e=d.Zb(5);d.gc("tooltip",e.i18n.transaction.processFailedOccurrence)}}function jr(e,t){if(1&e&&(d.Qb(0,"td",23),d.Bc(1,zr,2,1,"button",29),d.Pb()),2&e){const e=d.Zb().$implicit;d.xb(1),d.gc("ngIf",e.canProcess)}}function Gr(e,t){if(1&e){const e=d.Rb();d.Qb(0,"tr",24),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.path(n)?i.router.navigate(i.path(n)):null})),d.Qb(1,"td"),d.Qb(2,"maybe-link",25),d.Dc(3),d.Pb(),d.Pb(),d.Qb(4,"td"),d.Qb(5,"maybe-link",25),d.Dc(6),d.ac(7,"date"),d.Pb(),d.Pb(),d.Qb(8,"td"),d.Qb(9,"maybe-link",25),d.Dc(10),d.Pb(),d.Pb(),d.Qb(11,"td",26),d.Qb(12,"maybe-link",25),d.Dc(13),d.ac(14,"currency"),d.Pb(),d.Pb(),d.Bc(15,jr,2,1,"td",22),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.gc("ngClass",d.jc(15,Mr,n.path(e))),d.xb(2),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",e.number," "),d.xb(2),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",d.bc(7,10,e.dueDate)," "),d.xb(3),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",n.installmentStatus(e.status)," "),d.xb(2),d.gc("link",n.path(e)),d.xb(1),d.Fc(" ",d.cc(14,12,e.amount,n.transaction.currency)," "),d.xb(2),d.gc("ngIf",n.hasActions)}}function _r(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"h2",18),d.Dc(2),d.Pb(),d.Qb(3,"table",35),d.Bc(4,Vr,10,5,"thead",14),d.ac(5,"async"),d.Qb(6,"tbody"),d.Bc(7,Gr,16,17,"tr",20),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.Fc(" ",e.i18n.transaction.occurrences," "),d.xb(2),d.gc("ngIf",d.bc(5,3,e.layout.gtxs$)),d.xb(3),d.gc("ngForOf",e.transaction.occurrences)}}const Kr=function(){return[]};function Xr(e,t){if(1&e&&(d.Bc(0,pr,2,2,"label-value",6),d.Lb(1,"label-value",7),d.Qb(2,"label-value",8),d.Dc(3),d.ac(4,"dateTime"),d.Pb(),d.Bc(5,hr,3,4,"label-value",6),d.Bc(6,yr,3,4,"label-value",6),d.Qb(7,"label-value",8),d.Dc(8),d.ac(9,"currency"),d.Pb(),d.Bc(10,xr,3,5,"label-value",6),d.Bc(11,vr,2,2,"label-value",6),d.Bc(12,Pr,2,2,"label-value",6),d.Qb(13,"label-value",8),d.Bc(14,Dr,1,1,"user-link",9),d.Bc(15,Lr,1,1,"ng-template",null,10,d.Cc),d.Pb(),d.Qb(17,"label-value",8),d.Bc(18,wr,1,1,"user-link",9),d.Bc(19,Cr,1,1,"ng-template",null,11,d.Cc),d.Pb(),d.Qb(21,"label-value",8),d.Dc(22),d.Pb(),d.Bc(23,Qr,1,1,"custom-field-value",12),d.Bc(24,Ir,2,2,"label-value",6),d.Bc(25,Fr,3,4,"label-value",6),d.Bc(26,Tr,3,4,"label-value",6),d.Bc(27,Sr,2,2,"label-value",6),d.Bc(28,Or,1,2,"label-value",13),d.Bc(29,Nr,1,2,"label-value",13),d.Bc(30,kr,1,2,"label-value",13),d.Bc(31,qr,8,5,"ng-container",14),d.Bc(32,_r,8,5,"ng-container",14)),2&e){const e=d.qc(16),t=d.qc(20),n=d.Zb();d.gc("ngIf",n.transaction.transactionNumber),d.xb(1),d.gc("label",n.i18n.general.status)("value",n.status),d.xb(1),d.gc("label",n.i18n.general.date),d.xb(1),d.Fc(" ",d.bc(4,30,n.transaction.date)," "),d.xb(2),d.gc("ngIf",n.isPaymentRequest()),d.xb(1),d.gc("ngIf",n.isPaymentRequest()&&n.transaction.processDate),d.xb(1),d.gc("label",n.i18n.transaction.amount),d.xb(1),d.Fc(" ",d.cc(9,32,n.transaction.amount,n.transaction.currency)," "),d.xb(2),d.gc("ngIf",n.hasDueAmount),d.xb(1),d.gc("ngIf",n.transaction.by),d.xb(1),d.gc("ngIf",null==n.transaction?null:n.transaction.receivedBy),d.xb(1),d.gc("label",n.isPaymentRequest()?n.i18n.transaction.sender:n.i18n.transaction.from),d.xb(1),d.gc("ngIf",n.transaction.fromUser)("ngIfElse",e),d.xb(3),d.gc("label",n.isPaymentRequest()?n.i18n.transaction.receiver:n.i18n.transaction.to),d.xb(1),d.gc("ngIf",n.transaction.toUser)("ngIfElse",t),d.xb(3),d.gc("label",n.i18n.transaction.type),d.xb(1),d.Fc(" ",n.transaction.type.name," "),d.xb(1),d.gc("ngForOf",n.transaction.customValues),d.xb(1),d.gc("ngIf",n.transaction.channel),d.xb(1),d.gc("ngIf",1===(n.transaction.installments||d.ic(35,Kr)).length),d.xb(1),d.gc("ngIf",n.transaction.nextOccurrenceDate),d.xb(1),d.gc("ngIf",n.transaction.occurrencesCount),d.xb(1),d.gc("ngIf",n.lastAuthComment),d.xb(1),d.gc("ngIf",n.transaction.description),d.xb(1),d.gc("ngIf",n.transaction.comments),d.xb(1),d.gc("ngIf",(n.transaction.installments||d.ic(36,Kr)).length>1),d.xb(1),d.gc("ngIf",(n.transaction.occurrences||d.ic(37,Kr)).length>0)}}let Yr=(()=>{class e extends kc.a{constructor(e,t,n,i,a,c,r,o,s){super(e),this.transactionsService=t,this.installmentsService=n,this.pendingPaymentsService=i,this.scheduledPaymentsService=a,this.recurringPaymentsService=c,this.paymentRequestsService=r,this.transfersService=o,this.operationHelper=s,this.hasDueAmount=!1,this.hasActions=!1}get status(){return this.apiI18n.transactionStatus(this.transaction)}get transaction(){return this.data}get key(){return this.route.snapshot.paramMap.get("key")}ngOnInit(){super.ngOnInit(),this.addSub(this.transactionsService.viewTransaction({key:this.key}).subscribe(e=>{[this.title,this.mobileTitle]=this.titles(e.kind),this.headingActions=this.initActions(e),this.hasDueAmount=e.dueAmount&&!this.format.isZero(e.dueAmount),this.hasActions=!!(e.installments||e.occurrences||[]).find(e=>e.canProcess||e.canSettle),this.data=e,e.transfer&&(e.transfer.transaction=e),Object(s.h)(e.authorizations)||(this.lastAuthComment=e.authorizations[0].comments)}))}initActions(e){var t,n;const a=this.exportHelper.headingActions(e.exportFormats,t=>this.transactionsService.exportTransaction$Response({format:t.internalName,key:e.id})),c=e.authorizationPermissions||{};Object(s.h)(e.authorizations)||a.push(new At.c("check_circle_outline",this.i18n.transaction.viewAuthorizations,()=>this.router.navigate(["banking","transaction",this.key,"authorization-history"]))),c.authorize&&a.push(new At.c("thumb_up",this.i18n.transaction.authorizePending,()=>this.authorize())),c.deny&&a.push(new At.c("thumb_down",this.i18n.transaction.denyPending,()=>this.deny())),c.cancel&&a.push(new At.c("cancel",this.i18n.transaction.cancelAuthorization,()=>this.cancelAuthorization()));const r=e.scheduledPaymentPermissions||{};r.block&&a.push(new At.c("block",this.i18n.transaction.blockScheduling,()=>this.blockScheduled())),r.unblock&&a.push(new At.c("schedule",this.i18n.transaction.unblockScheduling,()=>this.unblockScheduled())),r.cancel&&a.push(new At.c("cancel",this.i18n.transaction.cancelScheduled,()=>this.cancelScheduled())),r.settle&&a.push(new At.c("done_all",this.i18n.transaction.settleScheduled,()=>this.settleScheduled())),e.kind===i.zb.SCHEDULED_PAYMENT&&1===e.installments.length&&e.installments[0].canProcess&&a.push(new At.c("play_circle_outline",this.i18n.transaction.processScheduled,()=>this.processScheduled(e.installments[0]))),(null===(t=e.recurringPaymentPermissions)||void 0===t?void 0:t.cancel)&&a.push(new At.c("cancel",this.i18n.transaction.cancelRecurring,()=>this.cancelRecurring()));const o=e.paymentRequestPermissions||{};o.accept&&a.push(new At.c("thumb_up",this.i18n.transaction.acceptPaymentRequest,()=>this.acceptPaymentRequest())),o.reject&&a.push(new At.c("thumb_down",this.i18n.transaction.rejectPaymentRequest,()=>this.rejectPaymentRequest())),o.cancel&&a.push(new At.c("cancel",this.i18n.transaction.cancelPaymentRequest,()=>this.cancelPaymentRequest())),o.reschedule&&a.push(new At.c("schedule",this.i18n.transaction.reschedulePaymentRequest,()=>this.reschedulePaymentRequest())),o.changeExpiration&&a.push(new At.c("schedule",this.i18n.transaction.changePaymentRequestExpiration,()=>this.changePaymentRequestExpiration())),(null===(n=e.transfer)||void 0===n?void 0:n.canChargeback)&&a.push(new At.c("undo",this.i18n.transaction.chargebackTransfer,()=>this.chargeback()));for(const i of(e.transfer||{}).operations||[])a.push(this.operationHelper.headingAction(i,e.transfer.id));return a}get authorizationFields(){return[{internalName:"comments",name:this.i18n.general.comments,type:i.p.TEXT}]}authDeviceConfirmation(e){return()=>({type:i.s.MANAGE_AUTHORIZATION,transaction:this.transaction.id,authorizationAction:e})}authorize(){this.notification.confirm({title:this.i18n.transaction.authorizePending,labelPosition:"above",customFields:this.authorizationFields,passwordInput:this.transaction.confirmationPasswordInput,createDeviceConfirmation:this.authDeviceConfirmation(i.h.AUTHORIZE),callback:e=>{this.addSub(this.pendingPaymentsService.authorizePendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(e=>{e?this.notification.warning(this.i18n.transaction.authorizePendingDoneStillPending):this.notification.snackBar(this.i18n.transaction.authorizePendingDone),this.reload()}))}})}deny(){this.notification.confirm({title:this.i18n.transaction.denyPending,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(i.h.DENY),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.pendingPaymentsService.denyPendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.denyPendingDone)))}})}cancelAuthorization(){this.notification.confirm({title:this.i18n.transaction.cancelAuthorization,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(i.h.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.pendingPaymentsService.cancelPendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelAuthorizationDone)))}})}schedDeviceConfirmation(e){return()=>({type:i.s.MANAGE_SCHEDULED_PAYMENT,transaction:this.transaction.id,scheduledPaymentAction:e})}blockScheduled(){this.notification.confirm({title:this.i18n.transaction.blockScheduling,message:this.i18n.transaction.blockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.lb.BLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.blockScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.blockSchedulingDone)))}})}unblockScheduled(){this.notification.confirm({title:this.i18n.transaction.unblockScheduling,message:this.i18n.transaction.unblockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.lb.UNBLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.unblockScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.unblockSchedulingDone)))}})}cancelScheduled(){this.notification.confirm({title:this.i18n.transaction.cancelScheduled,message:this.i18n.transaction.cancelScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.lb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.cancelScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelScheduledDone)))}})}settleScheduled(){this.notification.confirm({title:this.i18n.transaction.settleScheduled,message:this.i18n.transaction.settleScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.lb.SETTLE),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.settleScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleScheduledDone)))}})}recurringDeviceConfirmation(e){return()=>({type:i.s.MANAGE_RECURRING_PAYMENT,transaction:this.transaction.id,recurringPaymentAction:e})}cancelRecurring(){this.notification.confirm({title:this.i18n.transaction.cancelRecurring,message:this.i18n.transaction.cancelRecurringMessage,createDeviceConfirmation:this.recurringDeviceConfirmation(i.fb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.recurringPaymentsService.cancelRecurringPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelRecurringDone)))}})}paymentRequestDeviceConfirmation(e){return()=>({type:i.s.MANAGE_PAYMENT_REQUEST,transaction:this.transaction.id,paymentRequestAction:e})}cancelPaymentRequest(){this.notification.confirm({title:this.i18n.transaction.cancelPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.V.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"comments",name:this.i18n.general.comments,type:i.p.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.cancelPaymentRequest({key:this.transaction.id,body:e.customValues.comments,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelPaymentRequestDone)))}})}rejectPaymentRequest(){this.notification.confirm({title:this.i18n.transaction.rejectPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.V.DENY),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"comments",name:this.i18n.general.comments,type:i.p.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.rejectPaymentRequest({key:this.transaction.id,body:e.customValues.comments,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.rejectPaymentRequestDone)))}})}changePaymentRequestExpiration(){this.notification.confirm({title:this.i18n.transaction.changePaymentRequestExpiration,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.V.CHANGE_EXPIRATION),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:i.p.DATE,required:!0},{internalName:"comments",defaultValue:this.data.changeExpirationDateComments,name:this.i18n.general.comments,type:i.p.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.changePaymentRequestExpirationDate({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments,newExpirationDate:r.a.shiftToDayEnd(e.customValues.expiry)}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.changePaymentRequestExpirationDone)))}})}reschedulePaymentRequest(){this.notification.confirm({title:this.i18n.transaction.reschedulePaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.V.RESCHEDULE),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:i.p.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:i.p.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.reschedulePaymentRequest({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments,processDate:e.customValues.expiry}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.reschedulePaymentRequestDone)))}})}acceptPaymentRequest(){this.router.navigate(["/banking","payment-request",this.data.id,"accept"])}chargebackDeviceConfirmation(){return()=>({type:i.s.CHARGEBACK,transfer:this.transaction.transfer.id})}chargeback(){this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transaction.transfer.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.chargebackTransferDone)))}})}titles(e){switch(e){case i.zb.SCHEDULED_PAYMENT:return[this.i18n.transaction.title.detailsScheduled,this.i18n.transaction.mobileTitle.detailsScheduled];case i.zb.RECURRING_PAYMENT:return[this.i18n.transaction.title.detailsRecurring,this.i18n.transaction.mobileTitle.detailsRecurring];case i.zb.PAYMENT_REQUEST:return[this.i18n.transaction.title.detailsRequest,this.i18n.transaction.mobileTitle.detailsRequest];case i.zb.CHARGEBACK:return[this.i18n.transaction.title.detailsChargeback,this.i18n.transaction.mobileTitle.detailsChargeback];case i.zb.TICKET:return[this.i18n.transaction.title.detailsTicket,this.i18n.transaction.mobileTitle.detailsTicket];case i.zb.EXTERNAL_PAYMENT:return[this.i18n.transaction.title.detailsExternal,this.i18n.transaction.mobileTitle.detailsExternal];default:return[this.i18n.transaction.title.detailsPayment,this.i18n.transaction.mobileTitle.detailsPayment]}}installmentStatus(e){return this.apiI18n.installmentStatus(e)}path(e){const t=e.transferTransactionNumber||e.transferId;if(t)return["/banking","transfer",t]}installmentDeviceConfirmation(e,t){return()=>({type:i.s.MANAGE_INSTALLMENT,installment:t.id,installmentAction:e})}settleInstallment(e){this.notification.confirm({title:this.i18n.transaction.settleInstallment,message:this.i18n.transaction.settleInstallmentMessage(String(e.number)),createDeviceConfirmation:this.installmentDeviceConfirmation(i.F.SETTLE,e),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.installmentsService.settleInstallment({key:e.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleInstallmentDone)))}})}isScheduledPayment(){return this.data.kind===i.zb.SCHEDULED_PAYMENT}isPaymentRequest(){return this.data.kind===i.zb.PAYMENT_REQUEST}processInstallment(e){this.notification.confirm({title:this.i18n.transaction.processInstallment,message:this.i18n.transaction.processInstallmentMessage(e.number),createDeviceConfirmation:this.installmentDeviceConfirmation(i.F.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processInstallmentDone)})}processOccurrence(e){this.notification.confirm({title:this.i18n.transaction.processFailedOccurrence,message:this.i18n.transaction.processFailedOccurrenceMessage(e.number),createDeviceConfirmation:this.failedOccurreneceDeviceConfirmation(i.x.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processFailedOccurrenceDone)})}processScheduled(e){this.notification.confirm({title:this.i18n.transaction.processScheduled,message:this.i18n.transaction.processScheduledMessage,createDeviceConfirmation:this.installmentDeviceConfirmation(i.F.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processScheduledDone)})}processCallback(e,t){return n=>this.addSub(this.installmentsService.processInstallment({key:e,confirmationPassword:n.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(t)))}sendNotificationAndReload(e){this.notification.snackBar(e),this.reload()}failedOccurreneceDeviceConfirmation(e,t){return()=>({type:i.s.MANAGE_FAILED_OCCURRENCE,failedOccurrence:t.id,failedOccurrenceAction:e})}resolveMenu(e){return this.menu.accountMenu(e.from,e.to)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Ba.a),d.Kb(xa.a),d.Kb(Uc.a),d.Kb(zc.a),d.Kb(Vc.a),d.Kb(On.a),d.Kb(qc.a),d.Kb(jc.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["view-transaction"]],features:[d.ub],decls:5,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["transactionFields",""],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"transfer",4,"ngIf","ngIfElse"],[3,"transfer"],[3,"label",4,"ngIf"],[3,"label","value"],[3,"label"],[3,"user",4,"ngIf","ngIfElse"],["fromSystem",""],["toSystem",""],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"border-0","mt-4"],[1,"table","table-hover"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"amount"],["class","actions",4,"ngIf"],[1,"actions"],[3,"ngClass","click"],[3,"link"],[1,"text-right"],["class","actions actions-multiple",4,"ngIf"],[1,"actions","actions-multiple"],["class","btn btn-icon align-items-center",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon align-items-center",3,"tooltip","ngClass","click",4,"ngIf"],[1,"btn","btn-icon","align-items-center",3,"tooltip","click"],["icon","play_circle_outline"],[1,"btn","btn-icon","align-items-center",3,"tooltip","ngClass","click"],["icon","thumb_up"],[1,"table","table-hover","cursor-pointer"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,gr,3,7,"page-content",1),d.Pb(),d.Bc(3,Xr,33,38,"ng-template",null,2,d.Cc)),2&e&&(d.gc("ready",d.bc(1,2,t.data$)),d.xb(2),d.gc("ngIf",t.data))},directives:[m.a,f.t,g.a,dr,v.a,f.s,P.a,An.a,f.q,mr.a,kn.b,fi.a],pipes:[f.b,Bc.a,O.a,z.a],encapsulation:2,changeDetection:0}),e})();function Wr(e,t){1&e&&d.Mb(0)}function Jr(e,t){if(1&e&&d.Lb(0,"field-option",15),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e)("text",e.name)}}function eo(e,t){if(1&e&&(d.Qb(0,"div",12),d.Qb(1,"single-selection-field",13),d.Bc(2,Jr,1,3,"field-option",14),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.period),d.xb(1),d.gc("ngForOf",e.data.preselectedPeriods)}}function to(e,t){if(1&e&&d.Lb(0,"field-option",18),2&e){const e=t.$implicit,n=d.Zb(3);d.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function no(e,t){if(1&e&&(d.Qb(0,"div",12),d.Qb(1,"multi-selection-field",16),d.Bc(2,to,1,5,"field-option",17),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.groupFilter),d.xb(1),d.gc("ngForOf",e.data.groups)}}function io(e,t){if(1&e&&d.Lb(0,"field-option",21),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function ao(e,t){if(1&e&&(d.Qb(0,"div",12),d.Qb(1,"single-selection-field",19),d.Bc(2,io,1,2,"field-option",20),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),d.xb(1),d.gc("ngForOf",e.data.currencies)}}function co(e,t){if(1&e&&d.Lb(0,"field-option",39),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function ro(e,t){if(1&e&&d.Lb(0,"field-option",39),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function oo(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"div",22),d.Qb(2,"div",12),d.Qb(3,"single-selection-field",36),d.Bc(4,co,1,4,"field-option",37),d.Pb(),d.Pb(),d.Qb(5,"div",12),d.Qb(6,"single-selection-field",38),d.Bc(7,ro,1,4,"field-option",37),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(3),d.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.fromAccount),d.xb(1),d.gc("ngForOf",e.accountTypes()),d.xb(2),d.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.toAccount),d.xb(1),d.gc("ngForOf",e.accountTypes())}}function so(e,t){if(1&e&&d.Lb(0,"field-option",42),2&e){const e=t.$implicit,n=d.Zb(4);d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("category",n.singleAccount||null==e.accountType?null:e.accountType.name)}}function lo(e,t){if(1&e&&(d.Qb(0,"div",12),d.Qb(1,"multi-selection-field",40),d.Bc(2,so,1,5,"field-option",41),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.account.transferFilter),d.xb(1),d.gc("ngForOf",e.transferFilters())}}function uo(e,t){if(1&e&&d.Lb(0,"field-option",45),2&e){const e=t.$implicit;d.gc("id",e.id)("internalName",e.internalName)("value",e.internalName)("text",e.name)}}function bo(e,t){if(1&e&&(d.Qb(0,"div",12),d.Qb(1,"multi-selection-field",43),d.Bc(2,uo,1,4,"field-option",44),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.transaction.channel),d.xb(1),d.gc("ngForOf",e.data.channels)}}function mo(e,t){if(1&e&&(d.Qb(0,"div",12),d.Lb(1,"date-field",46),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.general.beginDate)}}function fo(e,t){if(1&e&&(d.Qb(0,"div",12),d.Lb(1,"date-field",47),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.general.endDate)}}function go(e,t){if(1&e&&(d.Qb(0,"div",12),d.Lb(1,"input-field",48),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function po(e,t){if(1&e&&(d.Ob(0),d.Bc(1,oo,8,6,"ng-container",8),d.Bc(2,lo,3,3,"div",7),d.Bc(3,bo,3,3,"div",7),d.Lb(4,"div",22),d.Bc(5,mo,2,1,"div",7),d.ac(6,"async"),d.Bc(7,fo,2,1,"div",7),d.ac(8,"async"),d.Qb(9,"div",12),d.Lb(10,"decimal-field",23),d.Pb(),d.Qb(11,"div",12),d.Lb(12,"decimal-field",24),d.Pb(),d.Qb(13,"div",12),d.Lb(14,"user-field",25),d.Pb(),d.Bc(15,go,2,2,"div",7),d.Qb(16,"div",12),d.Lb(17,"user-field",26),d.Pb(),d.Qb(18,"div",12),d.Lb(19,"multi-selection-field",27),d.Pb(),d.Qb(20,"div",12),d.Qb(21,"single-selection-field",28),d.Lb(22,"field-option",29),d.Lb(23,"field-option",30),d.Pb(),d.Pb(),d.Qb(24,"div",12),d.Qb(25,"single-selection-field",31),d.Lb(26,"field-option",32),d.Lb(27,"field-option",33),d.Lb(28,"field-option",34),d.Lb(29,"field-option",35),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);var n,i;d.xb(1),d.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.xb(1),d.gc("ngIf",e.transferFilters().length>0),d.xb(1),d.gc("ngIf",(null==e.data.channels?null:e.data.channels.length)>1),d.xb(2),d.gc("ngIf",null==(null==(n=e.form.value||d.bc(6,30,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),d.xb(2),d.gc("ngIf",null==(null==(i=e.form.value||d.bc(8,32,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end)),d.xb(3),d.gc("label",e.i18n.account.minAmount)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("label",e.i18n.account.maxAmount)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("ngIf",e.hasTransactionNumber),d.xb(2),d.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters())("allowContacts",!1),d.xb(2),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.transaction.transferKinds)("fieldOptions",e.kindOptions),d.xb(2),d.gc("label",e.i18n.transaction.chargedBack)("emptyOption",e.i18n.general.all),d.xb(1),d.gc("text",e.i18n.general.yes),d.xb(1),d.gc("text",e.i18n.general.no),d.xb(2),d.gc("label",e.i18n.general.orderBy),d.xb(1),d.gc("text",e.i18n.account.orderBy.dateDesc),d.xb(1),d.gc("text",e.i18n.account.orderBy.dateAsc),d.xb(1),d.gc("text",e.i18n.account.orderBy.amountAsc),d.xb(1),d.gc("text",e.i18n.account.orderBy.amountDesc)}}const ho=function(e,t){return{from:e,to:t}};function yo(e,t){if(1&e&&(d.Qb(0,"mobile-result",49),d.Qb(1,"div",50),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("date",e.date)("amount",e.amount)("currency",e.currency),d.xb(2),d.Fc(" ",n.i18n.transaction.fromToText(d.kc(4,ho,n.bankingHelper.ownerName(e.from),n.bankingHelper.ownerName(e.to))),"")}}function xo(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",54),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.path(n))})),d.Qb(2,"td"),d.Qb(3,"a",55),d.Dc(4),d.ac(5,"date"),d.Pb(),d.Pb(),d.Qb(6,"td"),d.Qb(7,"a",55),d.Dc(8),d.Pb(),d.Pb(),d.Qb(9,"td"),d.Qb(10,"a",55),d.Dc(11),d.Pb(),d.Pb(),d.Qb(12,"td",52),d.Qb(13,"a",55),d.Dc(14),d.ac(15,"currency"),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",d.bc(5,8,e.date)," "),d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",n.bankingHelper.ownerName(e.from)," "),d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",n.bankingHelper.ownerName(e.to)," "),d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",d.cc(15,10,n.format.abs(e.amount),e.currency)," ")}}function vo(e,t){if(1&e&&(d.Qb(0,"table",51),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th",52),d.Dc(9),d.Pb(),d.Pb(),d.Qb(10,"tbody"),d.Bc(11,xo,16,13,"ng-container",53),d.ac(12,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.general.date),d.xb(2),d.Ec(e.i18n.transaction.from),d.xb(2),d.Ec(e.i18n.transaction.to),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(12,5,e.results$))?null:n.results)}}function Po(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",4),d.ac(1,"async"),d.Qb(2,"form",5),d.Qb(3,"div",6),d.Bc(4,eo,3,2,"div",7),d.Bc(5,no,3,3,"div",7),d.Bc(6,ao,3,3,"div",7),d.Bc(7,po,30,34,"ng-container",8),d.ac(8,"async"),d.Pb(),d.Pb(),d.Pb(),d.Qb(9,"results-layout",9),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(10,"async"),d.Bc(11,yo,3,7,"mobile-result",10),d.Bc(12,vo,13,7,"table",11),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.transfersOverview)("mobileHeading",e.i18n.transaction.mobileTitle.transfersOverview)("headingActions",d.bc(1,11,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>1),d.xb(1),d.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),d.xb(1),d.gc("ngIf",(null==e.data.currencies?null:e.data.currencies.length)>1),d.xb(1),d.gc("ngIf",d.bc(8,13,e.moreFilters$)),d.xb(2),d.gc("results",d.bc(10,15,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}function Do(e,t){1&e&&d.Lb(0,"spinner",56)}let Lo=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.transfersService=t,this.bankingHelper=n,this.filters$=new u.a([])}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}getFormControlNames(){return["preselectedPeriod","periodBegin","periodEnd","groups","currency","channels","fromAccountType","toAccountType","transferFilters","kinds","chargedBack","minAmount","maxAmount","transactionNumber","user","by","orderBy","brokers"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.orderBy=t.orderBy||i.wb.DATE_DESC,t}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.transfersService.getTransferDataForSearch()).subscribe(e=>{this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.singleCurrency=1===(e.currencies||[]).length?e.currencies[0]:null,this.singleAccount=1===(e.accountTypes||[]).length?e.accountTypes[0]:null;const t=(e.currencies||[]).map(e=>e.transactionNumberPattern).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.form.controls.fromAccountType.valueChanges.subscribe(e=>this.updateTransferFilters(e))),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e))),this.headingActions=[this.moreFiltersAction],this.exportHelper.headingActions(e.exportFormats,e=>this.transfersService.exportTransfers$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))).forEach(e=>this.headingActions.push(e))}updateTransferFilters(e){const t=this.form.controls.transferFilters.value;e&&t&&this.form.controls.transferFilters.setValue(t.filter(t=>this.data.transferFilters.find(e=>e.id===t).accountType.id===e))}updateAccountTypes(e){const t=this.form.controls.fromAccountType.value,n=this.form.controls.toAccountType.value;if(e&&t){const n=this.data.accountTypes.find(e=>e.id===t).currency;this.form.controls.fromAccountType.setValue(n&&n.id!==e?null:t)}if(e&&n){const t=this.data.accountTypes.find(e=>e.id===n).currency;this.form.controls.toAccountType.setValue(t&&t.id!==e?null:n)}}userSearchFilters(){return{roles:[i.kb.BROKER]}}findCurrency(e){var t;if(this.singleCurrency)return this.singleCurrency;const n=this.form.controls.currency.value;if(n)return this.data.currencies.find(e=>e.id===n);const i=this.form.controls.fromAccountType.value;return e&&i?null===(t=this.data.accountTypes.find(e=>e.id===i))||void 0===t?void 0:t.currency:null}transferFilters(){const e=this.form.controls.fromAccountType.value,t=this.data.transferFilters||[];if(e)return t.filter(t=>t.accountType.id===e);if(this.findCurrency(!0)){const e=this.accountTypes().map(e=>e.id);return t.filter(t=>e.includes(t.accountType.id))}return t}accountTypes(){const e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter(t=>!t.currency||t.currency.id===e.id):t}currencyDecimalDigits(){const e=this.findCurrency(!0);return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency(!0);return e?e.prefix:null}currencySuffix(){const e=this.findCurrency(!0);return e?e.suffix:null}toSearchParams(e){const t=e;return t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=r.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],e.chargedBack&&(t.chargedBack="yes"===e.chargedBack),t}doSearch(e){return this.transfersService.searchTransfers$Response(e)}get kindOptions(){return Object.values(i.Bb).map(e=>({value:e,text:this.apiI18n.transferKind(e)}))}path(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}get toLink(){return e=>this.path(e)}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(){return this.dataForUiHolder.role===i.kb.ADMINISTRATOR?l.b.ADMIN_TRANSFERS_OVERVIEW:l.b.BROKER_TRANSFERS_OVERVIEW}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(qc.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-transfers-overview"]],features:[d.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","brokers",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","kinds",3,"emptyLabel","label","fieldOptions"],["labelPosition","side","formControlName","chargedBack",3,"label","emptyOption"],["value","yes",3,"text"],["value","no",3,"text"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["labelPosition","side","formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","transferFilters",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["labelPosition","side","formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["forceSign","",3,"date","amount","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Wr,1,0,"ng-container",1),d.Pb(),d.Bc(3,Po,13,17,"ng-template",null,2,d.Cc),d.Bc(5,Do,1,0,"ng-template",null,3,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,p.a,h.a,y.a,D.a,x.v,x.l,f.s,L.a,w.a,Q.a,F.a,C.a,I.a,T.a,q.a,V.h,H.a],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();function wo(e,t){if(1&e&&(d.Qb(0,"page-content",2),d.ac(1,"async"),d.Lb(2,"transfer-details",3),d.ac(3,"async"),d.Pb()),2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.detailsTransfer)("mobileHeading",e.i18n.transaction.mobileTitle.detailsTransfer)("headingActions",d.bc(1,5,e.headingActions$)),d.xb(2),d.gc("headingActions",d.bc(3,7,e.headingActions$))("transfer",e.transfer)}}let Co=(()=>{class e extends kc.a{constructor(e,t,n,i){super(e),this.bankingHelper=t,this.transfersService=n,this.operationHelper=i}get transfer(){return this.data}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.accountId=e.params.account,this.addSub(this.transfersService.viewTransfer({key:e.params.key}).subscribe(e=>{this.headingActions=this.initActions(e),this.data=e}))}initActions(e){const t=this.exportHelper.headingActions(e.exportFormats,t=>this.transfersService.exportTransfer$Response({format:t.internalName,key:e.id})),n=e.transaction||{};Object(s.h)(n.authorizations)||t.push(new At.c("check_circle_outline",this.i18n.transaction.viewAuthorizations,()=>{this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(n),"authorization-history"])})),e.canChargeback&&t.push(new At.c("undo",this.i18n.transaction.chargebackTransfer,()=>{this.chargeback()}));for(const i of e.operations||[])t.push(this.operationHelper.headingAction(i,e.id));return t}chargebackDeviceConfirmation(){return()=>({type:i.s.CHARGEBACK,transfer:this.transfer.id})}chargeback(){this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transfer.confirmationPasswordInput,callback:e=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transfer.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>{this.notification.snackBar(this.i18n.transaction.chargebackTransferDone),this.reload()}))}})}resolveMenu(e){return this.menu.transferMenu(e,this.accountId)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a),d.Kb(qc.a),d.Kb(jc.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["view-transfer"]],features:[d.ub],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"headingActions","transfer"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,wo,4,9,"page-content",1),d.Pb()),2&e&&(d.gc("ready",d.bc(1,2,t.data$)),d.xb(2),d.gc("ngIf",t.data))},directives:[m.a,f.t,g.a,dr],pipes:[f.b],encapsulation:2,changeDetection:0}),e})();var Qo=n("xVDN");function Io(e,t){if(1&e&&d.Lb(0,"user-info",5),2&e){const e=d.Zb();d.gc("user",e.user)}}function Fo(e,t){if(1&e&&(d.Qb(0,"mobile-result",6),d.Qb(1,"div",7),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit;d.gc("avatarImage",e.image),d.xb(2),d.Fc(" ",e.voucherTitle," ")}}function To(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",10),d.Xb("click",(function(){d.sc(e);const n=t.$implicit;return d.Zb(2).selectType(n)})),d.Qb(2,"td",11),d.Lb(3,"avatar",12),d.Pb(),d.Qb(4,"td"),d.Qb(5,"div"),d.Qb(6,"a",13),d.Xb("click",(function(){d.sc(e);const n=t.$implicit;return d.Zb(2).selectType(n)})),d.Dc(7),d.Pb(),d.Qb(8,"div"),d.Dc(9),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit;d.xb(3),d.gc("image",e.image),d.xb(4),d.Fc(" ",e.voucherTitle," "),d.xb(2),d.Fc(" ",e.voucherDescription," ")}}function So(e,t){if(1&e&&(d.Qb(0,"table",8),d.Qb(1,"tbody"),d.Bc(2,To,10,3,"ng-container",9),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.xb(2),d.gc("ngForOf",e.types)}}let Oo=(()=>{class e extends S.a{constructor(e){super(e),this.typeSelected=new d.n}get selectType(){return e=>this.typeSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["buy-vouchers-step-list-types"]],inputs:{types:"types",user:"user"},outputs:{typeSelected:"typeSelected"},features:[d.ub],decls:5,vars:6,consts:[[3,"mode","heading","mobileHeading"],["labelCols","2",3,"user",4,"ngIf"],["resultType","list",3,"results","onClick"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelCols","2",3,"user"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar"],["icon","shopping_cart","size","xlarge","roundBorders","false",3,"image"],["ngClass","font-weight-bold",3,"click"]],template:function(e,t){1&e&&(d.Qb(0,"page-content",0),d.Bc(1,Io,1,1,"user-info",1),d.Pb(),d.Qb(2,"results-layout",2),d.Bc(3,Fo,3,2,"mobile-result",3),d.Bc(4,So,3,1,"table",4),d.Pb()),2&e&&(d.gc("mode",t.user&&!t.authHelper.isSelf(t.user)?"normal":"empty")("heading",t.i18n.voucher.title.buy)("mobileHeading",t.i18n.voucher.mobileTitle.buy),d.xb(1),d.gc("ngIf",t.user&&!t.authHelper.isSelf(t.user)),d.xb(1),d.gc("results",t.types)("onClick",t.selectType))},directives:[g.a,f.t,p.a,h.a,y.a,ht.a,q.a,f.s,U.a,f.q],encapsulation:2,changeDetection:0}),e})();function No(e,t){if(1&e&&d.Lb(0,"user-info",8),2&e){const e=d.Zb();d.gc("user",e.data.user)}}function ko(e,t){if(1&e&&(d.Qb(0,"label-value",2),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.voucher.buy.minTimeToRedeem),d.xb(1),d.Fc(" ",e.i18n.voucher.buy.minTimeToRedeemAfterBuy(e.format.formatTimeInterval(e.data.minimumTimeToRedeem))," ")}}const Bo=function(e,t){return{min:e,max:t}};function Ao(e,t){if(1&e&&(d.Lb(0,"label-value",9),d.ac(1,"currency"),d.ac(2,"currency")),2&e){const e=d.Zb();d.gc("label",e.i18n.voucher.buy.amountRange)("value",e.format.formatRange(d.kc(8,Bo,d.cc(1,2,e.data.amountRange.min,e.currency),d.cc(2,5,e.data.amountRange.max,e.currency))))}}function Eo(e,t){if(1&e&&d.Lb(0,"custom-field-input",10),2&e){const e=t.$implicit,n=d.Zb();d.gc("field",e)("formControl",n.customFieldControlsMap.get(e.internalName))}}let $o=(()=>{class e extends S.a{constructor(e){super(e)}get currency(){return this.data.account.currency}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["buy-vouchers-step-form"]],inputs:{data:"data",form:"form",customFieldControlsMap:"customFieldControlsMap"},features:[d.ub],decls:12,vars:17,consts:[[3,"formGroup"],[3,"user",4,"ngIf"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["kind","fieldView",3,"label","value",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],[3,"user"],["kind","fieldView",3,"label","value"],[3,"field","formControl"]],template:function(e,t){1&e&&(d.Ob(0,0),d.Bc(1,No,1,1,"user-info",1),d.Qb(2,"label-value",2),d.Dc(3),d.Pb(),d.Qb(4,"label-value",2),d.Dc(5),d.ac(6,"currency"),d.Pb(),d.Bc(7,ko,2,2,"label-value",3),d.Lb(8,"input-field",4),d.Lb(9,"decimal-field",5),d.Bc(10,Ao,3,11,"label-value",6),d.Bc(11,Eo,1,2,"custom-field-input",7),d.Nb()),2&e&&(d.gc("formGroup",t.form),d.xb(1),d.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),d.xb(1),d.gc("label",t.i18n.voucher.originAccount),d.xb(1),d.Fc(" ",t.data.account.type.name," "),d.xb(1),d.gc("label",t.i18n.account.availableBalance),d.xb(1),d.Fc(" ",d.cc(6,14,t.data.account.status.availableBalance,t.currency)," "),d.xb(2),d.gc("ngIf",t.data.minimumTimeToRedeem),d.xb(1),d.gc("label",t.i18n.voucher.numberOfVouchers),d.xb(1),d.gc("label",t.i18n.voucher.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),d.xb(1),d.gc("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)||(null==t.data.amountRange?null:t.data.amountRange.max)),d.xb(1),d.gc("ngForOf",t.data.customFields))},directives:[x.w,x.n,f.t,v.a,I.a,x.v,x.l,x.D,Q.a,f.s,ht.a,Qi.a,x.k],pipes:[O.a],encapsulation:2,changeDetection:0}),e})();var Ro=n("5Wk5");function Zo(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"user-info",3),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("user",e.data.user)}}function Mo(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"label-value",4),d.ac(2,"async"),d.Lb(3,"format-field-value",5,6),d.Pb(),d.Nb()),2&e){const e=t.$implicit,n=d.qc(4),i=d.Zb();d.xb(1),d.gc("hidden",!n.hasValue)("label",e.name)("labelPosition",i.labelOnTop(d.bc(2,6,i.layout.ltsm$),e)?"top":"auto"),d.xb(2),d.gc("object",i.buyVoucher)("fields",i.data.customFields)("fieldName",e.internalName)}}function Ho(e,t){1&e&&d.Lb(0,"hr")}function qo(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Bc(1,Ho,1,0,"hr",0),d.ac(2,"async"),d.Qb(3,"form",7),d.Qb(4,"confirmation-password",8),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().confirmed.emit(t)})),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",d.bc(2,4,e.layout.gtxxs$)),d.xb(2),d.gc("formGroup",e.form),d.xb(1),d.gc("passwordInput",e.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let Uo=(()=>{class e extends S.a{constructor(e){super(e),this.confirmationModeChanged=new d.n,this.confirmed=new d.n}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=()=>({type:i.s.BUY_VOUCHERS,amount:this.buyVoucher.amount,voucherType:this.data.type.id,numberOfVouchers:this.buyVoucher.count}),this.confirmationPasswordInput||this.addShortcut(Nn.k,()=>this.confirmed.emit())}labelOnTop(e,t){return!!e&&[i.p.RICH_TEXT,i.p.TEXT].includes(t?t.type:null)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["buy-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",buyVoucher:"buyVoucher",data:"data"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[d.ub],decls:10,vars:12,consts:[[4,"ngIf"],[3,"label"],[4,"ngFor","ngForOf"],[3,"user"],[3,"hidden","label","labelPosition"],[3,"object","fields","fieldName"],["formatFieldValue",""],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(d.Bc(0,Zo,2,1,"ng-container",0),d.Qb(1,"label-value",1),d.Dc(2),d.Pb(),d.Qb(3,"label-value",1),d.Dc(4),d.Pb(),d.Qb(5,"label-value",1),d.Dc(6),d.ac(7,"currency"),d.Pb(),d.Bc(8,Mo,5,8,"ng-container",2),d.Bc(9,qo,5,6,"ng-container",0)),2&e&&(d.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),d.xb(1),d.gc("label",t.i18n.general.type),d.xb(1),d.Fc(" ",t.data.type.voucherTitle,"\n"),d.xb(1),d.gc("label",t.i18n.voucher.numberOfVouchers),d.xb(1),d.Fc(" ",t.buyVoucher.count,"\n"),d.xb(1),d.gc("label",t.i18n.voucher.amountPerVoucher),d.xb(1),d.Fc(" ",d.cc(7,9,t.buyVoucher.amount,t.data.account.currency),"\n"),d.xb(2),d.gc("ngForOf",t.data.customFields),d.xb(1),d.gc("ngIf",t.confirmationPasswordInput))},directives:[f.t,v.a,f.s,ht.a,Ro.a,x.I,x.w,x.n,En.a,$n.a,x.v,x.l],pipes:[O.a,f.b],encapsulation:2,changeDetection:0}),e})();function Vo(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"buy-vouchers-step-list-types",4),d.Xb("typeSelected",(function(t){return d.sc(e),d.Zb().toForm(t)})),d.Pb(),d.Nb()}if(2&e){const e=d.Zb();d.xb(1),d.gc("user",e.data.user)("types",e.data.types)}}function zo(e,t){if(1&e){const e=d.Rb();d.Qb(0,"action-button",10),d.Xb("action",(function(){return d.sc(e),d.Zb(2).backToSelectType()})),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.previous)}}function jo(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",5),d.ac(1,"async"),d.Lb(2,"buy-vouchers-step-form",6),d.Qb(3,"actions",7),d.Qb(4,"action-button",8),d.Xb("action",(function(){return d.sc(e),d.Zb().toConfirm()})),d.ac(5,"async"),d.Pb(),d.Bc(6,zo,1,1,"action-button",9),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.dataTypeForBuy.type.voucherTitle)("mobileHeading",e.dataTypeForBuy.type.voucherTitle)("mode",d.bc(1,9,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("data",e.dataTypeForBuy)("form",e.form)("customFieldControlsMap",e.customFieldControlsMap),d.xb(2),d.gc("disabled",d.bc(5,11,e.requesting$))("label",e.i18n.general.next),d.xb(2),d.gc("ngIf",!e.singleType)}}function Go(e,t){if(1&e){const e=d.Rb();d.Qb(0,"action-button",8),d.Xb("action",(function(){return d.sc(e),d.Zb(2).buy()})),d.ac(1,"async"),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("disabled",!e.canConfirm||d.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function _o(e,t){1&e&&d.Dc(0,"\xa0")}function Ko(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",5),d.ac(1,"async"),d.Qb(2,"buy-vouchers-step-confirm",11),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().buy(t)})),d.Pb(),d.Qb(3,"actions",7),d.Bc(4,Go,2,4,"action-button",12),d.ac(5,"async"),d.Bc(6,_o,1,0,"ng-template",null,13,d.Cc),d.Qb(8,"action-button",10),d.Xb("action",(function(){return d.sc(e),d.Zb().backToForm()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.qc(7),t=d.Zb();d.gc("heading",t.i18n.voucher.title.buyConfirmation)("mobileHeading",t.i18n.voucher.mobileTitle.buyConfirmation)("mode",d.bc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("buyVoucher",t.form.value)("data",t.dataTypeForBuy)("confirmationPasswordInput",t.dataTypeForBuy.confirmationPasswordInput)("confirmationPassword",t.confirmationPassword),d.xb(2),d.gc("ngIf",d.bc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),d.xb(4),d.gc("label",t.i18n.general.previous)}}function Xo(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}let Yo=(()=>{class e extends ut.a{constructor(e,t){super(e),this.voucherService=t,this.ConfirmationMode=hn.a,this.step$=new u.a(null),this.singleType=!1,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.user=this.authHelper.isSelf(e.user)?this.ApiHelper.SELF:e.user,this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){const t=e.types||[];1===t.length?(this.singleType=!0,this.toForm(t[0])):this.step="select-type"}get currency(){return this.dataTypeForBuy.account.currency}buy(e){if(e&&this.confirmationPassword.setValue(e),this.confirmationPasswordInput&&!Object(s.F)(this.confirmationPassword))return;const t=this.form.value;t.type=this.dataTypeForBuy.type.id,this.addSub(this.voucherService.buyVouchers({user:this.user,confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:t}).subscribe(e=>{this.router.navigate(1===e.length?["banking","vouchers","view",e[0]]:["banking",this.user,"vouchers","bought"]),this.notification.snackBar(this.i18n.voucher.buy.done)}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(e){this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user,type:e.id}).subscribe(e=>{this.dataTypeForBuy=e,this.buildForm(),this.step="form"}))}toConfirm(){Object(s.F)(this.form)&&(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),this.canConfirm?(this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(x.G.required))),this.step="confirm"):this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput)))}get confirmationPasswordInput(){return this.dataTypeForBuy.confirmationPasswordInput}buildForm(){if(this.form)this.form.reset();else if(this.customFieldControlsMap=this.fieldHelper.customValuesFormControlMap(this.dataTypeForBuy.customFields),this.form=this.formBuilder.group({count:new x.j(""),amount:new x.j("")}),this.customFieldControlsMap.size>0){const e=new x.m({});for(const t of this.customFieldControlsMap)e.addControl(t[0],t[1]);this.form.setControl("customValues",e)}this.form.get("count").setValue(1)}resolveMenu(e){return this.menu.userMenu(e.user,l.b.BUY_VOUCHER)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Qo.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["buy-vouchers"]],features:[d.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"user","types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form","customFieldControlsMap"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"buyVoucher","data","confirmationPasswordInput","confirmationPassword","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,Vo,2,2,"ng-container",1),d.Bc(4,jo,7,13,"page-content",2),d.Bc(5,Ko,9,14,"page-content",2),d.Bc(6,Xo,2,0,"page-content",3),d.Pb()),2&e&&(d.gc("ready",d.bc(1,5,t.data$))("ngSwitch",d.bc(2,7,t.step$)),d.xb(3),d.gc("ngSwitchCase","select-type"),d.xb(1),d.gc("ngSwitchCase","form"),d.xb(1),d.gc("ngSwitchCase","confirm"))},directives:[m.a,f.x,f.y,f.z,Oo,g.a,$o,dt.a,mt.a,f.t,Uo,H.a],pipes:[f.b],encapsulation:2,changeDetection:0}),e})();var Wo=n("5pUo"),Jo=n("LqlI"),es=n("pBnU");const ts=["inputField"];function ns(e,t){if(1&e){const e=d.Rb();d.Qb(0,"button",14,15),d.Xb("click",(function(){return d.sc(e),d.Zb(3).showScanQrCode()})),d.Lb(2,"icon",16),d.Pb()}if(2&e){const e=d.Zb(3);d.gc("tooltip",e.i18n.field.user.scanQrCodeTooltip)}}function is(e,t){if(1&e){const e=d.Rb();d.Qb(0,"div"),d.Mb(1,6),d.Qb(2,"div",7),d.Qb(3,"div",8),d.Qb(4,"label-value",9),d.Lb(5,"input-field",10,11),d.Bc(7,ns,3,1,"button",12),d.Pb(),d.Pb(),d.Pb(),d.Qb(8,"actions"),d.Qb(9,"action-button",13),d.Xb("action",(function(){return d.sc(e),d.Zb(2).submit()})),d.ac(10,"async"),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.Zb(2),t=d.qc(6);d.xb(1),d.gc("ngTemplateOutlet",t),d.xb(3),d.gc("label",e.i18n.voucher.token),d.xb(1),d.gc("mask",e.mask)("formControl",e.token)("placeholder",e.mask),d.xb(4),d.gc("disabled",d.bc(10,7,e.requesting$))("label",e.i18n.general.submit)}}function as(e,t){if(1&e&&(d.Qb(0,"page-content",4),d.ac(1,"async"),d.Bc(2,is,11,9,"div",5),d.ac(3,"async"),d.Pb()),2&e){const e=d.Zb(),t=d.qc(8);d.gc("heading",e.i18n.voucher.title.redeem)("mobileHeading",e.i18n.voucher.mobileTitle.redeem)("mode",d.bc(1,5,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("ngIf",d.bc(3,7,e.data$))("ngIfElse",t)}}const cs=function(e){return{"flex-grow-1":e}};function rs(e,t){if(1&e&&(d.Qb(0,"div",27),d.Lb(1,"avatar",28),d.Pb()),2&e){const e=d.Zb(3);d.gc("ngClass",d.jc(2,cs,!e.dataForRedeem.type.voucherDescription)),d.xb(1),d.gc("image",e.dataForRedeem.type.image)}}function os(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",29),d.Dc(2),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(2),d.Fc("",e.dataForRedeem.type.voucherDescription," ")}}function ss(e,t){if(1&e&&(d.Qb(0,"label-value",23),d.Lb(1,"user-link",30),d.Pb()),2&e){const e=d.Zb(3);d.gc("label",e.i18n.voucher.buy.buyer),d.xb(1),d.gc("user",e.dataForRedeem.buyer)}}function ls(e,t){if(1&e&&d.Lb(0,"custom-field-input",31),2&e){const e=t.$implicit,n=d.Zb(3);d.gc("field",e)("formControl",n.form.get(e.internalName))}}const us=function(e){return{"d-flex flex-row-reverse justify-content-between":e}};function bs(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Mb(1,6),d.Qb(2,"notification",17),d.Dc(3),d.Pb(),d.Qb(4,"div",18),d.Qb(5,"div",19),d.ac(6,"async"),d.Bc(7,rs,2,4,"div",20),d.Bc(8,os,3,1,"ng-container",21),d.Pb(),d.Lb(9,"hr",22),d.Qb(10,"label-value",23),d.Dc(11),d.Pb(),d.Qb(12,"label-value",23),d.Dc(13),d.Pb(),d.Bc(14,ss,2,2,"label-value",24),d.Qb(15,"label-value",23),d.Dc(16),d.ac(17,"currency"),d.Pb(),d.Bc(18,ls,1,2,"custom-field-input",25),d.Pb(),d.Qb(19,"actions"),d.Qb(20,"action-button",13),d.Xb("action",(function(){return d.sc(e),d.Zb(2).submit()})),d.ac(21,"async"),d.Pb(),d.Qb(22,"action-button",26),d.Xb("action",(function(){return d.sc(e),d.Zb(2).backToForm()})),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=d.Zb(2),t=d.qc(6);d.xb(1),d.gc("ngTemplateOutlet",t),d.xb(2),d.Fc(" ",e.i18n.voucher.redeem.confirm," "),d.xb(2),d.gc("ngClass",d.jc(23,us,d.bc(6,16,e.layout.gtsm$)&&e.dataForRedeem.type.image)),d.xb(2),d.gc("ngIf",e.dataForRedeem.type.image),d.xb(1),d.gc("ngIf",e.dataForRedeem.type.voucherDescription),d.xb(2),d.gc("label",e.i18n.general.type),d.xb(1),d.Fc(" ",e.dataForRedeem.type.name," "),d.xb(1),d.gc("label",e.i18n.voucher.token),d.xb(1),d.Fc(" ",e.dataForRedeem.token," "),d.xb(1),d.gc("ngIf",e.dataForRedeem.buyer),d.xb(1),d.gc("label",e.i18n.transaction.amount),d.xb(1),d.Fc(" ",d.cc(17,18,e.dataForRedeem.amount,e.dataForRedeem.type.configuration.currency)," "),d.xb(2),d.gc("ngForOf",e.dataForRedeem.customFields),d.xb(2),d.gc("disabled",d.bc(21,21,e.requesting$))("label",e.i18n.general.submit),d.xb(2),d.gc("label",e.i18n.general.previous)}}function ds(e,t){if(1&e&&(d.Qb(0,"page-content",4),d.ac(1,"async"),d.Bc(2,bs,23,25,"ng-container",5),d.ac(3,"async"),d.Pb()),2&e){const e=d.Zb(),t=d.qc(8);d.gc("heading",e.i18n.voucher.title.redeem)("mobileHeading",e.i18n.voucher.mobileTitle.redeem)("mode",d.bc(1,5,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("ngIf",d.bc(3,7,e.dataForRedeem$))("ngIfElse",t)}}function ms(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"user-info",30),d.Lb(2,"hr"),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("user",e.data.user)}}function fs(e,t){if(1&e&&d.Bc(0,ms,3,1,"ng-container",21),2&e){const e=d.Zb();d.gc("ngIf",!e.self)}}function gs(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}let ps=(()=>{class e extends ut.a{constructor(e,t,n){super(e),this.voucherService=t,this.modal=n,this.step$=new u.a(null),this.token=new x.j("",x.G.required),this.mask="",this.dataForRedeem$=new u.a(null)}get dataForRedeem(){return this.dataForRedeem$.value}set dataForRedeem(e){this.dataForRedeem$.next(e)}get step(){return this.step$.value}set step(e){this.step$.next(e)}submit(){if("form"===this.step){if(!Object(s.F)(this.token))return;this.addSub(this.voucherService.getVoucherDataForRedeem({user:this.userId,token:this.token.value}).subscribe(e=>{this.dataForRedeem=e,this.form=this.fieldHelper.customValuesFormGroup(this.dataForRedeem.customFields),this.step="confirm"}))}else this.addSub(this.voucherService.redeemVoucher({user:this.userId,token:this.token.value,body:{customValues:this.form.value}}).subscribe(e=>{this.router.navigate(["banking","vouchers","view",e.voucherId]),this.notification.info(this.i18n.voucher.redeem.done)}))}backToForm(){this.step="form"}ngOnInit(){super.ngOnInit(),this.userId=this.route.snapshot.paramMap.get("user"),this.addSub(this.voucherService.getVoucherInitialDataForRedeem({user:this.userId}).subscribe(e=>{this.data=e,this.mask=this.data.mask?this.data.mask:"",this.self=this.authHelper.isSelf(e.user)})),this.step="form"}reload(){this.step="form",super.reload()}resolveMenu(e){return this.menu.userMenu(e.user,l.b.REDEEM_VOUCHER)}showScanQrCode(){this.modal.show(Wo.a,{class:"modal-form"}).content.select.pipe(Object(xn.a)()).subscribe(e=>{this.token.setValue(e),this.submit()}),this.modal.onHide.pipe(Object(xn.a)()).subscribe(()=>Object(s.j)(this.inputField,!0))}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Qo.a),d.Kb(Jo.b))},e.\u0275cmp=d.Eb({type:e,selectors:[["app-redeem-voucher"]],viewQuery:function(e,t){var n;1&e&&d.Hc(ts,!0),2&e&&d.pc(n=d.Yb())&&(t.inputField=n.first)},features:[d.ub],decls:9,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["active_user",""],["loading",""],[3,"heading","mobileHeading","mode"],[4,"ngIf","ngIfElse"],[3,"ngTemplateOutlet"],[1,"d-flex","flex-grow-1"],[1,"flex-grow-1"],["kind","field",3,"label"],["type","text","focused","","required","",3,"mask","formControl","placeholder"],["inputField",""],["class","btn btn-icon",3,"tooltip","click",4,"extraCell"],[3,"disabled","label","action"],[1,"btn","btn-icon",3,"tooltip","click"],["scanQrCodeButton",""],["icon","scan_qr_code"],["ngClass","mb-3","type","warning"],[1,"d-flex","flex-grow-1","flex-column"],[3,"ngClass"],["class","image d-flex justify-content-center mt-2 mb-4",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"mt-3"],[3,"label"],[3,"label",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],["outline","",3,"label","action"],[1,"image","d-flex","justify-content-center","mt-2","mb-4",3,"ngClass"],["size","160","imageSize","200","useLightbox","",3,"image"],[1,"break-nl"],[3,"user"],[3,"field","formControl"]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,as,4,9,"page-content",1),d.Bc(4,ds,4,9,"page-content",1),d.Pb(),d.Bc(5,fs,1,1,"ng-template",null,2,d.Cc),d.Bc(7,gs,2,0,"ng-template",null,3,d.Cc)),2&e&&(d.gc("ready",d.bc(1,4,t.data$))("ngSwitch",d.bc(2,6,t.step$)),d.xb(3),d.gc("ngSwitchCase","form"),d.xb(1),d.gc("ngSwitchCase","confirm"))},directives:[m.a,f.x,f.y,g.a,f.t,f.A,v.a,I.a,$n.a,x.D,T.a,x.v,x.k,es.a,dt.a,mt.a,kn.b,fi.a,Bn.a,f.q,f.s,U.a,P.a,Qi.a,ht.a,H.a],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})();function hs(e,t){1&e&&d.Mb(0)}function ys(e,t){1&e&&d.Lb(0,"div",7)}function xs(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",7),d.Qb(2,"label-value",14),d.Lb(3,"user-link",15),d.Pb(),d.Pb(),d.Bc(4,ys,1,0,"div",16),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("ngIf",e.layout.gtsm$)}}function vs(e,t){if(1&e&&d.Lb(0,"field-option",17),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ps(e,t){if(1&e&&(d.Qb(0,"mobile-result",18),d.Qb(1,"div",19),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit;d.gc("date",e.creationDate)("amount",e.amount)("amountColor",!1)("currency",e.type.configuration.currency),d.xb(2),d.Fc(" ",e.type.name," ")}}function Ds(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",23),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.path(n))})),d.Qb(2,"td"),d.Qb(3,"a",24),d.Dc(4),d.ac(5,"date"),d.Pb(),d.Pb(),d.Qb(6,"td"),d.Qb(7,"a",24),d.Dc(8),d.ac(9,"date"),d.Pb(),d.Pb(),d.Qb(10,"td"),d.Qb(11,"a",24),d.Dc(12),d.Pb(),d.Pb(),d.Qb(13,"td"),d.Qb(14,"a",24),d.Dc(15),d.Pb(),d.Pb(),d.Qb(16,"td",21),d.Qb(17,"a",24),d.Dc(18),d.ac(19,"currency"),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.Ec(d.bc(5,10,e.creationDate)),d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.Ec(d.bc(9,12,e.expirationDate)),d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.Ec(n.voucherStatus(e.status)),d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.Ec(e.type.name),d.xb(2),d.gc("routerLink",n.path(e)),d.xb(1),d.Ec(d.cc(19,14,e.amount,e.type.configuration.currency))}}function Ls(e,t){if(1&e&&(d.Qb(0,"table",20),d.Qb(1,"tbody"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Qb(10,"th",21),d.Dc(11),d.Pb(),d.Bc(12,Ds,20,17,"ng-container",22),d.ac(13,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.general.creationDate),d.xb(2),d.Ec(e.i18n.general.expirationDate),d.xb(2),d.Ec(e.i18n.general.status),d.xb(2),d.Ec(e.i18n.general.type),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(1),d.gc("ngForOf",null==(n=d.bc(13,6,e.results$))?null:n.results)}}function ws(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.Qb(1,"form",4),d.Qb(2,"div",5),d.Bc(3,xs,5,3,"ng-container",6),d.Qb(4,"div",7),d.Qb(5,"multi-selection-field",8),d.Bc(6,vs,1,4,"field-option",9),d.Pb(),d.Pb(),d.Qb(7,"div",7),d.Lb(8,"multi-selection-field",10),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(9,"results-layout",11),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(10,"async"),d.Bc(11,Ps,3,5,"mobile-result",12),d.Bc(12,Ls,14,8,"table",13),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.voucher.title.searchBought)("mobileHeading",e.i18n.voucher.mobileTitle.bought),d.xb(1),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",e.data.user&&!e.self),d.xb(2),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.type),d.xb(1),d.gc("ngForOf",e.data.types),d.xb(2),d.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.status)("fieldOptions",e.statusOptions),d.xb(1),d.gc("results",d.bc(10,13,e.results$))("rendering$",e.rendering$)("toLink",e.toLink)}}let Cs=(()=>{class e extends o.a{constructor(e,t){super(e),this.vouchersService=t}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.self=this.authHelper.isSelf(e.user),this.user=this.self?this.ApiHelper.SELF:e.user,this.addSub(this.vouchersService.getUserVouchersDataForSearch({user:this.user,relation:i.Sb.BOUGHT}).subscribe(e=>{this.form.patchValue(e.query),this.data=e}))}get statusOptions(){return Object.values(i.Tb).map(e=>({value:e,text:this.voucherStatus(e)}))}getFormControlNames(){return["types","statuses"]}toSearchParams(e){const t=Object(bt.a)(e);return t.user=this.user,t}doSearch(e){return this.vouchersService.searchUserVouchers$Response(e)}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/view/",e.id]}voucherStatus(e){switch(e){case i.Tb.CANCELED:return this.i18n.voucher.status.canceled;case i.Tb.EXPIRED:return this.i18n.voucher.status.expired;case i.Tb.OPEN:return this.i18n.voucher.status.open;case i.Tb.PENDING:return this.i18n.voucher.status.pending;case i.Tb.REDEEMED:return this.i18n.voucher.status.redeemed}}resolveMenu(e){return this.menu.userMenu(e.user,l.b.SEARCH_BOUGHT_VOUCHERS)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Qo.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-bought-vouchers"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","types",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[3,"value","internalName","id","text"],[3,"date","amount","amountColor","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,hs,1,0,"ng-container",1),d.Pb(),d.Bc(3,ws,13,15,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,w.a,x.v,x.l,f.s,p.a,h.a,y.a,v.a,P.a,L.a,q.a,V.h],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();function Qs(e,t){1&e&&d.Mb(0)}function Is(e,t){1&e&&d.Lb(0,"div",9)}function Fs(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",9),d.Qb(2,"label-value",15),d.Lb(3,"user-link",16),d.Pb(),d.Pb(),d.Bc(4,Is,1,0,"div",7),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.data.user),d.xb(1),d.gc("ngIf",e.layout.gtsm$)}}function Ts(e,t){if(1&e&&d.Lb(0,"field-option",19),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ss(e,t){if(1&e&&(d.Qb(0,"div",9),d.Qb(1,"multi-selection-field",17),d.Bc(2,Ts,1,4,"field-option",18),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.general.type),d.xb(1),d.gc("ngForOf",e.data.types)}}function Os(e,t){if(1&e&&d.Lb(0,"field-option",22),2&e){const e=t.$implicit;d.gc("value",e.id)("id",e.id)("text",e.display)}}function Ns(e,t){if(1&e&&(d.Qb(0,"div",9),d.Qb(1,"single-selection-field",20),d.Bc(2,Os,1,3,"field-option",21),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.general.operator),d.xb(1),d.gc("ngForOf",e.data.operators)}}function ks(e,t){if(1&e&&(d.Qb(0,"mobile-result",23),d.Qb(1,"div",24),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit;d.gc("date",e.redeemDate)("amount",e.amount)("currency",e.type.configuration.currency)("amountColor",!1),d.xb(2),d.Fc(" ",e.type.name," ")}}function Bs(e,t){if(1&e&&(d.Qb(0,"th"),d.Dc(1),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.Ec(e.i18n.general.operator)}}function As(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.Nb()),2&e){const e=d.Zb(2).$implicit;d.xb(1),d.Fc(" ",null!=e.redeemBy&&e.redeemBy.user?e.redeemBy.display:""," ")}}function Es(e,t){if(1&e&&(d.Qb(0,"td"),d.Bc(1,As,2,1,"ng-container",6),d.Pb()),2&e){const e=d.Zb().$implicit;d.xb(1),d.gc("ngIf",e.redeemBy)}}function $s(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",28),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.path(n))})),d.Qb(2,"td"),d.Qb(3,"a",29),d.Dc(4),d.ac(5,"date"),d.Pb(),d.Pb(),d.Bc(6,Es,2,1,"td",6),d.Qb(7,"td"),d.Dc(8),d.Pb(),d.Qb(9,"td",26),d.Dc(10),d.ac(11,"currency"),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.gc("routerLink",n.path(e)),d.xb(1),d.Fc(" ",d.bc(5,5,e.redeemDate)," "),d.xb(2),d.gc("ngIf",n.data.operators.length>0),d.xb(2),d.Fc(" ",e.type.name," "),d.xb(2),d.Fc(" ",d.cc(11,7,e.amount,e.type.configuration.currency)," ")}}function Rs(e,t){if(1&e&&(d.Qb(0,"table",25),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Bc(4,Bs,2,1,"th",6),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Qb(7,"th",26),d.Dc(8),d.Pb(),d.Pb(),d.Qb(9,"tbody"),d.Bc(10,$s,12,10,"ng-container",27),d.ac(11,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.voucher.redeem.date),d.xb(1),d.gc("ngIf",e.data.operators.length>0),d.xb(2),d.Ec(e.i18n.general.type),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(11,5,e.results$))?null:n.results)}}function Zs(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.Qb(1,"form",4),d.Qb(2,"div",5),d.Bc(3,Fs,5,3,"ng-container",6),d.Bc(4,Ss,3,2,"div",7),d.Bc(5,Ns,3,3,"div",7),d.Qb(6,"div",8),d.Qb(7,"div",9),d.Lb(8,"date-field",10),d.Pb(),d.Qb(9,"div",9),d.Lb(10,"date-field",11),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(11,"results-layout",12),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(12,"async"),d.Bc(13,ks,3,5,"mobile-result",13),d.Bc(14,Rs,12,7,"table",14),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.voucher.title.redeemed)("mobileHeading",e.i18n.voucher.mobileTitle.redeemed),d.xb(1),d.gc("formGroup",e.form),d.xb(2),d.gc("ngIf",e.data.user&&!e.self),d.xb(1),d.gc("ngIf",(null==e.data.types?null:e.data.types.length)>1),d.xb(1),d.gc("ngIf",(null==e.data.operators?null:e.data.operators.length)>0),d.xb(3),d.gc("label",e.i18n.general.beginDate),d.xb(2),d.gc("label",e.i18n.general.endDate),d.xb(1),d.gc("results",d.bc(12,11,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let Ms=(()=>{class e extends o.a{constructor(e,t){super(e),this.voucherService=t}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("user");this.addSub(this.voucherService.getUserVouchersDataForSearch({user:e,relation:i.Sb.REDEEMED}).subscribe(e=>{this.data=e,this.self=this.authHelper.isSelf(e.user)}))}getFormControlNames(){return["types","periodBegin","periodEnd","operator"]}toSearchParams(e){const t=e;return t.user=this.route.snapshot.paramMap.get("user"),t.relation=i.Sb.REDEEMED,t.redeemBy=e.operator,(e.periodBegin||e.periodEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.periodBegin,e.periodEnd)),t}doSearch(e){return this.voucherService.searchUserVouchers$Response(e)}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/view/",e.id]}resolveMenu(e){return this.menu.userMenu(e.user,l.b.SEARCH_REDEEMED)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Qo.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["app-search-redeemed-vouchers"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[4,"ngIf"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","periodBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency","amountColor",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","operator",3,"emptyOption","label"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],[3,"date","amount","currency","amountColor"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Qs,1,0,"ng-container",1),d.Pb(),d.Bc(3,Zs,15,13,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,C.a,x.v,x.l,p.a,h.a,y.a,v.a,P.a,w.a,f.s,L.a,D.a,q.a,V.h],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();function Hs(e,t){if(1&e&&d.Lb(0,"field-option",15),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function qs(e,t){if(1&e&&(d.Qb(0,"div",4),d.Qb(1,"multi-selection-field",13),d.Bc(2,Hs,1,4,"field-option",14),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.xb(1),d.gc("label",e.i18n.general.type),d.xb(1),d.gc("ngForOf",e.data.types)}}function Us(e,t){if(1&e&&d.Lb(0,"field-option",31),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function Vs(e,t){if(1&e&&(d.Qb(0,"div",4),d.Qb(1,"multi-selection-field",29),d.Bc(2,Us,1,5,"field-option",30),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.voucher.buyerGroups),d.xb(1),d.gc("ngForOf",e.data.userGroups)}}function zs(e,t){if(1&e&&d.Lb(0,"field-option",31),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function js(e,t){if(1&e&&(d.Qb(0,"div",4),d.Qb(1,"multi-selection-field",32),d.Bc(2,zs,1,5,"field-option",30),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("label",e.i18n.voucher.redeemerGroups),d.xb(1),d.gc("ngForOf",e.data.userGroups)}}function Gs(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"div",16),d.Qb(2,"div",4),d.Lb(3,"date-field",17),d.Pb(),d.Qb(4,"div",4),d.Lb(5,"date-field",18),d.Pb(),d.Pb(),d.Qb(6,"div",16),d.Qb(7,"div",4),d.Lb(8,"date-field",19),d.Pb(),d.Qb(9,"div",4),d.Lb(10,"date-field",20),d.Pb(),d.Pb(),d.Qb(11,"div",16),d.Qb(12,"div",4),d.Lb(13,"date-field",21),d.Pb(),d.Qb(14,"div",4),d.Lb(15,"date-field",22),d.Pb(),d.Pb(),d.Qb(16,"div",16),d.Qb(17,"div",4),d.Lb(18,"decimal-field",23,24),d.Pb(),d.Qb(20,"div",4),d.Lb(21,"decimal-field",25,24),d.Pb(),d.Pb(),d.Bc(23,Vs,3,2,"div",3),d.Qb(24,"div",4),d.Qb(25,"label-value",26),d.Lb(26,"user-field",27),d.Pb(),d.Pb(),d.Bc(27,js,3,2,"div",3),d.Qb(28,"div",4),d.Qb(29,"label-value",26),d.Lb(30,"user-field",28),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(3),d.gc("label",e.i18n.general.creationDate),d.xb(2),d.gc("label",e.i18n.general.to),d.xb(3),d.gc("label",e.i18n.general.expirationDate),d.xb(2),d.gc("label",e.i18n.general.to),d.xb(3),d.gc("label",e.i18n.voucher.redeem.date),d.xb(2),d.gc("label",e.i18n.general.to),d.xb(3),d.gc("label",e.i18n.transaction.amount)("scale",e.maxScale),d.xb(3),d.gc("label",e.i18n.general.to)("scale",e.maxScale),d.xb(2),d.gc("ngIf",(null==e.data.userGroups?null:e.data.userGroups.length)>1),d.xb(2),d.gc("label",e.i18n.voucher.buy.buyer),d.xb(1),d.gc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1),d.xb(1),d.gc("ngIf",(null==e.data.userGroups?null:e.data.userGroups.length)>1),d.xb(2),d.gc("label",e.i18n.voucher.redeem.redeemer),d.xb(1),d.gc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1)}}function _s(e,t){if(1&e&&d.Lb(0,"field-option",9),2&e){const e=t.$implicit,n=d.Zb();d.gc("value",e)("text",n.orderBy(e))}}let Ks=(()=>{class e extends S.a{constructor(e){super(e)}ngOnInit(){super.ngOnInit(),this.mask=this.data.mask?this.data.mask:"",this.form.patchValue({creationType:null,printed:null})}get statusOptions(){return Object.values(i.Tb).map(e=>({value:e,text:this.apiI18n.voucherStatus(e)}))}get creationTypeOptions(){const e=Object.values(i.Qb);return[].concat(e.map(e=>({value:e,text:this.apiI18n.voucherCreationType(e)})))}get maxScale(){return this.data.types.map(e=>e.configuration.currency.decimalDigits).reduce((e,t,n,i)=>e>t?e:t)}orderByOptions(){return Object.values(i.Rb)}orderBy(e){switch(e){case i.Rb.CREATION_DATE_ASC:return this.i18n.voucher.sort.creationDateAsc;case i.Rb.CREATION_DATE_DESC:return this.i18n.voucher.sort.creationDateDesc;case i.Rb.EXPIRATION_DATE_ASC:return this.i18n.voucher.sort.expirationDateAsc;case i.Rb.EXPIRATION_DATE_DESC:return this.i18n.voucher.sort.expirationDateDesc;case i.Rb.REDEEM_DATE_ASC:return this.i18n.voucher.sort.redeemDateAsc;case i.Rb.REDEEM_DATE_DESC:return this.i18n.voucher.sort.redeemDateDesc}}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["voucher-filters"]],inputs:{data:"data",heading:"heading",mobileHeading:"mobileHeading",form:"form",moreFilters:"moreFilters",headingActions:"headingActions"},features:[d.ub],decls:18,vars:23,consts:[["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions","emptyLabel"],["type","text","formControlName","token",3,"label","mask","placeholder"],["labelPosition","side","formControlName","creationType",3,"label","fieldOptions","emptyOption"],["labelPosition","side","formControlName","printed",3,"label","emptyOption"],[3,"value","text"],[4,"ngIf"],["labelPosition","side","formControlName","orderBy",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","creationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","creationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expirationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","expirationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","redeemBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","redeemEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","amountMin",3,"label","scale"],["amount",""],["formControlName","amountMax",3,"label","scale"],["kind","field",3,"label"],["formControlName","buyer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["formControlName","redeemer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","buyerGroups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","redeemerGroups",3,"label"]],template:function(e,t){1&e&&(d.Qb(0,"page-content",0),d.Qb(1,"form",1),d.Qb(2,"div",2),d.Bc(3,qs,3,2,"div",3),d.Qb(4,"div",4),d.Lb(5,"multi-selection-field",5),d.Pb(),d.Qb(6,"div",4),d.Lb(7,"input-field",6),d.Pb(),d.Qb(8,"div",4),d.Lb(9,"single-selection-field",7),d.Pb(),d.Qb(10,"div",4),d.Qb(11,"single-selection-field",8),d.Lb(12,"field-option",9),d.Lb(13,"field-option",9),d.Pb(),d.Pb(),d.Bc(14,Gs,31,22,"ng-container",10),d.Qb(15,"div",4),d.Qb(16,"single-selection-field",11),d.Bc(17,_s,1,2,"field-option",12),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.gc("heading",t.heading)("mobileHeading",t.mobileHeading)("headingActions",t.headingActions),d.xb(1),d.gc("formGroup",t.form),d.xb(2),d.gc("ngIf",(null==t.data.types?null:t.data.types.length)>1),d.xb(2),d.gc("label",t.i18n.general.status)("fieldOptions",t.statusOptions)("emptyLabel",t.i18n.general.notApplied),d.xb(2),d.gc("label",t.i18n.voucher.token)("mask",t.mask)("placeholder",t.mask),d.xb(2),d.gc("label",t.i18n.voucher.creationType)("fieldOptions",t.creationTypeOptions)("emptyOption",t.i18n.general.all),d.xb(2),d.gc("label",t.i18n.general.printed)("emptyOption",t.i18n.general.all),d.xb(1),d.gc("value","true")("text",t.i18n.general.yes),d.xb(1),d.gc("value","false")("text",t.i18n.general.no),d.xb(1),d.gc("ngIf",t.moreFilters),d.xb(2),d.gc("label",t.i18n.general.orderBy),d.xb(1),d.gc("ngForOf",t.orderByOptions()))},directives:[g.a,x.I,x.w,x.n,f.t,w.a,x.v,x.l,I.a,T.a,D.a,L.a,f.s,C.a,Q.a,v.a,F.a],encapsulation:2,changeDetection:0}),e})();function Xs(e,t){1&e&&d.Mb(0)}function Ys(e,t){if(1&e&&(d.Qb(0,"mobile-result"),d.Qb(1,"div"),d.Qb(2,"div",7),d.Qb(3,"div",8),d.Dc(4),d.Pb(),d.Qb(5,"div",8),d.Dc(6),d.Pb(),d.Pb(),d.Qb(7,"div",9),d.Dc(8),d.ac(9,"currency"),d.Pb(),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.xb(4),d.Fc(" ",e.type.name," "),d.xb(2),d.Fc(" ",n.apiI18n.voucherStatus(e.status)," "),d.xb(2),d.Fc(" ",d.cc(9,3,e.amount,e.type.configuration.currency)," ")}}function Ws(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",13),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.path(n))})),d.Qb(2,"td"),d.Dc(3),d.ac(4,"date"),d.Pb(),d.Qb(5,"td"),d.Dc(6),d.ac(7,"date"),d.Pb(),d.Qb(8,"td"),d.Dc(9),d.Pb(),d.Qb(10,"td"),d.Dc(11),d.Pb(),d.Qb(12,"td",11),d.Dc(13),d.ac(14,"currency"),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.Ec(d.bc(4,5,e.creationDate)),d.xb(3),d.Fc(" ",d.bc(7,7,e.expirationDate),""),d.xb(3),d.Fc(" ",n.apiI18n.voucherStatus(e.status)," "),d.xb(2),d.Fc(" ",e.type.name," "),d.xb(2),d.Fc(" ",d.cc(14,9,e.amount,e.type.configuration.currency)," ")}}function Js(e,t){if(1&e&&(d.Qb(0,"table",10),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Qb(10,"th",11),d.Dc(11),d.Pb(),d.Pb(),d.Qb(12,"tbody"),d.Bc(13,Ws,15,12,"ng-container",12),d.ac(14,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.general.creationDate),d.xb(2),d.Ec(e.i18n.general.expirationDate),d.xb(2),d.Ec(e.i18n.general.status),d.xb(2),d.Ec(e.i18n.general.type),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(14,6,e.results$))?null:n.results)}}function el(e,t){if(1&e){const e=d.Rb();d.Lb(0,"voucher-filters",3),d.ac(1,"async"),d.ac(2,"async"),d.Qb(3,"results-layout",4),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(4,"async"),d.Bc(5,Ys,10,6,"mobile-result",5),d.Bc(6,Js,15,8,"table",6),d.Pb()}if(2&e){const e=d.Zb();d.gc("data",e.data)("form",e.form)("heading",e.i18n.voucher.title.search)("mobileHeading",e.i18n.voucher.mobileTitle.search)("moreFilters",d.bc(1,9,e.moreFilters$))("headingActions",d.bc(2,11,e.headingActions$)),d.xb(3),d.gc("results",d.bc(4,13,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let tl=(()=>{class e extends o.a{constructor(e,t){super(e),this.voucherService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.voucherService.getVouchersDataForSearch({}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=[this.moreFiltersAction],this.form.patchValue(e.query)}getFormControlNames(){return["types","creationBegin","creationEnd","statuses","token","creationType","printed","amountMin","amountMax","expirationBegin","expirationEnd","redeemBegin","redeemEnd","buyer","redeemer","buyerGroups","redeemerGroups","orderBy"]}toSearchParams(e){const t=e;return(e.redeemBegin||e.redeemEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.redeemBegin,e.redeemEnd)),(e.creationBegin||e.creationEnd)&&(t.creationPeriod=this.ApiHelper.dateRangeFilter(e.creationBegin,e.creationEnd)),(e.expirationBegin||e.expirationEnd)&&(t.expirationPeriod=this.ApiHelper.dateRangeFilter(e.expirationBegin,e.expirationEnd)),(e.amountMin||e.amountMax)&&(t.amountRange=this.ApiHelper.rangeFilter(e.amountMin,e.amountMax)),t}doSearch(e){return this.voucherService.searchVouchers$Response(e)}get statusOptions(){return Object.values(i.Tb).map(e=>({value:e,text:this.apiI18n.voucherStatus(e)}))}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/view/",e.id]}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(e){return l.b.SEARCH_VOUCHERS}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Qo.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-vouchers"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"data","form","heading","mobileHeading","moreFilters","headingActions"],["resultType","list",3,"results","toLink","rendering$","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"cell-main","float-left"],[1,"cell-text"],[1,"float-right"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Xs,1,0,"ng-container",1),d.Pb(),d.Bc(3,el,7,15,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,Ks,p.a,h.a,y.a,q.a,f.s],pipes:[f.b,O.a,z.a],encapsulation:2,changeDetection:0}),e})();var nl=n("cyUc");function il(e,t){if(1&e&&(d.Qb(0,"div",14),d.Lb(1,"avatar",15),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("image",e.data.type.image)}}function al(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.creationType),d.xb(1),d.Fc(" ",e.apiI18n.voucherCreationType(e.data.creationType)," ")}}function cl(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Lb(1,"user-link",16),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.owner),d.xb(1),d.gc("user",e.data.owner)}}function rl(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Lb(1,"user-link",16),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.buy.buyer),d.xb(1),d.gc("user",e.data.buyer)}}function ol(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Qb(1,"a",17),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.buy.payment),d.xb(1),d.gc("routerLink",e.transferPath(e.data.buy)),d.xb(1),d.Fc(" ",e.bankingHelper.transactionNumberOrId(e.data.buy)," ")}}function sl(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"dateTime"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.redeem.date),d.xb(1),d.Fc(" ",d.bc(2,2,e.data.redeemDate)," ")}}function ll(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Lb(1,"user-link",16),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.redeem.redeemer),d.xb(1),d.gc("user",e.data.redeemer)}}function ul(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Lb(1,"user-link",16),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.operator),d.xb(1),d.gc("user",e.data.redeemBy)}}function bl(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Qb(1,"a",17),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.redeem.payment),d.xb(1),d.gc("routerLink",e.transferPath(e.data.redeem)),d.xb(1),d.Fc(" ",e.bankingHelper.transactionNumberOrId(e.data.redeem)," ")}}function dl(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.status),d.xb(1),d.Fc(" ",e.data.redeemAfterDate," ")}}function ml(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"dateTime"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.expirationDate),d.xb(1),d.Fc(" ",d.bc(2,2,e.data.expirationDate)," ")}}function fl(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Dc(1),d.ac(2,"dateTime"),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.refundDate),d.xb(1),d.Fc(" ",d.bc(2,2,e.data.refund.date)," ")}}function gl(e,t){if(1&e&&(d.Qb(0,"label-value",8),d.Qb(1,"a",17),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",e.i18n.voucher.refundPayment),d.xb(1),d.gc("routerLink",e.transferPath(e.data.refund)),d.xb(1),d.Fc(" ",e.bankingHelper.transactionNumberOrId(e.data.refund)," ")}}function pl(e,t){if(1&e&&(d.Ob(0,18),d.Qb(1,"h2",11),d.Dc(2),d.Pb(),d.Qb(3,"div",19),d.Dc(4),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(2),d.Fc(" ",e.i18n.general.description," "),d.xb(2),d.Fc(" ",e.data.description," ")}}function hl(e,t){1&e&&(d.Lb(0,"img",20),d.ac(1,"trust")),2&e&&d.gc("src",d.cc(1,1,t.ngIf,"url"),d.uc)}function yl(e,t){if(1&e&&(d.Qb(0,"page-content",3),d.ac(1,"async"),d.Qb(2,"div",4),d.Qb(3,"div",5),d.Bc(4,il,2,1,"div",6),d.Qb(5,"div",7),d.Qb(6,"label-value",8),d.Dc(7),d.Pb(),d.Qb(8,"label-value",8),d.Dc(9),d.Pb(),d.Qb(10,"label-value",8),d.Dc(11),d.ac(12,"currency"),d.Pb(),d.Bc(13,al,2,2,"label-value",9),d.Qb(14,"label-value",8),d.Dc(15),d.ac(16,"dateTime"),d.Pb(),d.Bc(17,cl,2,2,"label-value",9),d.Bc(18,rl,2,2,"label-value",9),d.Bc(19,ol,3,3,"label-value",9),d.Qb(20,"label-value",8),d.Dc(21),d.Pb(),d.Bc(22,sl,3,4,"label-value",9),d.Bc(23,ll,2,2,"label-value",9),d.Bc(24,ul,2,2,"label-value",9),d.Bc(25,bl,3,3,"label-value",9),d.Bc(26,dl,2,2,"label-value",9),d.Bc(27,ml,3,4,"label-value",9),d.Bc(28,fl,3,4,"label-value",9),d.Bc(29,gl,3,3,"label-value",9),d.Pb(),d.Pb(),d.Bc(30,pl,5,2,"ng-container",10),d.Lb(31,"hr",11),d.Qb(32,"div",12),d.Bc(33,hl,2,4,"img",13),d.ac(34,"async"),d.Pb(),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.gc("heading",e.data.title)("mobileHeading",e.data.title)("headingActions",d.bc(1,28,e.headingActions$)),d.xb(4),d.gc("ngIf",e.data.type.image),d.xb(2),d.gc("label",e.i18n.general.type),d.xb(1),d.Fc(" ",e.data.type.name," "),d.xb(1),d.gc("label",e.i18n.voucher.token),d.xb(1),d.Fc(" ",e.data.token," "),d.xb(1),d.gc("label",e.i18n.transaction.amount),d.xb(1),d.Fc(" ",d.cc(12,30,e.data.amount,e.data.type.configuration.currency)," "),d.xb(2),d.gc("ngIf",e.data.creationType),d.xb(1),d.gc("label",e.i18n.general.creationDate),d.xb(1),d.Fc(" ",d.bc(16,33,e.data.creationDate)," "),d.xb(2),d.gc("ngIf",e.data.owner),d.xb(1),d.gc("ngIf",e.data.buyer),d.xb(1),d.gc("ngIf",e.data.buy),d.xb(1),d.gc("label",e.i18n.general.status),d.xb(1),d.Fc(" ",e.apiI18n.voucherStatus(e.data.status)," "),d.xb(1),d.gc("ngIf",e.data.redeemDate),d.xb(1),d.gc("ngIf",e.data.redeemer),d.xb(1),d.gc("ngIf",null==e.data.redeemBy?null:e.data.redeemBy.user),d.xb(1),d.gc("ngIf",e.data.redeem),d.xb(1),d.gc("ngIf",!e.data.redeemAfterDateReached),d.xb(1),d.gc("ngIf",e.data.expirationDate),d.xb(1),d.gc("ngIf",e.data.refund),d.xb(1),d.gc("ngIf",e.data.refund),d.xb(1),d.gc("ngIf",e.data.description),d.xb(3),d.gc("ngIf",d.bc(34,35,e.qrCodeUrl$))}}function xl(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}let vl=(()=>{class e extends kc.a{constructor(e,t,n){super(e),this.voucherService=t,this.bankingHelper=n,this.qrCodeUrl$=new u.a(null)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("key");this.addSub(this.voucherService.viewVoucher({key:e}).subscribe(e=>this.data=e))}onDataInitialized(e){this.addSub(this.voucherService.getVoucherQrCode({key:e.id,size:i.D.MEDIUM}).subscribe(e=>this.qrCodeUrl$.next(URL.createObjectURL(e)))),this.createCancelDeviceConfirmation=()=>({type:i.s.MANAGE_VOUCHER,voucher:e.id,voucherAction:i.Ob.CANCEL}),this.createChangeExpirationDeviceConfirmation=()=>({type:i.s.MANAGE_VOUCHER,voucher:e.id,voucherAction:i.Ob.CHANGE_EXPIRATION}),this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),e.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("confirmationPassword",x.G.required)),this.headingActions=this.initActions(e)}initActions(e){const t=this.exportHelper.headingActions(e.exportFormats,t=>this.voucherService.exportVoucher$Response({format:t.internalName,key:e.id}));return e.cancelAction&&t.push(new At.c("cancel",e.cancelAction===i.Pb.CANCEL_AND_REFUND?this.i18n.voucher.cancelAndRefund:this.i18n.general.cancel,()=>{this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.notification.confirm({title:this.cancelConfirmationTitle(e.cancelAction),passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.createCancelDeviceConfirmation,callback:e=>this.cancel(e.confirmationPassword)})})),e.canChangeExpirationDate&&t.push(new At.c("update",this.i18n.voucher.changeExpirationDate,()=>{this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.notification.confirm({passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.createChangeExpirationDeviceConfirmation,customFields:this.changeExpirationFields,callback:t=>{this.addSub(this.voucherService.changeVoucherExpirationDate({key:e.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments,newExpirationDate:t.customValues.newExpirationDate}}).subscribe(()=>{this.notification.snackBar(this.i18n.voucher.expirationDateChanged),this.reload()}))}})})),t}cancel(e){!e&&this.confirmationPassword&&(e=this.confirmationPassword.value),Object(s.F)(this.confirmationPassword)&&this.addSub(this.voucherService.cancelVoucher({key:this.data.id,confirmationPassword:e}).subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.voucher.cancel.done)}))}cancelConfirmationTitle(e){switch(e){case i.Pb.CANCEL_AND_REFUND:return this.i18n.voucher.cancel.refundConfirmation;case i.Pb.CANCEL_PENDING_PACK:return this.i18n.voucher.cancel.packConfirmation;case i.Pb.CANCEL_GENERATED:case i.Pb.CANCEL_PENDING_SINGLE:return this.i18n.voucher.cancel.confirmation}}get changeExpirationFields(){return[{internalName:"newExpirationDate",name:this.i18n.general.newExpirationDate,type:i.p.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:i.p.TEXT}]}transferPath(e){return null===e.authorizationStatus||e.authorizationStatus===i.yb.AUTHORIZED?["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]:["/banking","transaction",this.bankingHelper.transactionNumberOrId(e)]}resolveMenu(e){return e.redeemer&&this.authHelper.isSelfOrOwner(e.redeemer)?l.b.SEARCH_REDEEMED:e.buyer&&this.authHelper.isSelfOrOwner(e.buyer)?l.b.SEARCH_BOUGHT_VOUCHERS:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Qo.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["app-view-voucher"]],features:[d.ub],decls:6,vars:7,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf","ngIfElse"],["loading",""],[3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column"],[1,"d-flex","flex-column","flex-sm-row-reverse","justify-content-sm-between"],["class","image d-flex justify-content-center mt-2 mb-4 align-self-center",4,"ngIf"],[1,"d-flex","flex-column","flex-grow-1"],[3,"label"],[3,"label",4,"ngIf"],["class","d-flex justify-content-start",4,"ngIf"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4","align-self-center"],["size","160","imageSize","200","useLightbox","",3,"image"],[3,"user"],[3,"routerLink"],[1,"d-flex","justify-content-start"],[1,"break-nl"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,yl,35,37,"page-content",1),d.ac(3,"async"),d.Pb(),d.Bc(4,xl,2,0,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(5);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",d.bc(3,5,t.data$))("ngIfElse",e)}},directives:[m.a,f.t,g.a,v.a,U.a,P.a,V.h,H.a],pipes:[f.b,O.a,Bc.a,nl.a],encapsulation:2,changeDetection:0}),e})();var Pl=n("IbW5");function Dl(e,t){1&e&&d.Mb(0)}function Ll(e,t){if(1&e&&d.Lb(0,"field-option",16),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function wl(e,t){if(1&e&&d.Lb(0,"field-option",16),2&e){const e=t.$implicit;d.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Cl(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"div",12),d.Qb(2,"div",6),d.Qb(3,"single-selection-field",13),d.Bc(4,Ll,1,4,"field-option",14),d.Pb(),d.Pb(),d.Qb(5,"div",6),d.Qb(6,"single-selection-field",15),d.Bc(7,wl,1,4,"field-option",14),d.Pb(),d.Pb(),d.Nb()),2&e){const e=d.Zb(2);d.xb(3),d.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.fromAccount),d.xb(1),d.gc("ngForOf",e.data.accountTypes),d.xb(2),d.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.toAccount),d.xb(1),d.gc("ngForOf",e.data.accountTypes)}}function Ql(e,t){if(1&e&&(d.Qb(0,"div",6),d.Lb(1,"input-field",19),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function Il(e,t){if(1&e&&d.Lb(0,"field-option",22),2&e){const e=t.$implicit;d.gc("id",e.id)("value",e)("text",e.name)}}function Fl(e,t){if(1&e&&(d.Qb(0,"div",6),d.Qb(1,"single-selection-field",20),d.Bc(2,Il,1,3,"field-option",21),d.Pb(),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.general.period),d.xb(1),d.gc("ngForOf",e.data.preselectedPeriods)}}function Tl(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"div",12),d.Qb(2,"div",6),d.Lb(3,"date-field",23),d.Pb(),d.Nb()),2&e){const e=d.Zb(3);d.xb(3),d.gc("label",e.i18n.general.beginDate)}}function Sl(e,t){if(1&e&&(d.Qb(0,"div",6),d.Lb(1,"date-field",24),d.Pb()),2&e){const e=d.Zb(3);d.xb(1),d.gc("label",e.i18n.general.endDate)}}function Ol(e,t){if(1&e&&(d.Ob(0),d.Bc(1,Ql,2,2,"div",17),d.Qb(2,"div",6),d.Lb(3,"user-field",18),d.Pb(),d.Ob(4),d.Bc(5,Fl,3,2,"div",17),d.Bc(6,Tl,4,1,"ng-container",8),d.ac(7,"async"),d.Bc(8,Sl,2,1,"div",17),d.ac(9,"async"),d.Nb(),d.Nb()),2&e){const e=d.Zb(2);var n,i;d.xb(1),d.gc("ngIf",e.hasTransactionNumber),d.xb(2),d.gc("label",e.i18n.general.user),d.xb(2),d.gc("ngIf",(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),d.xb(1),d.gc("ngIf",null==(null==(n=e.form.value||d.bc(7,5,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),d.xb(2),d.gc("ngIf",null==(null==(i=e.form.value||d.bc(9,7,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end))}}function Nl(e,t){if(1&e&&(d.Qb(0,"mobile-result",25),d.Qb(1,"div",26),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.gc("date",e.date)("amount",e.amount)("avatarImage",n.bankingHelper.avatarImage(e.transaction.related))("avatarIcon",n.bankingHelper.avatarIcon(e.transaction.related))("currency",n.currencies.get(e.currency)),d.xb(2),d.Fc(" ",n.bankingHelper.subjectName(e.transaction.related)," ")}}function kl(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",30),d.Xb("click",(function(){d.sc(e);const n=t.$implicit,i=d.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n.transaction))})),d.Qb(2,"td"),d.Dc(3),d.ac(4,"date"),d.Pb(),d.Qb(5,"td"),d.Dc(6),d.Pb(),d.Qb(7,"td"),d.Dc(8),d.Pb(),d.Qb(9,"td"),d.Dc(10),d.Pb(),d.Qb(11,"td",28),d.Dc(12),d.ac(13,"currency"),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit,n=d.Zb(3);d.xb(3),d.Ec(d.bc(4,5,e.dueDate)),d.xb(3),d.Ec(n.bankingHelper.subjectName(e.transaction.from)),d.xb(2),d.Ec(n.bankingHelper.subjectName(e.transaction.to)),d.xb(2),d.Ec(n.number(e)),d.xb(2),d.Fc(" ",d.cc(13,7,e.amount,n.currencies.get(e.transaction.currency))," ")}}function Bl(e,t){if(1&e&&(d.Qb(0,"table",27),d.Qb(1,"thead"),d.Qb(2,"th"),d.Dc(3),d.Pb(),d.Qb(4,"th"),d.Dc(5),d.Pb(),d.Qb(6,"th"),d.Dc(7),d.Pb(),d.Qb(8,"th"),d.Dc(9),d.Pb(),d.Qb(10,"th",28),d.Dc(11),d.Pb(),d.Pb(),d.Qb(12,"tbody"),d.Bc(13,kl,14,10,"ng-container",29),d.ac(14,"async"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);var n;d.xb(3),d.Ec(e.i18n.transaction.dueDate),d.xb(2),d.Ec(e.i18n.transaction.from),d.xb(2),d.Ec(e.i18n.transaction.to),d.xb(2),d.Ec(e.i18n.transaction.installmentNumber),d.xb(2),d.Ec(e.i18n.transaction.amount),d.xb(2),d.gc("ngForOf",null==(n=d.bc(14,6,e.results$))?null:n.results)}}function Al(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",3),d.ac(1,"async"),d.Qb(2,"form",4),d.Qb(3,"div",5),d.Qb(4,"div",6),d.Lb(5,"single-selection-field",7),d.Pb(),d.Bc(6,Cl,8,6,"ng-container",8),d.Bc(7,Ol,10,9,"ng-container",8),d.ac(8,"async"),d.Pb(),d.Pb(),d.Pb(),d.Qb(9,"results-layout",9),d.Xb("update",(function(t){return d.sc(e),d.Zb().update(t)})),d.ac(10,"async"),d.Bc(11,Nl,3,6,"mobile-result",10),d.Bc(12,Bl,15,8,"table",11),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.i18n.transaction.title.scheduled)("mobileHeading",e.i18n.transaction.mobileTitle.scheduled)("headingActions",d.bc(1,11,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(3),d.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),d.xb(1),d.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.xb(1),d.gc("ngIf",d.bc(8,13,e.moreFilters$)),d.xb(2),d.gc("results",d.bc(10,15,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let El=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.installmentsService=t,this.bankingHelper=n,this.currencies=new Map}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.installmentsService.getInstallmentsOverviewDataForSearch({fields:["accountTypes","preselectedPeriods","query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.h)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e})}onDataInitialized(e){super.onDataInitialized(e);const t=(e.accountTypes||[]).map(e=>{var t;return null===(t=e.currency)||void 0===t?void 0:t.transactionNumberPattern}).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=[this.moreFiltersAction]}getFormControlNames(){return["status","fromAccountType","toAccountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.status=i.G.SCHEDULED,t}get statusOptions(){return Object.values(i.G).map(e=>({value:e,text:this.apiI18n.installmentStatus(e)}))}toSearchParams(e){const t=e;return t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.statuses=[e.status],t}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(){return l.b.SCHEDULED_PAYMENTS_OVERVIEW}doSearch(e){return this.installmentsService.searchInstallmentsOverview$Response(e)}get toLink(){return e=>this.bankingHelper.transactionPath(e.transaction)}number(e){return e.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:e.number,total:e.totalInstallments}):String(e.number)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(xa.a),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["search-installments"]],features:[d.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.Bc(2,Dl,1,0,"ng-container",1),d.Pb(),d.Bc(3,Al,13,17,"ng-template",null,2,d.Cc)),2&e){const e=d.qc(4);d.gc("ready",d.bc(1,3,t.data$)),d.xb(2),d.gc("ngIf",t.data)("ngIfThen",e)}},directives:[m.a,f.t,g.a,x.I,x.w,x.n,D.a,x.v,x.l,p.a,h.a,y.a,f.s,L.a,F.a,I.a,T.a,C.a,q.a],pipes:[f.b,z.a,O.a],encapsulation:2,changeDetection:0}),e})();function $l(e,t){if(1&e&&(d.Qb(0,"mobile-result",4),d.Qb(1,"div",5),d.Dc(2),d.Pb(),d.Pb()),2&e){const e=t.$implicit;d.gc("avatarImage",e.image),d.xb(2),d.Fc(" ",e.voucherTitle," ")}}function Rl(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"tr",8),d.Xb("click",(function(){d.sc(e);const n=t.$implicit;return d.Zb(2).selectType(n)})),d.Qb(2,"td",9),d.Lb(3,"avatar",10),d.Pb(),d.Qb(4,"td"),d.Qb(5,"div"),d.Qb(6,"a",11),d.Xb("click",(function(){d.sc(e);const n=t.$implicit;return d.Zb(2).selectType(n)})),d.Dc(7),d.Pb(),d.Qb(8,"div"),d.Dc(9),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=t.$implicit;d.xb(3),d.gc("image",e.image),d.xb(4),d.Fc(" ",e.voucherTitle," "),d.xb(2),d.Fc(" ",e.voucherDescription," ")}}function Zl(e,t){if(1&e&&(d.Qb(0,"table",6),d.Qb(1,"tbody"),d.Bc(2,Rl,10,3,"ng-container",7),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.xb(2),d.gc("ngForOf",e.types)}}let Ml=(()=>{class e extends S.a{constructor(e){super(e),this.typeSelected=new d.n}get selectType(){return e=>this.typeSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["generate-vouchers-step-list-types"]],inputs:{types:"types"},outputs:{typeSelected:"typeSelected"},features:[d.ub],decls:4,vars:5,consts:[[3,"mode","heading","mobileHeading"],["resultType","list",3,"results","onClick"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar"],["icon","shopping_cart","size","xlarge","roundBorders","false",3,"image"],["ngClass","font-weight-bold",3,"click"]],template:function(e,t){1&e&&(d.Lb(0,"page-content",0),d.Qb(1,"results-layout",1),d.Bc(2,$l,3,2,"mobile-result",2),d.Bc(3,Zl,3,1,"table",3),d.Pb()),2&e&&(d.gc("mode","empty")("heading",t.i18n.voucher.title.generate)("mobileHeading",t.i18n.voucher.mobileTitle.generate),d.xb(1),d.gc("results",t.types)("onClick",t.selectType))},directives:[g.a,p.a,h.a,y.a,q.a,f.s,U.a,f.q],encapsulation:2,changeDetection:0}),e})();function Hl(e,t){if(1&e&&(d.Qb(0,"label-value",1),d.Dc(1),d.ac(2,"currency"),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.account.availableBalance),d.xb(1),d.Fc(" ",d.cc(2,2,e.data.account.status.availableBalance,e.currency)," ")}}let ql=(()=>{class e extends S.a{constructor(e){super(e)}ngOnInit(){super.ngOnInit(),this.addSub(this.form.get("user").valueChanges.subscribe(()=>this.saveUserData()))}saveUserData(){this.userField.user&&this.form.get("userData").setValue(this.userField.user)}get currency(){return this.data.account.currency}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["generate-vouchers-step-form"]],viewQuery:function(e,t){var n;1&e&&d.Hc(F.a,!0),2&e&&d.pc(n=d.Yb())&&(t.userField=n.first)},inputs:{data:"data",form:"form"},features:[d.ub],decls:8,vars:11,consts:[[3,"formGroup"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["formControlName","user",3,"label","allowContacts"],["user",""]],template:function(e,t){1&e&&(d.Ob(0,0),d.Qb(1,"label-value",1),d.Dc(2),d.Pb(),d.Bc(3,Hl,3,5,"label-value",2),d.Lb(4,"input-field",3),d.Lb(5,"decimal-field",4),d.Lb(6,"user-field",5,6),d.Nb()),2&e&&(d.gc("formGroup",t.form),d.xb(1),d.gc("label",t.i18n.voucher.originAccount),d.xb(1),d.Fc(" ",t.data.account.type.name," "),d.xb(1),d.gc("ngIf",t.data.account.status.availableBalance),d.xb(1),d.gc("label",t.i18n.voucher.numberOfVouchers),d.xb(1),d.gc("label",t.i18n.voucher.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),d.xb(1),d.gc("label",t.i18n.general.user)("allowContacts",!1))},directives:[x.w,x.n,v.a,f.t,I.a,x.v,x.l,x.D,Q.a,F.a],pipes:[O.a],encapsulation:2,changeDetection:0}),e})();function Ul(e,t){if(1&e&&(d.Qb(0,"label-value",0),d.Lb(1,"user-link",3),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.general.user),d.xb(1),d.gc("user",e.user)}}function Vl(e,t){1&e&&d.Lb(0,"hr")}function zl(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Bc(1,Vl,1,0,"hr",2),d.ac(2,"async"),d.Qb(3,"form",4),d.Qb(4,"confirmation-password",5),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().confirmed.emit(t)})),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",d.bc(2,4,e.layout.gtxxs$)),d.xb(2),d.gc("formGroup",e.form),d.xb(1),d.gc("passwordInput",e.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let jl=(()=>{class e extends S.a{constructor(e){super(e),this.confirmationModeChanged=new d.n,this.confirmed=new d.n}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=()=>({type:i.s.GENERATE_VOUCHERS,amount:this.generateVoucher.amount,voucherType:this.data.type.id,numberOfVouchers:this.generateVoucher.count}),this.confirmationPasswordInput||this.addShortcut(Nn.k,()=>this.confirmed.emit())}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["generate-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",generateVoucher:"generateVoucher",data:"data",user:"user"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[d.ub],decls:9,vars:11,consts:[[3,"label"],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(d.Qb(0,"label-value",0),d.Dc(1),d.Pb(),d.Qb(2,"label-value",0),d.Dc(3),d.Pb(),d.Qb(4,"label-value",0),d.Dc(5),d.ac(6,"currency"),d.Pb(),d.Bc(7,Ul,2,2,"label-value",1),d.Bc(8,zl,5,6,"ng-container",2)),2&e&&(d.gc("label",t.i18n.general.type),d.xb(1),d.Fc(" ",t.data.type.voucherTitle,"\n"),d.xb(1),d.gc("label",t.i18n.voucher.numberOfVouchers),d.xb(1),d.Fc(" ",t.generateVoucher.count,"\n"),d.xb(1),d.gc("label",t.i18n.voucher.amountPerVoucher),d.xb(1),d.Fc(" ",d.cc(6,8,t.generateVoucher.amount,t.data.account.currency),"\n"),d.xb(2),d.gc("ngIf",t.user),d.xb(1),d.gc("ngIf",t.confirmationPasswordInput))},directives:[v.a,f.t,P.a,x.I,x.w,x.n,En.a,$n.a,x.v,x.l],pipes:[O.a,f.b],encapsulation:2,changeDetection:0}),e})();function Gl(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Qb(1,"generate-vouchers-step-list-types",4),d.Xb("typeSelected",(function(t){return d.sc(e),d.Zb().toForm(t)})),d.Pb(),d.Nb()}if(2&e){const e=d.Zb();d.xb(1),d.gc("types",e.data.types)}}function _l(e,t){if(1&e){const e=d.Rb();d.Qb(0,"action-button",10),d.Xb("action",(function(){return d.sc(e),d.Zb(2).backToSelectType()})),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("label",e.i18n.general.previous)}}function Kl(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",5),d.ac(1,"async"),d.Lb(2,"generate-vouchers-step-form",6),d.Qb(3,"actions",7),d.Qb(4,"action-button",8),d.Xb("action",(function(){return d.sc(e),d.Zb().toConfirm()})),d.ac(5,"async"),d.Pb(),d.Bc(6,_l,1,1,"action-button",9),d.Pb(),d.Pb()}if(2&e){const e=d.Zb();d.gc("heading",e.dataTypeForGenerate.type.voucherTitle)("mobileHeading",e.dataTypeForGenerate.type.voucherTitle)("mode",d.bc(1,8,e.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("data",e.dataTypeForGenerate)("form",e.form),d.xb(2),d.gc("disabled",d.bc(5,10,e.requesting$))("label",e.i18n.general.next),d.xb(2),d.gc("ngIf",!e.singleType)}}function Xl(e,t){if(1&e){const e=d.Rb();d.Qb(0,"action-button",8),d.Xb("action",(function(){return d.sc(e),d.Zb(2).generate()})),d.ac(1,"async"),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("disabled",!e.canConfirm||d.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function Yl(e,t){1&e&&d.Dc(0,"\xa0")}function Wl(e,t){if(1&e){const e=d.Rb();d.Qb(0,"page-content",5),d.ac(1,"async"),d.Qb(2,"generate-vouchers-step-confirm",11),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().generate(t)})),d.Pb(),d.Qb(3,"actions",7),d.Bc(4,Xl,2,4,"action-button",12),d.ac(5,"async"),d.Bc(6,Yl,1,0,"ng-template",null,13,d.Cc),d.Qb(8,"action-button",10),d.Xb("action",(function(){return d.sc(e),d.Zb().backToForm()})),d.Pb(),d.Pb(),d.Pb()}if(2&e){const e=d.qc(7),t=d.Zb();d.gc("heading",t.i18n.voucher.title.generateConfirmation)("mobileHeading",t.i18n.voucher.mobileTitle.generateConfirmation)("mode",d.bc(1,11,t.layout.ltsm$)?"fullHeight":"normal"),d.xb(2),d.gc("generateVoucher",t.form.value)("data",t.dataTypeForGenerate)("user",t.form.get("userData").value)("confirmationPasswordInput",t.dataTypeForGenerate.confirmationPasswordInput)("confirmationPassword",t.confirmationPassword),d.xb(2),d.gc("ngIf",d.bc(5,13,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),d.xb(4),d.gc("label",t.i18n.general.previous)}}function Jl(e,t){1&e&&(d.Qb(0,"page-content"),d.Lb(1,"spinner"),d.Pb())}let eu=(()=>{class e extends ut.a{constructor(e,t){super(e),this.voucherService=t,this.ConfirmationMode=hn.a,this.step$=new u.a(null),this.singleType=!1,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.addSub(this.voucherService.getVoucherDataForGenerate().subscribe(e=>this.data=e))}onDataInitialized(e){const t=e.types||[];1===t.length?(this.singleType=!0,this.toForm(t[0])):this.step="select-type"}get currency(){return this.dataTypeForGenerate.account.currency}generate(e){if(e&&this.confirmationPassword.setValue(e),this.confirmationPasswordInput&&!Object(s.F)(this.confirmationPassword))return;const t=this.form.value;t.type=this.dataTypeForGenerate.type.id,delete t.userData,this.addSub(this.voucherService.generateVouchers({confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:t}).subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.voucher.generate.done)}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(e){this.addSub(this.voucherService.getVoucherDataForGenerate({type:e.id}).subscribe(e=>{this.dataTypeForGenerate=e,this.buildForm(),this.step="form"}))}toConfirm(){Object(s.F)(this.form)&&(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),this.canConfirm?(this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(x.G.required))),this.step="confirm"):this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput)))}get confirmationPasswordInput(){return this.dataTypeForGenerate.confirmationPasswordInput}buildForm(){this.form?this.form.reset():this.form=this.formBuilder.group({count:new x.j(""),amount:new x.j(""),user:new x.j(""),userData:new x.j("")}),this.form.get("count").setValue(1)}resolveMenu(){return l.b.GENERATE_VOUCHER}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Qo.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["generate-vouchers"]],features:[d.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"generateVoucher","data","user","confirmationPasswordInput","confirmationPassword","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(e,t){1&e&&(d.Qb(0,"page-layout",0),d.ac(1,"async"),d.ac(2,"async"),d.Bc(3,Gl,2,1,"ng-container",1),d.Bc(4,Kl,7,12,"page-content",2),d.Bc(5,Wl,9,15,"page-content",2),d.Bc(6,Jl,2,0,"page-content",3),d.Pb()),2&e&&(d.gc("ready",d.bc(1,5,t.data$))("ngSwitch",d.bc(2,7,t.step$)),d.xb(3),d.gc("ngSwitchCase","select-type"),d.xb(1),d.gc("ngSwitchCase","form"),d.xb(1),d.gc("ngSwitchCase","confirm"))},directives:[m.a,f.x,f.y,f.z,Ml,g.a,ql,dt.a,mt.a,f.t,jl,H.a],pipes:[f.b],encapsulation:2,changeDetection:0}),e})();const tu=[{path:"",canActivateChild:[Pl.a],children:[{path:":owner/account/:type",component:Ce},{path:"transfer/:key",component:Co},{path:"transfer/:account/:key",component:Co},{path:"transaction/:key",component:Yr},{path:"transfers-overview",component:Lo},{path:"transaction/:key/authorization-history",component:Hc},{path:":from/payment",component:Sn},{path:":from/payment/:to",component:Sn},{path:":from/payment-request",component:la},{path:"payment-request/:key/accept",component:Pi},{path:":from/payment-request/:to",component:la},{path:":owner/payment-requests",component:nc,data:{kind:"payment-request"}},{path:"payment-requests",component:Nc,data:{kind:"payment-request"}},{path:"pos",component:Sn},{path:"qr",component:ya},{path:":owner/installments",component:ka},{path:"installments-overview",component:El},{path:":owner/authorized-payments",component:nc,data:{kind:"authorized"}},{path:"authorized-payments",component:Nc,data:{kind:"authorized"}},{path:"pending-my-authorization",component:Nc,data:{kind:"myAuth"}},{path:":user/vouchers/redeem",component:ps},{path:":user/vouchers/redeemed",component:Ms},{path:":user/vouchers/buy",component:Yo},{path:":user/vouchers/bought",component:Cs},{path:"vouchers/view/:key",component:vl},{path:"vouchers",component:tl},{path:":user/account-balance-limits",component:Pt},{path:":user/account-balance-limits/:accountType",component:Ht},{path:":user/account-balance-limits/:accountType/edit",component:pt},{path:"account-balance-limits-overview",component:Bt},{path:":user/account-payment-limits",component:_t},{path:":user/account-payment-limits/:accountType",component:fn},{path:":user/account-payment-limits/:accountType/edit",component:Vt},{path:"account-payment-limits-overview",component:sn},{path:"user-balances-overview",component:st},{path:"vouchers/generate",component:eu}]}];let nu=(()=>{class e{}return e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({factory:function(t){return new(t||e)},imports:[[V.i.forChild(tu)],V.i]}),e})();function iu(e,t){if(1&e&&(d.Qb(0,"notification",6),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.xb(1),d.Fc(" ",e.i18n.transaction.requiresAuthorization,"\n")}}function au(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Lb(1,"user-link",8),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.fromUser),d.xb(1),d.gc("user",e.fromUser)}}function cu(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.fromAccount),d.xb(1),d.Fc(" ",e.preview.fromAccount.type.name,"\n")}}function ru(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Lb(1,"user-link",8),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.toUser),d.xb(1),d.gc("user",e.toUser)}}function ou(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.toAccount),d.xb(1),d.Fc(" ",e.preview.toAccount.type.name,"\n")}}function su(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Dc(1),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.type),d.xb(1),d.Fc(" ",e.preview.paymentType.name,"\n")}}function lu(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Dc(1),d.ac(2,"currency"),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.amount),d.xb(1),d.Fc(" ",d.cc(2,2,e.preview.mainAmount,e.preview.currency),"\n")}}function uu(e,t){if(1&e&&(d.Qb(0,"div"),d.Dc(1),d.ac(2,"currency"),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.xb(1),d.Gc(" ",e.fee.name,": ",d.cc(2,2,e.amount,n.preview.currency)," ")}}function bu(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Bc(1,uu,3,5,"div",9),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.appliedFees),d.xb(1),d.gc("ngForOf",e.fees)}}function du(e,t){1&e&&d.Lb(0,"custom-field-value",10),2&e&&d.gc("fieldValue",t.$implicit)}function mu(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Dc(1),d.ac(2,"date"),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.dueDate),d.xb(1),d.Fc(" ",d.bc(2,2,e.preview.installments[0].dueDate),"\n")}}function fu(e,t){if(1&e&&(d.Qb(0,"thead"),d.Qb(1,"th"),d.Dc(2),d.Pb(),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th",12),d.Dc(6),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.xb(2),d.Ec(e.i18n.transaction.installmentNumber),d.xb(2),d.Ec(e.i18n.transaction.dueDate),d.xb(2),d.Ec(e.i18n.transaction.amount)}}function gu(e,t){if(1&e&&(d.Qb(0,"tr"),d.Qb(1,"td"),d.Dc(2),d.Pb(),d.Qb(3,"td"),d.Dc(4),d.ac(5,"date"),d.Pb(),d.Qb(6,"td",12),d.Dc(7),d.ac(8,"currency"),d.Pb(),d.Pb()),2&e){const e=t.$implicit,n=d.Zb(2);d.xb(2),d.Fc(" ",e.number," "),d.xb(2),d.Fc(" ",d.bc(5,3,e.dueDate)," "),d.xb(3),d.Fc(" ",d.cc(8,5,e.mainAmount,n.preview.currency)," ")}}function pu(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Qb(1,"table",11),d.Bc(2,fu,7,3,"thead",4),d.ac(3,"async"),d.Qb(4,"tbody"),d.Bc(5,gu,9,8,"tr",9),d.Pb(),d.Pb(),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.installments),d.xb(2),d.gc("ngIf",d.bc(3,3,e.layout.gtxs$)),d.xb(3),d.gc("ngForOf",e.preview.installments)}}function hu(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentNowManual," ")}}function yu(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentNowFixed(e.preview.payment.occurrencesCount)," ")}}function xu(e,t){if(1&e&&(d.Ob(0),d.Bc(1,hu,2,1,"ng-container",4),d.Bc(2,yu,2,1,"ng-container",4),d.Nb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngIf",null==e.preview.payment.occurrencesCount),d.xb(1),d.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function vu(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.ac(2,"date"),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentDateManual(d.bc(2,1,e.preview.payment.firstOccurrenceDate))," ")}}const Pu=function(e,t){return{date:e,count:t}};function Du(e,t){if(1&e&&(d.Ob(0),d.Dc(1),d.ac(2,"date"),d.Nb()),2&e){const e=d.Zb(3);d.xb(1),d.Fc(" ",e.i18n.transaction.recurringPaymentDateFixed(d.kc(3,Pu,d.bc(2,1,e.preview.payment.firstOccurrenceDate),e.preview.payment.occurrencesCount))," ")}}function Lu(e,t){if(1&e&&(d.Bc(0,vu,3,3,"ng-container",4),d.Bc(1,Du,3,6,"ng-container",4)),2&e){const e=d.Zb(2);d.gc("ngIf",null==e.preview.payment.occurrencesCount),d.xb(1),d.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function wu(e,t){if(1&e&&(d.Qb(0,"label-value",7),d.Bc(1,xu,3,2,"ng-container",13),d.Bc(2,Lu,2,2,"ng-template",null,14,d.Cc),d.Pb()),2&e){const e=d.qc(3),t=d.Zb();d.gc("label",t.i18n.transaction.recurringPayment),d.xb(1),d.gc("ngIf",null==t.preview.payment.firstOccurrenceDate)("ngIfElse",e)}}function Cu(e,t){if(1&e&&d.Lb(0,"label-value",15),2&e){const e=d.Zb();d.gc("label",e.i18n.general.description)("value",e.preview.payment.description)}}function Qu(e,t){1&e&&d.Lb(0,"hr")}function Iu(e,t){1&e&&d.Lb(0,"hr")}function Fu(e,t){if(1&e&&(d.Ob(0),d.Bc(1,Iu,1,0,"hr",4),d.ac(2,"async"),d.Qb(3,"div",16),d.Dc(4),d.Pb(),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",d.bc(2,2,e.layout.gtxxs$)),d.xb(3),d.Ec(e.preview.confirmationMessage)}}function Tu(e,t){1&e&&d.Lb(0,"hr")}function Su(e,t){if(1&e){const e=d.Rb();d.Ob(0),d.Bc(1,Tu,1,0,"hr",4),d.ac(2,"async"),d.Qb(3,"form",17),d.Qb(4,"confirmation-password",18),d.Xb("confirmationModeChanged",(function(t){return d.sc(e),d.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return d.sc(e),d.Zb().confirmed.emit(t)})),d.Pb(),d.Pb(),d.Nb()}if(2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",d.bc(2,5,e.layout.gtxxs$)),d.xb(2),d.gc("formGroup",e.form),d.xb(1),d.gc("pos",e.pos)("passwordInput",e.preview.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let Ou=(()=>{class e extends S.a{constructor(e,t){super(e),this.bankingHelper=t,this.confirmationModeChanged=new d.n,this.confirmed=new d.n}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===i.a.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===i.a.SYSTEM,this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,Object(s.h)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=()=>this.pos?this.preview.payment:{type:i.s.PERFORM_PAYMENT,from:r.a.accountOwner(this.preview.fromAccount),to:r.a.accountOwner(this.preview.toAccount),paymentType:this.preview.paymentType.id,amount:this.preview.payment.amount},this.preview.confirmationPasswordInput||this.addShortcut(Nn.k,()=>this.confirmed.emit())}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["payment-step-confirm"]],inputs:{pos:"pos",preview:"preview",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[d.ub],decls:20,vars:23,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[3,"fieldValue"],[1,"table","table-hover"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"pos","passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(d.Bc(0,iu,2,1,"notification",0),d.Bc(1,au,2,2,"label-value",1),d.Bc(2,cu,2,2,"label-value",1),d.Bc(3,ru,2,2,"label-value",1),d.Bc(4,ou,2,2,"label-value",1),d.Bc(5,su,2,2,"label-value",1),d.Bc(6,lu,3,5,"label-value",1),d.Bc(7,bu,2,2,"label-value",1),d.Bc(8,du,1,1,"custom-field-value",2),d.Bc(9,mu,3,4,"label-value",1),d.Bc(10,pu,6,5,"label-value",1),d.Bc(11,wu,4,3,"label-value",1),d.Bc(12,Cu,1,2,"label-value",3),d.Bc(13,Qu,1,0,"hr",4),d.ac(14,"async"),d.Qb(15,"label-value",5),d.Dc(16),d.ac(17,"currency"),d.Pb(),d.Bc(18,Fu,5,4,"ng-container",4),d.Bc(19,Su,5,7,"ng-container",4)),2&e&&(d.gc("ngIf",t.preview.pendingAuthorization),d.xb(1),d.gc("ngIf",!t.fromSelf&&t.fromUser),d.xb(1),d.gc("ngIf",t.fromSystem),d.xb(1),d.gc("ngIf",t.toUser),d.xb(1),d.gc("ngIf",t.toSystem),d.xb(1),d.gc("ngIf",t.showPaymentType),d.xb(1),d.gc("ngIf",null!=t.preview.mainAmount&&t.preview.totalAmount!==t.preview.mainAmount),d.xb(1),d.gc("ngIf",(null==t.fees?null:t.fees.length)>0),d.xb(1),d.gc("ngForOf",t.preview.customValues),d.xb(1),d.gc("ngIf",1===(null==t.preview.installments?null:t.preview.installments.length)),d.xb(1),d.gc("ngIf",(null==t.preview.installments?null:t.preview.installments.length)>1),d.xb(1),d.gc("ngIf","recurring"===t.preview.payment.scheduling),d.xb(1),d.gc("ngIf",t.preview.payment.description),d.xb(1),d.gc("ngIf",d.bc(14,18,t.layout.gtxxs$)),d.xb(2),d.gc("label",t.i18n.transaction.totalAmount),d.xb(1),d.Fc(" ",d.cc(17,20,t.preview.totalAmount,t.preview.currency),"\n"),d.xb(2),d.gc("ngIf",(t.preview.confirmationMessage||"").length>0),d.xb(1),d.gc("ngIf",t.preview.confirmationPasswordInput))},directives:[f.t,f.s,v.a,Bn.a,P.a,An.a,x.I,x.w,x.n,En.a,$n.a,x.v,x.l],pipes:[f.b,O.a,z.a],encapsulation:2,changeDetection:0}),e})(),Nu=(()=>{class e extends S.a{constructor(e,t){super(e),this.performPayment=t}ngOnInit(){super.ngOnInit(),this.performed.authorizationStatus===i.yb.PENDING?(this.icon="scheduled",this.message=this.performed.transactionNumber?this.i18n.transaction.pendingWithNumber(this.performed.transactionNumber):this.i18n.transaction.pending):(this.icon="done",this.message=this.performed.transactionNumber?this.i18n.transaction.processedWithNumber(this.performed.transactionNumber):this.i18n.transaction.processed),this.addShortcut(Nn.k,()=>this.performPayment.viewPerformed())}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(Sn))},e.\u0275cmp=d.Eb({type:e,selectors:[["payment-step-done"]],inputs:{performed:"performed"},features:[d.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(d.Qb(0,"div",0),d.Qb(1,"div",1),d.Qb(2,"div",2),d.Lb(3,"icon",3),d.Pb(),d.Qb(4,"div",4),d.Dc(5),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.xb(3),d.gc("icon",t.icon),d.xb(2),d.Ec(t.message))},directives:[fi.a],encapsulation:2,changeDetection:0}),e})();const ku=["toUser"],Bu=["amount"];function Au(e,t){if(1&e&&(d.Qb(0,"label-value",15),d.Lb(1,"user-link",16),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.fromUser),d.xb(1),d.gc("user",e.fromUser)}}const Eu=function(e,t,n){return{positive:e,negative:t,"text-right":n}};function $u(e,t){if(1&e&&(d.Qb(0,"label-value",18),d.ac(1,"async"),d.Qb(2,"div",19),d.ac(3,"async"),d.Dc(4),d.ac(5,"currency"),d.Pb(),d.Pb()),2&e){const e=d.Zb(2);d.gc("label",d.bc(1,3,e.accountBalanceLabel$)),d.xb(2),d.gc("ngClass",d.lc(10,Eu,e.format.isPositive(e.singleAccount.status.balance),e.format.isNegative(e.singleAccount.status.balance),d.bc(3,5,e.layout.ltsm$))),d.xb(2),d.Fc(" ",d.cc(5,7,e.singleAccount.status.balance,e.singleAccount.currency)," ")}}function Ru(e,t){if(1&e&&(d.Ob(0),d.Bc(1,$u,6,14,"label-value",17),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("ngIf",e.singleAccount.status)}}function Zu(e,t){1&e&&d.Lb(0,"br")}function Mu(e,t){1&e&&d.Dc(0," - ")}function Hu(e,t){if(1&e&&(d.Ob(0),d.Bc(1,Zu,1,0,"br",2),d.ac(2,"async"),d.Bc(3,Mu,1,0,"ng-template",null,30,d.Cc),d.Dc(5),d.Nb()),2&e){const e=d.qc(4),t=d.Zb().$implicit,n=d.Zb(2);d.xb(1),d.gc("ngIf",d.bc(2,3,n.layout.ltsm$))("ngIfElse",e),d.xb(4),d.Fc(" ",t.number," ")}}const qu=function(e,t){return{positive:e,negative:t}};function Uu(e,t){if(1&e&&(d.Qb(0,"div",31),d.Dc(1),d.ac(2,"currency"),d.Pb()),2&e){const e=d.Zb().$implicit,t=d.Zb(2);d.gc("ngClass",d.kc(5,qu,t.format.isPositive(e.status.balance),t.format.isNegative(e.status.balance))),d.xb(1),d.Fc(" ",d.cc(2,2,e.status.balance,e.currency)," ")}}function Vu(e,t){if(1&e){const e=d.Rb();d.Qb(0,"div",23),d.Qb(1,"div"),d.Qb(2,"div",24),d.Qb(3,"input",25,26),d.Xb("keyup.enter",(function(){return d.sc(e),d.qc(4).click()})),d.Pb(),d.Qb(5,"label",27),d.Qb(6,"div",28),d.Dc(7),d.Bc(8,Hu,6,5,"ng-container",14),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Bc(9,Uu,3,8,"div",29),d.Pb()}if(2&e){const e=t.$implicit,n=d.Zb(2);d.xb(1),d.zb(n.pos?"col":"col-7 col-sm-8 col-md-5"),d.xb(2),d.gc("id","from_"+e.id)("value",e.type.id),d.xb(2),d.gc("for","from_"+e.id),d.xb(2),d.Fc(" ",e.type.name," "),d.xb(1),d.gc("ngIf",e.number),d.xb(1),d.gc("ngIf",!n.pos&&e.status)}}function zu(e,t){if(1&e&&(d.Qb(0,"label-value",20),d.Bc(1,Vu,10,8,"div",21),d.Lb(2,"field-errors",22),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.pos?e.i18n.transaction.toAccount:e.i18n.transaction.fromAccount),d.xb(1),d.gc("ngForOf",e.data.accounts),d.xb(1),d.gc("control",e.form.get("account"))}}function ju(e,t){if(1&e&&d.Lb(0,"field-option",37),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.display)}}function Gu(e,t){if(1&e&&(d.Qb(0,"single-selection-field",35),d.Bc(1,ju,1,2,"field-option",36),d.Pb()),2&e){const e=d.Zb(2);d.xb(1),d.gc("ngForOf",e.data.allowedUsers)}}const _u=function(e){return[e]},Ku=function(e){return{usersToExclude:e}};function Xu(e,t){if(1&e){const e=d.Rb();d.Qb(0,"user-field",38,39),d.Xb("selected",(function(t){d.sc(e),d.Zb(2);const n=d.qc(10);return t?n.focus():null})),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("autoSearch",!e.allowPrincipal)("filters",d.jc(9,Ku,e.fromUser&&!e.fromSelf?d.jc(7,_u,e.fromParam):null))("allowContacts",e.allowContacts)("allowSearch",e.allowSearch)("allowPrincipal",e.allowPrincipal)("allowQrCode",e.allowQrCode)("principalTypes",e.data.principalTypes)}}function Yu(e,t){if(1&e&&(d.Qb(0,"label-value",32),d.Bc(1,Gu,2,1,"single-selection-field",33),d.Bc(2,Xu,2,11,"ng-template",null,34,d.Cc),d.Pb()),2&e){const e=d.qc(3),t=d.Zb();d.gc("label",t.pos?t.i18n.transaction.fromUser:t.i18n.transaction.toUser),d.xb(1),d.gc("ngIf",t.fixedUsersList)("ngIfElse",e)}}function Wu(e,t){if(1&e&&(d.Qb(0,"label-value",40),d.Lb(1,"user-link",16),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.toUser),d.xb(1),d.gc("user",e.toUser)}}function Ju(e,t){if(1&e&&d.Lb(0,"field-option",37),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function eb(e,t){if(1&e&&(d.Qb(0,"single-selection-field",41,42),d.Bc(2,Ju,1,2,"field-option",36),d.ac(3,"async"),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.type),d.xb(2),d.gc("ngForOf",d.bc(3,2,e.paymentTypes$))}}function tb(e,t){if(1&e&&d.Lb(0,"custom-field-input",43),2&e){const e=t.$implicit,n=d.Zb();d.gc("field",e)("formControl",n.customValuesControlGetter(e))}}function nb(e,t){if(1&e&&d.Lb(0,"field-option",49),2&e){const e=d.Zb(2);d.gc("text",e.i18n.transaction.schedulingSingle)}}function ib(e,t){if(1&e&&d.Lb(0,"field-option",50),2&e){const e=d.Zb(2);d.gc("text",e.i18n.transaction.schedulingInstallments)}}function ab(e,t){if(1&e&&d.Lb(0,"field-option",51),2&e){const e=d.Zb(2);d.gc("text",e.i18n.transaction.schedulingRecurring)}}function cb(e,t){if(1&e&&(d.Qb(0,"single-selection-field",44),d.Lb(1,"field-option",45),d.Bc(2,nb,1,1,"field-option",46),d.Bc(3,ib,1,1,"field-option",47),d.Bc(4,ab,1,1,"field-option",48),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.scheduling),d.xb(1),d.gc("text",e.i18n.transaction.schedulingDirect),d.xb(1),d.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>0),d.xb(1),d.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>1),d.xb(1),d.gc("ngIf",null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.allowsRecurringPayments)}}function rb(e,t){if(1&e&&d.Lb(0,"date-field",52),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.dueDate)}}function ob(e,t){if(1&e&&d.Lb(0,"date-field",52),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.firstInstallmentDate)}}function sb(e,t){if(1&e&&(d.Ob(0),d.Lb(1,"input-field",53),d.Qb(2,"radio-group-field",54),d.Lb(3,"field-option",37),d.Lb(4,"field-option",37),d.Pb(),d.Bc(5,ob,1,1,"date-field",55),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("label",e.i18n.transaction.installmentsCount),d.xb(1),d.gc("label",e.i18n.transaction.firstInstallment),d.xb(1),d.gc("value",!0)("text",e.i18n.general.now),d.xb(1),d.gc("value",!1)("text",e.i18n.general.futureDate),d.xb(1),d.gc("ngIf",!1===e.form.value.firstInstallmentIsNow)}}function lb(e,t){if(1&e&&d.Lb(0,"date-field",60),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.firstOccurrenceDate)}}function ub(e,t){if(1&e&&d.Lb(0,"input-field",61),2&e){const e=d.Zb(2);d.gc("label",e.i18n.transaction.occurrencesCount)}}function bb(e,t){if(1&e&&(d.Ob(0),d.Qb(1,"radio-group-field",56),d.Lb(2,"field-option",37),d.Lb(3,"field-option",37),d.Pb(),d.Bc(4,lb,1,1,"date-field",57),d.Qb(5,"radio-group-field",58),d.Lb(6,"field-option",37),d.Lb(7,"field-option",37),d.Pb(),d.Bc(8,ub,1,1,"input-field",59),d.Nb()),2&e){const e=d.Zb();d.xb(1),d.gc("label",e.i18n.transaction.firstOccurrence),d.xb(1),d.gc("value",!0)("text",e.i18n.general.now),d.xb(1),d.gc("value",!1)("text",e.i18n.general.futureDate),d.xb(1),d.gc("ngIf",!1===e.form.value.firstOccurrenceIsNow),d.xb(1),d.gc("label",e.i18n.transaction.repeatUntil),d.xb(1),d.gc("value",!0)("text",e.i18n.transaction.repeatUntilManual),d.xb(1),d.gc("value",!1)("text",e.i18n.transaction.repeatUntilFixed),d.xb(1),d.gc("ngIf",!1===e.form.value.repeatUntilCanceled)}}function db(e,t){if(1&e&&d.Lb(0,"textarea-field",63),2&e){const e=d.Zb().ngIf,t=d.Zb();d.gc("required","required"===e)("label",t.i18n.general.description)}}function mb(e,t){if(1&e&&(d.Ob(0),d.Bc(1,db,1,2,"textarea-field",62),d.Nb()),2&e){const e=t.ngIf;d.xb(1),d.gc("ngIf","disabled"!==e)}}const fb=[Di.a.FORBIDDEN,Di.a.UNAUTHORIZED,Di.a.NOT_FOUND];let gb=(()=>{class e extends S.a{constructor(e,t,n,i){super(e),this.bankingHelper=t,this.paymentsService=n,this.posService=i,this.availablePaymentTypes=new d.n,this.accountBalanceLabel$=new u.a(null),this.fixedDestination=!1,this.paymentTypes$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe(Object(Li.a)(),Object(wi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.fetchPaymentTypes())),this.addSub(this.form.get("account").valueChanges.pipe(Object(Li.a)(),Object(wi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes())),this.addSub(this.form.get("type").valueChanges.pipe(Object(Li.a)(),Object(wi.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>this.fetchPaymentTypeData(e))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateAccountBalanceLabel())),this.updateAccountBalanceLabel()}updateAccountBalanceLabel(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}fetchPaymentTypes(){this.dataCache.clear(),this.fetchedPaymentTypes=null;const e=r.a.escapeNumeric(this.form.value.subject);""!==e&&this.errorHandler.requestWithCustomErrorHandler(t=>{let n;n=this.pos?this.posService.dataForReceivePayment({from:e,fields:["fromUser","paymentTypes","paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:e,fields:["toUser","paymentTypes","paymentTypeData"]}),n.pipe(Object(xn.a)()).subscribe(e=>{this.setFetchedPaymentTypes(e)},e=>{if(this.allowPrincipal&&this.userField&&e.status===Di.a.NOT_FOUND){let t=e.error;if("string"==typeof t)try{t=JSON.parse(t)}catch(n){t={}}const i=t.entityType;if(!Object(s.a)(i)&&i.endsWith("User"))return void this.userField.search()}fb.includes(e.status)||t(e)})})}adjustPaymentTypes(){const e=this.form.value;if(0===(e.subject||"").trim().length)return;const t=this.fetchedPaymentTypes||[];Object(s.h)(t)&&this.notification.error(this.i18n.transaction.noTypes);const n=t.filter(t=>t.from.id===e.account);let i=this.form.value.type,a=null;Object(s.h)(n)?a={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(n),n.find(e=>e.id===i)||(i=n[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:i}),this.form.get("account").setErrors(a),this.form.get("account").markAsTouched(),Object(s.h)(i)||this.fetchPaymentTypeData(i),this.availablePaymentTypes.emit(n)}setFetchedPaymentTypes(e){this.userField&&(this.userField.user=this.pos?e.fromUser:e.toUser),this.fetchedPaymentTypes=e.paymentTypes;const t=e.paymentTypeData;t&&this.dataCache.set(t.id,t),this.adjustPaymentTypes()}fetchPaymentTypeData(e){const t=this.form.value;if(Object(s.h)(t.subject)||Object(s.h)(e))return;const n=this.dataCache.get(e);n?this.setPaymentTypeData(n):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(n=>{let i;i=this.pos?this.posService.dataForReceivePayment({from:t.subject,type:e,fields:["paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:t.subject,type:e,fields:["paymentTypeData"]}),i.pipe(Object(xn.a)()).subscribe(e=>{this.setPaymentTypeData(e.paymentTypeData)},e=>{fb.includes(e.status)||n(e)})}))}setPaymentTypeData(e){((this.paymentTypeData$.value||{}).id||null)!==((e||{}).id||null)&&(e&&(this.dataCache.set(e.id,e),Object(s.j)(this.amountField)),this.paymentTypeData$.next(e))}get fixedUsersList(){return!Object(s.h)(this.data.allowedUsers)}get allowQrCode(){return this.allowPrincipal&&this.data.allowScanQrCode}get allowPrincipal(){return!Object(s.h)(this.data.principalTypes)}get allowSearch(){return this.data.allowAutocomplete}get allowContacts(){return this.data.allowContacts}get singleAccount(){const e=this.data.accounts||[];return 1===e.length?e[0]:null}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(c.a),d.Kb(gn.a),d.Kb(pn.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["payment-step-form"]],viewQuery:function(e,t){var n;1&e&&(d.Hc(ku,!0),d.yc(Bu,!0)),2&e&&(d.pc(n=d.Yb())&&(t.userField=n.first),d.pc(n=d.Yb())&&(t.amountField=n.first))},inputs:{data:"data",pos:"pos",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[d.ub],decls:22,vars:29,consts:[[3,"formGroup"],["kind","field",3,"label",4,"ngIf"],[4,"ngIf","ngIfElse"],["multipleAccounts",""],["kind","field","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngSwitchCase"],[4,"ngSwitchCase"],[4,"ngIf"],["kind","field",3,"label"],[3,"user"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label",4,"ngIf"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label"],[1,"w-100","text-nowrap","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],["class","col-5 col-sm-4 col-md-7 pl-2 text-right text-xs-left font-weight-bold",3,"ngClass",4,"ngIf"],["separator",""],[1,"col-5","col-sm-4","col-md-7","pl-2","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["kind","fieldView",3,"label"],["formControlName","type","required","",3,"label"],["type",""],[3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsNow",3,"label"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","firstOccurrenceIsNow",3,"label"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(e,t){if(1&e&&(d.Ob(0,0),d.Bc(1,Au,2,2,"label-value",1),d.Bc(2,Ru,2,1,"ng-container",2),d.Bc(3,zu,3,3,"ng-template",null,3,d.Cc),d.Bc(5,Yu,4,3,"label-value",4),d.Bc(6,Wu,2,2,"label-value",5),d.Bc(7,eb,4,4,"single-selection-field",6),d.ac(8,"async"),d.Lb(9,"decimal-field",7,8),d.Bc(11,tb,1,2,"custom-field-input",9),d.ac(12,"async"),d.Bc(13,cb,5,5,"single-selection-field",10),d.ac(14,"async"),d.ac(15,"async"),d.Ob(16,11),d.Bc(17,rb,1,1,"date-field",12),d.Bc(18,sb,6,7,"ng-container",13),d.Bc(19,bb,9,12,"ng-container",13),d.Nb(),d.Bc(20,mb,2,1,"ng-container",14),d.ac(21,"async"),d.Nb()),2&e){const e=d.qc(4);var n,i,a,c=null;d.gc("formGroup",t.form),d.xb(1),d.gc("ngIf",t.fromUser&&!t.fromSelf),d.xb(1),d.gc("ngIf",t.singleAccount)("ngIfElse",e),d.xb(3),d.gc("ngIf",!t.fixedDestination),d.xb(1),d.gc("ngIf",t.fixedDestination&&t.toUser),d.xb(1),d.gc("ngIf",(null==(n=d.bc(8,19,t.paymentTypes$))?null:n.length)>1),d.xb(2),d.gc("focused",t.fixedDestination)("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix),d.xb(2),d.gc("ngForOf",null==(i=d.bc(12,21,t.paymentTypeData$))?null:i.customFields),d.xb(2),d.gc("ngIf",(null==(c=d.bc(14,23,t.paymentTypeData$))?null:c.allowsRecurringPayments)||(null==(c=d.bc(15,25,t.paymentTypeData$))?null:c.maxInstallments)>0),d.xb(3),d.gc("ngSwitch",t.form.value.scheduling),d.xb(1),d.gc("ngSwitchCase","futureDate"),d.xb(1),d.gc("ngSwitchCase","scheduled"),d.xb(1),d.gc("ngSwitchCase","recurring"),d.xb(1),d.gc("ngIf",(null==(a=d.bc(21,27,t.paymentTypeData$))?null:a.descriptionAvailability)||"disabled")}},directives:[x.w,x.n,f.t,Q.a,x.v,x.l,x.D,$n.a,f.s,f.x,f.y,v.a,P.a,f.q,Ci.a,x.A,x.e,D.a,L.a,F.a,Qi.a,x.k,C.a,I.a,Ii.a,Ti.a,ft.a],pipes:[f.b,O.a],encapsulation:2,changeDetection:0}),e})(),pb=(()=>{class e extends S.a{constructor(e,t){super(e),this.receiveQrPayment=t}ngOnInit(){super.ngOnInit(),this.payment.authorizationStatus===i.yb.PENDING?(this.icon="scheduled",this.message=this.payment.transactionNumber?this.i18n.transaction.pendingWithNumber(this.payment.transactionNumber):this.i18n.transaction.pending):(this.icon="done",this.message=this.payment.transactionNumber?this.i18n.transaction.processedWithNumber(this.payment.transactionNumber):this.i18n.transaction.processed),this.addShortcut(Nn.k,()=>this.receiveQrPayment.viewPerformed())}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r),d.Kb(ya))},e.\u0275cmp=d.Eb({type:e,selectors:[["receive-qr-payment-step-done"]],inputs:{payment:"payment"},features:[d.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4","positive"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(d.Qb(0,"div",0),d.Qb(1,"div",1),d.Qb(2,"div",2),d.Lb(3,"icon",3),d.Pb(),d.Qb(4,"div",4),d.Dc(5),d.Pb(),d.Pb(),d.Pb()),2&e&&(d.xb(3),d.gc("icon",t.icon),d.xb(2),d.Ec(t.message))},directives:[fi.a],encapsulation:2,changeDetection:0}),e})();const hb=["amount"];function yb(e,t){if(1&e&&d.Lb(0,"field-option",8),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.type.name)}}function xb(e,t){if(1&e&&(d.Qb(0,"radio-group-field",6),d.Bc(1,yb,1,2,"field-option",7),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.toAccount),d.xb(1),d.gc("ngForOf",e.data.accounts)}}function vb(e,t){if(1&e&&d.Lb(0,"field-option",8),2&e){const e=t.$implicit;d.gc("value",e.id)("text",e.name)}}function Pb(e,t){if(1&e&&(d.Qb(0,"single-selection-field",9),d.Bc(1,vb,1,2,"field-option",7),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.type),d.xb(1),d.gc("ngForOf",e.transferTypes)}}function Db(e,t){if(1&e&&d.Lb(0,"custom-field-input",11),2&e){const e=t.$implicit;d.gc("formControlName",e.internalName)("field",e)}}function Lb(e,t){if(1&e&&(d.Ob(0,0),d.Bc(1,Db,1,2,"custom-field-input",10),d.Nb()),2&e){const e=d.Zb();d.gc("formGroup",e.form.controls.customValues),d.xb(1),d.gc("ngForOf",e.typeData.customFields)}}function wb(e,t){if(1&e&&d.Lb(0,"textarea-field",12),2&e){const e=d.Zb();d.gc("label",e.i18n.general.description)("required","required"===(null==e.typeData?null:e.typeData.descriptionAvailability))}}let Cb=(()=>{class e extends S.a{constructor(e){super(e)}get singleAccount(){return 1===this.data.accounts.length}get currency(){return null==this.typeData?null:this.typeData.currency}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["receive-qr-payment-step-form"]],viewQuery:function(e,t){var n;1&e&&d.yc(hb,!0),2&e&&d.pc(n=d.Yb())&&(t.amountField=n.first)},inputs:{data:"data",form:"form",transferTypes:"transferTypes",type:"type",typeData:"typeData"},features:[d.ub],decls:6,vars:9,consts:[[3,"formGroup"],["formControlName","account","required","","asColumn","",3,"label",4,"ngIf"],["formControlName","type",3,"label",4,"ngIf"],["formControlName","amount","focused","","required","",3,"label","prefix","suffix","scale"],[3,"formGroup",4,"ngIf"],["formControlName","description",3,"label","required",4,"ngIf"],["formControlName","account","required","","asColumn","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","type",3,"label"],[3,"formControlName","field",4,"ngFor","ngForOf"],[3,"formControlName","field"],["formControlName","description",3,"label","required"]],template:function(e,t){1&e&&(d.Ob(0,0),d.Bc(1,xb,2,2,"radio-group-field",1),d.Bc(2,Pb,2,2,"single-selection-field",2),d.Lb(3,"decimal-field",3),d.Bc(4,Lb,2,2,"ng-container",4),d.Bc(5,wb,1,2,"textarea-field",5),d.Nb()),2&e&&(d.gc("formGroup",t.form),d.xb(1),d.gc("ngIf",!t.singleAccount),d.xb(1),d.gc("ngIf",(null==t.transferTypes?null:t.transferTypes.length)>1),d.xb(1),d.gc("label",t.i18n.transaction.amount)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix)("scale",null==t.currency?null:t.currency.decimalDigits),d.xb(1),d.gc("ngIf",(null==t.typeData||null==t.typeData.customFields?null:t.typeData.customFields.length)>0),d.xb(1),d.gc("ngIf","disabled"!==(null==t.typeData?null:t.typeData.descriptionAvailability)))},directives:[x.w,x.n,f.t,Q.a,x.v,x.l,$n.a,x.D,Ti.a,f.s,L.a,D.a,Qi.a,ft.a],encapsulation:2,changeDetection:0}),e})();function Qb(e,t){if(1&e){const e=d.Rb();d.Qb(0,"button",10),d.Xb("click",(function(){return d.sc(e),d.Zb(2).copyUrl()})),d.Lb(1,"icon",11),d.Pb()}if(2&e){const e=d.Zb(2);d.gc("tooltip",e.i18n.general.copyToClipboard)}}function Ib(e,t){if(1&e&&(d.Qb(0,"label-value",3),d.Qb(1,"div",8),d.Dc(2),d.Pb(),d.Bc(3,Qb,2,1,"button",9),d.Pb()),2&e){const e=d.Zb();d.gc("label",e.i18n.transaction.ticketShareUrl),d.xb(2),d.Ec(e.ticket.approveUrl)}}let Fb=(()=>{class e extends S.a{constructor(e){super(e),this.supportsShare=Object(s.C)()}copyUrl(){Object(s.f)(this.ticket.approveUrl),this.notification.snackBar(this.i18n.general.copyToClipboardDone)}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(d.r))},e.\u0275cmp=d.Eb({type:e,selectors:[["receive-qr-payment-step-pending"]],inputs:{ticket:"ticket",qrCodeUrl:"qrCodeUrl"},features:[d.ub],decls:10,vars:9,consts:[[1,"d-flex","justify-content-center","align-items-center"],[1,"mb-3",3,"src"],[3,"label","value"],[3,"label"],[1,"d-flex"],[1,"flex-grow-1"],["bootstrap","","size","1.5rem",1,"p-0","ml-2"],[3,"label",4,"ngIf"],[1,"w-100"],["class","btn btn-icon","type","button",3,"tooltip","click",4,"extraCell"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],["icon","link"]],template:function(e,t){1&e&&(d.Qb(0,"div",0),d.Lb(1,"img",1),d.ac(2,"trust"),d.Pb(),d.Lb(3,"label-value",2),d.Qb(4,"label-value",3),d.Qb(5,"div",4),d.Qb(6,"div",5),d.Dc(7),d.Pb(),d.Lb(8,"spinner",6),d.Pb(),d.Pb(),d.Bc(9,Ib,4,2,"label-value",7)),2&e&&(d.xb(1),d.gc("src",d.cc(2,6,t.qrCodeUrl,"url"),d.uc),d.xb(2),d.gc("label",t.i18n.transaction.amount)("value",t.format.formatAsCurrency(t.ticket.currency,t.ticket.amount)),d.xb(1),d.gc("label",t.i18n.general.status),d.xb(3),d.Ec(t.i18n.transaction.status.pending),d.xb(2),d.gc("ngIf",!t.supportsShare))},directives:[v.a,H.a,f.t,es.a,kn.b,fi.a],pipes:[nl.a],encapsulation:2,changeDetection:0}),e})();var Tb=n("Se2V"),Sb=n("CNMR"),Ob=n("aHM3"),Nb=n("6No5"),kb=n("38Bd"),Bb=n("p4Ho"),Ab=n("FE24"),Eb=n("GTjh"),$b=n("7Ub2"),Rb=n("yThH"),Zb=n("vdzA"),Mb=n("o/nJ"),Hb=n("AH7H"),qb=n("lrfU"),Ub=n("aVfl"),Vb=n("G1xJ"),zb=n("VpKs"),jb=n("yk18"),Gb=n("nGVv"),_b=n("559x"),Kb=n("0C6t"),Xb=n("z332"),Yb=n("pz1b"),Wb=n("bER3"),Jb=n("ZJXG"),ed=n("wUcZ"),td=n("yRWz"),nd=n("/edM"),id=n("vHbw"),ad=n("USuC"),cd=n("Y49Y"),rd=n("2V/7"),od=n("HZ9B"),sd=n("g9Ug"),ld=n("jOM4"),ud=n("DFH8"),bd=n("csas"),dd=n("p60g"),md=n("8pf7"),fd=n("UnhA"),gd=n("N7zh"),pd=n("sGzL"),hd=n("eNTF"),yd=n("Kiu2"),xd=n("vOpc"),vd=n("T6RQ"),Pd=n("U4Kh"),Dd=n("ugYG"),Ld=n("MNyf"),wd=n("CyT4"),Cd=n("x741"),Qd=n("BTg0"),Id=n("BUNh"),Fd=n("podT"),Td=n("oOvo"),Sd=n("L/K/"),Od=n("7nZW"),Nd=n("9uOH"),kd=n("dCJh"),Bd=n("g1uo"),Ad=n("cLCZ"),Ed=n("kmyw"),$d=n("/NTq");let Rd=(()=>{class e{}return e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({factory:function(t){return new(t||e)},imports:[[nu,Tb.a]]}),e})();d.vc(Sn,[V.j,V.f,V.h,V.g,V.k,f.q,f.r,f.s,f.t,f.A,f.w,f.x,f.y,f.z,f.u,f.v,x.I,x.x,x.H,x.e,x.y,x.B,x.b,x.E,x.F,x.A,x.v,x.w,x.D,x.r,x.q,x.z,x.c,x.f,x.k,x.n,x.l,x.o,x.h,Sb.a,Jo.c,Jo.d,Ob.a,Ob.b,Ob.c,Nb.a,Nb.b,kb.a,kb.b,Bb.a,kn.b,Ab.b,Ab.d,Ab.a,Eb.b,$b.a,Rb.a,Bn.a,Zb.a,fi.a,mr.a,U.a,H.a,dt.a,Mb.a,En.a,v.a,es.a,Hb.a,Ro.a,An.a,Fi.a,I.a,qb.a,Ub.a,Vb.a,zb.a,jb.a,ft.a,Ci.a,L.a,D.a,w.a,Gb.a,Ti.a,_b.a,C.a,Kb.a,Q.a,Qi.a,Oe.a,Se.a,Xb.a,Yb.a,Wb.a,Jb.a,ed.a,td.a,nd.a,F.a,id.a,ad.a,cd.a,rd.a,od.a,sd.a,Wo.a,ld.a,ud.a,bd.a,mt.a,$n.a,Ii.a,T.a,dd.a,md.a,fd.a,gd.a,pd.a,hd.a,yd.a,P.a,ht.a,xd.a,vd.a,Pd.a,Dd.a,Ld.a,wd.a,Ae.a,q.a,Cd.a,m.a,g.a,Qd.a,Id.a,Fd.a,p.a,Td.a,Sd.a,y.a,h.a,Od.a,Fe.a,Nd.a,Te.a,Ie.a,kd.a,Ce,M,Co,dr,Hc,Lo,st,Be,nc,Nc,ka,El,Yr,Sn,gb,Ou,Nu,ya,Cb,Fb,pb,Yo,Cs,Oo,$o,Uo,ps,vl,Ms,tl,Ks,eu,Ml,ql,jl,Ht,pt,Pt,Bt,fn,Vt,_t,sn,la,aa,gi,Pi,mi],[f.b,f.G,f.p,f.k,f.E,f.g,f.C,f.F,f.d,f.f,f.i,f.j,f.l,nl.a,z.a,Bc.a,Bd.a,Ad.a,O.a,Ed.a,$d.a]),d.vc(ya,[V.j,V.f,V.h,V.g,V.k,f.q,f.r,f.s,f.t,f.A,f.w,f.x,f.y,f.z,f.u,f.v,x.I,x.x,x.H,x.e,x.y,x.B,x.b,x.E,x.F,x.A,x.v,x.w,x.D,x.r,x.q,x.z,x.c,x.f,x.k,x.n,x.l,x.o,x.h,Sb.a,Jo.c,Jo.d,Ob.a,Ob.b,Ob.c,Nb.a,Nb.b,kb.a,kb.b,Bb.a,kn.b,Ab.b,Ab.d,Ab.a,Eb.b,$b.a,Rb.a,Bn.a,Zb.a,fi.a,mr.a,U.a,H.a,dt.a,Mb.a,En.a,v.a,es.a,Hb.a,Ro.a,An.a,Fi.a,I.a,qb.a,Ub.a,Vb.a,zb.a,jb.a,ft.a,Ci.a,L.a,D.a,w.a,Gb.a,Ti.a,_b.a,C.a,Kb.a,Q.a,Qi.a,Oe.a,Se.a,Xb.a,Yb.a,Wb.a,Jb.a,ed.a,td.a,nd.a,F.a,id.a,ad.a,cd.a,rd.a,od.a,sd.a,Wo.a,ld.a,ud.a,bd.a,mt.a,$n.a,Ii.a,T.a,dd.a,md.a,fd.a,gd.a,pd.a,hd.a,yd.a,P.a,ht.a,xd.a,vd.a,Pd.a,Dd.a,Ld.a,wd.a,Ae.a,q.a,Cd.a,m.a,g.a,Qd.a,Id.a,Fd.a,p.a,Td.a,Sd.a,y.a,h.a,Od.a,Fe.a,Nd.a,Te.a,Ie.a,kd.a,Ce,M,Co,dr,Hc,Lo,st,Be,nc,Nc,ka,El,Yr,Sn,gb,Ou,Nu,ya,Cb,Fb,pb,Yo,Cs,Oo,$o,Uo,ps,vl,Ms,tl,Ks,eu,Ml,ql,jl,Ht,pt,Pt,Bt,fn,Vt,_t,sn,la,aa,gi,Pi,mi],[f.b,f.G,f.p,f.k,f.E,f.g,f.C,f.F,f.d,f.f,f.i,f.j,f.l,nl.a,z.a,Bc.a,Bd.a,Ad.a,O.a,Ed.a,$d.a])},v4xg:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("s7LF"),a=n("mwYl"),c=n("tAww"),r=n("rCAV"),o=n("uuU0"),s=n("Ky6R"),l=n("TFmz"),u=n("Muja"),b=n("2Vo4"),d=n("Kj3r"),m=n("8Y7J");let f=(()=>{class e extends o.a{constructor(e){super(e),this.ResultType=l.a,this.resultType$=new b.a(null),this.resultTypeControl=new i.j(null),this.results$=new b.a(null),this.allowedResultTypes$=new b.a([l.a.LIST]),this.rendering$=new b.a(!1),this.moreFilters$=new b.a(!1),this.ignoreNextUpdate=!1,this.nextRequestState=e.get(a.a);const t={page:0};t.resultType=this.getInitialResultType();for(const n of this.getFormControlNames()||[])t[n]=null;this.form=this.formBuilder.group(t)}getInitialFormValue(e){return e.query||{}}onDataInitialized(e){this.form.patchValue(this.getInitialFormValue(e)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe(e=>{const t=this.previousResultType;this.previousResultType=e,this.resultType$.next(e),this.shouldUpdateOnResultTypeChange(e,t)&&this.update(),null!=t&&t===e||(this.rendering=!0,this.stateManager.set("resultType",e),this.onResultTypeChanged(e,t))})),setTimeout(()=>{this.addSub(this.form.valueChanges.pipe(Object(d.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>{this.shouldUpdateOnChange(e)&&this.update(),this.previousValue=e}),!0),this.previousResultType!==l.a.CATEGORIES&&this.update()},1)}shouldUpdateOnResultTypeChange(e,t){return e!==l.a.CATEGORIES&&([l.a.LIST,l.a.TILES].includes(t)!==[l.a.LIST,l.a.TILES].includes(e)||t===l.a.MAP!=(e===l.a.MAP))}shouldUpdateOnChange(e){return!Object(u.a)(this.previousValue,e)}get results(){return this.results$.value}set results(e){this.results$.next(e)}get rendering(){return this.rendering$.value}set rendering(e){this.rendering$.next(e)}get allowedResultTypes(){return this.allowedResultTypes$.value}set allowedResultTypes(e){this.allowedResultTypes$.next(e)}get moreFilters(){return this.moreFilters$.value}set moreFilters(e){this.moreFilters$.next(e)}get pageData(){const e=this.form.value;return{page:e.page,pageSize:e.pageSize}}set pageData(e){this.form.patchValue(e)}get resultType(){return this.resultTypeControl.value}set resultType(e){null==e&&(e=this.getInitialResultType()),this.resultTypeControl.setValue(e)}ngOnInit(){super.ngOnInit(),this.resultType=this.getInitialResultType()}get moreFiltersAction(){return this._moreFiltersAction||(this._moreFiltersAction=new c.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),()=>{this.moreFilters=!this.moreFilters,this._moreFiltersAction.icon=this.moreFilters?this.showLessFiltersIcon():this.showMoreFiltersIcon(),this._moreFiltersAction.label=this.moreFilters?this.showLessFiltersLabel():this.showMoreFiltersLabel()},!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}showMoreFiltersLabel(){return this.i18n.general.showMoreFilters}showLessFiltersLabel(){return this.i18n.general.showLessFilters}showMoreFiltersIcon(){return"filter_list"}showLessFiltersIcon(){return"filter_list"}onResultTypeChanged(e,t){}getInitialResultType(){return l.a.LIST}update(e){if(this.ignoreNextUpdate)return;e&&(this.form.patchValue(e,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;const t=this.form.value;t.pageSize=this.uiLayout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(t)).subscribe(e=>{this.resultType===l.a.CATEGORIES&&(this.resultType=this.allowedResultTypes.find(e=>e!==l.a.CATEGORIES)),this.results=s.a.from(e)}))}resetPage(e=!1){this.form.patchValue({page:0},{emitEvent:e})}doIgnoringUpdate(e){this.ignoreNextUpdate=!0;try{e()}finally{this.ignoreNextUpdate=!1}}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275dir=m.Fb({type:e,features:[m.ub]}),e})()}}]);