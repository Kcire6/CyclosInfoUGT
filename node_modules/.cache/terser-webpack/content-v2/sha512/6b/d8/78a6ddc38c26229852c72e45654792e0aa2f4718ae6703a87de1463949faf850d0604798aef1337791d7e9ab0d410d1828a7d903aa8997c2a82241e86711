{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{WjKW:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"OperationsModule\",(function(){return operations_module_OperationsModule}));var router=__webpack_require__(\"iInd\"),logged_user_guard=__webpack_require__(\"IbW5\"),models=__webpack_require__(\"XDzf\"),operations_service=__webpack_require__(\"J6cT\"),base_page_component=__webpack_require__(\"uuU0\"),menu=__webpack_require__(\"QH++\"),core=__webpack_require__(\"8Y7J\"),page_layout_component=__webpack_require__(\"3qho\"),common=__webpack_require__(\"SVse\"),page_content_component=__webpack_require__(\"I0FJ\"),ngx_bootstrap_alert=__webpack_require__(\"CNMR\");function OperationCallbackComponent_page_content_2_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"page-content\",2),core.Qb(1,\"alert\",3),core.Qb(2,\"div\",4),core.Dc(3),core.Pb(),core.Pb(),core.Pb()),2&rf){const ctx_r0=core.Zb();core.gc(\"heading\",ctx_r0.data.title)(\"mobileHeading\",ctx_r0.i18n.operation.mobileTitle.result),core.xb(1),core.gc(\"type\",ctx_r0.alertType),core.xb(2),core.Ec(ctx_r0.data.notification)}}let operation_callback_component_OperationCallbackComponent=(()=>{class OperationCallbackComponent extends base_page_component.a{constructor(injector,operationsService){super(injector),this.operationsService=operationsService,this.alertType=\"success\"}ngOnInit(){const route=this.route.snapshot;super.ngOnInit(),this.addSub(this.operationsService.runCustomOperationCallback({id:route.params.id,token:route.params.token,body:{method:\"GET\",parameters:route.queryParams}}).subscribe(result=>{result.notificationLevel===models.K.WARNING?this.alertType=\"warning\":result.notificationLevel===models.K.ERROR&&(this.alertType=\"danger\"),this.data=result}))}resolveMenu(){return this.login.user?menu.b.DASHBOARD:menu.b.HOME}}return OperationCallbackComponent.ɵfac=function(t){return new(t||OperationCallbackComponent)(core.Kb(core.r),core.Kb(operations_service.a))},OperationCallbackComponent.ɵcmp=core.Eb({type:OperationCallbackComponent,selectors:[[\"operation-callback\"]],features:[core.ub],decls:3,vars:4,consts:[[3,\"ready\"],[\"last\",\"\",3,\"heading\",\"mobileHeading\",4,\"ngIf\"],[\"last\",\"\",3,\"heading\",\"mobileHeading\"],[3,\"type\"],[1,\"break-nl\"]],template:function(rf,ctx){1&rf&&(core.Qb(0,\"page-layout\",0),core.ac(1,\"async\"),core.Bc(2,OperationCallbackComponent_page_content_2_Template,4,4,\"page-content\",1),core.Pb()),2&rf&&(core.gc(\"ready\",core.bc(1,2,ctx.data$)),core.xb(2),core.gc(\"ngIf\",ctx.data))},directives:[page_layout_component.a,common.t,page_content_component.a,ngx_bootstrap_alert.a],pipes:[common.b],encapsulation:2,changeDetection:0}),OperationCallbackComponent})();var OperationRunScope=function(OperationRunScope){return OperationRunScope.User=\"user\",OperationRunScope.Ad=\"ad\",OperationRunScope.Record=\"record\",OperationRunScope.Transfer=\"transfer\",OperationRunScope.Standalone=\"standalone\",OperationRunScope}({}),field_helper_service=__webpack_require__(\"OoS4\"),next_request_state=__webpack_require__(\"mwYl\"),operation_helper_service=__webpack_require__(\"Ewue\"),shared_action=__webpack_require__(\"tAww\"),api_helper=__webpack_require__(\"rCAV\"),helper=__webpack_require__(\"ObUu\"),paged_results=__webpack_require__(\"Ky6R\"),BehaviorSubject=__webpack_require__(\"2Vo4\"),first=__webpack_require__(\"SxV6\"),tap=__webpack_require__(\"vkgz\"),actions_component=__webpack_require__(\"UXR7\"),action_button_component=__webpack_require__(\"OTwK\"),results_layout_component=__webpack_require__(\"Zilp\"),mobile_result_directive=__webpack_require__(\"IbGL\"),result_table_directive=__webpack_require__(\"Ae/X\"),mobile_result_component=__webpack_require__(\"iM3x\"),label_value_component=__webpack_require__(\"JFlR\"),fesm2015_forms=__webpack_require__(\"s7LF\"),custom_field_input_component=__webpack_require__(\"Y+zs\"),focused_directive=__webpack_require__(\"bBjs\"),file_field_component=__webpack_require__(\"ZJXG\"),chip_component=__webpack_require__(\"HZ9B\"),trust_pipe=__webpack_require__(\"cyUc\");function RunOperationComponent_ng_container_2_Template(rf,ctx){1&rf&&core.Mb(0)}function RunOperationComponent_ng_template_3_ng_container_0_ng_container_3_Template(rf,ctx){1&rf&&core.Mb(0)}function RunOperationComponent_ng_template_3_ng_container_0_actions_4_Template(rf,ctx){if(1&rf){const _r14=core.Rb();core.Qb(0,\"actions\",11),core.Qb(1,\"action-button\",12),core.Xb(\"action\",(function(){return core.sc(_r14),core.Zb(3).run()})),core.ac(2,\"async\"),core.Pb(),core.Pb()}if(2&rf){const ctx_r11=core.Zb(3);core.xb(1),core.gc(\"disabled\",core.bc(2,2,ctx_r11.requesting$))(\"label\",ctx_r11.data.customSubmitLabel||ctx_r11.i18n.general.submit)}}function RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_mobile_result_1_label_value_1_Template(rf,ctx){if(1&rf&&core.Lb(0,\"label-value\",17),2&rf){const col_r19=ctx.$implicit,row_r17=core.Zb().$implicit;core.gc(\"label\",col_r19.header)(\"value\",row_r17[col_r19.property])}}function RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_mobile_result_1_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"mobile-result\"),core.Bc(1,RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_mobile_result_1_label_value_1_Template,1,2,\"label-value\",16),core.ac(2,\"async\"),core.Pb()),2&rf){const ctx_r15=core.Zb(4);var tmp_0_0;core.xb(1),core.gc(\"ngForOf\",null==(tmp_0_0=core.bc(2,1,ctx_r15.result$))?null:tmp_0_0.columns)}}const _c0=function(a0,a1){return{textAlign:a0,width:a1}};function RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_th_2_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"th\",21),core.Dc(1),core.Pb()),2&rf){const col_r23=ctx.$implicit;core.gc(\"ngStyle\",core.kc(2,_c0,col_r23.align,col_r23.width)),core.xb(1),core.Fc(\" \",col_r23.header,\" \")}}const _c1=function(a0){return{textAlign:a0}};function RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_tr_5_td_1_Template(rf,ctx){if(1&rf&&(core.Lb(0,\"td\",24),core.ac(1,\"trust\")),2&rf){const col_r26=ctx.$implicit,row_r24=core.Zb().$implicit;core.gc(\"ngStyle\",core.jc(4,_c1,col_r26.align))(\"innerHTML\",core.bc(1,2,row_r24[col_r26.property]),core.tc)}}function RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_tr_5_Template(rf,ctx){if(1&rf){const _r29=core.Rb();core.Qb(0,\"tr\",22),core.Xb(\"click\",(function(){core.sc(_r29);const row_r24=ctx.$implicit;return core.Zb(5).rowClick(row_r24)})),core.Bc(1,RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_tr_5_td_1_Template,2,6,\"td\",23),core.ac(2,\"async\"),core.Pb()}if(2&rf){const ctx_r22=core.Zb(5);var tmp_0_0;core.xb(1),core.gc(\"ngForOf\",null==(tmp_0_0=core.bc(2,1,ctx_r22.result$))?null:tmp_0_0.columns)}}const _c2=function(a0){return{\"cursor-pointer\":a0}};function RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"table\",18),core.Qb(1,\"thead\"),core.Bc(2,RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_th_2_Template,2,5,\"th\",19),core.ac(3,\"async\"),core.Pb(),core.Qb(4,\"tbody\"),core.Bc(5,RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_tr_5_Template,3,3,\"tr\",20),core.ac(6,\"async\"),core.Pb(),core.Pb()),2&rf){const ctx_r16=core.Zb(4);var tmp_1_0,tmp_2_0;core.gc(\"ngClass\",core.jc(7,_c2,ctx_r16.data.rowAction)),core.xb(2),core.gc(\"ngForOf\",null==(tmp_1_0=core.bc(3,3,ctx_r16.result$))?null:tmp_1_0.columns),core.xb(3),core.gc(\"ngForOf\",null==(tmp_2_0=core.bc(6,5,ctx_r16.result$))?null:tmp_2_0.rows)}}function RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_Template(rf,ctx){if(1&rf){const _r31=core.Rb();core.Qb(0,\"results-layout\",13),core.Xb(\"update\",(function($event){return core.sc(_r31),core.Zb(3).updatePage($event)})),core.Bc(1,RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_mobile_result_1_Template,3,3,\"mobile-result\",14),core.Bc(2,RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_table_2_Template,7,9,\"table\",15),core.Pb()}if(2&rf){const ctx_r12=core.Zb(3);core.gc(\"results\",ctx_r12.pageResults)(\"onClick\",ctx_r12.onClick)}}function RunOperationComponent_ng_template_3_ng_container_0_Template(rf,ctx){if(1&rf&&(core.Ob(0),core.Qb(1,\"page-content\",7),core.ac(2,\"async\"),core.Bc(3,RunOperationComponent_ng_template_3_ng_container_0_ng_container_3_Template,1,0,\"ng-container\",8),core.Bc(4,RunOperationComponent_ng_template_3_ng_container_0_actions_4_Template,3,4,\"actions\",9),core.Pb(),core.Bc(5,RunOperationComponent_ng_template_3_ng_container_0_results_layout_5_Template,3,2,\"results-layout\",10),core.ac(6,\"async\"),core.Nb()),2&rf){const ctx_r9=core.Zb(2),_r5=core.qc(8);core.xb(1),core.gc(\"mode\",ctx_r9.hasSearchFields?\"filters\":\"emptyFilters\")(\"heading\",ctx_r9.data.name)(\"mobileHeading\",ctx_r9.data.label)(\"headingActions\",core.bc(2,7,ctx_r9.headingActions$)),core.xb(2),core.gc(\"ngTemplateOutlet\",_r5),core.xb(1),core.gc(\"ngIf\",!ctx_r9.runDirectly),core.xb(1),core.gc(\"ngIf\",core.bc(6,9,ctx_r9.pageResults$))}}function RunOperationComponent_ng_template_3_Template(rf,ctx){if(1&rf&&core.Bc(0,RunOperationComponent_ng_template_3_ng_container_0_Template,7,11,\"ng-container\",6),2&rf){const ctx_r2=core.Zb(),_r3=core.qc(6);core.gc(\"ngIf\",ctx_r2.isSearch)(\"ngIfElse\",_r3)}}function RunOperationComponent_ng_template_5_page_content_0_alert_1_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"alert\",31),core.Lb(1,\"div\",32),core.ac(2,\"trust\"),core.Pb()),2&rf){const ctx_r34=core.Zb(3);core.xb(1),core.gc(\"innerHTML\",core.bc(2,1,ctx_r34.data.informationText),core.tc)}}function RunOperationComponent_ng_template_5_page_content_0_ng_container_2_Template(rf,ctx){1&rf&&core.Mb(0)}function RunOperationComponent_ng_template_5_page_content_0_actions_3_Template(rf,ctx){if(1&rf){const _r39=core.Rb();core.Qb(0,\"actions\"),core.Qb(1,\"action-button\",12),core.Xb(\"action\",(function(){return core.sc(_r39),core.Zb(3).run()})),core.ac(2,\"async\"),core.Pb(),core.Pb()}if(2&rf){const ctx_r36=core.Zb(3);core.xb(1),core.gc(\"disabled\",core.bc(2,2,ctx_r36.requesting$))(\"label\",ctx_r36.data.customSubmitLabel||ctx_r36.i18n.general.submit)}}function RunOperationComponent_ng_template_5_page_content_0_div_5_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"div\",33),core.Dc(1),core.Pb()),2&rf){const ctx_r37=core.Zb(3);core.xb(1),core.Fc(\" \",ctx_r37.i18n.operation.redirecting,\" \")}}function RunOperationComponent_ng_template_5_page_content_0_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"page-content\",27),core.Bc(1,RunOperationComponent_ng_template_5_page_content_0_alert_1_Template,3,3,\"alert\",28),core.Bc(2,RunOperationComponent_ng_template_5_page_content_0_ng_container_2_Template,1,0,\"ng-container\",8),core.Bc(3,RunOperationComponent_ng_template_5_page_content_0_actions_3_Template,3,4,\"actions\",29),core.ac(4,\"async\"),core.Bc(5,RunOperationComponent_ng_template_5_page_content_0_div_5_Template,2,1,\"div\",30),core.ac(6,\"async\"),core.Pb()),2&rf){const ctx_r32=core.Zb(2),_r5=core.qc(8);core.gc(\"heading\",ctx_r32.data.name)(\"mobileHeading\",ctx_r32.data.label),core.xb(1),core.gc(\"ngIf\",ctx_r32.data.informationText),core.xb(1),core.gc(\"ngTemplateOutlet\",_r5),core.xb(1),core.gc(\"ngIf\",!1===core.bc(4,6,ctx_r32.redirecting$)),core.xb(2),core.gc(\"ngIf\",core.bc(6,8,ctx_r32.redirecting$))}}function RunOperationComponent_ng_template_5_page_content_2_ng_container_2_ng_container_1_Template(rf,ctx){1&rf&&core.Mb(0)}function RunOperationComponent_ng_template_5_page_content_2_ng_container_2_Template(rf,ctx){if(1&rf&&(core.Ob(0),core.Bc(1,RunOperationComponent_ng_template_5_page_content_2_ng_container_2_ng_container_1_Template,1,0,\"ng-container\",8),core.Nb()),2&rf){core.Zb(3);const _r7=core.qc(10);core.xb(1),core.gc(\"ngTemplateOutlet\",_r7)}}function RunOperationComponent_ng_template_5_page_content_2_div_3_Template(rf,ctx){if(1&rf&&(core.Lb(0,\"div\",32),core.ac(1,\"trust\")),2&rf){const ctx_r41=core.Zb(3);core.gc(\"innerHTML\",core.bc(1,1,ctx_r41.result.content),core.tc)}}function RunOperationComponent_ng_template_5_page_content_2_div_4_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"div\",37),core.Dc(1),core.Pb()),2&rf){const ctx_r42=core.Zb(3);core.xb(1),core.Fc(\" \",ctx_r42.result.content,\"\")}}function RunOperationComponent_ng_template_5_page_content_2_actions_5_Template(rf,ctx){if(1&rf){const _r46=core.Rb();core.Qb(0,\"actions\"),core.Qb(1,\"action-button\",12),core.Xb(\"action\",(function(){return core.sc(_r46),core.Zb(3).reload()})),core.ac(2,\"async\"),core.Pb(),core.Pb()}if(2&rf){const ctx_r43=core.Zb(3);core.xb(1),core.gc(\"disabled\",core.bc(2,2,ctx_r43.requesting$))(\"label\",ctx_r43.i18n.general.close)}}function RunOperationComponent_ng_template_5_page_content_2_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"page-content\",34),core.ac(1,\"async\"),core.Bc(2,RunOperationComponent_ng_template_5_page_content_2_ng_container_2_Template,2,1,\"ng-container\",29),core.Bc(3,RunOperationComponent_ng_template_5_page_content_2_div_3_Template,2,3,\"div\",35),core.Bc(4,RunOperationComponent_ng_template_5_page_content_2_div_4_Template,2,1,\"div\",36),core.Bc(5,RunOperationComponent_ng_template_5_page_content_2_actions_5_Template,3,4,\"actions\",29),core.Pb()),2&rf){const ctx_r33=core.Zb(2);core.gc(\"heading\",ctx_r33.result.title||ctx_r33.data.name)(\"mobileHeading\",ctx_r33.i18n.operation.mobileTitle.result)(\"headingActions\",core.bc(1,7,ctx_r33.headingActions$)),core.xb(2),core.gc(\"ngIf\",ctx_r33.runDirectly),core.xb(1),core.gc(\"ngIf\",\"richText\"===ctx_r33.result.resultType),core.xb(1),core.gc(\"ngIf\",\"plainText\"===ctx_r33.result.resultType),core.xb(1),core.gc(\"ngIf\",!ctx_r33.runDirectly)}}function RunOperationComponent_ng_template_5_Template(rf,ctx){if(1&rf&&(core.Bc(0,RunOperationComponent_ng_template_5_page_content_0_Template,7,10,\"page-content\",25),core.ac(1,\"async\"),core.Bc(2,RunOperationComponent_ng_template_5_page_content_2_Template,6,9,\"page-content\",26),core.ac(3,\"async\")),2&rf){const ctx_r4=core.Zb();core.gc(\"ngIf\",ctx_r4.data&&!ctx_r4.runDirectly&&null===core.bc(1,2,ctx_r4.result$)),core.xb(2),core.gc(\"ngIf\",ctx_r4.isContent&&core.bc(3,4,ctx_r4.result$))}}function RunOperationComponent_ng_template_7_ng_container_1_Template(rf,ctx){1&rf&&core.Mb(0)}function RunOperationComponent_ng_template_7_ng_container_2_Template(rf,ctx){if(1&rf&&(core.Ob(0),core.Lb(1,\"custom-field-input\",41),core.Nb()),2&rf){const cf_r50=ctx.$implicit,first_r51=ctx.first,ctx_r48=core.Zb(2);core.xb(1),core.gc(\"field\",cf_r50)(\"formControlName\",cf_r50.internalName)(\"focused\",!ctx_r48.isSearch&&first_r51)(\"labelPosition\",ctx_r48.isSearch?\"left\":\"auto\")}}function RunOperationComponent_ng_template_7_file_field_3_Template(rf,ctx){if(1&rf&&core.Lb(0,\"file-field\",42),2&rf){const ctx_r49=core.Zb(2);core.gc(\"label\",ctx_r49.i18n.operation.fileUpload)(\"formControl\",ctx_r49.fileControl)}}function RunOperationComponent_ng_template_7_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"form\",38),core.Bc(1,RunOperationComponent_ng_template_7_ng_container_1_Template,1,0,\"ng-container\",8),core.Bc(2,RunOperationComponent_ng_template_7_ng_container_2_Template,2,4,\"ng-container\",39),core.Bc(3,RunOperationComponent_ng_template_7_file_field_3_Template,1,2,\"file-field\",40),core.Pb()),2&rf){const ctx_r6=core.Zb(),_r7=core.qc(10);core.gc(\"formGroup\",ctx_r6.form),core.xb(1),core.gc(\"ngTemplateOutlet\",_r7),core.xb(1),core.gc(\"ngForOf\",ctx_r6.formFields),core.xb(1),core.gc(\"ngIf\",ctx_r6.data.hasFileUpload)}}function RunOperationComponent_ng_template_9_label_value_0_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"label-value\",45),core.Qb(1,\"chip\",46),core.Dc(2),core.Pb(),core.Pb()),2&rf){const ctx_r52=core.Zb(2);core.gc(\"label\",ctx_r52.i18n.general.user),core.xb(1),core.gc(\"image\",ctx_r52.data.user.image)(\"closeable\",!1),core.xb(1),core.Fc(\" \",ctx_r52.data.user.display,\" \")}}function RunOperationComponent_ng_template_9_label_value_1_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"label-value\",45),core.Qb(1,\"chip\",46),core.Dc(2),core.Pb(),core.Pb()),2&rf){const ctx_r53=core.Zb(2);core.gc(\"label\",ctx_r53.i18n.operation.ad),core.xb(1),core.gc(\"image\",ctx_r53.data.ad.image)(\"closeable\",!0),core.xb(1),core.Fc(\" \",ctx_r53.data.ad.name,\" \")}}function RunOperationComponent_ng_template_9_label_value_2_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"label-value\",47),core.Qb(1,\"chip\"),core.Dc(2),core.Pb(),core.Pb()),2&rf){const ctx_r54=core.Zb(2);core.gc(\"label\",ctx_r54.i18n.operation.transfer),core.xb(2),core.Fc(\" \",ctx_r54.data.transfer.display,\" \")}}function RunOperationComponent_ng_template_9_hr_3_Template(rf,ctx){1&rf&&core.Lb(0,\"hr\")}function RunOperationComponent_ng_template_9_Template(rf,ctx){if(1&rf&&(core.Bc(0,RunOperationComponent_ng_template_9_label_value_0_Template,3,4,\"label-value\",43),core.Bc(1,RunOperationComponent_ng_template_9_label_value_1_Template,3,4,\"label-value\",43),core.Bc(2,RunOperationComponent_ng_template_9_label_value_2_Template,3,2,\"label-value\",44),core.Bc(3,RunOperationComponent_ng_template_9_hr_3_Template,1,0,\"hr\",29)),2&rf){const ctx_r8=core.Zb();core.gc(\"ngIf\",ctx_r8.data.user&&ctx_r8.data.user.id!==ctx_r8.login.user.id),core.xb(1),core.gc(\"ngIf\",ctx_r8.data.ad),core.xb(1),core.gc(\"ngIf\",ctx_r8.data.transfer),core.xb(1),core.gc(\"ngIf\",ctx_r8.data.user&&ctx_r8.data.user.id!==ctx_r8.login.user.id||ctx_r8.data.ad||ctx_r8.data.transfer)}}let run_operation_component_RunOperationComponent=(()=>{class RunOperationComponent extends base_page_component.a{constructor(injector,fieldsHelper,operationHelper,nextRequestState,operationsService){super(injector),this.fieldsHelper=fieldsHelper,this.operationHelper=operationHelper,this.nextRequestState=nextRequestState,this.operationsService=operationsService,this.result$=new BehaviorSubject.a(null),this.pageResults$=new BehaviorSubject.a(null),this.redirecting$=new BehaviorSubject.a(!1)}get result(){return this.result$.value}get pageResults(){return this.pageResults$.value}ngOnInit(){super.ngOnInit();const route=this.route.snapshot;if(this.runScope=route.data.runScope,this.userParam=route.params.user,!this.runScope)throw new Error(\"No runScope on \"+route.url);const params={operation:route.params.operation};let request;switch(this.createDeviceConfirmation=()=>({type:models.s.RUN_OPERATION,operation:this.data.id}),this.runScope){case OperationRunScope.User:this.scopeId=params.owner=route.params.user||this.login.user.id,request=this.operationsService.getOwnerOperationDataForRun(params);break;case OperationRunScope.Ad:this.scopeId=params.ad=route.params.ad,request=this.operationsService.getAdOperationDataForRun(params);break;case OperationRunScope.Record:this.scopeId=params.id=route.params.record,request=this.operationsService.getRecordOperationDataForRun(params);break;case OperationRunScope.Transfer:this.scopeId=params.key=route.params.transfer,request=this.operationsService.getTransferOperationDataForRun(params);break;default:request=this.operationsService.getOperationDataForRun(params)}this.nextRequestState.queryParams=route.queryParams,this.leaveNotification=this.nextRequestState.leaveNotification,this.addSub(request.subscribe(data=>{this.data=data}))}onDataInitialized(data){this.runScope===OperationRunScope.User&&(this.self=this.authHelper.isSelf(data.user)),this.isSearch=data.resultType===models.M.RESULT_PAGE,this.isContent=[models.M.PLAIN_TEXT,models.M.RICH_TEXT].includes(data.resultType);const formFields=data.formParameters||[];if(this.form=this.fieldsHelper.customValuesFormGroup(formFields),this.fileControl=this.formBuilder.control(null),this.runDirectly=this.operationHelper.canRunDirectly(data,!1),this.hasSearchFields=formFields.length>0||data.hasFileUpload,formFields.length>0){const queryParams=this.route.snapshot.queryParamMap;this.formFields=[];for(const field of formFields){const value=queryParams.get(field.internalName);if(Object(helper.h)(value))this.formFields.push(field);else{const patch={};patch[field.internalName]=value,this.form.patchValue(patch,{emitEvent:!1})}}}this.isSearch&&(this.stateManager.manage(this.form),this.pageData={page:0,pageSize:this.uiLayout.searchPageSize}),this.operationHelper.register(data.rowOperation),this.runDirectly&&(this.nextRequestState.leaveNotification=this.leaveNotification,this.isSearch&&this.addSub(this.form.valueChanges.subscribe(()=>this.run(data))),this.run(data))}run(data){(data||(data=this.data))&&(Object(helper.F)(this.form),this.form.valid&&(!Object(helper.h)(data.confirmationText)||data.confirmationPasswordInput?this.notification.confirm({title:data.name,message:data.confirmationText,createDeviceConfirmation:this.createDeviceConfirmation,passwordInput:data.confirmationPasswordInput,callback:conf=>this.doRun(data,conf.confirmationPassword)}):this.doRun(data,null)))}updatePage(data){this.pageData=data,this.run()}doRun(data,confirmationPassword,exportFormat){const request=this.operationHelper.runRequest(data,{scopeId:this.scopeId,confirmationPassword:confirmationPassword,formParameters:this.form.value,pageData:this.pageData,upload:this.fileControl.value,exportFormat:exportFormat});this.nextRequestState.queryParams=this.route.snapshot.queryParams,this.addSub(request.pipe(Object(first.a)(),Object(tap.a)(r=>r,()=>this.redirecting$.next(!1))).subscribe(response=>this.afterRun(response))),this.redirecting$.next(data.resultType===models.M.EXTERNAL_REDIRECT)}afterRun(response){if(this.operationHelper.handleResult(response))return;const result=response.body;this.result$.next(result);const headingActions=[];this.data.allowPrint&&this.isContent?headingActions.push(this.exportHelper.printAction()):Object(helper.h)(this.data.exportFormats)||this.exportHelper.headingActions(this.data.exportFormats,f=>this.operationHelper.runRequest(this.data,{scopeId:this.scopeId,formParameters:this.form.value,pageData:this.pageData,upload:this.fileControl.value,exportFormat:f})).forEach(a=>headingActions.push(a));for(const action of result.actions||[]){const op=action.action;op&&(this.operationHelper.register(op),headingActions.push(new shared_action.c(this.operationHelper.icon(op),op.label,()=>{this.operationHelper.run(op,null,action.parameters)})))}if(1===headingActions.length&&(headingActions[0].maybeRoot=!0),this.headingActions=headingActions,this.isSearch){const paged=new paged_results.a(result.rows);paged_results.a.fillHeaders(paged,response),this.pageResults$.next(paged)}}rowClick(row){const data=this.data,action=data.rowAction,params={};switch((data.rowParameters||[]).forEach(p=>params[p]=row[p]),action){case models.N.OPERATION:this.router.navigate([\"operations\",\"action\",api_helper.a.internalNameOrId(data.rowOperation)],{queryParams:params});break;case models.N.URL:let url=data.rowUrl;for(const name of Object.keys(params)){const value=params[name];value&&(url+=url.includes(\"?\")?\"&\":\"?\",url+=encodeURIComponent(name)+\"=\"+encodeURIComponent(value))}window.open(url);break;case models.N.LOCATION:const dest=api_helper.a.urlForLocation(data.rowLocation,params.id);dest&&this.router.navigateByUrl(dest)}}get onClick(){return row=>this.rowClick(row)}resolveMenu(data){if(data.scope===models.O.SYSTEM||data.scope===models.O.USER&&this.self)return new menu.a(this.menu.menuForOwnerOperation(data),{operation:data});switch(this.runScope){case OperationRunScope.User:return this.menu.userMenu(data.user,menu.b.MY_PROFILE);case OperationRunScope.Ad:return this.menu.userMenu(data.user,menu.b.SEARCH_ADS);case OperationRunScope.Record:return this.authHelper.isSelf(data.user)?this.menu.menuForRecordType(data.user,data.recordType):this.menu.userMenu(data.user,menu.b.SEARCH_USERS);case OperationRunScope.Transfer:return this.menu.transferMenu(data.transfer);case OperationRunScope.Standalone:return null}}}return RunOperationComponent.ɵfac=function(t){return new(t||RunOperationComponent)(core.Kb(core.r),core.Kb(field_helper_service.a),core.Kb(operation_helper_service.a),core.Kb(next_request_state.a),core.Kb(operations_service.a))},RunOperationComponent.ɵcmp=core.Eb({type:RunOperationComponent,selectors:[[\"run-operation\"]],features:[core.ub],decls:11,vars:5,consts:[[3,\"ready\"],[4,\"ngIf\",\"ngIfThen\"],[\"content\",\"\"],[\"regular\",\"\"],[\"theForm\",\"\"],[\"operationContext\",\"\"],[4,\"ngIf\",\"ngIfElse\"],[3,\"mode\",\"heading\",\"mobileHeading\",\"headingActions\"],[4,\"ngTemplateOutlet\"],[\"class\",\"mb-3 mt-0\",4,\"ngIf\"],[\"resultType\",\"list\",3,\"results\",\"onClick\",\"update\",4,\"ngIf\"],[1,\"mb-3\",\"mt-0\"],[3,\"disabled\",\"label\",\"action\"],[\"resultType\",\"list\",3,\"results\",\"onClick\",\"update\"],[4,\"mobileResult\"],[\"class\",\"table table-hover\",3,\"ngClass\",4,\"resultTable\"],[\"labelPosition\",\"sideForced\",\"valueFormat\",\"html\",3,\"label\",\"value\",4,\"ngFor\",\"ngForOf\"],[\"labelPosition\",\"sideForced\",\"valueFormat\",\"html\",3,\"label\",\"value\"],[1,\"table\",\"table-hover\",3,\"ngClass\"],[3,\"ngStyle\",4,\"ngFor\",\"ngForOf\"],[3,\"click\",4,\"ngFor\",\"ngForOf\"],[3,\"ngStyle\"],[3,\"click\"],[3,\"ngStyle\",\"innerHTML\",4,\"ngFor\",\"ngForOf\"],[3,\"ngStyle\",\"innerHTML\"],[\"last\",\"\",3,\"heading\",\"mobileHeading\",4,\"ngIf\"],[\"last\",\"\",3,\"heading\",\"mobileHeading\",\"headingActions\",4,\"ngIf\"],[\"last\",\"\",3,\"heading\",\"mobileHeading\"],[\"type\",\"info\",4,\"ngIf\"],[4,\"ngIf\"],[\"class\",\"mt-3 text-right\",4,\"ngIf\"],[\"type\",\"info\"],[3,\"innerHTML\"],[1,\"mt-3\",\"text-right\"],[\"last\",\"\",3,\"heading\",\"mobileHeading\",\"headingActions\"],[3,\"innerHTML\",4,\"ngIf\"],[\"class\",\"break-nl\",4,\"ngIf\"],[1,\"break-nl\"],[3,\"formGroup\"],[4,\"ngFor\",\"ngForOf\"],[3,\"label\",\"formControl\",4,\"ngIf\"],[3,\"field\",\"formControlName\",\"focused\",\"labelPosition\"],[3,\"label\",\"formControl\"],[\"kind\",\"field\",3,\"label\",4,\"ngIf\"],[\"kind\",\"fieldView\",3,\"label\",4,\"ngIf\"],[\"kind\",\"field\",3,\"label\"],[3,\"image\",\"closeable\"],[\"kind\",\"fieldView\",3,\"label\"]],template:function(rf,ctx){if(1&rf&&(core.Qb(0,\"page-layout\",0),core.ac(1,\"async\"),core.Bc(2,RunOperationComponent_ng_container_2_Template,1,0,\"ng-container\",1),core.Pb(),core.Bc(3,RunOperationComponent_ng_template_3_Template,1,2,\"ng-template\",null,2,core.Cc),core.Bc(5,RunOperationComponent_ng_template_5_Template,4,6,\"ng-template\",null,3,core.Cc),core.Bc(7,RunOperationComponent_ng_template_7_Template,4,4,\"ng-template\",null,4,core.Cc),core.Bc(9,RunOperationComponent_ng_template_9_Template,4,4,\"ng-template\",null,5,core.Cc)),2&rf){const _r1=core.qc(4);core.gc(\"ready\",core.bc(1,3,ctx.data$)),core.xb(2),core.gc(\"ngIf\",ctx.data)(\"ngIfThen\",_r1)}},directives:[page_layout_component.a,common.t,page_content_component.a,common.A,actions_component.a,action_button_component.a,results_layout_component.a,mobile_result_directive.a,result_table_directive.a,mobile_result_component.a,common.s,label_value_component.a,common.q,common.w,ngx_bootstrap_alert.a,fesm2015_forms.I,fesm2015_forms.w,fesm2015_forms.n,custom_field_input_component.a,fesm2015_forms.v,fesm2015_forms.l,focused_directive.a,file_field_component.a,fesm2015_forms.k,chip_component.a],pipes:[common.b,trust_pipe.a],encapsulation:2,changeDetection:0}),RunOperationComponent})();const operationRoutes=[{path:\"\",children:[{path:\"system/:operation\",component:run_operation_component_RunOperationComponent,canActivate:[logged_user_guard.a],data:{runScope:OperationRunScope.Standalone}},{path:\"self/:operation\",component:run_operation_component_RunOperationComponent,canActivate:[logged_user_guard.a],data:{runScope:OperationRunScope.User}},{path:\"action/:operation\",component:run_operation_component_RunOperationComponent,canActivate:[logged_user_guard.a],data:{runScope:OperationRunScope.Standalone}},{path:\"user/:user/:operation\",component:run_operation_component_RunOperationComponent,canActivate:[logged_user_guard.a],data:{runScope:OperationRunScope.User}},{path:\"marketplace/:ad/:operation\",component:run_operation_component_RunOperationComponent,canActivate:[logged_user_guard.a],data:{runScope:OperationRunScope.Ad}},{path:\"record/:record/:operation\",component:run_operation_component_RunOperationComponent,canActivate:[logged_user_guard.a],data:{runScope:OperationRunScope.Record}},{path:\"transfer/:transfer/:operation\",component:run_operation_component_RunOperationComponent,canActivate:[logged_user_guard.a],data:{runScope:OperationRunScope.Transfer}},{path:\"callback/:id/:token\",component:operation_callback_component_OperationCallbackComponent}]}];let operations_routing_module_OperationsRoutingModule=(()=>{class OperationsRoutingModule{}return OperationsRoutingModule.ɵmod=core.Ib({type:OperationsRoutingModule}),OperationsRoutingModule.ɵinj=core.Hb({factory:function(t){return new(t||OperationsRoutingModule)},imports:[[router.i.forChild(operationRoutes)],router.i]}),OperationsRoutingModule})();var ui_shared_module=__webpack_require__(\"Se2V\");let operations_module_OperationsModule=(()=>{class OperationsModule{}return OperationsModule.ɵmod=core.Ib({type:OperationsModule}),OperationsModule.ɵinj=core.Hb({factory:function(t){return new(t||OperationsModule)},imports:[[operations_routing_module_OperationsRoutingModule,ui_shared_module.a]]}),OperationsModule})()}}]);","extractedComments":[]}