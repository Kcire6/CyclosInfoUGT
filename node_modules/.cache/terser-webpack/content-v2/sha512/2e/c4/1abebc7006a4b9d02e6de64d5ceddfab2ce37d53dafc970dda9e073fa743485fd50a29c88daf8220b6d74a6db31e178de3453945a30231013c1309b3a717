{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{bnt4:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"PersonalModule\",(function(){return personal_module_PersonalModule}));var router=__webpack_require__(\"iInd\"),logged_user_guard=__webpack_require__(\"IbW5\"),notifications_service=__webpack_require__(\"wgiT\"),action=__webpack_require__(\"tAww\"),api_helper=__webpack_require__(\"rCAV\"),base_search_page_component=__webpack_require__(\"v4xg\"),menu=__webpack_require__(\"QH++\"),forkJoin=__webpack_require__(\"cp0P\"),first=__webpack_require__(\"SxV6\"),skip=__webpack_require__(\"zP0r\"),core=__webpack_require__(\"8Y7J\"),page_layout_component=__webpack_require__(\"3qho\"),page_content_component=__webpack_require__(\"I0FJ\"),fesm2015_forms=__webpack_require__(\"s7LF\"),boolean_field_component=__webpack_require__(\"yHfF\"),results_layout_component=__webpack_require__(\"Zilp\"),mobile_result_directive=__webpack_require__(\"IbGL\"),result_table_directive=__webpack_require__(\"Ae/X\"),mobile_result_component=__webpack_require__(\"iM3x\"),ngx_bootstrap_tooltip=__webpack_require__(\"978R\"),common=__webpack_require__(\"SVse\"),avatar_component=__webpack_require__(\"sifq\"),icon_component=__webpack_require__(\"H4pW\"),date_time_pipe=__webpack_require__(\"/kmK\");function SearchNotificationsComponent_mobile_result_9_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"mobile-result\",8),core.Qb(1,\"div\",9),core.Dc(2),core.Pb(),core.Qb(3,\"div\",10),core.Dc(4),core.ac(5,\"dateTime\"),core.Pb(),core.Pb()),2&rf){const row_r2=ctx.$implicit;core.gc(\"avatarImage\",null==row_r2.relatedUser?null:row_r2.relatedUser.image),core.xb(1),core.gc(\"tooltip\",row_r2.message),core.xb(1),core.Ec(row_r2.subject),core.xb(1),core.gc(\"tooltip\",row_r2.message),core.xb(1),core.Fc(\" \",core.bc(5,5,row_r2.date),\" \")}}const _c0=function(a0){return{\"font-weight-bold\":a0}},_c1=function(a0,a1){return{\"pb-0\":a0,\"border-0\":a1}};function SearchNotificationsComponent_table_10_ng_container_9_Template(rf,ctx){if(1&rf){const _r6=core.Rb();core.Ob(0),core.Qb(1,\"tr\",15),core.Xb(\"click\",(function(){core.sc(_r6);const row_r4=ctx.$implicit;return core.Zb(2).rowClick(row_r4)})),core.Qb(2,\"td\",16),core.ac(3,\"async\"),core.ac(4,\"async\"),core.Lb(5,\"avatar\",17),core.Pb(),core.Qb(6,\"td\"),core.Dc(7),core.ac(8,\"dateTime\"),core.Pb(),core.Qb(9,\"td\"),core.Dc(10),core.Pb(),core.Qb(11,\"td\",13),core.Qb(12,\"button\",18),core.Xb(\"click\",(function($event){core.sc(_r6);const row_r4=ctx.$implicit;return core.Zb(2).remove(row_r4),$event.stopPropagation()})),core.Lb(13,\"icon\",19),core.Pb(),core.Pb(),core.Pb(),core.Nb()}if(2&rf){const row_r4=ctx.$implicit,ctx_r3=core.Zb(2);core.xb(1),core.gc(\"ngClass\",core.jc(13,_c0,!row_r4.read)),core.xb(1),core.gc(\"ngClass\",core.kc(15,_c1,core.bc(3,7,ctx_r3.layout.xxs$),core.bc(4,9,ctx_r3.layout.xxs$))),core.xb(3),core.gc(\"image\",null==row_r4.relatedUser?null:row_r4.relatedUser.image)(\"tooltip\",null==row_r4.relatedUser?null:row_r4.relatedUser.display),core.xb(2),core.Ec(core.bc(8,11,row_r4.date)),core.xb(3),core.Ec(row_r4.message),core.xb(2),core.gc(\"tooltip\",ctx_r3.i18n.notification.actions.remove)}}function SearchNotificationsComponent_table_10_Template(rf,ctx){if(1&rf&&(core.Qb(0,\"table\",11),core.Qb(1,\"thead\"),core.Lb(2,\"th\",12),core.Qb(3,\"th\"),core.Dc(4),core.Pb(),core.Qb(5,\"th\"),core.Dc(6),core.Pb(),core.Lb(7,\"th\",13),core.Pb(),core.Qb(8,\"tbody\"),core.Bc(9,SearchNotificationsComponent_table_10_ng_container_9_Template,14,18,\"ng-container\",14),core.ac(10,\"async\"),core.Pb(),core.Pb()),2&rf){const ctx_r1=core.Zb();var tmp_2_0;core.xb(4),core.Ec(ctx_r1.i18n.general.date),core.xb(2),core.Ec(ctx_r1.i18n.notification.message),core.xb(3),core.gc(\"ngForOf\",null==(tmp_2_0=core.bc(10,3,ctx_r1.results$))?null:tmp_2_0.results)}}let search_notifications_component_SearchNotificationsComponent=(()=>{class SearchNotificationsComponent extends base_search_page_component.a{constructor(injector,notificationsService){super(injector),this.notificationsService=notificationsService}ngOnInit(){super.ngOnInit(),this.data={},this.addSub(this.notificationsService.markAsViewed().pipe(Object(first.a)()).subscribe(()=>{const status$=this.notification.notificationsStatus$,status=Object.assign({},status$.value);status.lastViewDate=this.dataForUiHolder.now().toISOString(),status.newNotifications=0,status$.next(status),this.addSub(this.notification.notificationsStatus$.pipe(Object(skip.a)(1)).subscribe(()=>this.update()))})),this.addSub(this.results$.subscribe(results=>{const headingActions=[],notifications=(results?results.results:null)||[];notifications.filter(n=>!n.read).length>0&&headingActions.push(new action.c(\"done_all\",this.i18n.notification.actions.markAllRead,()=>this.markAllRead())),notifications.length>0&&headingActions.push(new action.c(\"clear\",this.i18n.notification.actions.removeAll,()=>this.removeAll())),this.headingActions=headingActions}))}rowClick(notification){this.addSub(this.notificationsService.markNotificationsAsRead({ids:[notification.id]}).subscribe());const path=this.path(notification);path&&this.router.navigateByUrl(path)}remove(notification){this.addSub(this.notificationsService.deleteNotification({id:notification.id}).subscribe(()=>this.update()))}path(notification){return api_helper.a.notificationPath(notification)}markAllRead(){this.addSub(this.notificationsService.markNotificationsAsRead({ids:this.ids}).subscribe(()=>this.update()))}removeAll(){const observables=[];for(const id of this.ids)observables.push(this.notificationsService.deleteNotification({id:id}));this.addSub(Object(forkJoin.a)(observables).pipe(Object(first.a)()).subscribe(()=>this.update()))}get ids(){return this.results&&this.results.results?this.results.results.map(n=>n.id):[]}getFormControlNames(){return[\"onlyUnread\"]}toSearchParams(value){return value}doSearch(value){return this.notificationsService.searchNotifications$Response(value)}get onClick(){return row=>this.rowClick(row)}resolveMenu(){return menu.b.NOTIFICATIONS}}return SearchNotificationsComponent.ɵfac=function(t){return new(t||SearchNotificationsComponent)(core.Kb(core.r),core.Kb(notifications_service.a))},SearchNotificationsComponent.ɵcmp=core.Eb({type:SearchNotificationsComponent,selectors:[[\"search-notifications\"]],features:[core.ub],decls:11,vars:12,consts:[[\"mode\",\"filters\",3,\"heading\",\"mobileHeading\",\"headingActions\"],[1,\"filters-form\",\"filters-form-separator\",3,\"formGroup\"],[1,\"row\"],[1,\"col-12\",\"col-md-6\"],[\"labelPosition\",\"sideForced\",\"formControlName\",\"onlyUnread\",3,\"label\"],[\"resultType\",\"list\",3,\"results\",\"onClick\",\"rendering$\",\"update\"],[\"avatarIcon\",\"notifications_none\",3,\"avatarImage\",4,\"mobileResult\"],[\"class\",\"table table-hover cursor-pointer\",4,\"resultTable\"],[\"avatarIcon\",\"notifications_none\",3,\"avatarImage\"],[1,\"cell-main\",3,\"tooltip\"],[1,\"cell-cell-date\",3,\"tooltip\"],[1,\"table\",\"table-hover\",\"cursor-pointer\"],[1,\"avatar\"],[1,\"actions\"],[4,\"ngFor\",\"ngForOf\"],[3,\"ngClass\",\"click\"],[1,\"avatar\",3,\"ngClass\"],[\"icon\",\"notifications_none\",3,\"image\",\"tooltip\"],[1,\"btn\",\"btn-icon\",3,\"tooltip\",\"click\"],[\"icon\",\"clear\"]],template:function(rf,ctx){1&rf&&(core.Qb(0,\"page-layout\"),core.Qb(1,\"page-content\",0),core.ac(2,\"async\"),core.Qb(3,\"form\",1),core.Qb(4,\"div\",2),core.Qb(5,\"div\",3),core.Lb(6,\"boolean-field\",4),core.Pb(),core.Pb(),core.Pb(),core.Pb(),core.Qb(7,\"results-layout\",5),core.Xb(\"update\",(function($event){return ctx.update($event)})),core.ac(8,\"async\"),core.Bc(9,SearchNotificationsComponent_mobile_result_9_Template,6,7,\"mobile-result\",6),core.Bc(10,SearchNotificationsComponent_table_10_Template,11,5,\"table\",7),core.Pb(),core.Pb()),2&rf&&(core.xb(1),core.gc(\"heading\",ctx.i18n.notification.title)(\"mobileHeading\",ctx.i18n.notification.mobileTitle)(\"headingActions\",core.bc(2,8,ctx.headingActions$)),core.xb(2),core.gc(\"formGroup\",ctx.form),core.xb(3),core.gc(\"label\",ctx.i18n.notification.onlyUnread),core.xb(1),core.gc(\"results\",core.bc(8,10,ctx.results$))(\"onClick\",ctx.onClick)(\"rendering$\",ctx.rendering$))},directives:[page_layout_component.a,page_content_component.a,fesm2015_forms.I,fesm2015_forms.w,fesm2015_forms.n,boolean_field_component.a,fesm2015_forms.v,fesm2015_forms.l,results_layout_component.a,mobile_result_directive.a,result_table_directive.a,mobile_result_component.a,ngx_bootstrap_tooltip.b,common.s,common.q,avatar_component.a,icon_component.a],pipes:[common.b,date_time_pipe.a],encapsulation:2,changeDetection:0}),SearchNotificationsComponent})();var base_page_component=__webpack_require__(\"uuU0\"),radio_group_field_component=__webpack_require__(\"wR2l\"),field_option_directive=__webpack_require__(\"chz4\");const personalRoutes=[{path:\"\",children:[{path:\"notifications\",component:search_notifications_component_SearchNotificationsComponent,canActivate:[logged_user_guard.a],data:{menu:menu.b.NOTIFICATIONS}},{path:\"settings\",component:(()=>{class ManageSettingsComponent extends base_page_component.a{constructor(injector){super(injector)}ngOnInit(){super.ngOnInit(),this.darkThemeControl=new fesm2015_forms.j(this.layout.darkTheme),this.addSub(this.darkThemeControl.valueChanges.subscribe(value=>{this.layout.darkTheme=value}))}resolveMenu(){return menu.b.SETTINGS}}return ManageSettingsComponent.ɵfac=function(t){return new(t||ManageSettingsComponent)(core.Kb(core.r))},ManageSettingsComponent.ɵcmp=core.Eb({type:ManageSettingsComponent,selectors:[[\"manage-settings\"]],features:[core.ub],decls:5,vars:8,consts:[[\"last\",\"\",3,\"heading\",\"mobileHeading\"],[3,\"label\",\"formControl\"],[3,\"value\",\"text\"]],template:function(rf,ctx){1&rf&&(core.Qb(0,\"page-layout\"),core.Qb(1,\"page-content\",0),core.Qb(2,\"radio-group-field\",1),core.Lb(3,\"field-option\",2),core.Lb(4,\"field-option\",2),core.Pb(),core.Pb(),core.Pb()),2&rf&&(core.xb(1),core.gc(\"heading\",ctx.i18n.setting.title)(\"mobileHeading\",ctx.i18n.setting.mobileTitle),core.xb(1),core.gc(\"label\",ctx.i18n.setting.theme)(\"formControl\",ctx.darkThemeControl),core.xb(1),core.gc(\"value\",!1)(\"text\",ctx.i18n.setting.themeLight),core.xb(1),core.gc(\"value\",!0)(\"text\",ctx.i18n.setting.themeDark))},directives:[page_layout_component.a,page_content_component.a,radio_group_field_component.a,fesm2015_forms.v,fesm2015_forms.k,field_option_directive.a],encapsulation:2,changeDetection:0}),ManageSettingsComponent})(),canActivate:[logged_user_guard.a],data:{menu:menu.b.SETTINGS}}]}];let personal_routing_module_PersonalRoutingModule=(()=>{class PersonalRoutingModule{}return PersonalRoutingModule.ɵmod=core.Ib({type:PersonalRoutingModule}),PersonalRoutingModule.ɵinj=core.Hb({factory:function(t){return new(t||PersonalRoutingModule)},imports:[[router.i.forChild(personalRoutes)],router.i]}),PersonalRoutingModule})();var ui_shared_module=__webpack_require__(\"Se2V\");let personal_module_PersonalModule=(()=>{class PersonalModule{}return PersonalModule.ɵmod=core.Ib({type:PersonalModule}),PersonalModule.ɵinj=core.Hb({factory:function(t){return new(t||PersonalModule)},imports:[[personal_routing_module_PersonalRoutingModule,ui_shared_module.a]]}),PersonalModule})()},v4xg:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.d(__webpack_exports__,\"a\",(function(){return BaseSearchPageComponent}));var _angular_forms__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(\"s7LF\"),app_core_next_request_state__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(\"mwYl\"),app_shared_action__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(\"tAww\"),app_shared_api_helper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(\"rCAV\"),app_ui_shared_base_page_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(\"uuU0\"),app_shared_paged_results__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(\"Ky6R\"),app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(\"TFmz\"),lodash_es__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(\"Muja\"),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(\"2Vo4\"),rxjs_operators__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(\"Kj3r\"),_angular_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(\"8Y7J\");let BaseSearchPageComponent=(()=>{class BaseSearchPageComponent extends app_ui_shared_base_page_component__WEBPACK_IMPORTED_MODULE_4__.a{constructor(injector){super(injector),this.ResultType=app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a,this.resultType$=new rxjs__WEBPACK_IMPORTED_MODULE_8__.a(null),this.resultTypeControl=new _angular_forms__WEBPACK_IMPORTED_MODULE_0__.j(null),this.results$=new rxjs__WEBPACK_IMPORTED_MODULE_8__.a(null),this.allowedResultTypes$=new rxjs__WEBPACK_IMPORTED_MODULE_8__.a([app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.LIST]),this.rendering$=new rxjs__WEBPACK_IMPORTED_MODULE_8__.a(!1),this.moreFilters$=new rxjs__WEBPACK_IMPORTED_MODULE_8__.a(!1),this.ignoreNextUpdate=!1,this.nextRequestState=injector.get(app_core_next_request_state__WEBPACK_IMPORTED_MODULE_1__.a);const controls={page:0};controls.resultType=this.getInitialResultType();for(const name of this.getFormControlNames()||[])controls[name]=null;this.form=this.formBuilder.group(controls)}getInitialFormValue(data){return data.query||{}}onDataInitialized(data){this.form.patchValue(this.getInitialFormValue(data)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,\"resultType\"),this.stateManager.manageValue(this.moreFilters$,\"moreFilters\"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe(rt=>{const previous=this.previousResultType;this.previousResultType=rt,this.resultType$.next(rt),this.shouldUpdateOnResultTypeChange(rt,previous)&&this.update(),null!=previous&&previous===rt||(this.rendering=!0,this.stateManager.set(\"resultType\",rt),this.onResultTypeChanged(rt,previous))})),setTimeout(()=>{this.addSub(this.form.valueChanges.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.a)(app_shared_api_helper__WEBPACK_IMPORTED_MODULE_3__.a.DEBOUNCE_TIME)).subscribe(value=>{this.shouldUpdateOnChange(value)&&this.update(),this.previousValue=value}),!0),this.previousResultType!==app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.CATEGORIES&&this.update()},1)}shouldUpdateOnResultTypeChange(resultType,previous){return resultType!==app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.CATEGORIES&&([app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.LIST,app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.TILES].includes(previous)!==[app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.LIST,app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.TILES].includes(resultType)||previous===app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.MAP!=(resultType===app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.MAP))}shouldUpdateOnChange(value){return!Object(lodash_es__WEBPACK_IMPORTED_MODULE_7__.a)(this.previousValue,value)}get results(){return this.results$.value}set results(results){this.results$.next(results)}get rendering(){return this.rendering$.value}set rendering(rendering){this.rendering$.next(rendering)}get allowedResultTypes(){return this.allowedResultTypes$.value}set allowedResultTypes(resultTypes){this.allowedResultTypes$.next(resultTypes)}get moreFilters(){return this.moreFilters$.value}set moreFilters(moreFilters){this.moreFilters$.next(moreFilters)}get pageData(){const val=this.form.value;return{page:val.page,pageSize:val.pageSize}}set pageData(pageData){this.form.patchValue(pageData)}get resultType(){return this.resultTypeControl.value}set resultType(resultType){null==resultType&&(resultType=this.getInitialResultType()),this.resultTypeControl.setValue(resultType)}ngOnInit(){super.ngOnInit(),this.resultType=this.getInitialResultType()}get moreFiltersAction(){return this._moreFiltersAction||(this._moreFiltersAction=new app_shared_action__WEBPACK_IMPORTED_MODULE_2__.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),()=>{this.moreFilters=!this.moreFilters,this._moreFiltersAction.icon=this.moreFilters?this.showLessFiltersIcon():this.showMoreFiltersIcon(),this._moreFiltersAction.label=this.moreFilters?this.showLessFiltersLabel():this.showMoreFiltersLabel()},!0),this._moreFiltersAction.breakpoint=\"gt-xxs\",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}showMoreFiltersLabel(){return this.i18n.general.showMoreFilters}showLessFiltersLabel(){return this.i18n.general.showLessFilters}showMoreFiltersIcon(){return\"filter_list\"}showLessFiltersIcon(){return\"filter_list\"}onResultTypeChanged(_resultType,_previous){}getInitialResultType(){return app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.LIST}update(pageData){if(this.ignoreNextUpdate)return;pageData&&(this.form.patchValue(pageData,{emitEvent:!1}),this.stateManager.set(\"form\",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;const value=this.form.value;value.pageSize=this.uiLayout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(value)).subscribe(response=>{this.resultType===app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.CATEGORIES&&(this.resultType=this.allowedResultTypes.find(rt=>rt!==app_ui_shared_result_type__WEBPACK_IMPORTED_MODULE_6__.a.CATEGORIES)),this.results=app_shared_paged_results__WEBPACK_IMPORTED_MODULE_5__.a.from(response)}))}resetPage(emitEvent=!1){this.form.patchValue({page:0},{emitEvent:emitEvent})}doIgnoringUpdate(fn){this.ignoreNextUpdate=!0;try{fn()}finally{this.ignoreNextUpdate=!1}}}return BaseSearchPageComponent.ɵfac=function(t){return new(t||BaseSearchPageComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_10__.Kb(_angular_core__WEBPACK_IMPORTED_MODULE_10__.r))},BaseSearchPageComponent.ɵdir=_angular_core__WEBPACK_IMPORTED_MODULE_10__.Fb({type:BaseSearchPageComponent,features:[_angular_core__WEBPACK_IMPORTED_MODULE_10__.ub]}),BaseSearchPageComponent})()}}]);","extractedComments":[]}