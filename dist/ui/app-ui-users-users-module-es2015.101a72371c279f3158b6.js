(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{RsAj:function(e,t,i){"use strict";i.r(t),i.d(t,"UsersModule",(function(){return Pd}));var n=i("Se2V"),a=i("iInd"),s=i("bkl+"),o=i("IbW5"),r=i("q8SF"),c=i("rCAV"),l=i("uuU0"),b=i("ObUu"),u=i("QH++"),d=i("XIp8"),g=i("8Y7J"),f=i("3qho"),m=i("I0FJ"),p=i("SVse"),h=i("s7LF"),v=i("yHfF"),x=i("UXR7"),y=i("OTwK"),P=i("s7Af"),I=i("978R");function E(e,t){if(1&e&&(g.Qb(0,"li"),g.Dc(1),g.Pb()),2&e){const e=t.$implicit;g.xb(1),g.Ec(e)}}function A(e,t){if(1&e&&g.Lb(0,"user-info",9),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function C(e,t){if(1&e&&g.Lb(0,"boolean-field",11),2&e){const e=t.$implicit;g.gc("formControlName",e.id)("label",e.name)("tooltip",e.informationText)("placement","left")}}function D(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Bc(3,C,1,4,"boolean-field",10),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.privacySettings.controlsSection),g.xb(1),g.gc("ngForOf",e.data.availableControls)}}function O(e,t){if(1&e){const e=g.Rb();g.Ob(0,2),g.Qb(1,"div"),g.Dc(2),g.Pb(),g.Qb(3,"div"),g.Dc(4),g.Pb(),g.Qb(5,"ul"),g.Bc(6,E,2,1,"li",3),g.Pb(),g.Bc(7,A,1,1,"user-info",4),g.Lb(8,"boolean-field",5,6),g.Bc(10,D,4,2,"ng-container",7),g.Qb(11,"actions"),g.Qb(12,"action-button",8),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(13,"async"),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.qc(9),t=g.Zb();g.gc("formGroup",t.form),g.xb(2),g.Ec(t.i18n.privacySettings.information),g.xb(2),g.Ec(t.i18n.privacySettings.dataSubjectToControls),g.xb(2),g.gc("ngForOf",t.fields()),g.xb(1),g.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),g.xb(1),g.gc("formControlName","enabled")("label",t.i18n.general.enabled),g.xb(2),g.gc("ngIf",e.value),g.xb(2),g.gc("label",t.i18n.general.save)("disabled",g.bc(13,10,t.requesting$))}}let S=(()=>{class e extends l.a{constructor(e,t){super(e),this.privacySettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.privacySettingsService.getPrivacySettingsData({user:this.user?this.user:c.a.SELF}).subscribe(e=>this.data=e))}fields(){return this.data.controlledFields.map(e=>this.fieldHelper.fieldDisplay(e,this.data.customFields))}onDataInitialized(e){this.form=this.formBuilder.group({enabled:e.enabled}),e.availableControls.forEach(t=>this.form.addControl(t.id,this.formBuilder.control({value:e.selectedControls.includes(t.id)||t.fieldsAlwaysVisible,disabled:t.fieldsAlwaysVisible})))}save(){if(Object(b.F)(this.form),!this.form.valid)return;const e=Object(d.a)(this.form.value),t=e.enabled;delete e.enabled;const i={enabled:t,selectedControls:[]};this.data.availableControls.forEach(t=>{e[t.id]&&i.selectedControls.push(t.id)}),this.addSub(this.privacySettingsService.savePrivacySettings({user:this.user?this.user:c.a.SELF,body:i}).subscribe(()=>this.notification.snackBar(this.i18n.privacySettings.saved)))}resolveMenu(){return this.authHelper.isSelf(this.user)?u.b.PRIVACY_SETTINGS:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(r.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["edit-privacy-settings"]],features:[g.ub],decls:5,vars:8,consts:[[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngFor","ngForOf"],[3,"user",4,"ngIf"],[3,"formControlName","label"],["enabled",""],[4,"ngIf"],[3,"label","disabled","action"],[3,"user"],[3,"formControlName","label","tooltip","placement",4,"ngFor","ngForOf"],[3,"formControlName","label","tooltip","placement"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout"),g.Qb(1,"page-content",0),g.ac(2,"async"),g.Bc(3,O,14,12,"ng-container",1),g.ac(4,"async"),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.gc("heading",t.i18n.privacySettings.title)("mobileHeading",t.i18n.privacySettings.mobileTitle)("headingActions",g.bc(2,4,t.headingActions$)),g.xb(2),g.gc("ngIf",g.bc(4,6,t.data$)))},directives:[f.a,m.a,p.t,h.w,h.n,p.s,v.a,h.v,h.l,x.a,y.a,P.a,I.b],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Q=i("JFlR");function N(e,t){if(1&e&&(g.Qb(0,"li"),g.Dc(1),g.Pb()),2&e){const e=t.$implicit;g.xb(1),g.Ec(e)}}function F(e,t){if(1&e&&g.Lb(0,"user-info",5),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function L(e,t){if(1&e&&(g.Qb(0,"label-value",7),g.Dc(1),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("label",e.name)("tooltip",e.informationText)("placement","left"),g.xb(1),g.Fc(" ",e.fieldsAlwaysVisible||i.data.selectedControls.includes(e.id)?i.i18n.general.yes:i.i18n.general.no," ")}}function B(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Bc(3,L,2,4,"label-value",6),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.privacySettings.controlsSection),g.xb(1),g.gc("ngForOf",e.data.availableControls)}}function w(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div"),g.Dc(2),g.Pb(),g.Qb(3,"div"),g.Dc(4),g.Pb(),g.Qb(5,"ul"),g.Bc(6,N,2,1,"li",2),g.Pb(),g.Bc(7,F,1,1,"user-info",3),g.Qb(8,"label-value",4),g.Dc(9),g.Pb(),g.Bc(10,B,4,2,"ng-container",1),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.Ec(e.i18n.privacySettings.information),g.xb(2),g.Ec(e.i18n.privacySettings.dataSubjectToControls),g.xb(2),g.gc("ngForOf",e.fields()),g.xb(1),g.gc("ngIf",e.data.user&&!e.authHelper.isSelf(e.data.user)),g.xb(1),g.gc("label",e.i18n.general.enabled),g.xb(1),g.Fc(" ",e.data.enabled?e.i18n.general.yes:e.i18n.general.no,""),g.xb(1),g.gc("ngIf",e.data.enabled)}}let R=(()=>{class e extends l.a{constructor(e,t){super(e),this.privacySettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.privacySettingsService.getPrivacySettingsData({user:this.user?this.user:c.a.SELF}).subscribe(e=>{e.canEdit&&this.router.navigate(["/users",this.user,"privacy-settings","edit"],{replaceUrl:!0}),this.data=e}))}fields(){return this.data.controlledFields.map(e=>this.fieldHelper.fieldDisplay(e,this.data.customFields))}resolveMenu(){return this.authHelper.isSelf(this.user)?u.b.PRIVACY_SETTINGS:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(r.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-privacy-settings"]],features:[g.ub],decls:5,vars:8,consts:[[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"user",4,"ngIf"],[3,"label"],[3,"user"],[3,"label","tooltip","placement",4,"ngFor","ngForOf"],[3,"label","tooltip","placement"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout"),g.Qb(1,"page-content",0),g.ac(2,"async"),g.Bc(3,w,11,7,"ng-container",1),g.ac(4,"async"),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.gc("heading",t.i18n.privacySettings.title)("mobileHeading",t.i18n.privacySettings.mobileTitle)("headingActions",g.bc(2,4,t.headingActions$)),g.xb(2),g.gc("ngIf",g.bc(4,6,t.data$)))},directives:[f.a,m.a,p.t,p.s,Q.a,P.a,I.b],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var k=i("cutz"),T=i("tzq7"),Z=i("ugYG"),_=i("Pm8L"),M=i("LqlI"),$=i("Zilp"),U=i("IbGL"),H=i("Ae/X"),G=i("iM3x"),q=i("H4pW"),K=i("yL40"),V=i("/kmK"),j=i("kmyw");function z(e,t){1&e&&g.Mb(0)}function X(e,t){if(1&e&&g.Lb(0,"user-info",8),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function J(e,t){if(1&e&&(g.Qb(0,"del"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.agreement.name," ")}}function Y(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb().$implicit;g.Fc(" ",e.agreement.name," ")}}function W(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div"),g.Qb(2,"div",9),g.Dc(3),g.ac(4,"date"),g.Pb(),g.Qb(5,"div",10),g.Bc(6,J,2,1,"del",11),g.Bc(7,Y,1,1,"ng-template",null,12,g.Cc),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.qc(8);g.xb(3),g.Fc(" ",g.bc(4,3,e.date)," "),g.xb(3),g.gc("ngIf",!e.accepted)("ngIfElse",i)}}function ee(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Ec(e.i18n.agreements.accepted)}}function te(e,t){if(1&e&&(g.Qb(0,"th",18),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.general.remoteAddress,"")}}function ie(e,t){if(1&e&&(g.Qb(0,"td"),g.Dc(1),g.ac(2,"boolean"),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Ec(g.bc(2,1,e.accepted))}}function ne(e,t){if(1&e&&(g.Qb(0,"td",18),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.remoteAddress,"")}}function ae(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",21),g.Xb("click",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).showAgreement(t)})),g.Lb(1,"icon",22),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.view)}}const se=function(e){return{"cursor-pointer":e}};function oe(e,t){if(1&e&&(g.Qb(0,"tr",19),g.Qb(1,"td"),g.Dc(2),g.ac(3,"dateTime"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Bc(6,ie,3,3,"td",14),g.Bc(7,ne,2,1,"td",15),g.Qb(8,"td",16),g.Bc(9,ae,2,1,"button",20),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("ngClass",g.jc(8,se,e.accepted)),g.xb(2),g.Ec(g.bc(3,6,e.date)),g.xb(3),g.Ec(e.agreement.name),g.xb(1),g.gc("ngIf",i.hasAccepted),g.xb(1),g.gc("ngIf",i.hasRemoteAddress),g.xb(2),g.gc("ngIf",e.accepted)}}function re(e,t){if(1&e&&(g.Qb(0,"table",13),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Bc(6,ee,2,1,"th",14),g.Bc(7,te,2,1,"th",15),g.Lb(8,"th",16),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,oe,10,10,"tr",17),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.agreements.agreement),g.xb(1),g.gc("ngIf",e.hasAccepted),g.xb(1),g.gc("ngIf",e.hasRemoteAddress),g.xb(3),g.gc("ngForOf",e.data.history)}}function ce(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Bc(1,X,1,1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,W,9,5,"mobile-result",6),g.Bc(4,re,11,5,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.agreements.title.history)("mobileHeading",e.i18n.agreements.mobileTitle.history)("mode",e.self?"empty":"normal"),g.xb(1),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.history)("onClick",e.showAgreement)}}let le=(()=>{class e extends _.a{constructor(e,t,i,n){super(e),this.agreementsService=t,this.userHelper=i,this.modal=n}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=e.history||[];this.hasAccepted=t.findIndex(e=>!e.accepted)>=0,this.hasRemoteAddress=t.findIndex(e=>e.remoteAddress)>=0}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.userMenu(e.user,u.b.AGREEMENTS)}get showAgreement(){return e=>{e.accepted&&this.modal.show(Z.a,{ignoreBackdropClick:!0,class:"modal-form modal-form-large",initialState:{agreement:e.agreement,version:e.acceptedVersion}})}}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(k.a),g.Kb(T.a),g.Kb(M.b))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-agreements-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading","mode"],[3,"user",4,"ngIf"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"user"],[1,"cell-text","float-left"],[1,"cell-main","float-right"],[4,"ngIf","ngIfElse"],["accepted",""],[1,"table","table-hover"],[4,"ngIf"],["class","align-center",4,"ngIf"],[1,"actions"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"align-center"],[3,"ngClass"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","search"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,z,1,0,"ng-container",1),g.Pb(),g.Bc(3,ce,5,6,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,$.a,U.a,H.a,P.a,G.a,p.s,p.q,I.b,q.a],pipes:[p.b,K.a,V.a,j.a],encapsulation:2,changeDetection:0}),e})();var be=i("tAww"),ue=i("T6RQ"),de=i("U4Kh");function ge(e,t){if(1&e&&g.Lb(0,"user-info",9),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function fe(e,t){if(1&e&&g.Lb(0,"accept-agreements",10),2&e){const e=g.Zb(2);g.gc("label",e.i18n.agreements.optional)("formControl",e.optionalControl)("agreements",e.allOptional)}}function me(e,t){1&e&&g.Mb(0)}const pe=function(e){return{$implicit:e}};function he(e,t){if(1&e&&(g.Qb(0,"label-value",11),g.Bc(1,me,1,0,"ng-container",12),g.Pb()),2&e){const e=g.Zb(3),t=g.qc(4);g.gc("label",e.i18n.agreements.optional),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.jc(3,pe,e.acceptedOptional))}}function ve(e,t){if(1&e&&g.Bc(0,he,2,5,"label-value",7),2&e){const e=g.Zb(2);g.gc("ngIf",(null==e.acceptedOptional?null:e.acceptedOptional.length)>0)}}function xe(e,t){1&e&&g.Mb(0)}function ye(e,t){if(1&e&&(g.Qb(0,"label-value",11),g.Bc(1,xe,1,0,"ng-container",12),g.Pb()),2&e){const e=g.Zb(2),t=g.qc(4);g.gc("label",e.i18n.agreements.required),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.jc(3,pe,e.acceptedRequired))}}function Pe(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"hr"),g.Dc(2),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc(" ",e.i18n.agreements.noAccepted," ")}}function Ie(e,t){if(1&e){const e=g.Rb();g.Qb(0,"actions"),g.Qb(1,"action-button",13),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.ac(2,"async"),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(1),g.gc("disabled",g.bc(2,2,e.requesting$))("label",e.i18n.general.save)}}function Ee(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.ac(1,"async"),g.Bc(2,ge,1,1,"user-info",4),g.Bc(3,fe,1,3,"accept-agreements",5),g.Bc(4,ve,1,1,"ng-template",null,6,g.Cc),g.Bc(6,ye,2,5,"label-value",7),g.Bc(7,Pe,3,1,"ng-container",8),g.Bc(8,Ie,3,4,"actions",8),g.Pb()),2&e){const e=g.qc(5),t=g.Zb();g.gc("heading",t.i18n.agreements.title.accepted)("mobileHeading",t.i18n.agreements.mobileTitle.accepted)("headingActions",g.bc(1,9,t.headingActions$)),g.xb(2),g.gc("ngIf",!t.self),g.xb(1),g.gc("ngIf",t.optionalControl)("ngIfElse",e),g.xb(3),g.gc("ngIf",(null==t.acceptedRequired?null:t.acceptedRequired.length)>0),g.xb(1),g.gc("ngIf",t.noAgreements),g.xb(1),g.gc("ngIf",t.optionalControl)}}const Ae=function(e){return{"mt-2":e}};function Ce(e,t){if(1&e&&(g.Qb(0,"div",15),g.Lb(1,"agreement-link",16),g.Pb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(2);g.gc("ngClass",g.jc(3,Ae,!i)),g.xb(1),g.gc("agreement",e)("version",null==n.data.accepted[e.id]?null:n.data.accepted[e.id].acceptedVersion)}}function De(e,t){1&e&&g.Bc(0,Ce,2,5,"div",14),2&e&&g.gc("ngForOf",t.$implicit)}let Oe=(()=>{class e extends _.a{constructor(e,t){super(e),this.agreementsService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["-history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=Object.keys(e.accepted||{}),i=(e.agreements||[]).filter(e=>t.includes(e.id));this.allOptional=(e.agreements||[]).filter(e=>!e.required),this.acceptedOptional=i.filter(e=>!e.required),this.acceptedRequired=i.filter(e=>e.required),e.canEdit?this.optionalControl=this.formBuilder.control(this.acceptedOptional.map(e=>e.id)):this.noAgreements=0===i.length,this.noAgreements||(this.headingActions=[new be.c("history",this.i18n.general.viewHistory,()=>this.router.navigate(["users",this.param,"agreements","history"]),!0)])}save(){Object(b.F)(this.optionalControl)&&this.addSub(this.agreementsService.acceptOptionalAgreements({agreements:this.optionalControl.value}).subscribe(()=>{this.notification.snackBar(this.i18n.agreements.optionalSaved),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.AGREEMENTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(k.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-agreements"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],["agreementLinks",""],[3,"heading","mobileHeading","headingActions"],[3,"user",4,"ngIf"],[3,"label","formControl","agreements",4,"ngIf","ngIfElse"],["optionalNotEditable",""],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"label","formControl","agreements"],[3,"label"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"disabled","label","action"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["ignoreRequired","",3,"agreement","version"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ee,9,11,"page-content",1),g.Pb(),g.Bc(3,De,1,1,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,ue.a,h.v,h.k,Q.a,p.A,x.a,y.a,p.s,p.q,de.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Se=i("hQUc"),Qe=i("v4xg"),Ne=i("6g1M"),Fe=i("WYBn"),Le=i("chz4"),Be=i("JbOn"),we=i("sifq");function Re(e,t){if(1&e&&(g.Qb(0,"mobile-result",25),g.Qb(1,"div",26),g.Dc(2),g.Pb(),g.Qb(3,"div",27),g.Dc(4),g.ac(5,"dateTime"),g.Pb(),g.Qb(6,"div",28),g.Dc(7),g.Pb(),g.Pb()),2&e){const e=t.$implicit;g.gc("avatarImage",null==e.user?null:e.user.image),g.xb(1),g.gc("tooltip",e.user.display),g.xb(1),g.Fc(" ",e.user.display,""),g.xb(2),g.Fc(" ",g.bc(5,5,e.date)," "),g.xb(3),g.Ec(e.text)}}const ke=function(e,t){return{"pb-0":e,"border-0":t}};function Te(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"tr"),g.Qb(2,"td",32),g.ac(3,"async"),g.ac(4,"async"),g.Lb(5,"avatar",33),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.ac(12,"dateTime"),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(2),g.gc("ngClass",g.kc(12,ke,g.bc(3,6,i.layout.xxs$),g.bc(4,8,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.user?null:e.user.image)("tooltip",null==e.user?null:e.user.display),g.xb(2),g.Ec(e.user.display),g.xb(2),g.Ec(e.text),g.xb(2),g.Ec(g.bc(12,10,e.date))}}function Ze(e,t){if(1&e&&(g.Qb(0,"table",29),g.Qb(1,"thead"),g.Lb(2,"th",30),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,Te,13,15,"ng-container",31),g.ac(11,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb();var i;g.xb(4),g.Ec(e.i18n.general.user),g.xb(2),g.Ec(e.i18n.userAlert.text),g.xb(2),g.Ec(e.i18n.general.date),g.xb(2),g.gc("ngForOf",null==(i=g.bc(11,4,e.results$))?null:i.results)}}let _e=(()=>{class e extends Qe.a{constructor(e,t){super(e),this.alertsService=t}ngOnInit(){super.ngOnInit(),this.data={}}getFormControlNames(){return["types","user","beginDate","endDate"]}toSearchParams(e){return{datePeriod:c.a.dateRangeFilter(e.beginDate,e.endDate),page:e.page,pageSize:e.pageSize,types:e.types,user:e.user}}doSearch(e){return this.alertsService.searchUserAlerts$Response(e)}resolveMenu(){return u.b.USER_ALERTS}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Se.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-user-alerts"]],features:[g.ub],decls:30,vars:28,consts:[[3,"ready"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","beginDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","endDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","types",3,"label","emptyOption"],["value","custom",3,"text"],["value","givenVeryBadRefs",3,"text"],["value","insufficientBalanceForInitialCredit",3,"text"],["value","maxDeviceActivationAttemptsReached",3,"text"],["value","maxDeviceConfirmationCheckAttemptsReached",3,"text"],["value","maxTokenActivationAttemptsReached",3,"text"],["value","maxUserLocalizationAttemptsReached",3,"text"],["value","maxVoucherRedeemAttemptsReached",3,"text"],["value","moveUserAutomaticallyFailed",3,"text"],["value","passwordDisabledByTries",3,"text"],["value","passwordTemporarilyBlocked",3,"text"],["value","receivedVeryBadRefs",3,"text"],["value","scheduledPaymentFailed",3,"text"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","rendering$","update"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarIcon","user",3,"avatarImage"],[1,"cell-main",3,"tooltip"],[1,"cell-cell-date"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.Qb(3,"form",2),g.Qb(4,"div",3),g.Qb(5,"div",4),g.Lb(6,"date-field",5),g.Pb(),g.Qb(7,"div",4),g.Lb(8,"date-field",6),g.Pb(),g.Qb(9,"div",4),g.Qb(10,"single-selection-field",7),g.Lb(11,"field-option",8),g.Lb(12,"field-option",9),g.Lb(13,"field-option",10),g.Lb(14,"field-option",11),g.Lb(15,"field-option",12),g.Lb(16,"field-option",13),g.Lb(17,"field-option",14),g.Lb(18,"field-option",15),g.Lb(19,"field-option",16),g.Lb(20,"field-option",17),g.Lb(21,"field-option",18),g.Lb(22,"field-option",19),g.Lb(23,"field-option",20),g.Pb(),g.Pb(),g.Qb(24,"div",4),g.Lb(25,"user-field",21),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Qb(26,"results-layout",22),g.Xb("update",(function(e){return t.update(e)})),g.ac(27,"async"),g.Bc(28,Re,8,7,"mobile-result",23),g.Bc(29,Ze,12,6,"table",24),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,24,t.data$)),g.xb(2),g.gc("heading",t.i18n.userAlert.title)("mobileHeading",t.i18n.userAlert.mobileTitle),g.xb(1),g.gc("formGroup",t.form),g.xb(3),g.gc("label",t.i18n.general.beginDate),g.xb(2),g.gc("label",t.i18n.general.endDate),g.xb(2),g.gc("label",t.i18n.userAlert.type.title)("emptyOption",t.i18n.general.notApplied),g.xb(1),g.gc("text",t.i18n.userAlert.type.custom),g.xb(1),g.gc("text",t.i18n.userAlert.type.givenVeryBadRefs),g.xb(1),g.gc("text",t.i18n.userAlert.type.insufficientBalanceForInitialCredit),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxDeviceActivationAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxTokenActivationAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxUserLocalizationAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxVoucherRedeemAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.moveUserAutomaticallyFailed),g.xb(1),g.gc("text",t.i18n.userAlert.type.passwordDisabledByTries),g.xb(1),g.gc("text",t.i18n.userAlert.type.passwordTemporarilyBlocked),g.xb(1),g.gc("text",t.i18n.userAlert.type.receivedVeryBadRefs),g.xb(1),g.gc("text",t.i18n.userAlert.type.receivedVeryBadRefs),g.xb(2),g.gc("label",t.i18n.general.user),g.xb(1),g.gc("results",g.bc(27,26,t.results$))("rendering$",t.rendering$))},directives:[f.a,m.a,h.I,h.w,h.n,Ne.a,h.v,h.l,Fe.a,Le.a,Be.a,$.a,U.a,H.a,G.a,I.b,p.s,p.q,we.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var Me=i("XDzf"),$e=i("Dhej");function Ue(e,t){if(1&e&&g.Lb(0,"boolean-field",7),2&e){const e=g.Zb(2);g.gc("label",e.i18n.brokers.mainBroker)}}function He(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",2),g.Qb(2,"form",3),g.Lb(3,"user-field",4),g.Bc(4,Ue,1,1,"boolean-field",5),g.Pb(),g.Qb(5,"actions"),g.Qb(6,"action-button",6),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(7,"async"),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.brokers.title.new)("mobileHeading",e.i18n.brokers.mobileTitle.new),g.xb(1),g.gc("formGroup",e.form),g.xb(1),g.gc("filters",e.userQuery)("allowContacts",!1)("label",e.i18n.brokers.broker),g.xb(1),g.gc("ngIf",e.data.brokers),g.xb(2),g.gc("disabled",g.bc(7,9,e.requesting$))("label",e.i18n.general.save)}}let Ge=(()=>{class e extends l.a{constructor(e,t){super(e),this.brokeringService=t,this.form=this.formBuilder.group({})}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.brokeringService.getBrokerDataForAdd({user:this.user}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.userQuery={roles:[Me.kb.BROKER],usersToExclude:e.brokers.map(e=>e.id),groups:e.brokerGroups.map(e=>e.id)},e.brokers&&this.form.setControl("mainBroker",this.formBuilder.control(!1)),this.form.setControl("broker",this.formBuilder.control(null,h.G.required))}save(){if(Object(b.F)(this.form),!this.form.valid)return;const e=this.form.value;this.addSub(this.brokeringService.addBroker({broker:e.broker,user:this.user,main:e.mainBroker}).subscribe(()=>{this.notification.snackBar(this.i18n.brokers.brokerAdded),this.router.navigate(["/users",this.user,"brokers"])}))}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb($e.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["broker-form"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],[3,"formGroup"],["formControlName","broker",3,"filters","allowContacts","label"],["formControlName","mainBroker",3,"label",4,"ngIf"],[3,"disabled","label","action"],["formControlName","mainBroker",3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,He,8,11,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Be.a,h.v,h.l,x.a,y.a,v.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function qe(e,t){if(1&e&&g.Lb(0,"user-info",7),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function Ke(e,t){1&e&&g.Lb(0,"icon",17)}function Ve(e,t){if(1&e){const e=g.Rb();g.Qb(0,"a",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).setMain(i),t.stopPropagation(),t.preventDefault()})),g.Dc(1),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(1),g.Fc("",e.i18n.brokers.setMain," ")}}function je(e,t){if(1&e){const e=g.Rb();g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Qb(2,"div"),g.Qb(3,"div",10),g.Dc(4),g.Pb(),g.Qb(5,"div",11),g.Bc(6,Ke,1,0,"icon",12),g.Bc(7,Ve,2,1,"a",13),g.Pb(),g.Pb(),g.Qb(8,"div",14),g.Qb(9,"button",15),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit;return g.Zb(2).remove(n),i.stopPropagation(),i.preventDefault()})),g.Lb(10,"icon",16),g.Pb(),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit;g.gc("avatarImage",null==e.broker?null:e.broker.image),g.xb(4),g.Fc(" ",e.broker.display," "),g.xb(2),g.gc("ngIf",e.main),g.xb(1),g.gc("ngIf",!e.main)}}function ze(e,t){1&e&&g.Lb(0,"icon",17)}function Xe(e,t){if(1&e){const e=g.Rb();g.Qb(0,"a",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).setMain(i),t.stopPropagation(),t.preventDefault()})),g.Dc(1),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.Fc("",e.i18n.brokers.setMain," ")}}const Je=function(e,t){return{"pb-0":e,"border-0":t}};function Ye(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"tr",24),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(3);return n.router.navigate(n.path(i))})),g.Qb(2,"td",25),g.ac(3,"async"),g.ac(4,"async"),g.Lb(5,"avatar",26),g.Pb(),g.Qb(6,"td"),g.Qb(7,"a",27),g.Dc(8),g.Pb(),g.Pb(),g.Qb(9,"td",28),g.Bc(10,ze,1,0,"icon",12),g.Bc(11,Xe,2,1,"a",13),g.Pb(),g.Qb(12,"td",29),g.Qb(13,"button",30),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit;return g.Zb(3).remove(n),i.stopPropagation()})),g.Lb(14,"icon",16),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.gc("ngClass",g.kc(12,Je,g.bc(3,8,i.layout.xxs$),g.bc(4,10,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.broker?null:e.broker.image)("tooltip",null==e.broker?null:e.broker.display),g.xb(2),g.gc("routerLink",i.path(e)),g.xb(1),g.Fc(" ",e.broker.shortDisplay," "),g.xb(2),g.gc("ngIf",e.main),g.xb(1),g.gc("ngIf",!e.main),g.xb(2),g.gc("tooltip",i.i18n.general.remove)}}function We(e,t){if(1&e&&(g.Qb(0,"table",19),g.Qb(1,"thead"),g.Lb(2,"th",20),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th",21),g.Dc(6),g.Pb(),g.Lb(7,"th",22),g.Pb(),g.Qb(8,"tbody"),g.Bc(9,Ye,15,15,"ng-container",23),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(4),g.Ec(e.i18n.general.user),g.xb(2),g.Fc("",e.i18n.brokers.mainBroker," "),g.xb(3),g.gc("ngForOf",e.data.brokers)}}function et(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,qe,1,1,"user-info",3),g.Pb(),g.Qb(4,"results-layout",4),g.Bc(5,je,11,4,"mobile-result",5),g.Bc(6,We,10,3,"table",6),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.brokers.title.list)("mobileHeading",e.i18n.brokers.mobileTitle.list)("headingActions",g.bc(2,7,e.headingActions$))("mode",e.self?"empty":"normal"),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.brokers)("toLink",e.toLink)}}let tt=(()=>{class e extends l.a{constructor(e,t){super(e),this.brokeringService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param}).subscribe(e=>{this.data=e}))}path(e){return["/users",e.broker.id,"profile"]}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user),this.brokers=e.brokers,this.headingActions=[],e.editable&&this.headingActions.push(new be.c("registration",this.i18n.general.addNew,()=>this.router.navigate(["/users",this.param,"brokers","new"]),!0)),e.history&&this.headingActions.push(new be.c("history",this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.param,"brokers","history"]),!0))}get toLink(){return e=>this.path(e)}setMain(e){this.addSub(this.brokeringService.setMainBroker({broker:e.broker.id,user:this.param}).subscribe(()=>{this.reload()}))}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.broker.display),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.brokeringService.removeBroker({broker:e.broker.id,user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.broker.display)),this.reload()}))}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb($e.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-user-brokers"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],["avatarIcon","user",3,"avatarImage"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],["class","d-inline-block","icon","done_outline",4,"ngIf"],["class","decorated",3,"click",4,"ngIf"],[1,"ml-auto"],[1,"btn","btn-icon",3,"click"],["icon","clear"],["icon","done_outline",1,"d-inline-block"],[1,"decorated",3,"click"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","20%",1,"text-center"],[1,"actions"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"],[3,"routerLink"],[1,"text-center"],[1,"actions","actions-multiple"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,et,7,9,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,U.a,H.a,P.a,G.a,q.a,p.s,p.q,we.a,I.b,a.h],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var it=i("zisa");function nt(e,t){1&e&&g.Mb(0)}function at(e,t){if(1&e&&(g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Qb(3,"div",10),g.Dc(4),g.ac(5,"date"),g.Pb(),g.Qb(6,"div",11),g.Dc(7),g.Pb(),g.Qb(8,"div",11),g.Dc(9),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("avatarImage",null==e.broker?null:e.broker.image),g.xb(2),g.Fc(" ",e.broker.display," "),g.xb(2),g.Fc(" ",g.bc(5,7,e.date)," "),g.xb(3),g.Gc(" ",i.i18n.general.action,": ",i.showActionLabel(e)," "),g.xb(2),g.Gc(" ",i.i18n.general.performedBy,": ",e.by?e.by.shortDisplay:i.i18n.brokers.administration," ")}}const st=function(e,t){return{"pb-0":e,"border-0":t}};function ot(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td",15),g.ac(2,"async"),g.ac(3,"async"),g.Lb(4,"avatar",16),g.Pb(),g.Qb(5,"td"),g.Dc(6),g.Pb(),g.Qb(7,"td"),g.Dc(8),g.ac(9,"date"),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.Pb(),g.Qb(12,"td"),g.Dc(13),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngClass",g.kc(13,st,g.bc(2,7,i.layout.xxs$),g.bc(3,9,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.broker?null:e.broker.image)("tooltip",null==e.broker?null:e.broker.display),g.xb(2),g.Ec(e.broker.shortDisplay),g.xb(2),g.Ec(g.bc(9,11,e.date)),g.xb(3),g.Ec(i.showActionLabel(e)),g.xb(2),g.Fc(" ",e.by?e.by.shortDisplay:i.i18n.brokers.administration," ")}}function rt(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Lb(2,"th",13),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Qb(9,"th"),g.Dc(10),g.Pb(),g.Pb(),g.Qb(11,"tbody"),g.Bc(12,ot,14,16,"tr",14),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(4),g.Ec(e.i18n.brokers.broker),g.xb(2),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.action),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function ct(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Lb(1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,at,10,9,"mobile-result",6),g.Bc(4,rt,13,5,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.brokers.title.history)("mobileHeading",e.i18n.brokers.mobileTitle.history),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)("onClick",e.onClick)}}let lt=(()=>{class e extends _.a{constructor(e,t){super(e),this.brokeringService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}showActionLabel(e){switch(e.action){case it.a.ADD:return this.i18n.brokers.action.add;case it.a.REMOVE:return this.i18n.brokers.action.remove;case it.a.SET_MAIN:return this.i18n.brokers.action.setMain}}get onClick(){return e=>null!=e}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb($e.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-broker-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results","onClick"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover",4,"resultTable"],["avatarIcon","user",3,"avatarImage"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[1,"avatar"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,nt,1,0,"ng-container",1),g.Pb(),g.Bc(3,ct,5,5,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,$.a,U.a,H.a,G.a,p.s,p.q,we.a,I.b],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();var bt=i("5Qz4"),ut=i("4APx");function dt(e,t){if(1&e&&g.Lb(0,"field-option",13),2&e){const e=t.$implicit;g.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function gt(e,t){if(1&e&&(g.Qb(0,"div",6),g.Qb(1,"multi-selection-field",11),g.Bc(2,dt,1,4,"field-option",12),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.connectedUser.channel),g.xb(1),g.gc("ngForOf",e.data.channels)}}function ft(e,t){if(1&e&&g.Lb(0,"field-option",16),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",e)("text",i.showConnectedLabel(e))}}function mt(e,t){if(1&e&&(g.Qb(0,"div",6),g.Qb(1,"multi-selection-field",14),g.Bc(2,ft,1,2,"field-option",15),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.connectedUser.showConnected),g.xb(1),g.gc("ngForOf",e.data.roles)}}function pt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",24),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).disconnect(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",25),g.Pb()}}function ht(e,t){if(1&e&&(g.Qb(0,"mobile-result",17),g.Qb(1,"div",18),g.Qb(2,"div"),g.Qb(3,"div",19),g.Dc(4),g.Pb(),g.Qb(5,"div",20),g.Dc(6),g.ac(7,"dateTime"),g.Pb(),g.Qb(8,"div",21),g.Dc(9),g.Pb(),g.Pb(),g.Qb(10,"div",22),g.Bc(11,pt,2,0,"button",23),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("avatarImage",null==e.user?null:e.user.image),g.xb(4),g.Fc(" ",e.user.shortDisplay," "),g.xb(2),g.Fc(" ",g.bc(7,5,e.creationDate)," "),g.xb(3),g.Fc(" ",e.channel.name," "),g.xb(2),g.gc("ngIf",i.canDisconnect(e))}}function vt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",33),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).disconnect(i),t.stopPropagation()})),g.Lb(1,"icon",25),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.connectedUser.disconnect)}}const xt=function(e,t){return{"pb-0":e,"border-0":t}};function yt(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"tr"),g.Qb(2,"td",30),g.ac(3,"async"),g.ac(4,"async"),g.Lb(5,"avatar",31),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.ac(12,"dateTime"),g.Pb(),g.Qb(13,"td"),g.Dc(14),g.Pb(),g.Qb(15,"td",28),g.Bc(16,vt,2,1,"button",32),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.gc("ngClass",g.kc(14,xt,g.bc(3,8,i.layout.xxs$),g.bc(4,10,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.user?null:e.user.image)("tooltip",null==e.user?null:e.user.display),g.xb(2),g.Ec(e.user.shortDisplay),g.xb(2),g.Ec(e.channel.name),g.xb(2),g.Ec(g.bc(12,12,e.creationDate)),g.xb(3),g.Ec(e.remoteAddress),g.xb(2),g.gc("ngIf",i.canDisconnect(e))}}function Pt(e,t){if(1&e&&(g.Qb(0,"table",26),g.Qb(1,"thead"),g.Lb(2,"th",27),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Qb(9,"th"),g.Dc(10),g.Pb(),g.Lb(11,"th",28),g.Pb(),g.Qb(12,"tbody"),g.Bc(13,yt,17,17,"ng-container",29),g.ac(14,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(4),g.Ec(e.i18n.general.user),g.xb(2),g.Ec(e.i18n.connectedUser.channel),g.xb(2),g.Ec(e.i18n.connectedUser.loggedInAt),g.xb(2),g.Ec(e.i18n.connectedUser.ipAddress),g.xb(3),g.gc("ngForOf",null==(i=g.bc(14,5,e.results$))?null:i.results)}}function It(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",2),g.Qb(2,"form",3),g.Qb(3,"div",4),g.Bc(4,gt,3,2,"div",5),g.Bc(5,mt,3,2,"div",5),g.Qb(6,"div",6),g.Lb(7,"user-field",7),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Qb(8,"results-layout",8),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(9,"async"),g.Bc(10,ht,12,7,"mobile-result",9),g.Bc(11,Pt,15,7,"table",10),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.connectedUser.title)("mobileHeading",e.i18n.connectedUser.mobileTitle),g.xb(1),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",(null==e.data.channels?null:e.data.channels.length)>1),g.xb(1),g.gc("ngIf",(null==e.data.roles?null:e.data.roles.length)>1),g.xb(2),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("results",g.bc(9,9,e.results$))("onClick",e.onClick)("rendering$",e.rendering$)}}let Et=(()=>{class e extends Qe.a{constructor(e,t){super(e),this.sessionsService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.sessionsService.getSessionDataForSearch().subscribe(e=>{this.form.patchValue(e.query,{emitEvent:!1}),this.data=e}))}toSearchParams(e){return e}disconnect(e){this.addSub(this.sessionsService.disconnectSession({sessionToken:e.sessionToken}).subscribe(()=>{this.notification.snackBar(this.i18n.connectedUser.disconnected(e.user.display)),this.update()}))}canDisconnect(e){return this.login.auth.permissions.sessions.disconnect&&this.login.auth.sessionToken!==e.sessionToken}get onClick(){return e=>null!=e}getFormControlNames(){return["channels","roles","user"]}doSearch(e){return this.sessionsService.searchSessions$Response(e)}showConnectedLabel(e){switch(e){case Me.kb.ADMINISTRATOR:return this.i18n.connectedUser.viewConnected.admin;case Me.kb.BROKER:return this.i18n.connectedUser.viewConnected.broker;case Me.kb.MEMBER:return this.i18n.connectedUser.viewConnected.member;case Me.kb.OPERATOR:return this.i18n.connectedUser.viewConnected.operator}}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(bt.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-connected"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","onClick","rendering$","update"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","formControlName","channels",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","roles",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["avatarIcon","user",3,"avatarImage"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[1,"ml-auto"],["class","btn btn-icon",3,"click",4,"ngIf"],[1,"btn","btn-icon",3,"click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"actions"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,It,12,11,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Be.a,h.v,h.l,$.a,U.a,H.a,ut.a,p.s,Le.a,G.a,q.a,p.q,we.a,I.b],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var At=i("2S6i"),Ct=i("2Vo4"),Dt=i("Ls5z"),Ot=i("DIHi"),St=i("YG2p"),Qt=i("ZJXG");function Nt(e,t){if(1&e&&g.Lb(0,"boolean-field",16),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.brokerManageable)}}function Ft(e,t){if(1&e){const e=g.Rb();g.Qb(0,"label-value",17),g.Qb(1,"div"),g.Qb(2,"span"),g.Dc(3),g.ac(4,"async"),g.Pb(),g.Qb(5,"button",18),g.Xb("click",(function(t){return g.sc(e),g.Zb(2).download(),t.stopPropagation()})),g.Lb(6,"icon",19),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.document),g.xb(3),g.Fc(" ",g.bc(4,3,e.fileName$)," "),g.xb(2),g.gc("tooltip",e.i18n.general.download)}}function Lt(e,t){if(1&e&&(g.Ob(0,4),g.Qb(1,"label-value",5),g.Lb(2,"user-link",6),g.Pb(),g.Lb(3,"input-field",7),g.Lb(4,"textarea-field",8),g.Lb(5,"boolean-field",9),g.Lb(6,"boolean-field",10),g.Lb(7,"boolean-field",11,12),g.Bc(9,Nt,1,1,"boolean-field",13),g.Bc(10,Ft,7,5,"label-value",14),g.ac(11,"async"),g.Lb(12,"file-field",15),g.ac(13,"async"),g.Nb()),2&e){const e=g.qc(8),t=g.Zb();g.gc("formGroup",t.form),g.xb(1),g.gc("label",t.i18n.general.user),g.xb(1),g.gc("user",t.data.user),g.xb(1),g.gc("label",t.i18n.general.name),g.xb(1),g.gc("label",t.i18n.general.description),g.xb(1),g.gc("label",t.i18n.document.enable),g.xb(1),g.gc("label",t.i18n.document.userVisible),g.xb(1),g.gc("label",t.i18n.document.brokerVisible),g.xb(2),g.gc("ngIf",e.value),g.xb(1),g.gc("ngIf",!t.create&&g.bc(11,13,t.fileName$)),g.xb(2),g.gc("required",t.create)("label",t.create||null!==g.bc(13,15,t.fileName$)?t.i18n.document.newDocument:t.i18n.document.replaceDocument)("formControl",t.fileControl)}}let Bt=(()=>{class e extends l.a{constructor(e,t){super(e),this.documentsService=t,this.fileName$=new Ct.a(null)}isOwner(){return this.authHelper.isSelf(this.data.user)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.user=e.params.user,this.id=e.params.id,this.create=null==this.id;const t=this.create?this.documentsService.getUserDocumentDataForNew({user:this.user}):this.documentsService.getDocumentDataForEdit({id:this.id});this.addSub(t.subscribe(e=>this.data=e))}download(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(b.g))}onDataInitialized(e){var t;super.onDataInitialized(e);const i=e.document,n=e.document;this.create||this.fileName$.next(null===(t=e.file)||void 0===t?void 0:t.name),this.fileControl=this.formBuilder.control(null,this.create?h.G.required:null),this.form=this.formBuilder.group({name:[i.name,h.G.required],description:i.description,enabled:i.enabled,userVisible:i.userVisible,brokerVisible:i.brokerVisible,brokerManageable:i.brokerManageable,version:n.version})}asEdit(){return this.data}asNew(){return this.data}save(){Object(b.F)(this.form);const e=this.fileControl.value;if((this.create||e)&&Object(b.F)(this.fileControl),!this.form.valid||!this.fileControl.valid)return;const t=Object(d.a)(this.form.value);t.brokerVisible||(t.brokerManageable=!1),this.addSub(this.create?this.documentsService.createUserDocumentWithUpload({user:this.user,body:{document:t,file:e}}).subscribe(e=>this.notifySavedAndReload(e)):this.fileControl.value?this.documentsService.updateDocumentWithUpload({id:this.id,body:{document:t,file:e}}).subscribe(()=>this.notifySavedAndReload(this.id)):this.documentsService.updateDocument({id:this.id,body:t}).subscribe(()=>this.notifySavedAndReload(this.id)))}notifySavedAndReload(e){this.notification.snackBar(this.i18n.document.savedSuccessfully),this.router.navigate(["/users","documents","edit",e])}formControl(e){return this.form.get(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(At.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["edit-document"]],features:[g.ub],decls:7,vars:10,consts:[[3,"ready"],[3,"heading","mobileHeading"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["fieldSize","full","required","","formControlName","name",3,"label"],["formControlName","description",3,"label"],["formControlName","enabled",3,"label"],["formControlName","userVisible",3,"label"],["formControlName","brokerVisible",3,"label"],["brokerVisible",""],["formControlName","brokerManageable",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],[3,"required","label","formControl"],["formControlName","brokerManageable",3,"label"],[3,"label"],[1,"btn","btn-icon","ml-2",3,"tooltip","click"],["icon","save_alt"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.Bc(3,Lt,14,17,"ng-container",2),g.Qb(4,"actions"),g.Qb(5,"action-button",3),g.Xb("action",(function(){return t.save()})),g.ac(6,"async"),g.Pb(),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,6,t.data$)),g.xb(2),g.gc("heading",t.create?t.i18n.document.title.new:t.i18n.document.title.edit)("mobileHeading",t.create?t.i18n.document.mobileTitle.new:t.i18n.document.mobileTitle.edit),g.xb(1),g.gc("ngIf",t.data),g.xb(2),g.gc("disabled",g.bc(6,8,t.requesting$))("label",t.i18n.general.save))},directives:[f.a,m.a,p.t,x.a,y.a,h.w,h.n,Q.a,Dt.a,Ot.a,h.D,h.v,h.l,St.a,v.a,Qt.a,h.k,I.b,q.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function wt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).download(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",11),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.download)}}function Rt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(2);return n.router.navigate(n.path(i)),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",12),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.document.process)}}function kt(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",6),g.Qb(2,"div"),g.Qb(3,"label-value",7),g.Dc(4),g.Pb(),g.Qb(5,"label-value",7),g.Dc(6),g.Pb(),g.Pb(),g.Qb(7,"div",8),g.Bc(8,wt,2,1,"button",9),g.Bc(9,Rt,2,1,"button",9),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("label",i.i18n.general.name),g.xb(1),g.Fc(" ",e.name," "),g.xb(1),g.gc("label",i.i18n.general.description),g.xb(1),g.Fc(" ",e.description," "),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind))}}function Tt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).download(i),t.stopPropagation()})),g.Lb(1,"icon",11),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.download)}}function Zt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(3);return n.router.navigate(n.path(i)),t.stopPropagation()})),g.Lb(1,"icon",12),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.document.process)}}function _t(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",16),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.isStatic(n.kind)?a.download(n):a.router.navigate(a.path(n)),i.stopPropagation()})),g.Qb(1,"td",17),g.Dc(2),g.Pb(),g.Qb(3,"td"),g.Dc(4),g.Pb(),g.Qb(5,"td",18),g.Bc(6,Tt,2,1,"button",9),g.Bc(7,Zt,2,1,"button",9),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(e.name),g.xb(2),g.Ec(e.description),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind))}}function Mt(e,t){if(1&e&&(g.Qb(0,"table",13),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Lb(6,"th",14),g.Pb(),g.Qb(7,"tbody"),g.Bc(8,_t,8,4,"tr",15),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.name),g.xb(2),g.Ec(e.i18n.general.description),g.xb(3),g.gc("ngForOf",e.data)}}function $t(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"results-layout",3),g.Bc(4,kt,10,6,"mobile-result",4),g.Bc(5,Mt,9,3,"table",5),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("mode","empty")("heading",e.i18n.document.title.list)("mobileHeading",e.i18n.document.mobileTitle.list)("headingActions",g.bc(2,5,e.headingActions$)),g.xb(2),g.gc("results",e.data)}}let Ut=(()=>{class e extends l.a{constructor(e,t){super(e),this.documentsService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.documentsService.listUserDocuments({user:c.a.SELF}).subscribe(e=>this.data=e))}isStatic(e){return e!==Me.u.DYNAMIC}download(e){this.addSub(this.documentsService.downloadDocumentFile$Response({id:e.id}).subscribe(b.g))}path(e){return["/users","documents","process-dynamic",e.id]}resolveMenu(){return this.menu.userMenu(null,u.b.MY_DOCUMENTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(At.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-documents"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","save_alt"],["icon","edit"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,$t,6,7,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,U.a,H.a,G.a,Q.a,I.b,q.a,p.s],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Ht=i("OoS4"),Gt=i("Y+zs"),qt=i("bBjs"),Kt=i("cyUc");function Vt(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"custom-field-input",6),g.Nb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(2);g.xb(1),g.gc("field",e)("formControl",n.formControl(e.internalName))("focused",i)("labelPosition","auto")}}function jt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.Bc(1,Vt,2,4,"ng-container",4),g.Qb(2,"actions"),g.Qb(3,"action-button",5),g.Xb("action",(function(){return g.sc(e),g.Zb().process()})),g.ac(4,"async"),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.data.document.name)("mobileHeading",e.data.document.name),g.xb(1),g.gc("ngForOf",e.formFields),g.xb(2),g.gc("disabled",g.bc(4,5,e.requesting$))("label",e.i18n.general.submit)}}function zt(e,t){if(1&e&&(g.Qb(0,"page-content",7),g.ac(1,"async"),g.Lb(2,"div",8),g.ac(3,"trust"),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.data.document.name)("mobileHeading",e.data.document.name)("headingActions",g.bc(1,4,e.headingActions$)),g.xb(2),g.gc("innerHTML",g.bc(3,6,e.result),g.tc)}}let Xt=(()=>{class e extends l.a{constructor(e,t,i){super(e),this.fieldsHelper=t,this.documentsService=i,this.step$=new Ct.a(null),this.result$=new Ct.a(null)}get result(){return this.result$.value}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.documentId=this.route.snapshot.params.id,this.addSub(this.documentsService.getDataForDynamicDocument({id:this.documentId,user:c.a.SELF}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.formFields=e.formFields||[],this.form=this.fieldsHelper.customValuesFormGroup(this.formFields),this.formFields.length>0?this.step="form":this.process()}process(){Object(b.F)(this.form),this.form.valid&&this.addSub(this.documentsService.processDynamicDocument({id:this.documentId,user:c.a.SELF,body:{formFields:this.form.value}}).subscribe(e=>{this.result$.next(e);const t=[];t.push(this.exportHelper.printAction()),t[0].maybeRoot=!0,this.headingActions=t,this.step="preview"}))}formControl(e){return this.form.get(e)}resolveMenu(){return this.menu.userMenu(null,u.b.MY_DOCUMENTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ht.a),g.Kb(At.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["process-dynamic-document"]],features:[g.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading",4,"ngSwitchCase"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[3,"heading","mobileHeading"],[4,"ngFor","ngForOf"],[3,"disabled","label","action"],[3,"field","formControl","focused","labelPosition"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions"],[3,"innerHTML"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.ac(2,"async"),g.Bc(3,jt,5,7,"page-content",1),g.Bc(4,zt,4,8,"page-content",2),g.Pb()),2&e&&(g.gc("ready",g.bc(1,4,t.data$))("ngSwitch",g.bc(2,6,t.step$)),g.xb(3),g.gc("ngSwitchCase","form"),g.xb(1),g.gc("ngSwitchCase","preview"))},directives:[f.a,p.x,p.y,m.a,p.s,x.a,y.a,Gt.a,h.v,h.k,qt.a],pipes:[p.b,Kt.a],encapsulation:2,changeDetection:0}),e})();function Jt(e,t){1&e&&g.Lb(0,"div",5)}function Yt(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",5),g.Qb(2,"label-value",10),g.Lb(3,"user-link",11),g.Pb(),g.Pb(),g.Bc(4,Jt,1,0,"div",12),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("ngIf",e.layout.gtsm$)}}function Wt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).navigateToView(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.view)}}function ei(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",20),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).download(i),t.stopPropagation()})),g.Lb(1,"icon",21),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.download)}}function ti(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(2);return n.router.navigate(n.process(i)),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.document.process)}}function ii(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",20),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).remove(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",22),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.remove)}}function ni(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",13),g.Qb(2,"div"),g.Qb(3,"label-value",14),g.Dc(4),g.Pb(),g.Qb(5,"label-value",14),g.Dc(6),g.Pb(),g.Pb(),g.Qb(7,"div",15),g.Bc(8,Wt,2,1,"button",16),g.Bc(9,ei,2,1,"button",17),g.Bc(10,ti,2,1,"button",16),g.Bc(11,ii,2,1,"button",17),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("label",i.i18n.general.name),g.xb(1),g.Fc(" ",e.name," "),g.xb(1),g.gc("label",i.i18n.general.description),g.xb(1),g.Fc(" ",e.description," "),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",i.isUserKind(e))}}function ai(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).download(i),t.stopPropagation()})),g.Lb(1,"icon",21),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.download)}}function si(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(3);return n.router.navigate(n.process(i)),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.document.process)}}function oi(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",30),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).remove(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",22),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.remove)}}function ri(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",26),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.isStatic(n.kind)?a.navigateToView(n):a.router.navigate(a.process(n)),i.stopPropagation(),i.preventDefault()})),g.Qb(1,"td",27),g.Dc(2),g.Pb(),g.Qb(3,"td"),g.Dc(4),g.Pb(),g.Qb(5,"td",28),g.Bc(6,ai,2,1,"button",16),g.Bc(7,si,2,1,"button",16),g.Bc(8,oi,2,1,"button",29),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(e.name),g.xb(2),g.Ec(e.description),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",i.data.canManageIndividual&&i.isUserKind(e))}}function ci(e,t){if(1&e&&(g.Qb(0,"table",23),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Lb(6,"th",24),g.Pb(),g.Qb(7,"tbody"),g.Bc(8,ri,9,5,"tr",25),g.ac(9,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(3),g.Ec(e.i18n.general.name),g.xb(2),g.Ec(e.i18n.general.description),g.xb(3),g.gc("ngForOf",null==(i=g.bc(9,3,e.results$))?null:i.results)}}function li(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"form",3),g.Qb(4,"div",4),g.Bc(5,Yt,5,3,"ng-container",1),g.Qb(6,"div",5),g.Lb(7,"input-field",6),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Qb(8,"results-layout",7),g.ac(9,"async"),g.Bc(10,ni,12,8,"mobile-result",8),g.Bc(11,ci,10,5,"table",9),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.document.title.search)("mobileHeading",e.i18n.document.mobileTitle.search)("headingActions",g.bc(2,8,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",!e.authHelper.isSelf(e.data.user)),g.xb(2),g.gc("label",e.i18n.general.keywords),g.xb(1),g.gc("results",g.bc(9,10,e.results$))("rendering$",e.rendering$)}}let bi=(()=>{class e extends Qe.a{constructor(e,t){super(e),this.documentsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.documentsService.getDocumentsDataForSearch({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=[new be.c("add",this.i18n.general.add,()=>{this.router.navigate(["/users",this.user,"documents","new"])},!0)]}doSearch(e){return this.documentsService.searchDocuments$Response(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.documentsService.deleteDocument({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.update()}))}toSearchParams(e){return e}getFormControlNames(){return["brokers","categories","enabled","groups","keywords","range","user"]}isStatic(e){return e!==Me.u.DYNAMIC}download(e){this.addSub(this.documentsService.downloadDocumentFile$Response({id:e.id}).subscribe(b.g))}process(e){return["/users","documents","process-dynamic",e.id]}view(e){return["/users","documents","view",e.id]}isUserKind(e){return e.kind===Me.u.USER}navigateToView(e){this.router.navigate(this.view(e))}get toProcessLink(){return e=>this.process(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(At.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-documents"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords","fieldSize","full",3,"label"],["resultType","list",3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon mt-2",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","edit"],[1,"btn","btn-icon","mt-2",3,"tooltip","click"],["icon","save_alt"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"],["class","btn btn-icon ml-2",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon","ml-2",3,"tooltip","click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,li,12,12,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Ot.a,h.v,h.l,$.a,U.a,H.a,Q.a,Dt.a,G.a,I.b,q.a,p.s],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function ui(e,t){if(1&e&&(g.Qb(0,"label-value",8),g.Lb(1,"user-link",9),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function di(e,t){if(1&e&&(g.Qb(0,"label-value",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.category),g.xb(1),g.Fc(" ",e.data.category.name," ")}}function gi(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.userVisible),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.userVisible)," ")}}function fi(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.brokerVisible),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.brokerVisible)," ")}}function mi(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.brokerManageable),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.brokerManageable)," ")}}function pi(e,t){if(1&e&&(g.Ob(0),g.Bc(1,ui,2,2,"label-value",4),g.Qb(2,"label-value",5),g.Dc(3),g.Pb(),g.Qb(4,"label-value",5),g.Dc(5),g.Pb(),g.Bc(6,di,2,2,"label-value",6),g.Qb(7,"label-value",5),g.Dc(8),g.Pb(),g.Bc(9,gi,2,2,"label-value",7),g.Bc(10,fi,2,2,"label-value",7),g.Bc(11,mi,2,2,"label-value",7),g.Qb(12,"label-value",5),g.Dc(13),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("ngIf",e.data.user),g.xb(1),g.gc("label",e.i18n.general.name),g.xb(1),g.Fc(" ",e.data.name," "),g.xb(1),g.gc("label",e.i18n.general.description),g.xb(1),g.Fc(" ",e.data.description," "),g.xb(1),g.gc("ngIf",e.data.category),g.xb(1),g.gc("label",e.i18n.document.enable),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.enabled)," "),g.xb(1),g.gc("ngIf",e.data.userVisible),g.xb(1),g.gc("ngIf",e.data.brokerVisible),g.xb(1),g.gc("ngIf",e.data.brokerVisible),g.xb(1),g.gc("label",e.i18n.document.document),g.xb(1),g.Fc(" ",e.data.file.name," ")}}let hi=(()=>{class e extends l.a{constructor(e,t){super(e),this.documentsService=t}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.documentsService.viewDocument({id:this.id}).subscribe(e=>this.data=e))}onDataInitialized(e){if(super.onDataInitialized(e),this.dataForUiHolder.auth.role!==Me.kb.BROKER||e.brokerManageable){const e=[new be.c("edit",this.i18n.general.edit,()=>this.navigateToEdit(),!0)];e.push(new be.c("clear",this.i18n.general.remove,()=>this.remove(),!0)),this.headingActions=e}}remove(){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.doRemove()})}doRemove(){this.addSub(this.documentsService.deleteDocument({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.router.navigate(["/users",this.data.user.id,"documents","search"])}))}download(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(b.g))}navigateToEdit(){this.router.navigate(["/users","documents","edit",this.id])}resolveMenu(e){return e.kind===Me.u.USER&&this.authHelper.isSelf(e.user)?this.menu.userMenu(null,u.b.MY_DOCUMENTS):this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(At.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-document"]],features:[g.ub],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[3,"disabled","label","action"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],["ng","",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["ng","",3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.ac(3,"async"),g.Bc(4,pi,14,13,"ng-container",2),g.Qb(5,"actions"),g.Qb(6,"action-button",3),g.Xb("action",(function(){return t.download()})),g.ac(7,"async"),g.Pb(),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,7,t.data$)),g.xb(2),g.gc("heading",t.i18n.document.title.view)("mobileHeading",t.i18n.document.mobileTitle.view)("headingActions",g.bc(3,9,t.headingActions$)),g.xb(2),g.gc("ngIf",t.data),g.xb(2),g.gc("disabled",g.bc(7,11,t.requesting$))("label",t.i18n.general.download))},directives:[f.a,m.a,p.t,x.a,y.a,Q.a,Dt.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var vi=i("j79m");function xi(e,t){1&e&&g.Mb(0)}function yi(e,t){if(1&e&&(g.Qb(0,"div",11),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Gc(" ",t.i18n.general.performedBy,": ",e.by.display," ")}}function Pi(e,t){if(1&e&&(g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Bc(3,yi,2,2,"div",10),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("date",null==e.period?null:e.period.date),g.xb(2),g.Gc(" ",i.i18n.user.group,": ",e.group?e.group.name:i.i18n.user.operatorNoGroup," "),g.xb(1),g.gc("ngIf",e.by)}}function Ii(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td"),g.Dc(2),g.ac(3,"date"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(g.bc(3,3,null==e.period?null:e.period.begin)),g.xb(3),g.Fc("",e.group?e.group.name:i.i18n.user.operatorNoGroup," "),g.xb(2),g.Ec(null==e.by?null:e.by.display)}}function Ei(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Pb(),g.Qb(8,"tbody"),g.Bc(9,Ii,8,5,"tr",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function Ai(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Lb(1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,Pi,4,4,"mobile-result",6),g.Bc(4,Ei,10,4,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.groupMembership.title.historyOperator:e.i18n.groupMembership.title.historyUser)("mobileHeading",e.operator?e.i18n.groupMembership.mobileTitle.historyOperator:e.i18n.groupMembership.mobileTitle.historyUser),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)}}let Ci=(()=>{class e extends _.a{constructor(e,t,i){super(e),this.groupMembershipService=t,this.userHelper=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(vi.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-group-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,xi,1,0,"ng-container",1),g.Pb(),g.Bc(3,Ai,5,4,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,$.a,U.a,H.a,G.a,p.s],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function Di(e,t){if(1&e&&g.Lb(0,"field-option",11),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function Oi(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Lb(1,"hr"),g.Qb(2,"form",6),g.Qb(3,"single-selection-field",7),g.Bc(4,Di,1,4,"field-option",8),g.Pb(),g.Lb(5,"textarea-field",9),g.Pb(),g.Qb(6,"actions"),g.Qb(7,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(2);g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("label",e.i18n.groupMembership.new)("required",!e.allowEmptyGroup)("emptyOption",e.allowEmptyGroup?e.i18n.user.operatorNoGroup:null),g.xb(1),g.gc("ngForOf",e.data.possibleNewGroups),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(2),g.gc("label",e.i18n.general.submit)}}function Si(e,t){if(1&e&&(g.Qb(0,"page-content",2),g.ac(1,"async"),g.Lb(2,"user-info",3),g.Qb(3,"label-value",4),g.Dc(4),g.Pb(),g.Bc(5,Oi,8,7,"ng-container",5),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.groupMembership.title.groupOperator:e.i18n.groupMembership.title.groupUser)("mobileHeading",e.operator?e.i18n.groupMembership.mobileTitle.groupOperator:e.i18n.groupMembership.mobileTitle.groupUser)("headingActions",g.bc(1,7,e.headingActions$)),g.xb(2),g.gc("user",e.data.user),g.xb(1),g.gc("label",e.i18n.groupMembership.current),g.xb(1),g.Fc(" ",e.data.group?e.data.group.name:e.i18n.user.operatorNoGroup," "),g.xb(1),g.gc("ngIf",e.editable)}}let Qi=(()=>{class e extends _.a{constructor(e,t,i){super(e),this.userHelper=t,this.groupMembershipService=i}get editable(){return!Object(b.h)(this.data.possibleNewGroups)}get operator(){return this.userHelper.isOperator(this.data.user)}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["-history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.allowEmptyGroup=this.userHelper.isOperator(e.user)&&!!e.group,this.form=this.formBuilder.group({group:this.allowEmptyGroup?null:[null,h.G.required],comment:null}),this.headingActions=[new be.c("history",this.i18n.general.viewHistory,()=>this.router.navigate(["users",this.param,"group","history"]),!0)]}save(){if(Object(b.F)(this.form),!this.form.valid)return;const e=this.data.possibleNewGroups.find(e=>e.id===this.form.value.group);let t,i;t=this.userHelper.isOperator(this.data.user)?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,i=e?this.i18n.groupMembership.confirm({user:this.data.user.display,group:e?e.name:this.i18n.user.operatorNoGroup}):this.i18n.groupMembership.confirmAliasOperator(this.data.user.display),this.notification.confirm({title:t,message:i,callback:()=>this.submit()})}submit(){this.addSub(this.groupMembershipService.changeGroupMembership({user:this.param,body:this.form.value}).subscribe(()=>{this.notification.snackBar(this.operator?this.i18n.groupMembership.doneOperator:this.i18n.groupMembership.doneUser),this.reload()}))}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(vi.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-group"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","group",3,"label","required","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[3,"label","action"],[3,"value","id","internalName","text"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Si,6,9,"page-content",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,Q.a,h.I,h.w,h.n,Fe.a,h.v,h.l,h.D,p.s,St.a,x.a,y.a,Le.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Ni=i("fGFU");function Fi(e,t){1&e&&g.Mb(0)}function Li(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"user-info",7),g.Lb(2,"hr"),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("user",e.data.user)}}function Bi(e,t){1&e&&g.Lb(0,"hr",18)}function wi(e,t){if(1&e&&g.Lb(0,"avatar",19),2&e){const e=g.Zb().$implicit;g.gc("size",64)("image",e.identityProvider.image)}}function Ri(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.ac(2,"dateTime"),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.xb(1),g.Fc(" ",t.i18n.identityProvider.connectedOn(g.bc(2,1,e.linkDate))," ")}}function ki(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.Fc(" ",e.i18n.identityProvider.disconnected," ")}}function Ti(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.name," ")}}function Zi(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.email," ")}}const _i=function(e){return{"mb-3":e}};function Mi(e,t){if(1&e&&(g.Qb(0,"action-button",20),g.Xb("action",(function(){return t.$implicit.onClick()})),g.Pb()),2&e){const e=t.$implicit;g.gc("ngClass",g.jc(2,_i,!t.last))("label",e.label)}}const $i=function(e){return{"mt-0":e}};function Ui(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Bi,1,0,"hr",9),g.Qb(2,"div",10),g.Qb(3,"div",11),g.Bc(4,wi,1,2,"avatar",12),g.ac(5,"async"),g.Pb(),g.Qb(6,"div",13),g.Qb(7,"h2",14),g.Dc(8),g.Pb(),g.Qb(9,"div",15),g.Bc(10,Ri,3,3,"div",5),g.Bc(11,ki,2,1,"div",5),g.Bc(12,Ti,2,1,"div",5),g.Bc(13,Zi,2,1,"div",5),g.Pb(),g.Pb(),g.Qb(14,"div",16),g.Bc(15,Mi,1,4,"action-button",17),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(3);g.xb(1),g.gc("ngIf",!i),g.xb(3),g.gc("ngIf",g.bc(5,9,n.layout.gtxxs$)),g.xb(3),g.gc("ngClass",g.jc(11,$i,i)),g.xb(1),g.Fc(" ",e.identityProvider.name,""),g.xb(2),g.gc("ngIf",e.linkDate),g.xb(1),g.gc("ngIf","linked"!==e.status),g.xb(1),g.gc("ngIf",e.name),g.xb(1),g.gc("ngIf",e.email),g.xb(2),g.gc("ngForOf",n.actions(e))}}function Hi(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Ui,16,13,"ng-container",8),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("ngForOf",e.data.identityProviders)}}function Gi(e,t){if(1&e&&(g.Qb(0,"page-content",4),g.Bc(1,Li,3,1,"ng-container",5),g.Bc(2,Hi,2,1,"ng-container",6),g.Pb()),2&e){const e=g.Zb(),t=g.qc(6);g.gc("heading",e.title)("mobileHeading",e.mobileTitle),g.xb(1),g.gc("ngIf",e.data.user&&!e.self),g.xb(1),g.gc("ngIf",e.data.identityProviders.length>0)("ngIfElse",t)}}function qi(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb();g.Fc(" ",e.i18n.identityProvider.noResults,"\n")}}let Ki=(()=>{class e extends l.a{constructor(e,t){super(e),this.identityProvidersService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.identityProvidersService.getUserIdentityProvidersListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user),this.title=this.self?this.i18n.identityProvider.title.manageSelf:this.i18n.identityProvider.title.manageUser,this.mobileTitle=this.self?this.i18n.identityProvider.mobileTitle.manageSelf:this.i18n.identityProvider.mobileTitle.manageUser}actions(e){const t=[];return e.status!==Me.Gb.LINKED&&this.data.canLink&&t.push(new be.a(this.i18n.identityProvider.action.connect,()=>{this.connect(e)})),e.status===Me.Gb.LINKED&&this.data.canEdit&&t.push(new be.a(this.i18n.identityProvider.action.disconnect,()=>{this.disconnect(e)})),t}connect(e){this.addSub(this.authHelper.identityProviderPopup(e.identityProvider,"link").subscribe(e=>{this.notification.snackBar(this.i18n.identityProvider.action.connectDone({name:e.name,provider:e.identityProvider.name})),this.reload()}))}disconnect(e){this.notification.confirm({title:this.i18n.identityProvider.action.disconnect,message:this.i18n.identityProvider.action.disconnectConfirm(e.identityProvider.name),callback:()=>this.doDisconnect(e)})}doDisconnect(e){const t=e.identityProvider;this.addSub(this.identityProvidersService.deleteUserIdentityProvider({user:this.param,identityProvider:t.internalName,disable:!0}).subscribe(()=>{this.notification.info(this.i18n.identityProvider.action.disconnectDone(t.name)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.IDENTITY_PROVIDERS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ni.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["user-identity-providers"]],features:[g.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["noResults",""],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["labelCols","2",3,"user"],[4,"ngFor","ngForOf"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-xs-3","col-md-2"],["class","ml-2 mr-5 management","iconSize","64px","icon","perm_identity",3,"size","image",4,"ngIf"],[1,"col-8","col-xs-9","col-md-7"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto",3,"ngClass","label","action",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px","icon","perm_identity",1,"ml-2","mr-5","management",3,"size","image"],[1,"d-block","ml-auto",3,"ngClass","label","action"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Fi,1,0,"ng-container",1),g.Pb(),g.Bc(3,Gi,3,5,"ng-template",null,2,g.Cc),g.Bc(5,qi,1,1,"ng-template",null,3,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,p.s,p.q,we.a,y.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var Vi=i("+QOm"),ji=i("dCJh"),zi=i("iXUt");function Xi(e,t){if(1&e&&g.Lb(0,"boolean-field",9),2&e){const e=g.Zb(2);g.gc("label",e.i18n.notificationSettings.forwardMessages)("disabled",!e.data.editable)}}const Ji=function(e){return{"border-top-0":e}};function Yi(e,t){if(1&e&&(g.Qb(0,"h2",13),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.gc("ngClass",g.jc(2,Ji,!e.data.forwardMessagesAllowed)),g.xb(1),g.Fc(" ",e.i18n.notificationSettings.payments,"")}}function Wi(e,t){if(1&e&&(g.Qb(0,"h3",14),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit;g.xb(1),g.Fc(" ",e.name," ")}}function en(e,t){1&e&&g.Mb(0)}const tn=function(e){return{$implicit:e}};function nn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Yi,2,4,"h2",10),g.Ob(2,4),g.Bc(3,Wi,2,1,"h3",11),g.Bc(4,en,1,0,"ng-container",12),g.Nb(),g.Nb()),2&e){const e=t.ngIf,i=g.Zb(),n=i.first,a=i.$implicit,s=g.Zb(2),o=g.qc(4);g.xb(1),g.gc("ngIf",n),g.xb(1),g.gc("formGroup",e),g.xb(1),g.gc("ngIf",!s.singleAccount),g.xb(1),g.gc("ngTemplateOutlet",o)("ngTemplateOutletContext",g.jc(5,tn,a))}}function an(e,t){if(1&e&&(g.Ob(0),g.Bc(1,nn,5,7,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(1),g.gc("ngIf",i.form.get("userAccounts").get(e.id))}}function sn(e,t){if(1&e&&g.Lb(0,"field-option",17),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function on(e,t){if(1&e&&(g.Qb(0,"multi-selection-field",15),g.Bc(1,sn,1,4,"field-option",16),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.notificationSettings.forwardMessages),g.xb(1),g.gc("ngForOf",e.data.messageCategories)}}const rn=function(e){return{"section-title-action":e}},cn=function(e,t){return{"mr-3":e,"mb-2":t}};function ln(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",13),g.ac(1,"async"),g.Qb(2,"action-button",21),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(2).enableNotifications(t,!0)})),g.ac(3,"async"),g.ac(4,"async"),g.Pb(),g.Qb(5,"action-button",22),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(2).enableNotifications(t,!1)})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("ngClass",g.jc(10,rn,g.bc(1,4,e.layout.gtsm$))),g.xb(2),g.gc("ngClass",g.kc(12,cn,!g.bc(3,6,e.layout.ltxs$),g.bc(4,8,e.layout.ltxs$)))("label",e.i18n.notificationSettings.enableAll),g.xb(3),g.gc("label",e.i18n.notificationSettings.disableAll)}}function bn(e,t){if(1&e&&(g.Qb(0,"h2",19),g.Qb(1,"div",20),g.Dc(2),g.Pb(),g.Bc(3,ln,6,15,"div",10),g.Pb()),2&e){const e=g.Zb(),t=e.first,i=e.$implicit,n=g.Zb(2);g.gc("ngClass",g.jc(3,Ji,t&&0===n.data.userAccounts.length&&0===n.data.messageCategories.length&&!n.data.forwardMessagesAllowed)),g.xb(2),g.Fc(" ",i," "),g.xb(1),g.gc("ngIf",!n.adminSettings&&n.notificationSections.get(i).length>3&&n.data.editable)}}function un(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"label-value",23),g.Lb(2,"notification-type-setting",24),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("label",i.resolveNotificationLabel(e)),g.xb(1),g.gc("setting",e)("options",i.kindFieldOptionsMap.get(e.kind))("form",i.resolveControl(e.kind))("multiSelectionControl",i.kindControlsMap.get(e.kind))("disabled",!i.data.editable)}}function dn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,bn,4,5,"h2",18),g.Bc(2,un,3,6,"ng-container",6),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(1),g.gc("ngIf",""!==e),g.xb(1),g.gc("ngForOf",i.notificationSections.get(e))}}const gn=function(e,t){return{count:e,total:t}};function fn(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Qb(3,"label"),g.Dc(4),g.Pb(),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.general.sendMedium.sms),g.xb(2),g.Ec(e.i18n.notificationSettings.smsCount(g.kc(2,gn,e.data.smsCountThisMonth,e.data.maxSmsPerMonth)))}}function mn(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",25),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.ac(1,"async"),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("disabled",g.bc(1,2,e.requesting$))("label",e.i18n.general.save)}}function pn(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",3),g.Qb(2,"form",4),g.Bc(3,Xi,1,2,"boolean-field",5),g.Bc(4,an,2,1,"ng-container",6),g.Bc(5,on,2,2,"multi-selection-field",7),g.Bc(6,dn,3,2,"ng-container",6),g.Bc(7,fn,5,5,"ng-container",1),g.Pb(),g.Qb(8,"actions"),g.Bc(9,mn,2,4,"action-button",8),g.Pb(),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.notificationSettings.title)("mobileHeading",e.i18n.notificationSettings.mobileTitle),g.xb(1),g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",e.data.forwardMessagesAllowed),g.xb(1),g.gc("ngForOf",e.data.userAccounts),g.xb(1),g.gc("ngIf",e.data.messageCategories.length>0),g.xb(1),g.gc("ngForOf",e.notificationSections.keys()),g.xb(1),g.gc("ngIf",e.data.smsAllowed),g.xb(2),g.gc("ngIf",e.data.editable)}}function hn(e,t){if(1&e&&(g.Ob(0,4),g.Lb(1,"decimal-field",26),g.Lb(2,"decimal-field",27),g.Nb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("formGroup",i.form.get("userAccounts").get(e.id).get("paymentAmount")),g.xb(1),g.gc("label",i.i18n.notificationSettings.paymentNotificationsAbove)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("disabled",!i.data.editable)("emptyLabel",i.i18n.general.notSet),g.xb(1),g.gc("label",i.i18n.notificationSettings.paymentNotificationsBelow)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("disabled",!i.data.editable)("emptyLabel",i.i18n.general.notSet)}}let vn=(()=>{class e extends l.a{constructor(e,t){super(e),this.notificationSettingsService=t,this.notificationSections=new Map,this.kindControlsMap=new Map,this.kindFieldOptionsMap=new Map}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.notificationSettingsService.getNotificationSettingsDataForEdit({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){if(this.adminSettings=e.role===Me.kb.ADMINISTRATOR,this.form=this.formBuilder.group({version:e.settings.version}),this.adminSettings){if(!this.hasSettings(e))return void this.notification.info(this.i18n.notificationSettings.notAvailableSettings);this.notificationSections.set("",e.settings.notifications),this.form.addControl("forwardMessageCategories",this.formBuilder.control(e.settings.forwardMessageCategories))}e.forwardMessagesAllowed&&this.form.setControl("forwardMessages",this.formBuilder.control(e.settings.forwardMessages));const t=[],i=this.formBuilder.array([]);for(const n of e.settings.notifications){const e=this.formBuilder.group({internal:n.internal,kind:n.kind,sms:void 0===n.sms?null:n.sms,email:void 0===n.email?null:n.email});if(this.addSub(e.controls.internal.valueChanges.subscribe(()=>{this.updateControls(e)})),this.updateControls(e),i.push(e),t.push(n.kind),!this.adminSettings){const e=this.resolveSection(n.kind),t=this.notificationSections.get(e);t?t.push(n):this.notificationSections.set(e,[n])}}if(t.length>0)for(const n of t){let t,i,a;[t,i,a]=this.resolveOptions(n,e);const s=this.formBuilder.control(i);this.kindControlsMap.set(n,s),this.form.setControl(a,s),this.kindFieldOptionsMap.set(n,t)}if(this.form.setControl("notifications",i),!Object(b.h)(e.userAccounts)){this.singleAccount=1===e.userAccounts.length;const t=this.formBuilder.group({});for(const i of e.userAccounts){const n=(e.settings.userAccounts[this.ApiHelper.internalNameOrId(i)]||{}).paymentAmount||{};t.setControl(i.id,this.formBuilder.group({paymentAmount:this.formBuilder.group({min:n.min,max:n.max})}))}this.form.setControl("userAccounts",t)}}updateControls(e){e.controls.internal.value?(e.controls.sms&&e.controls.sms.enable(),e.controls.email&&e.controls.email.enable()):(e.controls.sms&&e.controls.sms.disable(),e.controls.email&&e.controls.email.disable())}save(){const e=this.notificationSettingsService.saveNotificationSettings({user:this.user,body:this.form.value});this.addSub(e.subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.notificationSettings.saved)}))}hasSettings(e){return!(Object(b.h)(e.settings.notifications)||this.adminSettings&&Object(b.h)(e.messageCategories))}resolveSection(e){return e.startsWith("account")?this.i18n.notificationSettings.accounts:e.startsWith("personal")?this.i18n.notificationSettings.personal:e.startsWith("buyer")?this.i18n.notificationSettings.marketplaceAsBuyer:e.startsWith("seller")?this.i18n.notificationSettings.marketplaceAsSeller:e.startsWith("reference")||e.startsWith("feedback")?this.i18n.notificationSettings.feedbackAndReferences:""}resolveMenu(){return this.adminSettings||this.user===this.ApiHelper.SELF?u.b.NOTIFICATIONS_SETTINGS:this.menu.searchUsersMenu()}resolveControl(e){const t=this.form.controls.notifications.controls;for(const i of t){const t=i;if(t.controls.kind.value===e)return t}return null}enableNotifications(e,t){for(const i of this.notificationSections.get(e))this.resolveControl(i.kind).controls.internal.setValue(t)}resolveNotificationLabel(e){switch(e.kind){case Me.J.ADMIN_AD_PENDING_AUTHORIZATION:return this.i18n.notification.admin.adPendingAuthorization;case Me.J.ADMIN_APPLICATION_ERROR:return this.i18n.notification.admin.applicationErrors;case Me.J.ADMIN_EXTERNAL_PAYMENT_EXPIRED:return this.i18n.notification.admin.externalPaymentExpired;case Me.J.ADMIN_EXTERNAL_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.admin.externalPaymentPerformedFailed;case Me.J.ADMIN_GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.generatedVouchersAboutToExpire;case Me.J.ADMIN_GENERATED_VOUCHERS_EXPIRED:return this.i18n.notification.admin.generatedVouchersExpired;case Me.J.ADMIN_NETWORK_CREATED:return this.i18n.notification.admin.networkCreated;case Me.J.ADMIN_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.admin.paymentAwaitingAuthorization;case Me.J.ADMIN_PAYMENT_PERFORMED:return this.i18n.notification.admin.paymentPerformed;case Me.J.ADMIN_SYSTEM_ALERT:return this.i18n.notification.admin.systemAlert;case Me.J.ADMIN_USER_ALERT:return this.i18n.notification.admin.userAlert;case Me.J.ADMIN_USER_IMPORT_REGISTRATION:return"";case Me.J.ADMIN_USER_REGISTRATION:return this.i18n.notification.admin.userRegistration;case Me.J.ADMIN_VOUCHER_BUYING_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.voucherBuyingAboutToExpire;case Me.J.ACCOUNT_ALL_NON_SMS_PERFORMED_PAYMENTS:return this.i18n.notification.user.account.allNonSmsPerformedPayments;case Me.J.ACCOUNT_AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.authorizedPaymentCanceled;case Me.J.ACCOUNT_AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.authorizedPaymentDenied;case Me.J.ACCOUNT_AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.authorizedPaymentExpired;case Me.J.ACCOUNT_AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.authorizedPaymentSucceeded;case Me.J.ACCOUNT_BOUGHT_VOUCHERS_ABOUT_TO_EXPIRE:return this.i18n.notification.user.account.boughtVouchersAboutToExpire;case Me.J.ACCOUNT_BOUGHT_VOUCHERS_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.boughtVouchersExpirationDateChanged;case Me.J.ACCOUNT_BOUGHT_VOUCHERS_EXPIRED:return this.i18n.notification.user.account.boughtVouchersExpired;case Me.J.ACCOUNT_EXTERNAL_PAYMENT_EXPIRED:return this.i18n.notification.user.account.externalPaymentExpired;case Me.J.ACCOUNT_EXTERNAL_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.user.account.externalPaymentPerformedFailed;case Me.J.ACCOUNT_EXTERNAL_PAYMENT_RECEIVED_FAILED:return this.i18n.notification.user.account.externalPaymentReceivedFailed;case Me.J.ACCOUNT_INCOMING_RECURRING_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingRecurringPaymentCanceled;case Me.J.ACCOUNT_INCOMING_RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingRecurringPaymentFailed;case Me.J.ACCOUNT_INCOMING_RECURRING_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingRecurringPaymentReceived;case Me.J.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingScheduledPaymentCanceled;case Me.J.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingScheduledPaymentFailed;case Me.J.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingScheduledPaymentReceived;case Me.J.ACCOUNT_LIMIT_CHANGE:return this.i18n.notification.user.account.limitChange;case Me.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_APPROVED_STILL_PENDING:return this.i18n.notification.user.account.operator.authorizedPaymentApprovedStillPending;case Me.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.operator.authorizedPaymentCanceled;case Me.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.operator.authorizedPaymentDenied;case Me.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.operator.authorizedPaymentExpired;case Me.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.operator.authorizedPaymentSucceeded;case Me.J.ACCOUNT_OPERATOR_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.operator.paymentAwaitingAuthorization;case Me.J.ACCOUNT_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.paymentAwaitingAuthorization;case Me.J.ACCOUNT_PAYMENT_RECEIVED:return this.i18n.notification.user.account.paymentReceived;case Me.J.ACCOUNT_PAYMENT_REQUEST_CANCELED:return this.i18n.notification.user.account.paymentRequestCanceled;case Me.J.ACCOUNT_PAYMENT_REQUEST_DENIED:return this.i18n.notification.user.account.paymentRequestDenied;case Me.J.ACCOUNT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.paymentRequestExpirationDateChanged;case Me.J.ACCOUNT_PAYMENT_REQUEST_EXPIRED:return this.i18n.notification.user.account.paymentRequestExpired;case Me.J.ACCOUNT_PAYMENT_REQUEST_PROCESSED:return this.i18n.notification.user.account.paymentRequestProcessed;case Me.J.ACCOUNT_PAYMENT_REQUEST_RECEIVED:return this.i18n.notification.user.account.paymentRequestReceived;case Me.J.ACCOUNT_RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.recurringPaymentFailed;case Me.J.ACCOUNT_RECURRING_PAYMENT_OCCURRENCE_PROCESSED:return this.i18n.notification.user.account.recurringPaymentOcurrenceProcessed;case Me.J.ACCOUNT_SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.scheduledPaymentFailed;case Me.J.ACCOUNT_SCHEDULED_PAYMENT_INSTALLMENT_PROCESSED:return this.i18n.notification.user.account.scheduledPaymentInstallmentProcessed;case Me.J.ACCOUNT_SCHEDULED_PAYMENT_REQUEST_FAILED:return this.i18n.notification.user.account.scheduledPaymentRequestFailed;case Me.J.ACCOUNT_SENT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.sentPaymentRequestExpirationDateChanged;case Me.J.ACCOUNT_SMS_PERFORMED_PAYMENT:return this.i18n.notification.user.account.smsPerformedPayment;case Me.J.ACCOUNT_TICKET_WEBHOOK_FAILED:return this.i18n.notification.user.account.ticketWebhookFailed;case Me.J.BROKERING_AD_PENDING_AUTHORIZATION:return this.i18n.notification.user.brokering.adPendingAuthorization;case Me.J.BROKERING_MEMBER_ASSIGNED:return this.i18n.notification.user.brokering.memberAssigned;case Me.J.BROKERING_MEMBER_UNASSIGNED:return this.i18n.notification.user.brokering.memberUnassigned;case Me.J.BUYER_AD_INTEREST_NOTIFICATION:return this.i18n.notification.user.buyer.adInterestNotification;case Me.J.BUYER_AD_QUESTION_ANSWERED:return this.i18n.notification.user.buyer.adQuestionAnswered;case Me.J.BUYER_ORDER_CANCELED:return this.i18n.notification.user.buyer.orderCanceled;case Me.J.BUYER_ORDER_PAYMENT_CANCELED:return this.i18n.notification.user.buyer.orderPaymentCanceled;case Me.J.BUYER_ORDER_PAYMENT_DENIED:return this.i18n.notification.user.buyer.orderPaymentDenied;case Me.J.BUYER_ORDER_PAYMENT_EXPIRED:return this.i18n.notification.user.buyer.orderPaymentExpired;case Me.J.BUYER_ORDER_PENDING:return this.i18n.notification.user.buyer.orderPending;case Me.J.BUYER_ORDER_PENDING_AUTHORIZATION:return this.i18n.notification.user.buyer.orderPendingAuthorization;case Me.J.BUYER_ORDER_PENDING_DELIVERY_DATA:return this.i18n.notification.user.buyer.orderPendingDeliveryData;case Me.J.BUYER_ORDER_PROCESSED_BY_SELLER:return this.i18n.notification.user.buyer.orderProcessedBySeller;case Me.J.BUYER_ORDER_REJECTED_BY_SELLER:return this.i18n.notification.user.buyer.orderRejectedBySeller;case Me.J.BUYER_SALE_PENDING:return this.i18n.notification.user.buyer.buyerSalePending;case Me.J.BUYER_SALE_REJECTED_BY_SELLER:return this.i18n.notification.user.buyer.buyerSaleRejectedBySeller;case Me.J.FEEDBACK_CHANGED:return this.i18n.notification.user.feedback.changed;case Me.J.FEEDBACK_CREATED:return this.i18n.notification.user.feedback.created;case Me.J.FEEDBACK_EXPIRATION_REMINDER:return this.i18n.notification.user.feedback.expirationReminder;case Me.J.FEEDBACK_OPTIONAL:return this.i18n.notification.user.feedback.optional;case Me.J.FEEDBACK_REPLY_CREATED:return this.i18n.notification.user.feedback.replyCreated;case Me.J.FEEDBACK_REQUIRED:return this.i18n.notification.user.feedback.required;case Me.J.PERSONAL_BROKER_ASSIGNED:return this.i18n.notification.user.personal.brokerAssigned;case Me.J.PERSONAL_BROKER_UNASSIGNED:return this.i18n.notification.user.personal.brokerUnassigned;case Me.J.PERSONAL_MAX_SMS_PER_MONTH_REACHED:return this.i18n.notification.user.personal.maxSmsPerMonthReached;case Me.J.PERSONAL_NEW_TOKEN:return this.i18n.notification.user.personal.newToken;case Me.J.PERSONAL_NEW_TOKEN_PENDING_ACTIVATION:return this.i18n.notification.user.personal.newTokenPendingActivation;case Me.J.PERSONAL_PASSWORD_STATUS_CHANGED:return this.i18n.notification.user.personal.passwordStatusChanged;case Me.J.PERSONAL_TOKEN_STATUS_CHANGED:return this.i18n.notification.user.personal.tokenStatusChanged;case Me.J.PERSONAL_USER_STATUS_CHANGED:return this.i18n.notification.user.personal.userStatusChanged;case Me.J.REFERENCE_CHANGED:return this.i18n.notification.user.reference.changed;case Me.J.REFERENCE_CREATED:return this.i18n.notification.user.reference.created;case Me.J.SELLER_AD_AUTHORIZED:return this.i18n.notification.user.seller.adAuthorized;case Me.J.SELLER_AD_EXPIRED:return this.i18n.notification.user.seller.adExpired;case Me.J.SELLER_AD_LOW_STOCK:return this.i18n.notification.user.seller.adLowStock;case Me.J.SELLER_AD_OUT_OF_STOCK:return this.i18n.notification.user.seller.adOutOfStock;case Me.J.SELLER_AD_QUESTION_CREATED:return this.i18n.notification.user.seller.adQuestionCreated;case Me.J.SELLER_AD_REJECTED:return this.i18n.notification.user.seller.adRejected;case Me.J.SELLER_ORDER_CANCELED:return this.i18n.notification.user.seller.orderCanceled;case Me.J.SELLER_ORDER_CREATED:return this.i18n.notification.user.seller.orderCreated;case Me.J.SELLER_ORDER_PAYMENT_CANCELED:return this.i18n.notification.user.seller.orderPaymentCanceled;case Me.J.SELLER_ORDER_PAYMENT_DENIED:return this.i18n.notification.user.seller.orderPaymentDenied;case Me.J.SELLER_ORDER_PAYMENT_EXPIRED:return this.i18n.notification.user.seller.orderPaymentExpired;case Me.J.SELLER_ORDER_PENDING_AUTHORIZATION:return this.i18n.notification.user.seller.orderPendingAuthorization;case Me.J.SELLER_ORDER_PENDING_DELIVERY_DATA:return this.i18n.notification.user.seller.orderPendingDeliveryData;case Me.J.SELLER_ORDER_PROCESSED_BY_BUYER:return this.i18n.notification.user.seller.orderProcessedByBuyer;case Me.J.SELLER_ORDER_REJECTED_BY_BUYER:return this.i18n.notification.user.seller.orderRejectedByBuyer;case Me.J.SELLER_SALE_PROCESSED_BY_BUYER:return this.i18n.notification.user.seller.saleProcessedByBuyer}return""}resolveOptions(e,t){let i,n,a,s,o;switch(e){case Me.J.ADMIN_EXTERNAL_PAYMENT_EXPIRED:i=t.externalPayments,n=t.settings.externalPaymentsExpired,s="externalPaymentsExpired";break;case Me.J.ADMIN_EXTERNAL_PAYMENT_PERFORMED_FAILED:i=t.externalPayments,n=t.settings.externalPaymentsFailed,s="externalPaymentsFailed";break;case Me.J.ADMIN_GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:case Me.J.ADMIN_GENERATED_VOUCHERS_EXPIRED:i=t.voucherConfigurations,n=t.settings.voucherConfigurations,s="voucherConfigurations";break;case Me.J.ADMIN_VOUCHER_BUYING_ABOUT_TO_EXPIRE:i=t.voucherConfigurations,n=t.settings.voucherConfigurationsBuying,s="voucherConfigurationsBuying";break;case Me.J.ADMIN_PAYMENT_AWAITING_AUTHORIZATION:i=t.authorizablePayments,n=t.settings.authorizablePayments,s="authorizablePayments";break;case Me.J.ADMIN_PAYMENT_PERFORMED:i=t.payments,n=t.settings.payments,s="payments";break;case Me.J.ADMIN_USER_REGISTRATION:i=t.userGroups,n=t.settings.userGroups,s="userGroups";break;case Me.J.ADMIN_SYSTEM_ALERT:a=Object.values(Me.rb),n=t.settings.systemAlerts,s="systemAlert";break;case Me.J.ADMIN_USER_ALERT:a=Object.values(Me.Fb),n=t.settings.userAlerts,s="userAlert"}return i?o=i.map(e=>({id:e.id,internalName:e.internalName,value:this.ApiHelper.internalNameOrId(e),text:e.name})):a&&(o=a.map(e=>({value:e,text:this.resolveAlertLabel(e)}))),[o,n,s]}resolveAlertLabel(e){switch(e){case Me.rb.ACCOUNT_FEE_CHARGED_NO_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedNoFailures;case Me.rb.ACCOUNT_FEE_CHARGED_WITH_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedWithFailures;case Me.rb.APPLICATION_RESTARTED:return this.i18n.systemAlert.type.applicationRestarted;case Me.rb.CUSTOM:return this.i18n.systemAlert.type.custom;case Me.rb.MAX_GLOBAL_SMS_REACHED:return this.i18n.systemAlert.type.maxGlobalSmsReached;case Me.rb.MAX_INCORRECT_LOGIN_ATTEMPTS:return this.i18n.systemAlert.type.maxIncorrectLoginAttempts;case Me.Fb.CUSTOM:return this.i18n.userAlert.type.custom;case Me.Fb.GIVEN_VERY_BAD_REFS:return this.i18n.userAlert.type.givenVeryBadRefs;case Me.Fb.INSUFFICIENT_BALANCE_FOR_INITIAL_CREDIT:return this.i18n.userAlert.type.insufficientBalanceForInitialCredit;case Me.Fb.MAX_DEVICE_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceActivationAttemptsReached;case Me.Fb.MAX_DEVICE_CONFIRMATION_CHECK_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached;case Me.Fb.MAX_TOKEN_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxTokenActivationAttemptsReached;case Me.Fb.MAX_USER_LOCALIZATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxUserLocalizationAttemptsReached;case Me.Fb.MAX_VOUCHER_REDEEM_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxVoucherRedeemAttemptsReached;case Me.Fb.MOVE_USER_AUTOMATICALLY_FAILED:return this.i18n.userAlert.type.moveUserAutomaticallyFailed;case Me.Fb.PASSWORD_DISABLED_BY_TRIES:return this.i18n.userAlert.type.passwordDisabledByTries;case Me.Fb.PASSWORD_TEMPORARILY_BLOCKED:return this.i18n.userAlert.type.passwordTemporarilyBlocked;case Me.Fb.RECEIVED_VERY_BAD_REFS:return this.i18n.userAlert.type.receivedVeryBadRefs;case Me.Fb.SCHEDULED_PAYMENT_FAILED:return this.i18n.userAlert.type.scheduledPaymentFailed}return""}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Vi.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["notification-settings-form"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],[3,"heading","mobileHeading"],[3,"formGroup"],["formControlName","forwardMessages",3,"label","disabled",4,"ngIf"],[4,"ngFor","ngForOf"],["formControlName","forwardMessageCategories",3,"label",4,"ngIf"],[3,"disabled","label","action",4,"ngIf"],["formControlName","forwardMessages",3,"label","disabled"],[3,"ngClass",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],[1,"mt-3","mb-0"],["formControlName","forwardMessageCategories",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["class","d-flex flex-column flex-xs-row justify-content-between",3,"ngClass",4,"ngIf"],[1,"d-flex","flex-column","flex-xs-row","justify-content-between",3,"ngClass"],[1,"mb-2","mb-xs-0"],["outline","",3,"ngClass","label","action"],["outline","",3,"label","action"],["kind","field",3,"label"],[3,"setting","options","form","multiSelectionControl","disabled"],[3,"disabled","label","action"],["formControlName","min",3,"label","scale","prefix","suffix","disabled","emptyLabel"],["formControlName","max",3,"label","scale","prefix","suffix","disabled","emptyLabel"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,pn,10,9,"ng-container",1),g.Pb(),g.Bc(3,hn,3,13,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,p.s,x.a,v.a,h.v,h.l,p.A,p.q,ut.a,Le.a,y.a,Q.a,ji.a,zi.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var xn=i("a50p");function yn(e,t){if(1&e&&(g.Qb(0,"div",7),g.Qb(1,"label-value",8),g.Lb(2,"user-link",9),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function Pn(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",10),g.Dc(2),g.Pb(),g.Pb()),2&e){const e=t.$implicit;g.xb(2),g.Ec(e.name)}}function In(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"tr",13),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(3);return n.router.navigate(n.path(i))})),g.Qb(2,"td"),g.Qb(3,"a",14),g.Dc(4),g.Pb(),g.Pb(),g.Qb(5,"td",15),g.Qb(6,"button",16),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit;return g.Zb(3).remove(n),i.stopPropagation()})),g.Lb(7,"icon",17),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(3),g.gc("routerLink",i.path(e)),g.xb(1),g.Fc(" ",e.name," "),g.xb(2),g.gc("tooltip",i.i18n.general.removeTooltip(e.name))}}function En(e,t){if(1&e&&(g.Qb(0,"table",11),g.Qb(1,"tbody"),g.Bc(2,In,8,3,"ng-container",12),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("ngForOf",e.data.operatorGroups)}}function An(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,yn,3,2,"div",3),g.Pb(),g.Qb(4,"results-layout",4),g.Bc(5,Pn,3,1,"mobile-result",5),g.Bc(6,En,3,1,"table",6),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("mode",e.self?"empty":"filters")("heading",e.i18n.operatorGroup.title.list)("mobileHeading",e.i18n.operatorGroup.mobileTitle.list)("headingActions",g.bc(2,7,e.headingActions$)),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.operatorGroups)("toLink",e.toLink)}}let Cn=(()=>{class e extends l.a{constructor(e,t){super(e),this.operatorGroupsService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.param),this.addSub(this.operatorGroupsService.getUserOperatorGroupsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.groups=e.operatorGroups,e.canCreate&&(this.headingActions=[new be.c("add",this.i18n.general.addNew,()=>{this.router.navigate(["/users",this.param,"operator-groups","new"])},!0)])}path(e){return["/users","operator-groups",e.id]}get toLink(){return e=>this.path(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.name),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.name)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.OPERATOR_GROUPS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(xn.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-operator-groups"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],["class","col-12 col-md-6",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[1,"cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"actions"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,An,7,9,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,U.a,H.a,Q.a,Dt.a,G.a,p.s,a.h,I.b,q.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Dn=i("vHbw");function On(e,t){if(1&e&&(g.Qb(0,"label-value",16),g.Lb(1,"user-link",17),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function Sn(e,t){1&e&&g.Mb(0)}function Qn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Sn,1,0,"ng-container",19),g.Nb()),2&e){g.Zb(3);const e=g.qc(6);g.xb(1),g.gc("ngTemplateOutlet",e)}}function Nn(e,t){if(1&e&&(g.Qb(0,"h3",9),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit;g.xb(1),g.Fc(" ",e.name," ")}}function Fn(e,t){1&e&&g.Mb(0)}const Ln=function(e){return{$implicit:e}};function Bn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Fn,1,0,"ng-container",22),g.Nb()),2&e){const e=g.Zb(2).$implicit;g.Zb(3);const t=g.qc(4);g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.jc(2,Ln,e))}}function wn(e,t){if(1&e&&(g.Ob(0),g.Ob(1,5),g.Bc(2,Nn,2,1,"h3",20),g.Lb(3,"single-selection-field",21),g.Bc(4,Bn,2,4,"ng-container",1),g.Nb(),g.Nb()),2&e){const e=t.ngIf,i=g.Zb(4);g.xb(1),g.gc("formGroup",e),g.xb(1),g.gc("ngIf",!i.singleAccount),g.xb(1),g.gc("label",i.i18n.operatorGroup.accountAccess)("fieldOptions",i.accountAccessOptions),g.xb(1),g.gc("ngIf","none"!==e.value.access)}}function Rn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,wn,5,5,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngIf",i.form.get("accounts").get(e.id))}}function kn(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",9),g.Dc(2),g.ac(3,"async"),g.Pb(),g.Bc(4,Qn,2,1,"ng-container",1),g.Bc(5,Rn,2,1,"ng-container",18),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc("",g.bc(3,3,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.accountAccess:e.i18n.operatorGroup.title.accountAccess," "),g.xb(2),g.gc("ngIf",!e.singleAccount),g.xb(1),g.gc("ngForOf",e.data.accountTypes)}}function Tn(e,t){if(1&e&&g.Lb(0,"boolean-field",23),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.notifications)}}function Zn(e,t){if(1&e&&g.Lb(0,"boolean-field",24),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.viewAdvertisements)}}function _n(e,t){if(1&e&&g.Lb(0,"field-option",27),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function Mn(e,t){if(1&e&&(g.Qb(0,"multi-selection-field",25),g.Bc(1,_n,1,4,"field-option",26),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.runOperations),g.xb(1),g.gc("ngForOf",e.data.operations)}}function $n(e,t){if(1&e&&g.Lb(0,"boolean-field",28),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.brokering)}}function Un(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",4),g.ac(2,"async"),g.Qb(3,"form",5),g.Bc(4,On,2,2,"label-value",6),g.Lb(5,"input-field",7),g.Lb(6,"textarea-field",8),g.Bc(7,kn,6,5,"ng-container",1),g.Qb(8,"h2",9),g.Dc(9),g.ac(10,"async"),g.Pb(),g.Lb(11,"boolean-field",10),g.Bc(12,Tn,1,1,"boolean-field",11),g.Bc(13,Zn,1,1,"boolean-field",12),g.Bc(14,Mn,2,2,"multi-selection-field",13),g.Bc(15,$n,1,1,"boolean-field",14),g.Pb(),g.Qb(16,"actions"),g.Qb(17,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(18,"async"),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.create?e.i18n.operatorGroup.title.new:e.i18n.operatorGroup.title.edit)("mobileHeading",e.create?e.i18n.operatorGroup.mobileTitle.new:e.i18n.operatorGroup.mobileTitle.edit)("headingActions",g.bc(2,16,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",!e.self),g.xb(1),g.gc("label",e.i18n.general.name),g.xb(1),g.gc("label",e.i18n.general.description),g.xb(1),g.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>0),g.xb(2),g.Fc("",g.bc(10,18,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.permissions:e.i18n.operatorGroup.title.permissions," "),g.xb(2),g.gc("label",e.i18n.operatorGroup.editOwnProfile),g.xb(1),g.gc("ngIf",e.data.canHaveNotifications),g.xb(1),g.gc("ngIf",e.data.canViewAdvertisements),g.xb(1),g.gc("ngIf",(null==e.data.operations?null:e.data.operations.length)>0),g.xb(1),g.gc("ngIf",e.data.broker),g.xb(2),g.gc("disabled",g.bc(18,20,e.requesting$))("label",e.i18n.general.save)}}function Hn(e,t){1&e&&g.Mb(0)}function Gn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Hn,1,0,"ng-container",19),g.Nb()),2&e){g.Zb(2);const e=g.qc(6);g.xb(1),g.gc("ngTemplateOutlet",e)}}function qn(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"hr",36),g.Qb(2,"h4",37),g.Dc(3),g.Pb(),g.Nb()),2&e){const e=g.Zb().$implicit;g.xb(3),g.Ec(e.name)}}function Kn(e,t){if(1&e&&(g.Ob(0,5),g.Bc(1,qn,4,1,"ng-container",1),g.Lb(2,"boolean-field",32),g.Lb(3,"boolean-field",33),g.Lb(4,"decimal-field",34),g.Lb(5,"boolean-field",35),g.Nb()),2&e){const e=t.$implicit,n=g.Zb().$implicit,a=g.Zb();var i;g.gc("formGroup",a.form.get("payments").get(e.id)),g.xb(1),g.gc("ngIf",(null==(i=a.paymentTypes(n))?null:i.length)>1),g.xb(1),g.gc("label",a.i18n.operatorGroup.performPayments),g.xb(1),g.gc("label",a.i18n.operatorGroup.performPaymentsRequiresAuthorization),g.xb(1),g.gc("label",a.i18n.operatorGroup.performPaymentsMaxAmountPerDay)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),g.xb(1),g.gc("label",a.i18n.operatorGroup.authorizePayments)}}function Vn(e,t){if(1&e&&(g.Ob(0,5),g.Lb(1,"decimal-field",29),g.Lb(2,"decimal-field",30),g.Nb(),g.Bc(3,Gn,2,1,"ng-container",1),g.Bc(4,Kn,6,9,"ng-container",31)),2&e){const e=t.$implicit,i=g.Zb();g.gc("formGroup",i.form.get("accounts").get(e.id).get("notificationAmount")),g.xb(1),g.gc("label",i.i18n.operatorGroup.paymentNotificationsAbove)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),g.xb(1),g.gc("label",i.i18n.operatorGroup.paymentNotificationsBelow)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),g.xb(1),g.gc("ngIf",i.singleAccount),g.xb(1),g.gc("ngForOf",i.paymentTypes(e))}}function jn(e,t){if(1&e&&g.Lb(0,"boolean-field",40),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.chargebackPayments)}}function zn(e,t){if(1&e&&(g.Ob(0,5),g.Bc(1,jn,1,1,"boolean-field",38),g.Lb(2,"multiple-users-field",39),g.Nb()),2&e){const e=g.Zb();g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",e.data.canChargebackPayments),g.xb(1),g.gc("label",e.i18n.operatorGroup.restrictPaymentsToUsers)("preselectedUsers",e.restrictPaymentsToUsers)}}let Xn=(()=>{class e extends l.a{constructor(e,t,i){super(e),this.userHelper=t,this.operatorGroupsService=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.user=this.route.snapshot.params.user,this.create=null!=this.user;const e=this.create?this.operatorGroupsService.getOperatorGroupDataForNew({user:this.user}):this.operatorGroupsService.getOperatorGroupDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}));const t=Object(b.i)(Me.P);this.accountAccessOptions=t.map(e=>({value:e,text:this.userHelper.operatorGroupAccountAccess(e)}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=e.operatorGroup;if(this.form=this.formBuilder.group({name:[t.name,h.G.required],description:t.description}),!Object(b.h)(e.accountTypes)){this.singleAccount=1===e.accountTypes.length;const i=this.formBuilder.group({});for(const n of e.accountTypes){const e=t.accounts[n.id]||t.accounts[n.internalName]||{},a=e.notificationAmount||{};i.setControl(n.id,this.formBuilder.group({access:[e.access||Me.P.NONE,h.G.required],notificationAmount:this.formBuilder.group({min:a.min,max:a.max})}))}this.form.setControl("accounts",i)}if(!Object(b.h)(e.paymentTypes)){const i=this.formBuilder.group({});for(const n of e.paymentTypes){const e=t.payments[n.id]||t.payments[n.internalName]||{};i.setControl(n.id,this.formBuilder.group({perform:e.perform,maxAmountPerDay:e.maxAmountPerDay,requiresAuthorization:e.requiresAuthorization,authorize:e.authorize}))}this.form.setControl("payments",i)}this.form.addControl("editOwnProfile",new h.j(t.editOwnProfile)),this.form.addControl("restrictPaymentsToUsers",new h.j(t.restrictPaymentsToUsers)),e.canHaveNotifications&&this.form.addControl("notifications",new h.j(t.notifications)),e.canChargebackPayments&&this.form.addControl("chargebackPayments",new h.j(t.chargebackPayments)),e.canViewAdvertisements&&this.form.addControl("viewAdvertisements",new h.j(t.viewAdvertisements)),e.broker&&this.form.addControl("brokering",new h.j(t.brokering)),Object(b.h)(e.operations)||this.form.addControl("operations",new h.j(t.operations)),t.version&&this.form.addControl("version",new h.j(t.version))}paymentTypes(e){return(this.data.paymentTypes||[]).filter(t=>t.from.id===e.id)}save(){if(Object(b.F)(this.form),!this.form.valid)return;const e=this.form.value,t=this.create?this.operatorGroupsService.createOperatorGroup({user:this.user,body:e}):this.operatorGroupsService.updateOperatorGroup({id:this.id,body:e});this.addSub(t.subscribe(e=>{this.notification.snackBar(this.create?this.i18n.operatorGroup.created:this.i18n.operatorGroup.saved),this.router.navigate(["/users","operator-groups",e||this.id])}))}get restrictPaymentsToUsers(){return this.data.restrictPaymentsToUsers}resolveMenu(e){return this.menu.userMenu(e.user,u.b.OPERATOR_GROUPS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(xn.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["operator-group-form"]],features:[g.ub],decls:7,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],["generalAccounts",""],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["mode","fieldView",3,"label",4,"ngIf"],["formControlName","name","required","",3,"label"],["formControlName","description",3,"label"],[1,"mt-3","mb-0"],["formControlName","editOwnProfile",3,"label"],["formControlName","notifications",3,"label",4,"ngIf"],["formControlName","viewAdvertisements",3,"label",4,"ngIf"],["formControlName","operations",3,"label",4,"ngIf"],["formControlName","brokering",3,"label",4,"ngIf"],[1,"btn-main",3,"disabled","label","action"],["mode","fieldView",3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],["class","mt-3 mb-0",4,"ngIf"],["formControlName","access","required","",3,"label","fieldOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formControlName","notifications",3,"label"],["formControlName","viewAdvertisements",3,"label"],["formControlName","operations",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","brokering",3,"label"],["formControlName","min",3,"label","scale","prefix","suffix"],["formControlName","max",3,"label","scale","prefix","suffix"],[3,"formGroup",4,"ngFor","ngForOf"],["formControlName","perform",3,"label"],["formControlName","requiresAuthorization",3,"label"],["formControlName","maxAmountPerDay",3,"label","scale","prefix","suffix"],["formControlName","authorize",3,"label"],[1,"inner-separator"],[1,"mt-3","mb-2"],["formControlName","chargebackPayments",3,"label",4,"ngIf"],["formControlName","restrictPaymentsToUsers",3,"label","preselectedUsers"],["formControlName","chargebackPayments",3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Un,19,22,"ng-container",1),g.Pb(),g.Bc(3,Vn,5,11,"ng-template",null,2,g.Cc),g.Bc(5,zn,3,4,"ng-template",null,3,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Ot.a,h.v,h.l,h.D,St.a,v.a,x.a,y.a,Q.a,Dt.a,p.s,p.A,Fe.a,ut.a,Le.a,zi.a,Dn.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Jn=i("I9hm");function Yn(e,t){if(1&e&&(g.Qb(0,"label-value",9),g.Lb(1,"user-link",10),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.group.user)}}function Wn(e,t){if(1&e&&g.Lb(0,"label-value",11),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.description)("value",e.group.description)}}function ea(e,t){if(1&e&&(g.Qb(0,"h3",12),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.accountType.name," ")}}function ta(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Nb()),2&e){const e=g.Zb(6);g.xb(1),g.Ec(e.i18n.operatorGroup.performPaymentsRequiresAuthorizationView)}}function ia(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.ac(2,"currency"),g.Nb()),2&e){const e=g.Zb().$implicit,t=g.Zb(5);g.xb(1),g.Ec(t.i18n.operatorGroup.performPaymentsMaxAmountPerDayView(g.cc(2,1,e.maxAmountPerDay,e.paymentType.currency)))}}function na(e,t){1&e&&g.Lb(0,"br")}function aa(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,ta,2,1,"ng-container",1),g.Bc(3,ia,3,4,"ng-container",1),g.Bc(4,na,1,0,"br",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Fc(" ",e.paymentType.name,""),g.xb(1),g.gc("ngIf",e.requiresAuthorization),g.xb(1),g.gc("ngIf",e.maxAmountPerDay),g.xb(1),g.gc("ngIf",!i)}}function sa(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,aa,5,4,"ng-container",13),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.operatorGroup.performPayments),g.xb(1),g.gc("ngForOf",t.paymentsByAccount[e.accountType.id])}}function oa(e,t){1&e&&(g.Ob(0),g.Dc(1,", "),g.Nb())}function ra(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,oa,2,0,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Fc(" ",e.name,""),g.xb(1),g.gc("ngIf",!i)}}function ca(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,ra,3,2,"ng-container",13),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.operatorGroup.authorizePayments),g.xb(1),g.gc("ngForOf",t.authorizeByAccount[e.accountType.id])}}const la=function(e,t){return{min:e,max:t}};function ba(e,t){if(1&e&&(g.Lb(0,"label-value",4),g.ac(1,"currency"),g.ac(2,"currency")),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.operatorGroup.paymentNotifications)("value",t.format.formatRange(g.kc(8,la,g.cc(1,2,e.notificationAmount.min,e.accountType.currency),g.cc(2,5,e.notificationAmount.max,e.accountType.currency))))}}function ua(e,t){if(1&e&&(g.Ob(0),g.Bc(1,ea,2,1,"h3",6),g.Lb(2,"label-value",4),g.Bc(3,sa,2,2,"label-value",8),g.Bc(4,ca,2,2,"label-value",8),g.Bc(5,ba,3,11,"label-value",7),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngIf",!i.singleAccount),g.xb(1),g.gc("label",i.i18n.operatorGroup.accountAccess)("value",i.userHelper.operatorGroupAccountAccess(e.access)),g.xb(1),g.gc("ngIf",(null==i.paymentsByAccount[e.accountType.id]?null:i.paymentsByAccount[e.accountType.id].length)>0),g.xb(1),g.gc("ngIf",(null==i.authorizeByAccount[e.accountType.id]?null:i.authorizeByAccount[e.accountType.id].length)>0),g.xb(1),g.gc("ngIf",(null==e.notificationAmount?null:e.notificationAmount.min)||(null==e.notificationAmount?null:e.notificationAmount.max))}}function da(e,t){if(1&e&&(g.Qb(0,"h3",12),g.Dc(1),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.Fc(" ",g.bc(2,1,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.generalAccount:e.i18n.operatorGroup.title.generalAccount," ")}}function ga(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(4);g.gc("label",e.i18n.operatorGroup.chargebackPayments)("value",e.i18n.general.yes)}}function fa(e,t){1&e&&(g.Ob(0),g.Dc(1,", "),g.Nb())}function ma(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,fa,2,0,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Fc(" ",e.display,""),g.xb(1),g.gc("ngIf",!i)}}function pa(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,ma,3,2,"ng-container",13),g.Pb()),2&e){const e=g.Zb(4);g.gc("label",e.i18n.operatorGroup.restrictPaymentsToUsers),g.xb(1),g.gc("ngForOf",e.group.restrictPaymentsToUsers)}}function ha(e,t){if(1&e&&(g.Ob(0),g.Bc(1,da,3,3,"h3",6),g.Bc(2,ga,1,2,"label-value",7),g.Bc(3,pa,2,2,"label-value",8),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("ngIf",!e.singleAccount),g.xb(1),g.gc("ngIf",e.group.chargebackPayments),g.xb(1),g.gc("ngIf",(null==e.group.restrictPaymentsToUsers?null:e.group.restrictPaymentsToUsers.length)>0)}}function va(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",12),g.Dc(2),g.ac(3,"async"),g.Pb(),g.Bc(4,ua,6,6,"ng-container",13),g.Bc(5,ha,4,3,"ng-container",1),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc("",g.bc(3,3,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.accountAccess:e.i18n.operatorGroup.title.accountAccess," "),g.xb(2),g.gc("ngForOf",e.visibleAccounts),g.xb(1),g.gc("ngIf",(null==e.group.restrictPaymentsToUsers?null:e.group.restrictPaymentsToUsers.length)>0||e.group.chargebackPayments)}}function xa(e,t){if(1&e&&(g.Qb(0,"h2",12),g.Dc(1),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.Fc("",g.bc(2,1,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.permissions:e.i18n.operatorGroup.title.permissions," ")}}function ya(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.editOwnProfile)("value",e.i18n.general.yes)}}function Pa(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.notifications)("value",e.i18n.general.yes)}}function Ia(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.viewAdvertisements)("value",e.i18n.general.yes)}}function Ea(e,t){1&e&&(g.Ob(0),g.Dc(1,", "),g.Nb())}function Aa(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,Ea,2,0,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Ec(e.name),g.xb(1),g.gc("ngIf",!i)}}function Ca(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,Aa,3,2,"ng-container",13),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.runOperations),g.xb(1),g.gc("ngForOf",e.group.operations)}}function Da(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.brokering)("value",e.i18n.general.yes)}}function Oa(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,Yn,2,2,"label-value",3),g.Lb(4,"label-value",4),g.Bc(5,Wn,1,2,"label-value",5),g.Bc(6,va,6,5,"ng-container",1),g.Bc(7,xa,3,3,"h2",6),g.Bc(8,ya,1,2,"label-value",7),g.Bc(9,Pa,1,2,"label-value",7),g.Bc(10,Ia,1,2,"label-value",7),g.Bc(11,Ca,2,2,"label-value",8),g.Bc(12,Da,1,2,"label-value",7),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.operatorGroup.title.view)("mobileHeading",e.i18n.operatorGroup.mobileTitle.view)("headingActions",g.bc(2,14,e.headingActions$)),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("label",e.i18n.general.name)("value",e.group.name),g.xb(1),g.gc("ngIf",e.group.description),g.xb(1),g.gc("ngIf",(null==e.visibleAccounts?null:e.visibleAccounts.length)>0),g.xb(1),g.gc("ngIf",e.group.editOwnProfile||e.group.notifications||e.group.viewAdvertisements||e.group.brokering||(null==e.group.operations?null:e.group.operations.length)>0),g.xb(1),g.gc("ngIf",e.group.editOwnProfile),g.xb(1),g.gc("ngIf",e.group.notifications),g.xb(1),g.gc("ngIf",e.group.viewAdvertisements),g.xb(1),g.gc("ngIf",(null==e.group.operations?null:e.group.operations.length)>0),g.xb(1),g.gc("ngIf",e.group.brokering)}}let Sa=(()=>{class e extends _.a{constructor(e,t,i){super(e),this.userHelper=t,this.operatorGroupsService=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.operatorGroupsService.viewOperatorGroup({id:this.id}).subscribe(e=>{this.data=e}))}get group(){return this.data}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=e.accounts||[];this.visibleAccounts=t.filter(e=>e.access!==Me.P.NONE),this.singleAccount=1===t.length,this.paymentsByAccount={},this.authorizeByAccount={};const i=e.payments||[];for(const n of this.visibleAccounts)this.paymentsByAccount[n.accountType.id]=i.filter(e=>e.perform&&e.paymentType.from.id===n.accountType.id),this.authorizeByAccount[n.accountType.id]=i.filter(e=>e.authorize&&e.paymentType.from.id===n.accountType.id).map(e=>e.paymentType);if(e.canEdit){const e=[new be.c("edit",this.i18n.general.edit,()=>{this.router.navigateByUrl(this.router.url+"/edit")},!0)];this.layout.ltsm&&e.push(new be.c("clear",this.i18n.general.remove,()=>this.remove())),this.headingActions=e}}remove(){this.notification.confirm({message:this.i18n.general.removeConfirm(this.group.name),callback:()=>this.doRemove()})}doRemove(){this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(this.group.name)),this.router.navigate(["users",this.authHelper.orSelf(this.group.user),"operator-groups"])}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.OPERATOR_GROUPS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(xn.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-operator-group"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],["valueFormat","break",3,"label","value",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[3,"label","value",4,"ngIf"],[3,"label",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"],["valueFormat","break",3,"label","value"],[1,"mt-3","mb-0"],[4,"ngFor","ngForOf"],[3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Oa,13,16,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,Q.a,Dt.a,p.s],pipes:[p.b,Jn.a],encapsulation:2,changeDetection:0}),e})();var Qa=i("yFKC");function Na(e,t){if(1&e&&(g.Qb(0,"label-value",15),g.Lb(1,"user-link",16),g.Pb()),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.operatorOwner),g.xb(1),g.gc("user",e.data.user)}}function Fa(e,t){if(1&e&&g.Lb(0,"field-option",19),2&e){const e=t.$implicit,i=g.Zb(4);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function La(e,t){if(1&e&&(g.Qb(0,"single-selection-field",17),g.Bc(1,Fa,1,4,"field-option",18),g.Pb()),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.group)("emptyOption",e.i18n.user.operatorNoGroup),g.xb(1),g.gc("ngForOf",e.data.groups)}}function Ba(e,t){if(1&e&&g.Lb(0,"input-field",20),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.name)}}function wa(e,t){if(1&e&&g.Lb(0,"input-field",21),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.username)}}function Ra(e,t){if(1&e&&g.Lb(0,"input-field",24),2&e){const e=g.Zb(4);g.gc("label",e.i18n.user.email)("required",e.data.emailRequired)}}function ka(e,t){if(1&e&&g.Lb(0,"boolean-field",25),2&e){const e=g.Zb(4);g.gc("label",e.i18n.user.registration.skipActivationEmail)}}function Ta(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Ra,1,2,"input-field",22),g.Bc(2,ka,1,1,"boolean-field",23),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("ngIf",e.canEdit("email")),g.xb(1),g.gc("ngIf",e.data.allowSetSendActivationEmail)}}function Za(e,t){if(1&e&&g.Lb(0,"custom-field-input",28),2&e){const e=g.Zb().$implicit;g.gc("field",e)("formControlName",e.internalName)}}function _a(e,t){if(1&e&&(g.Ob(0,26),g.Bc(1,Za,1,2,"custom-field-input",27),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("formGroup",i.form.get("customValues")),g.xb(1),g.gc("ngIf",i.canEdit(e))}}function Ma(e,t){if(1&e&&(g.Ob(0,26),g.Lb(1,"input-field",29),g.Nb()),2&e){const e=g.Zb(3);g.gc("formGroup",e.mobileForm),g.xb(1),g.gc("label",e.i18n.phone.mobile)("required","required"===e.mobileAvailability)("placeholder",e.data.phoneConfiguration.mobileExample)}}function $a(e,t){if(1&e&&g.Lb(0,"input-field",31),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.extension)}}function Ua(e,t){if(1&e&&(g.Ob(0,26),g.Lb(1,"input-field",29),g.Bc(2,$a,1,1,"input-field",30),g.Nb()),2&e){const e=g.Zb(3);g.gc("formGroup",e.landLineForm),g.xb(1),g.gc("label",e.i18n.phone.landLine)("required","required"===e.data.phoneConfiguration.landLineAvailability)("placeholder",e.data.phoneConfiguration.landLineExample),g.xb(1),g.gc("ngIf",e.data.phoneConfiguration.extensionEnabled)}}function Ha(e,t){if(1&e&&(g.Qb(0,"div",34),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Ec(e.description)}}function Ga(e,t){if(1&e&&g.Lb(0,"boolean-field",35),2&e){const e=g.Zb(4);g.gc("label",e.i18n.user.registration.passwordAssign)}}function qa(e,t){if(1&e&&g.Lb(0,"boolean-field",39),2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.registration.passwordForceChange)}}function Ka(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"input-field",36),g.Lb(2,"input-field",37),g.Bc(3,qa,1,1,"boolean-field",38),g.Nb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.xb(1),g.gc("label",e.name),g.xb(1),g.gc("label",t.i18n.user.passwordConfirmation(e.name)),g.xb(1),g.gc("ngIf",e.canForceChange)}}function Va(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Ob(3,26),g.Bc(4,Ha,2,1,"div",32),g.Bc(5,Ga,1,1,"boolean-field",33),g.Bc(6,Ka,4,3,"ng-container",10),g.Nb(),g.Nb()),2&e){const e=t.$implicit,i=t.index,n=g.Zb(3);g.xb(2),g.Ec(e.name),g.xb(1),g.gc("formGroup",n.passwordForms[i]),g.xb(1),g.gc("ngIf",e.description),g.xb(1),g.gc("ngIf",n.login.user),g.xb(1),g.gc("ngIf",n.passwordForms[i].get("defined").value)}}function ja(e,t){if(1&e){const e=g.Rb();g.Qb(0,"form",5),g.Bc(1,Na,2,2,"label-value",6),g.Bc(2,La,2,3,"single-selection-field",7),g.Bc(3,Ba,1,1,"input-field",8),g.Bc(4,wa,1,1,"input-field",9),g.Bc(5,Ta,3,2,"ng-container",10),g.Bc(6,_a,2,2,"ng-container",11),g.Bc(7,Ma,2,4,"ng-container",12),g.Bc(8,Ua,3,5,"ng-container",12),g.Bc(9,Va,7,5,"ng-container",13),g.Qb(10,"actions"),g.Qb(11,"action-button",14),g.Xb("action",(function(){return g.sc(e),g.Zb(2).register()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",!e.self),g.xb(1),g.gc("ngIf",e.data.groups.length>0),g.xb(1),g.gc("ngIf",e.canEdit("name")),g.xb(1),g.gc("ngIf",e.canEdit("username")),g.xb(1),g.gc("ngIf",e.canEdit("email")),g.xb(1),g.gc("ngForOf",e.data.customFields),g.xb(1),g.gc("ngIf","disabled"!==e.mobileAvailability),g.xb(1),g.gc("ngIf","disabled"!==e.landLineAvailability),g.xb(1),g.gc("ngForOf",e.data.passwordTypes),g.xb(2),g.gc("label",e.i18n.general.submit)}}function za(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Bc(1,ja,12,11,"form",4),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb(),t=g.qc(4);g.gc("heading",e.i18n.user.title.operatorRegistration)("mobileHeading",e.i18n.user.mobileTitle.operatorRegistration),g.xb(1),g.gc("ngIf",null==g.bc(2,4,e.result$))("ngIfElse",t)}}function Xa(e,t){if(1&e){const e=g.Rb();g.Lb(0,"p",40),g.ac(1,"trust"),g.Qb(2,"actions",41),g.Qb(3,"action-button",14),g.Xb("action",(function(){return g.sc(e),g.Zb().reload()})),g.Pb(),g.Qb(4,"action-button",14),g.Xb("action",(function(){return g.sc(e),g.Zb().viewProfile()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("innerHTML",g.bc(1,3,e.doneMessageHtml),g.tc),g.xb(3),g.gc("label",e.i18n.user.operatorRegistrationAddAnother),g.xb(1),g.gc("label",e.i18n.user.registration.viewProfile)}}let Ja=(()=>{class e extends l.a{constructor(e,t,i){super(e),this.userHelper=t,this.operatorsService=i,this.result$=new Ct.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.user),this.addSub(this.operatorsService.getOperatorDataForNew({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){this.form=this.formBuilder.group({group:null}),[this.mobileForm,this.landLineForm]=this.userHelper.setupRegistrationForm(this.form,e,!1),this.passwordForms=this.userHelper.passwordRegistrationForms(e),this.editableFields=this.userHelper.fieldNamesByAction(e,"edit")}canEdit(e){return this.editableFields.has(this.fieldHelper.fieldName(e))}get mobileAvailability(){return this.data.phoneConfiguration.mobileAvailability}get landLineAvailability(){return this.data.phoneConfiguration.landLineAvailability}register(){const e=Object(b.d)(this.form);this.mobileForm&&e.setControl("mobile",this.mobileForm),this.landLineForm&&e.setControl("landLine",this.landLineForm),e.setControl("passwords",new h.g(this.passwordForms)),Object(b.F)(e)&&this.addSub(this.operatorsService.registerOperator({user:this.user,body:e.value}).subscribe(e=>this.result$.next(e)))}get doneMessageHtml(){const e=this.result$.value;if(!e)return null;const t=e.user.display;switch(e.status){case Me.Lb.ACTIVE:return this.i18n.user.operatorRegistrationActive(t);case Me.Lb.INACTIVE:return this.i18n.user.operatorRegistrationInactive(t);case Me.Lb.EMAIL_VALIDATION:return this.i18n.user.operatorRegistrationPending(t)}}viewProfile(){const e=this.result$.value;e&&this.router.navigate(["users",e.user.id,"profile"])}resolveMenu(e){return this.menu.userMenu(e.user,u.b.MY_OPERATORS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(Qa.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["operator-registration"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading",4,"ngIf"],["done",""],["last","",3,"heading","mobileHeading"],["autocomplete","off",3,"formGroup",4,"ngIf","ngIfElse"],["autocomplete","off",3,"formGroup"],[3,"label",4,"ngIf"],["formControlName","group",3,"label","emptyOption",4,"ngIf"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","username","required","",3,"label",4,"ngIf"],[4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label","action"],[3,"label"],[3,"user"],["formControlName","group",3,"label","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","name","required","",3,"label"],["formControlName","username","required","",3,"label"],["formControlName","email",3,"label","required",4,"ngIf"],["formControlName","skipActivationEmail",3,"label",4,"ngIf"],["formControlName","email",3,"label","required"],["formControlName","skipActivationEmail",3,"label"],[3,"formGroup"],[3,"field","formControlName",4,"ngIf"],[3,"field","formControlName"],["formControlName","number",3,"label","required","placeholder"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],["class","mb-2",4,"ngIf"],["formControlName","defined",3,"label",4,"ngIf"],[1,"mb-2"],["formControlName","defined",3,"label"],["required","","formControlName","value","type","password","autocomplete","new-password",3,"label"],["required","","formControlName","confirmationValue","type","password","autocomplete","new-password",3,"label"],["formControlName","forceChange",3,"label",4,"ngIf"],["formControlName","forceChange",3,"label"],[3,"innerHTML"],["forceRow",""]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,za,3,6,"page-content",1),g.Bc(3,Xa,5,5,"ng-template",null,2,g.Cc),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,p.s,x.a,y.a,Q.a,Dt.a,Fe.a,h.v,h.l,Le.a,Ot.a,h.D,v.a,Gt.a],pipes:[p.b,Kt.a],encapsulation:2,changeDetection:0}),e})();var Ya=i("TFmz"),Wa=i("qCwG"),es=(i("Ky6R"),i("7nZW")),ts=i("XvX2"),is=i("5Wk5"),ns=i("oOvo"),as=i("IJ5G");const ss=function(e,t){return{"cell-main":e,"cell-text":t}};function os(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",8),g.Lb(2,"format-field-value",9),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb().$implicit,a=g.Zb();g.xb(1),g.gc("ngClass",g.kc(6,ss,i,!i)),g.xb(1),g.gc("fields",a.data.customFields)("plainText",!0)("fieldName",e)("object",a.user(n))("customValues",a.customValues(n))}}function rs(e,t){if(1&e&&(g.Qb(0,"div",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb();g.xb(1),g.Fc(" ",t.operatorGroup(e)," ")}}function cs(e,t){if(1&e&&(g.Qb(0,"mobile-result",5),g.Bc(1,os,3,9,"ng-container",6),g.Bc(2,rs,2,1,"div",7),g.Pb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("avatarImage",i.user(e).image)("avatarIcon","operator"===i.resultKind?null:"user"),g.xb(1),g.gc("ngForOf",i.fieldsInTile),g.xb(1),g.gc("ngIf","operator"===i.resultKind)}}function ls(e,t){1&e&&g.Lb(0,"th",15)}function bs(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(1),g.Ec(i.fieldName(e))}}function us(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.Ec(e.i18n.user.group)}}function ds(e,t){if(1&e&&(g.Qb(0,"td",15),g.Lb(1,"avatar",17),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.gc("image",t.user(e).image)}}function gs(e,t){if(1&e&&(g.Qb(0,"td"),g.Lb(1,"format-field-value",9),g.Pb()),2&e){const e=t.$implicit,i=g.Zb().$implicit,n=g.Zb(2);g.xb(1),g.gc("fields",n.data.customFields)("plainText",!0)("fieldName",e)("object",n.user(i))("customValues",n.customValues(i))}}function fs(e,t){if(1&e&&(g.Qb(0,"td"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Ec(t.operatorGroup(e))}}function ms(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",16),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(2);return n.canViewProfile?n.router.navigate(n.path(i)):null})),g.Bc(1,ds,2,1,"td",12),g.Bc(2,gs,2,5,"td",6),g.Bc(3,fs,2,1,"td",13),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(1),g.gc("ngIf","operator"!==e.resultKind),g.xb(1),g.gc("ngForOf",e.fieldsInList),g.xb(1),g.gc("ngIf","operator"===e.resultKind)}}const ps=function(e){return{"cursor-pointer":e}};function hs(e,t){if(1&e&&(g.Qb(0,"table",11),g.Qb(1,"thead"),g.Bc(2,ls,1,0,"th",12),g.Bc(3,bs,2,1,"th",6),g.Bc(4,us,2,1,"th",13),g.Pb(),g.Qb(5,"tbody"),g.Bc(6,ms,4,3,"tr",14),g.Pb(),g.Pb()),2&e){const e=g.Zb();g.gc("ngClass",g.jc(5,ps,e.canViewProfile)),g.xb(2),g.gc("ngIf","operator"!==e.resultKind),g.xb(1),g.gc("ngForOf",e.fieldsInList),g.xb(1),g.gc("ngIf","operator"===e.resultKind),g.xb(2),g.gc("ngForOf",null==e.results?null:e.results.results)}}function vs(e,t){if(1&e&&(g.Qb(0,"div",8),g.Qb(1,"format-field-value",20),g.Dc(2," \xa0 "),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb().$implicit,a=g.Zb();g.gc("ngClass",i?"card-title":"card-text"),g.xb(1),g.gc("fields",a.data.customFields)("fieldName",e)("object",a.user(n))("customValues",a.customValues(n))}}function xs(e,t){if(1&e&&(g.Qb(0,"tiled-result",18),g.Bc(1,vs,3,5,"div",19),g.Pb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("image",i.user(e).image),g.xb(1),g.gc("ngForOf",i.fieldsInTile)}}const ys=function(e,t){return{"font-weight-bold":e,"mb-2":t}};function Ps(e,t){if(1&e&&(g.Qb(0,"div",8),g.Lb(1,"format-field-value",9),g.Pb()),2&e){const e=t.$implicit,i=t.first,n=t.last,a=g.Zb().$implicit,s=g.Zb();g.gc("ngClass",g.kc(6,ys,i,n)),g.xb(1),g.gc("fields",s.data.customFields)("plainText",!0)("fieldName",e)("object",s.user(a))("customValues",s.customValues(a))}}function Is(e,t){if(1&e&&(g.Qb(0,"map-result",21),g.Bc(1,Ps,2,9,"div",19),g.Pb()),2&e){const e=t.$implicit,i=t.address,n=g.Zb();g.gc("image",n.user(e).image)("address",i),g.xb(1),g.gc("ngForOf",n.fieldsInTile)}}let Es=(()=>{class e extends Wa.a{constructor(e){super(e),this.clazz="flex-grow-1 d-flex",this.resultKind="user",this.update=new g.n}set data(e){this._data=e;const t=(e||{}).fieldsInList||[];this.fieldsInList=t.slice(0,Math.min(t.length,7)),this.fieldsInTile=t.slice(0,Math.min(t.length,2)),this.showTableHeader=this.fieldsInList.length>1}get data(){return this._data}ngOnInit(){super.ngOnInit(),this.canViewProfile=!0===(((this.dataForUiHolder.dataForUi.auth||{}).permissions||{}).users||{}).viewProfile}user(e){return"contact"===this.resultKind?e.contact:e}operatorGroup(e){if("operator"===this.resultKind){const t=e.group;return t?t.name:this.i18n.user.operatorNoGroup}return null}displayFunction(){return e=>{const t=this.user(e);if(t.display)return t.display;const i=t,n=this.fieldsInList[0];return i.hasOwnProperty(n)?i[n]:(i.customValues||{})[n]}}customValues(e){return null==e?null:e.customValues}address(e){return"contact"===this.resultKind?null:e.address}fieldName(e){return"operator"===this.resultKind&&"display"===e?this.i18n.general.operator:this.fieldHelper.fieldDisplay(e,this.data.customFields)}path(e){const t=this.user(e);return this.authHelper.isSelf(t)?["/users",this.ApiHelper.SELF,"profile"]:"operator"===this.resultKind?["/users","operators",t.id]:this.canViewProfile?"contact"===this.resultKind?["/users","contacts",t.id]:["/users",t.id,"profile"]:null}get toLink(){return e=>this.path(e)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r))},e.\u0275cmp=g.Eb({type:e,selectors:[["users-results"]],hostVars:2,hostBindings:function(e,t){2&e&&g.zb(t.clazz)},inputs:{resultType:"resultType",rendering$:"rendering$",referencePoint:"referencePoint",data:"data",results:"results",resultKind:"resultKind"},outputs:{update:"update"},features:[g.ub],decls:5,vars:7,consts:[[3,"results","rendering$","resultType","toAddress","referencePoint","toMarkerTitle","toLink","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover",3,"ngClass",4,"resultTable"],["icon","user","zoom","",3,"image",4,"resultTile"],[3,"image","address",4,"resultInfoWindow"],[3,"avatarImage","avatarIcon"],[4,"ngFor","ngForOf"],["class","cell-text",4,"ngIf"],[3,"ngClass"],[3,"fields","plainText","fieldName","object","customValues"],[1,"cell-text"],[1,"table","table-hover",3,"ngClass"],["class","avatar",4,"ngIf"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"avatar"],[3,"click"],[3,"image"],["icon","user","zoom","",3,"image"],[3,"ngClass",4,"ngFor","ngForOf"],["plainText","",1,"d-block","text-truncate",3,"fields","fieldName","object","customValues"],[3,"image","address"]],template:function(e,t){1&e&&(g.Qb(0,"results-layout",0),g.Xb("update",(function(e){return t.update.emit(e)})),g.Bc(1,cs,3,4,"mobile-result",1),g.Bc(2,hs,7,7,"table",2),g.Bc(3,xs,2,2,"tiled-result",3),g.Bc(4,Is,2,3,"map-result",4),g.Pb()),2&e&&g.gc("results",t.results)("rendering$",t.rendering$)("resultType",t.resultType)("toAddress",t.address)("referencePoint",t.referencePoint)("toMarkerTitle",t.displayFunction())("toLink",t.canViewProfile?t.toLink:null)},directives:[$.a,U.a,H.a,es.a,ts.a,G.a,p.s,p.t,p.q,is.a,we.a,ns.a,as.a],encapsulation:2,changeDetection:0}),e})();function As(e,t){1&e&&g.Mb(0)}function Cs(e,t){if(1&e&&(g.Qb(0,"div",9),g.Qb(1,"label-value",10),g.Lb(2,"user-link",11),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function Ds(e,t){if(1&e&&g.Lb(0,"field-option",14),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function Os(e,t){if(1&e&&(g.Qb(0,"div",9),g.Qb(1,"multi-selection-field",12),g.Bc(2,Ds,1,4,"field-option",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.user.groupFilter),g.xb(1),g.gc("ngForOf",e.data.groups)}}function Ss(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",9),g.Lb(2,"multi-selection-field",15),g.Pb(),g.Qb(3,"div",9),g.Lb(4,"date-field",16),g.Pb(),g.Qb(5,"div",9),g.Lb(6,"date-field",17),g.Pb(),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),g.xb(2),g.gc("label",e.i18n.user.creationBegin),g.xb(2),g.gc("label",e.i18n.user.creationEnd)}}function Qs(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"form",4),g.Qb(3,"div",5),g.Bc(4,Cs,3,2,"div",6),g.Bc(5,Os,3,2,"div",6),g.Bc(6,Ss,7,4,"ng-container",7),g.ac(7,"async"),g.Pb(),g.Pb(),g.Pb(),g.Qb(8,"users-results",8),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(9,"async"),g.ac(10,"async"),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.self?e.i18n.user.title.myOperators:e.i18n.user.title.userOperators)("mobileHeading",e.self?e.i18n.user.mobileTitle.myOperators:e.i18n.user.mobileTitle.userOperators)("headingActions",g.bc(1,11,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),g.xb(1),g.gc("ngIf",g.bc(7,13,e.layout.gtxxs$)),g.xb(2),g.gc("results",g.bc(9,15,e.results$))("rendering$",e.rendering$)("data",g.bc(10,17,e.data$))("resultKind","operator")}}let Ns=(()=>{class e extends Qe.a{constructor(e,t,i){super(e),this.operatorsService=t,this.userHelper=i,this.ResultType=Ya.a,this.empty=b.h}getFormControlNames(){return["operatorGroups","statuses","creationBegin","creationEnd"]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||c.a.SELF,this.self=this.authHelper.isSelf(this.param),this.addSub(this.operatorsService.getUserOperatorsDataForSearch({user:this.param}).subscribe(e=>{this.statusOptions=this.userHelper.statusOptions(),!this.self&&e.canCreateNew&&(this.headingActions=[new be.c("registration",this.i18n.general.addNew,()=>{this.router.navigate(["/users",this.param,"operators","registration"])},!0)]),this.data=e}))}onDataInitialized(e){super.onDataInitialized(e),Object(b.h)(e.fieldsInList)&&(e.fieldsInList=["display"])}toSearchParams(e){const t=e;return t.user=this.param,t.creationPeriod=c.a.rangeFilter(e.creationBegin,e.creationEnd),delete e.customValues,t}doSearch(e){return this.operatorsService.searchUserOperators$Response(e)}resolveMenu(e){return this.menu.userMenu(e.user,u.b.MY_OPERATORS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Qa.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-user-operators"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","rendering$","data","resultKind","update"],[1,"col-12","col-md-6"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["labelPosition","side","formControlName","operatorGroups",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions"],["labelPosition","side","formControlName","creationBegin","fieldSize","full",3,"label"],["labelPosition","side","formControlName","creationEnd","fieldSize","full",3,"label"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,As,1,0,"ng-container",1),g.Pb(),g.Bc(3,Qs,11,19,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Es,Q.a,Dt.a,ut.a,h.v,h.l,p.s,Le.a,Ne.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Fs=i("FUMw");function Ls(e,t){if(1&e&&g.Lb(0,"input-field",7),2&e){const e=g.Zb();g.gc("label",e.i18n.password.oldPassword)}}const Bs=e=>{const t=e.value;if(e.touched&&null!=t&&""!==t){const i=e.parent;if((null==i.get("newPassword")?"":i.get("newPassword").value)!==t)return{passwordsMatch:!0}}return null};let ws=(()=>{class e extends Wa.a{constructor(e,t,i){super(e),this.modalRef=t,this.passwordsService=i,this.done=new g.n}ngOnInit(){super.ngOnInit(),this.self=this.authHelper.isSelf(this.user),this.form=this.formBuilder.group({newPassword:[null,h.G.required],newPasswordConfirmation:[null,h.G.compose([h.G.required,Bs])]}),this.requireOld&&this.form.setControl("oldPassword",this.formBuilder.control(null,h.G.required))}submit(){if(!Object(b.F)(this.form))return;const e=this.form.value;e.checkConfirmation=!0,this.addSub(this.passwordsService.changePassword({user:this.param,type:this.type.id,body:e}).subscribe(()=>{this.done.emit(),this.modalRef.hide()}))}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.a),g.Kb(Fs.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["change-password-dialog"]],inputs:{param:"param",user:"user",type:"type",requireOld:"requireOld"},outputs:{done:"done"},features:[g.ub],decls:10,vars:10,consts:[[3,"formGroup"],["required","","focused","","formControlName","oldPassword","type","password",3,"label",4,"ngIf"],["required","","formControlName","newPassword","type","password",3,"label"],["required","","formControlName","newPasswordConfirmation","type","password",3,"label"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action"],["required","","focused","","formControlName","oldPassword","type","password",3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Qb(2,"form",0),g.Bc(3,Ls,1,1,"input-field",1),g.Lb(4,"input-field",2),g.Lb(5,"input-field",3),g.Pb(),g.Qb(6,"actions",4),g.Qb(7,"action-button",5),g.Xb("action",(function(){return t.submit()})),g.ac(8,"async"),g.Pb(),g.Qb(9,"action-button",6),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Fc(" ",t.self?t.i18n.password.title.changeSelf:t.i18n.password.title.changeUser,"\n"),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngIf",t.requireOld),g.xb(1),g.gc("label",t.i18n.password.newPassword),g.xb(1),g.gc("label",t.i18n.password.passwordConfirmation),g.xb(2),g.gc("disabled",g.bc(8,8,t.requesting$))("label",t.i18n.general.submit),g.xb(2),g.gc("label",t.i18n.general.cancel))},directives:[h.I,h.w,h.n,p.t,Ot.a,h.D,h.v,h.l,x.a,y.a,qt.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Rs=i("CNMR");function ks(e,t){1&e&&g.Mb(0)}function Ts(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"user-info",7),g.Lb(2,"hr"),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("user",e.data.user)}}function Zs(e,t){1&e&&g.Lb(0,"hr",17)}function _s(e,t){1&e&&g.Lb(0,"avatar",18),2&e&&g.gc("size",64)}const Ms=function(e){return{"mt-0":e}};function $s(e,t){if(1&e&&(g.Qb(0,"h2",19),g.Dc(1),g.Pb()),2&e){const e=g.Zb(),t=e.$implicit;g.gc("ngClass",g.jc(2,Ms,e.first)),g.xb(1),g.Fc(" ",t.type.name,"")}}function Us(e,t){if(1&e&&(g.Qb(0,"div",20),g.Dc(1),g.ac(2,"dateTime"),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Fc(" ",t.i18n.password.statusSince(g.bc(2,1,e.date))," ")}}const Hs=function(e){return{"mb-3":e}};function Gs(e,t){if(1&e&&(g.Qb(0,"action-button",21),g.Xb("action",(function(){return t.$implicit.onClick()})),g.Pb()),2&e){const e=t.$implicit;g.gc("ngClass",g.jc(2,Hs,!t.last))("label",e.label)}}function qs(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Zs,1,0,"hr",8),g.Qb(2,"div",9),g.Qb(3,"div",10),g.Bc(4,_s,1,1,"avatar",11),g.ac(5,"async"),g.Pb(),g.Qb(6,"div",12),g.Bc(7,$s,2,4,"h2",13),g.Qb(8,"div"),g.Dc(9),g.Pb(),g.Bc(10,Us,3,3,"div",14),g.Pb(),g.Qb(11,"div",15),g.Bc(12,Gs,1,4,"action-button",16),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(2);g.xb(1),g.gc("ngIf",!i),g.xb(3),g.gc("ngIf",g.bc(5,6,n.layout.gtxxs$)),g.xb(3),g.gc("ngIf",n.multiple),g.xb(2),g.Ec(n.status(e)),g.xb(1),g.gc("ngIf",e.date),g.xb(2),g.gc("ngForOf",n.actions(e))}}function Ks(e,t){if(1&e&&g.Lb(0,"field-option",29),2&e){const e=t.$implicit;g.gc("value",e.internalName)("text",e.name)}}function Vs(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",22),g.Qb(1,"alert",23),g.Dc(2),g.Pb(),g.Qb(3,"form",24),g.Qb(4,"single-selection-field",25),g.Bc(5,Ks,1,2,"field-option",26),g.Pb(),g.Lb(6,"input-field",27),g.Pb(),g.Qb(7,"actions"),g.Qb(8,"action-button",28),g.Xb("action",(function(){return g.sc(e),g.Zb(2).setSecurityAnswer()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("heading",e.i18n.password.title.securityAnswer)("mobileHeading",e.i18n.password.mobileTitle.securityAnswer),g.xb(2),g.Ec(e.i18n.securityQuestion.message),g.xb(1),g.gc("formGroup",e.securityAnswer),g.xb(1),g.gc("label",e.i18n.securityQuestion.question),g.xb(1),g.gc("ngForOf",e.data.dataForSetSecurityAnswer.securityQuestions),g.xb(1),g.gc("label",e.i18n.securityQuestion.answer),g.xb(2),g.gc("label",e.i18n.general.save)}}function js(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Bc(1,Ts,3,1,"ng-container",4),g.Bc(2,qs,13,8,"ng-container",5),g.Pb(),g.Bc(3,Vs,9,8,"page-content",6)),2&e){const e=g.Zb();g.gc("heading",e.title)("mobileHeading",e.mobileTitle)("last",!(null!=e.data&&e.data.dataForSetSecurityAnswer)),g.xb(1),g.gc("ngIf",e.data.user&&!e.self),g.xb(1),g.gc("ngForOf",e.data.passwords),g.xb(1),g.gc("ngIf",null==e.data?null:e.data.dataForSetSecurityAnswer)}}let zs=(()=>{class e extends l.a{constructor(e,t,i){super(e),this.modal=t,this.passwordsService=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.passwordsService.getUserPasswordsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user),this.multiple=e.passwords.length>1,this.self?(this.title=this.multiple?this.i18n.password.title.manageMultipleSelf:this.i18n.password.title.manageSingleSelf,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleSelf:this.i18n.password.mobileTitle.manageSingleSelf):(this.title=this.multiple?this.i18n.password.title.manageMultipleUser:this.i18n.password.title.manageSingleUser,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleUser:this.i18n.password.mobileTitle.manageSingleUser),e.dataForSetSecurityAnswer&&(this.securityAnswer=this.formBuilder.group({securityQuestion:[null,h.G.required],securityAnswer:[null,h.G.required]}))}actions(e){const t=[],i=e.permissions||{};return i.change&&t.push(new be.a(this.i18n.password.action.change,()=>{this.change(e)})),i.changeGenerated&&t.push(new be.a(this.i18n.password.action.change,()=>{this.changeGenerated(e)})),i.unblock&&t.push(new be.a(this.i18n.password.action.unblock,()=>{this.unblock(e)})),i.generate&&t.push(new be.a(this.i18n.password.action.activate,()=>{this.generate(e)})),i.enable&&t.push(new be.a(this.i18n.password.action.enable,()=>{this.enable(e)})),i.disable&&t.push(new be.a(this.i18n.password.action.disable,()=>{this.disable(e)})),t}setSecurityAnswer(){Object(b.F)(this.securityAnswer),this.securityAnswer.valid&&this.addSub(this.passwordsService.setSecurityAnswer({body:this.securityAnswer.value}).subscribe(()=>{this.notification.snackBar(this.i18n.securityQuestion.set),this.reload()}))}status(e){switch(e.status){case Me.T.ACTIVE:return this.i18n.password.status.active;case Me.T.DISABLED:return this.i18n.password.status.disabled;case Me.T.EXPIRED:return this.i18n.password.status.expired;case Me.T.INDEFINITELY_BLOCKED:return this.i18n.password.status.indefinitelyBlocked;case Me.T.NEVER_CREATED:return this.i18n.password.status.neverCreated;case Me.T.PENDING:return this.i18n.password.status.pending;case Me.T.RESET:return this.i18n.password.status.reset;case Me.T.TEMPORARILY_BLOCKED:return this.i18n.password.status.temporarilyBlocked}}change(e){const t=this.modal.show(ws,{class:"modal-form",initialState:{param:this.param,type:e.type,user:this.data.user,requireOld:e.requireOldPasswordForChange}});this.addSub(t.content.done.subscribe(()=>{this.notification.snackBar(this.i18n.password.action.changeDone(e.type.name)),this.reload()}))}generate(e){this.notification.confirm({title:this.i18n.password.action.activate,message:this.i18n.password.action.activateConfirm(e.type.name),callback:()=>this.doGenerate(e)})}doGenerate(e){this.addSub(this.passwordsService.generatePassword({type:e.type.id}).subscribe(t=>{this.notification.info(this.i18n.password.action.changeGeneratedDone({type:e.type.name,value:t})),this.reload()}))}createDeviceConfirmation(e){return()=>({type:Me.s.GENERATE_PASSWORD,passwordType:e.type.id})}changeGenerated(e){this.notification.confirm({title:this.i18n.password.action.change,message:this.i18n.password.action.changeGeneratedConfirm(e.type.name),createDeviceConfirmation:this.createDeviceConfirmation(e),passwordInput:this.data.confirmationPasswordInput,callback:t=>this.doChangeGenerated(e,t.confirmationPassword)})}doChangeGenerated(e,t){this.addSub(this.passwordsService.changeGenerated({type:e.type.id,confirmationPassword:t}).subscribe(t=>{this.notification.info(this.i18n.password.action.changeGeneratedDone({type:e.type.name,value:t})),this.reload()}))}unblock(e){this.notification.confirm({title:this.i18n.password.action.unblock,message:this.i18n.password.action.unblockConfirm(e.type.name),callback:()=>this.doUnblock(e)})}doUnblock(e){this.addSub(this.passwordsService.unblockPassword({user:this.param,type:e.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.unblockDone(e.type.name)),this.reload()}))}enable(e){this.notification.confirm({title:this.i18n.password.action.enable,message:this.i18n.password.action.enableConfirm(e.type.name),callback:()=>this.doEnable(e)})}doEnable(e){this.addSub(this.passwordsService.enablePassword({user:this.param,type:e.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.enableDone(e.type.name)),this.reload()}))}disable(e){this.notification.confirm({title:this.i18n.password.action.disable,message:this.i18n.password.action.disableConfirm(e.type.name),callback:()=>this.doDisable(e)})}doDisable(e){this.addSub(this.passwordsService.disablePassword({user:this.param,type:e.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.disableDone(e.type.name)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.PASSWORDS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.b),g.Kb(Fs.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["manage-passwords"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading","last"],[4,"ngIf"],[4,"ngFor","ngForOf"],["hideBack","","last","",3,"heading","mobileHeading",4,"ngIf"],["labelCols","2",3,"user"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-md-2"],["class","ml-2 mr-5 management","iconSize","64px","icon","vpn_key",3,"size",4,"ngIf"],[1,"col-8","col-md-7"],["class","border-0 mb-3",3,"ngClass",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto",3,"ngClass","label","action",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px","icon","vpn_key",1,"ml-2","mr-5","management",3,"size"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"d-block","ml-auto",3,"ngClass","label","action"],["hideBack","","last","",3,"heading","mobileHeading"],["type","info"],[3,"formGroup"],["formControlName","securityQuestion","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","securityAnswer","required","",3,"label"],[3,"label","action"],[3,"value","text"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,ks,1,0,"ng-container",1),g.Pb(),g.Bc(3,js,4,6,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,p.s,P.a,we.a,p.q,y.a,Rs.a,h.I,h.w,h.n,Fe.a,h.v,h.l,h.D,Ot.a,x.a,Le.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var Xs=i("GJcY");function Js(e,t){1&e&&g.Mb(0)}function Ys(e,t){1&e&&g.Mb(0)}function Ws(e,t){1&e&&g.Mb(0)}const eo=function(e,t){return{$implicit:e,title:t}},to=function(e,t){return{$implicit:e,title:t,readOnly:!0}};function io(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",3),g.ac(2,"async"),g.Lb(3,"user-info",4),g.Bc(4,Js,1,0,"ng-container",5),g.Bc(5,Ys,1,0,"ng-container",5),g.Bc(6,Ws,1,0,"ng-container",5),g.Pb(),g.Nb()),2&e){const e=g.Zb(),t=g.qc(4);g.xb(1),g.gc("heading",e.i18n.product.title.list)("mobileHeading",e.i18n.product.mobileTitle.list)("headingActions",g.bc(2,10,e.headingActions$)),g.xb(2),g.gc("user",e.data.user),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.kc(12,eo,e.data.userProducts,e.i18n.product.assigned.individual)),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.kc(15,to,e.data.groupProducts,e.i18n.product.assigned.group)),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.kc(18,to,e.data.groupSetProducts,e.i18n.product.assigned.groupSet))}}function no(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",13),g.Qb(1,"button",14),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(4).remove(i),t.stopPropagation(),t.preventDefault()})),g.Lb(2,"icon",15),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(5);g.xb(1),g.gc("tooltip",e.i18n.general.remove)}}function ao(e,t){if(1&e&&(g.Qb(0,"div",10),g.Qb(1,"div",11),g.Dc(2),g.Pb(),g.Bc(3,no,3,1,"div",12),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3).readOnly,n=g.Zb();g.xb(2),g.Ec(e.name),g.xb(1),g.gc("ngIf",!i&&n.canRemove(e))}}function so(e,t){if(1&e&&(g.Ob(0),g.Bc(1,ao,4,2,"div",9),g.Nb()),2&e){const e=g.Zb(2).$implicit;g.xb(1),g.gc("ngForOf",e)}}function oo(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",14),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(4).remove(i),t.stopPropagation()})),g.Lb(1,"icon",15),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("tooltip",e.i18n.general.remove)}}const ro=function(e){return{"no-border":e}};function co(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"tr"),g.Qb(2,"td",21),g.Dc(3),g.Pb(),g.Qb(4,"td",21),g.Dc(5),g.Pb(),g.Qb(6,"td",21),g.Dc(7),g.Pb(),g.Qb(8,"td",22),g.Bc(9,oo,2,1,"button",23),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3).readOnly,a=g.Zb();g.xb(2),g.gc("ngClass",g.jc(8,ro,i)),g.xb(1),g.Fc(" ",e.name," "),g.xb(1),g.gc("ngClass",g.jc(10,ro,i)),g.xb(1),g.Fc(" ",a.resolveKindLabel(e.kind)," "),g.xb(1),g.gc("ngClass",g.jc(12,ro,i)),g.xb(1),g.Fc(" ",null==e.userAccount?null:e.userAccount.name," "),g.xb(1),g.gc("ngClass",g.jc(14,ro,i)),g.xb(1),g.gc("ngIf",!n&&a.canRemove(e))}}function lo(e,t){if(1&e&&(g.Qb(0,"table",16),g.Qb(1,"thead"),g.Qb(2,"th",17),g.Dc(3),g.Pb(),g.Qb(4,"th",18),g.Dc(5),g.Pb(),g.Qb(6,"th",18),g.Dc(7),g.Pb(),g.Lb(8,"th",19),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,co,10,16,"ng-container",20),g.Pb(),g.Pb()),2&e){const e=g.Zb(2).$implicit,t=g.Zb();g.xb(3),g.Ec(t.i18n.general.name),g.xb(2),g.Ec(t.i18n.general.type),g.xb(2),g.Fc("",t.i18n.product.userAccount," "),g.xb(3),g.gc("ngForOf",e)}}function bo(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",6),g.Dc(2),g.Pb(),g.Bc(3,so,2,1,"ng-container",7),g.ac(4,"async"),g.Bc(5,lo,11,4,"ng-template",null,8,g.Cc),g.Nb()),2&e){const e=g.qc(6),t=g.Zb().title,i=g.Zb();g.xb(2),g.Ec(t),g.xb(1),g.gc("ngIf",g.bc(4,3,i.layout.ltsm$))("ngIfElse",e)}}function uo(e,t){if(1&e&&g.Bc(0,bo,7,5,"ng-container",1),2&e){const e=t.$implicit,i=g.Zb();g.gc("ngIf",!i.empty(e))}}let go=(()=>{class e extends l.a{constructor(e,t){super(e),this.productAssignmentService=t,this.empty=b.h}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.productAssignmentService.getUserProductsData({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){const t=[];e.assignable&&t.push(new be.c("add",this.i18n.product.assignIndividualProduct,()=>this.assign())),e.history&&t.push(new be.c("history",this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.user,"product-assignment","history"]))),this.headingActions=t}resolveKindLabel(e){switch(e){case Me.cb.ADMINISTRATOR:return this.i18n.product.kind.administrator;case Me.cb.BROKER:return this.i18n.product.kind.broker;case Me.cb.MEMBER:return this.i18n.product.kind.member}}resolveMenu(){return this.menu.searchUsersMenu()}assign(){this.notification.confirm({title:this.i18n.product.assignIndividualProduct,labelPosition:"above",customFields:[{internalName:"products",name:this.i18n.product.product,type:Me.p.SINGLE_SELECTION,control:Me.n.SINGLE_SELECTION,hasValuesList:!0,defaultValue:this.data.assignable[0].id,possibleValues:this.data.assignable.map(e=>({id:e.id,value:e.name})),required:!0}],callback:e=>{this.addSub(this.productAssignmentService.assignIndividualProduct({product:e.customValues.products,user:this.user}).subscribe(()=>{this.notification.snackBar(this.i18n.product.productAssigned),this.reload()}))}})}canRemove(e){return this.data.unassignable.find(t=>e.id===t||e.internalName===t)}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.productAssignmentService.unassignIndividualProduct({product:e.id,user:this.user}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Xs.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-product-assignment"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["products",""],[3,"heading","mobileHeading","headingActions"],[3,"user"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-3","mb-2"],[4,"ngIf","ngIfElse"],["largeTable",""],["class","d-flex mb-2",4,"ngFor","ngForOf"],[1,"d-flex","mb-2"],[1,"cell-main"],["class","ml-auto text-right",4,"ngIf"],[1,"ml-auto","text-right"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"],[1,"table","table-hover","small-height","mb-0"],["width","40%",1,"no-border"],["width","25%",1,"no-border"],["width","10%",1,"no-border"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"actions",3,"ngClass"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,io,7,21,"ng-container",1),g.Pb(),g.Bc(3,uo,1,1,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,p.A,p.s,I.b,q.a,p.q],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function fo(e,t){1&e&&g.Mb(0)}function mo(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Qb(3,"div",10),g.Dc(4),g.ac(5,"dateTime"),g.Pb(),g.Qb(6,"div",11),g.Dc(7),g.Pb(),g.Qb(8,"div",11),g.Dc(9),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(2),g.Fc(" ",e.product.name," "),g.xb(2),g.Fc(" ",g.bc(5,6,e.date)," "),g.xb(3),g.Gc(" ",i.i18n.product.action," ",e.action===i.ProductAssignmentActionEnum.ASSIGN?i.i18n.product.assign:i.i18n.product.unassign," "),g.xb(2),g.Gc(" ",i.i18n.general.performedBy," ",e.by.display," ")}}function po(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td"),g.Dc(2),g.ac(3,"dateTime"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(g.bc(3,4,e.date)),g.xb(3),g.Ec(e.product.name),g.xb(2),g.Fc(" ",e.action===i.ProductAssignmentActionEnum.ASSIGN?i.i18n.product.assign:i.i18n.product.unassign," "),g.xb(2),g.Ec(e.by.display)}}function ho(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Qb(8,"th"),g.Dc(9),g.Pb(),g.Pb(),g.Qb(10,"tbody"),g.Bc(11,po,10,6,"tr",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.product.product),g.xb(2),g.Ec(e.i18n.product.action),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function vo(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Qb(1,"label-value",4),g.Lb(2,"user-link",5),g.Pb(),g.Pb(),g.Qb(3,"results-layout",6),g.Bc(4,mo,10,8,"mobile-result",7),g.Bc(5,ho,12,5,"table",8),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.product.title.history)("mobileHeading",e.i18n.product.mobileTitle.history),g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)("onClick",e.onClick)}}let xo=(()=>{class e extends _.a{constructor(e,t){super(e),this.productAssignmentSerivce=t,this.ProductAssignmentActionEnum=Me.bb}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.productAssignmentSerivce.getUserProductsData({user:this.user,fields:["user","history"]}).subscribe(e=>this.data=e))}get onClick(){return e=>null!=e}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Xs.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-product-assignment-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"label"],[3,"user"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,fo,1,0,"ng-container",1),g.Pb(),g.Bc(3,vo,6,6,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,Q.a,Dt.a,$.a,U.a,H.a,G.a,p.s],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var yo=i("zlpg"),Po=i("mMSl"),Io=i("dt5f"),Eo=i("9d5G"),Ao=i("bER3"),Co=i("MYKl"),Do=i("c/3O");const Oo=["codeField"];let So=(()=>{class e extends Wa.a{constructor(e,t,i){super(e),this.modalRef=t,this.phonesService=i,this.verified=new g.n,this.message$=new Ct.a(""),this.disabled=!1,this.code=this.formBuilder.control(null,h.G.required)}ngOnInit(){super.ngOnInit(),this.message=this.i18n.phone.verify.message}sendCode(){this.addSub(this.phonesService.sendPhoneVerificationCode({id:this.phone.id}).subscribe(e=>{this.message=this.i18n.phone.verify.done(e),this.code.setValue(null),this.codeField.focus()}))}set message(e){this.message$.next(e)}verify(){Object(b.F)(this.code)&&this.addSub(this.phonesService.verifyPhone({id:this.phone.id,code:this.code.value}).subscribe(e=>{switch(e){case Me.l.CODE_NOT_SENT:case Me.l.EXPIRED:this.notification.error(this.i18n.phone.error.verify.expired);break;case Me.l.FAILED:this.notification.error(this.i18n.phone.error.verify.invalid);break;case Me.l.MAX_ATTEMPTS_REACHED:this.notification.error(this.i18n.phone.error.verify.maxAttempts);break;case Me.l.SUCCESS:this.disabled=!0,this.verified.emit(!0)}}))}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.a),g.Kb(Po.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["verify-phone"]],viewQuery:function(e,t){var i;1&e&&g.yc(Oo,!0),2&e&&g.pc(i=g.Yb())&&(t.codeField=i.first)},inputs:{phone:"phone"},outputs:{verified:"verified"},features:[g.ub],decls:18,vars:12,consts:[[1,"row"],[1,"col-3","col-form-label"],["for","smsCode"],[1,"col-6"],["id","smsCode","fieldSize","4","type","number","focused","",3,"formControl"],["codeField",""],[1,"col-3"],[1,"d-block","w-100",3,"label","action"],[1,"mt-3","pb-1"],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Qb(2,"div",0),g.Qb(3,"div",1),g.Qb(4,"label",2),g.Dc(5),g.Pb(),g.Pb(),g.Qb(6,"div",3),g.Lb(7,"input-field",4,5),g.Pb(),g.Qb(9,"div",6),g.Qb(10,"action-button",7),g.Xb("action",(function(){return t.sendCode()})),g.Pb(),g.Pb(),g.Pb(),g.Qb(11,"div",8),g.Dc(12),g.ac(13,"async"),g.Pb(),g.Qb(14,"actions"),g.Qb(15,"action-button",9),g.Xb("action",(function(){return t.verify()})),g.ac(16,"async"),g.Pb(),g.Qb(17,"action-button",10),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Fc(" ",t.i18n.phone.verify.title(t.phone.number),"\n"),g.xb(4),g.Fc(" ",t.i18n.phone.verify.code," "),g.xb(2),g.gc("formControl",t.code),g.xb(3),g.gc("label",t.i18n.phone.verify.send),g.xb(2),g.Ec(g.bc(13,8,t.message$)),g.xb(3),g.gc("disabled",g.bc(16,10,t.requesting$))("label",t.i18n.general.confirm),g.xb(2),g.gc("label",t.i18n.general.cancel))},directives:[Ot.a,qt.a,h.v,h.k,y.a,x.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Qo=i("IzEk"),No=i("SxV6"),Fo=i("pz1b"),Lo=i("pBnU"),Bo=i("sGzL"),wo=i("N7zh"),Ro=i("CyT4"),ko=i("FE24"),To=i("z332"),Zo=i("oj/z");function _o(e,t){if(1&e&&g.Lb(0,"avatar",21),2&e){const e=g.Zb(4);g.gc("image",e.images[0])("roundBorders",!1)}}function Mo(e,t){if(1&e&&(g.Qb(0,"div",22),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.Fc(" ",e.i18n.user.noImage," ")}}function $o(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(5).removeAllImages()})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.field.image.remove)}}function Uo(e,t){if(1&e){const e=g.Rb();g.Qb(0,"actions",23),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(),g.qc(7).perform()})),g.Pb(),g.Bc(2,$o,1,1,"action-button",25),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.gc("label",e.i18n.field.image.upload),g.xb(1),g.gc("ngIf",e.images.length>0)}}function Ho(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"h2",14),g.Dc(2),g.Pb(),g.Qb(3,"div",15),g.Bc(4,_o,1,2,"avatar",16),g.Bc(5,Mo,2,1,"div",17),g.Pb(),g.Qb(6,"image-upload",18,19),g.Xb("uploadDone",(function(t){return g.sc(e),g.Zb(3).onUploadDone(t)})),g.Pb(),g.Bc(8,Uo,3,2,"actions",20),g.ac(9,"async"),g.Nb()}if(2&e){const e=g.qc(7),t=g.Zb(3);g.xb(2),g.Fc(" ",t.i18n.user.title.image," "),g.xb(2),g.gc("ngIf",t.images.length>0),g.xb(1),g.gc("ngIf",0===t.images.length),g.xb(1),g.gc("owner",t.param),g.xb(2),g.gc("ngIf",t.canEdit("image")&&!1===g.bc(9,5,e.uploading$))}}function Go(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(),g.qc(11).perform()})),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("label",e.i18n.field.image.upload)}}function qo(e,t){if(1&e&&(g.Qb(0,"div",33),g.Lb(1,"avatar",34),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(4);g.xb(1),g.gc("image",e)("roundBorders",!1)("additionalImages",i.images)}}function Ko(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",35),g.Dc(2),g.Pb(),g.Nb()),2&e){const e=g.Zb(4);g.xb(2),g.Fc(" ",e.i18n.user.noImages," ")}}function Vo(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",36),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(4).manageImages()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.gc("label",e.i18n.field.image.manage)}}function jo(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"h2",26),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Bc(4,Go,1,1,"action-button",25),g.ac(5,"async"),g.Pb(),g.Qb(6,"div",28),g.Bc(7,qo,2,3,"div",29),g.Bc(8,Ko,3,1,"ng-container",4),g.Pb(),g.Bc(9,Vo,2,1,"div",30),g.Qb(10,"image-upload",31,32),g.Xb("uploadDone",(function(t){return g.sc(e),g.Zb(3).onUploadDone(t)})),g.Pb(),g.Nb()}if(2&e){const e=g.qc(11),t=g.Zb(3);g.xb(3),g.Fc(" ",t.i18n.user.title.images," "),g.xb(1),g.gc("ngIf",t.canUploadImages&&!1===g.bc(5,7,e.uploading$)),g.xb(3),g.gc("ngForOf",t.images),g.xb(1),g.gc("ngIf",0===t.images.length),g.xb(1),g.gc("ngIf",t.canEdit("image")&&t.images.length>0),g.xb(1),g.gc("owner",t.param)("max",t.data.imageConfiguration.maxImages)}}function zo(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Ho,10,7,"ng-container",4),g.Bc(2,jo,12,9,"ng-container",4),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("ngIf","single"===e.imagesAvailability),g.xb(1),g.gc("ngIf","multiple"===e.imagesAvailability)}}function Xo(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Lb(1,"user-link",38),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.operatorOwner),g.xb(1),g.gc("user",e.data.userConfiguration.details.user)}}function Jo(e,t){if(1&e&&g.Lb(0,"input-field",39),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.name)("required",e.canEdit("name"))}}function Yo(e,t){if(1&e&&g.Lb(0,"input-field",40),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.username)("required",e.canEdit("username"))}}function Wo(e,t){if(1&e&&g.Lb(0,"field-privacy",44),2&e){const e=g.Zb(3);g.gc("control",e.user.get("hiddenFields"))}}function er(e,t){if(1&e&&(g.Qb(0,"label-value",41),g.Lb(1,"input-field",42),g.Bc(2,Wo,1,1,"field-privacy",43),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.email)("kind",e.canEdit("email")?"field":"fieldView")("ignoreExtraCell",!e.canManagePrivacy("email")),g.xb(1),g.gc("required",e.canEdit("email"))}}function tr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.emailPending),g.xb(1),g.Fc(" ",e.data.userConfiguration.emailPendingValidation," ")}}function ir(e,t){if(1&e&&g.Lb(0,"custom-field-input",50),2&e){const e=g.Zb(2).$implicit,t=g.Zb(2);g.gc("field",e)("formControlName",e.internalName)("binaryValues",t.data.userConfiguration.binaryValues)}}function nr(e,t){if(1&e&&g.Lb(0,"format-field-value",51),2&e){const e=g.Zb(2).$implicit,t=g.Zb(2);g.gc("fieldValue",t.fieldValue(e))}}function ar(e,t){if(1&e&&g.Lb(0,"field-privacy",52),2&e){const e=g.Zb(2).$implicit,t=g.Zb(2);g.gc("field",e.internalName)("control",t.user.get("hiddenFields"))}}function sr(e,t){if(1&e&&(g.Qb(0,"label-value",46),g.Bc(1,ir,1,3,"custom-field-input",47),g.Bc(2,nr,1,1,"ng-template",null,48,g.Cc),g.Bc(4,ar,1,2,"field-privacy",49),g.Pb()),2&e){const e=g.qc(3),t=g.Zb().$implicit,i=g.Zb(2);g.gc("label",t.name)("kind",i.canEdit(t)?"field":"fieldView")("labelPosition","boolean"===t.type?"sideForced":"auto")("ignoreExtraCell",!i.canManagePrivacy(t))("fieldSize",i.fieldSize(t))("required",t.required),g.xb(1),g.gc("ngIf",i.canEdit(t))("ngIfElse",e)}}function or(e,t){if(1&e&&(g.Ob(0,6),g.Bc(1,sr,5,8,"label-value",45),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("formGroup",i.user.get("customValues")),g.xb(1),g.gc("ngIf",i.canEdit(e)||!i.isEmpty(e))}}function rr(e,t){if(1&e&&g.Lb(0,"input-field",57),2&e){const e=g.Zb(3);g.gc("placeholder",e.data.phoneConfiguration.mobileExample)}}function cr(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb(3);g.Fc(" ",e.singleMobile.get("number").value," ")}}function lr(e,t){if(1&e&&g.Lb(0,"field-privacy",58),2&e){const e=g.Zb(3);g.gc("control",e.singleMobile.get("hidden"))}}function br(e,t){if(1&e&&g.Lb(0,"boolean-field",61),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.verified)("formControl",e.singleMobile.get("verified"))}}function ur(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.verified),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.singleMobile.get("verified").value)," ")}}function dr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,br,1,2,"boolean-field",59),g.Bc(2,ur,2,2,"ng-template",null,60,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(3);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function gr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"boolean-field",64),g.Xb("click",(function(t){return g.sc(e),g.Zb(4).maybeVerify(t)})),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.enabledSms)("formControl",e.singleMobile.get("enabledForSms"))}}function fr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.enabledSms),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.singleMobile.get("enabledForSms").value)," ")}}function mr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,gr,1,2,"boolean-field",62),g.Bc(2,fr,2,2,"ng-template",null,63,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(3);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function pr(e,t){if(1&e&&(g.Ob(0,6),g.Qb(1,"label-value",53),g.Bc(2,rr,1,1,"input-field",54),g.Bc(3,cr,1,1,"ng-template",null,55,g.Cc),g.Bc(5,lr,1,1,"field-privacy",56),g.Pb(),g.Bc(6,dr,4,2,"ng-container",4),g.Bc(7,mr,4,2,"ng-container",4),g.Nb()),2&e){const e=g.qc(4),t=g.Zb(2);g.gc("formGroup",t.singleMobile),g.xb(1),g.gc("label",t.i18n.phone.mobile)("required","required"===t.data.phoneConfiguration.mobileAvailability)("ignoreExtraCell",!t.canManagePrivacy("phone")),g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e),g.xb(4),g.gc("ngIf",t.phoneHasSms(t.singleMobileManage)),g.xb(1),g.gc("ngIf",t.showEnableForSms(t.singleMobile))}}function hr(e,t){if(1&e&&g.Lb(0,"input-field",57),2&e){const e=g.Zb(3);g.gc("placeholder",e.data.phoneConfiguration.landLineExample)}}function vr(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb(3);g.Fc(" ",e.singleLandLine.get("number").value," ")}}function xr(e,t){if(1&e&&g.Lb(0,"field-privacy",58),2&e){const e=g.Zb(3);g.gc("control",e.singleLandLine.get("hidden"))}}function yr(e,t){if(1&e&&g.Lb(0,"input-field",66),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.extension)}}function Pr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,yr,1,1,"input-field",65),g.Nb()),2&e){const e=t.ngIf;g.xb(1),g.gc("ngIf",!e.disabled||e.value)}}function Ir(e,t){if(1&e&&(g.Ob(0,6),g.Qb(1,"label-value",53),g.Bc(2,hr,1,1,"input-field",54),g.Bc(3,vr,1,1,"ng-template",null,55,g.Cc),g.Bc(5,xr,1,1,"field-privacy",56),g.Pb(),g.Bc(6,Pr,2,1,"ng-container",4),g.Nb()),2&e){const e=g.qc(4),t=g.Zb(2);g.gc("formGroup",t.singleLandLine),g.xb(1),g.gc("label",t.i18n.phone.landLine)("required","required"===t.data.phoneConfiguration.landLineAvailability)("ignoreExtraCell",!t.canManagePrivacy("address")),g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e),g.xb(4),g.gc("ngIf",t.data.phoneConfiguration.extensionEnabled&&t.singleLandLine.get("extension"))}}function Er(e,t){if(1&e&&g.Lb(0,"boolean-field",69),2&e){const e=g.Zb(3);g.gc("formControl",e.defineSingleAddress)("label",e.i18n.user.addressDefine)}}function Ar(e,t){if(1&e){const e=g.Rb();g.Qb(0,"static-map",75),g.Xb("imageLoaded",(function(){g.sc(e);const t=g.Zb(5);return t.mapShown(t.singleAddress)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("address",e.singleAddress.value)}}function Cr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(6);return t.locateAddress(t.singleAddress)})),g.Pb()}if(2&e){const e=g.Zb(6);g.gc("label",e.i18n.general.mapView)}}function Dr(e,t){if(1&e&&(g.Bc(0,Cr,1,1,"action-button",76),g.ac(1,"async")),2&e){const e=g.Zb(5),t=g.qc(4);g.gc("ngIf",!1===g.bc(1,2,e.singleAddress.locating$))("ngIfElse",t)}}function Or(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Bc(1,Ar,1,1,"static-map",73),g.Bc(2,Dr,2,4,"ng-template",null,74,g.Cc),g.Pb()),2&e){const e=g.qc(3),t=g.Zb(4);g.gc("label",t.i18n.general.map),g.xb(1),g.gc("ngIf",null!=t.singleAddress.get("location").value.latitude)("ngIfElse",e)}}function Sr(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"address-form",70),g.Bc(2,Or,4,3,"label-value",71),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("addressForm",e.singleAddress)("configuration",e.data.addressConfiguration)("managePrivacy",e.data.addressConfiguration.managePrivacy)("binaryValues",e.data.addressBinaryValues[null==e.data.addresses[0]?null:e.data.addresses[0].id]),g.xb(1),g.gc("ngIf",e.maps.enabled)}}function Qr(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",67),g.Dc(2),g.Pb(),g.Bc(3,Er,1,2,"boolean-field",68),g.Bc(4,Sr,3,5,"ng-container",4),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.address.address),g.xb(1),g.gc("ngIf",e.canEdit("address")&&"required"!==e.data.addressConfiguration.availability),g.xb(1),g.gc("ngIf",e.defineSingleAddress.value)}}function Nr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",83,84),g.Qb(2,"button",85),g.Xb("click",(function(){return g.sc(e),g.Zb(4).addLandLine()})),g.Dc(3),g.Pb(),g.Qb(4,"button",85),g.Xb("click",(function(){return g.sc(e),g.Zb(4).addMobile()})),g.Dc(5),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(3),g.Fc(" ",e.i18n.user.phoneAddLandLine," "),g.xb(2),g.Fc(" ",e.i18n.user.phoneAddMobile," ")}}function Fr(e,t){if(1&e&&(g.Qb(0,"div",80),g.Qb(1,"button",81),g.Dc(2),g.Pb(),g.Bc(3,Nr,6,2,"div",82),g.Pb()),2&e){const e=g.Zb(3);g.xb(2),g.Fc(" ",e.i18n.user.phoneAdd," ")}}function Lr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",86),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addLandLine()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(1),g.gc("label",e.i18n.user.phoneAddLandLine)}}function Br(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",86),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addMobile()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(1),g.gc("label",e.i18n.user.phoneAddMobile)}}function wr(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.user.phoneNone," ")}}function Rr(e,t){if(1&e&&g.Lb(0,"input-field",66),2&e){const e=g.Zb(5);g.gc("label",e.i18n.phone.extension)}}function kr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Rr,1,1,"input-field",65),g.Nb()),2&e){const e=t.ngIf;g.xb(1),g.gc("ngIf",!e.disabled||e.value)}}function Tr(e,t){if(1&e&&g.Lb(0,"boolean-field",91),2&e){const e=g.Zb(5);g.gc("label",e.i18n.phone.verified)}}function Zr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit,t=g.Zb(3);g.gc("label",t.i18n.phone.verified),g.xb(1),g.Fc(" ",t.format.formatBoolean(e.verified)," ")}}function _r(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Tr,1,1,"boolean-field",90),g.Bc(2,Zr,2,2,"ng-template",null,60,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(4);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function Mr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"boolean-field",93),g.Xb("click",(function(t){g.sc(e);const i=g.Zb(2).$implicit;return g.Zb(3).maybeVerify(t,i.id)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.phone.enabledSms)}}function $r(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit,t=g.Zb(3);g.gc("label",t.i18n.phone.enabledSms),g.xb(1),g.Fc(" ",t.format.formatBoolean(e.enabledForSms)," ")}}function Ur(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Mr,1,1,"boolean-field",92),g.Bc(2,$r,2,2,"ng-template",null,63,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(4);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function Hr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removePhone(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.phoneRemove)}}function Gr(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Qb(1,"div",94),g.Lb(2,"field-privacy",95),g.Bc(3,Hr,1,1,"action-button",25),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.field.privacy.name),g.xb(2),g.gc("control",e.form.get("hidden")),g.xb(1),g.gc("ngIf",t.editableFields.has("phone")&&g.bc(4,3,t.layout.gtxxs$))}}function qr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removePhone(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.phoneRemove)}}const Kr=function(e){return{"mt-3":e}};function Vr(e,t){if(1&e&&(g.Qb(0,"div",96),g.Bc(1,qr,1,1,"action-button",25),g.Pb()),2&e){const e=g.Zb(4);g.gc("ngClass",g.jc(2,Kr,!e.data.phoneConfiguration.managePrivacy)),g.xb(1),g.gc("ngIf",e.editableFields.has("phone"))}}function jr(e,t){1&e&&g.Lb(0,"hr")}function zr(e,t){if(1&e&&(g.Ob(0,6),g.Lb(1,"input-field",87),g.Lb(2,"input-field",88),g.Bc(3,kr,2,1,"ng-container",4),g.Bc(4,_r,4,2,"ng-container",4),g.Bc(5,Ur,4,2,"ng-container",4),g.Bc(6,Gr,5,5,"label-value",71),g.Bc(7,Vr,2,4,"div",89),g.ac(8,"async"),g.Bc(9,jr,1,0,"hr",4),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3);g.gc("formGroup",e.form),g.xb(1),g.gc("id","phone_name"+e.idSuffix)("label",n.phoneNameLabel(e)),g.xb(1),g.gc("id","phone_number"+e.idSuffix)("label",n.phoneNumberLabel(e))("placeholder",n.phoneExample(e)),g.xb(1),g.gc("ngIf",n.hasExtension(e)&&e.form.get("extension")),g.xb(1),g.gc("ngIf","mobile"===e.kind&&n.phoneHasSms(e.form)),g.xb(1),g.gc("ngIf","mobile"===e.kind&&n.showEnableForSms(e.form)),g.xb(1),g.gc("ngIf",n.canManagePrivacy("phone")),g.xb(1),g.gc("ngIf",g.bc(8,12,n.layout.xxs$)||!n.data.phoneConfiguration.managePrivacy),g.xb(2),g.gc("ngIf",!i)}}function Xr(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",77),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Bc(4,Fr,4,1,"div",78),g.Bc(5,Lr,2,1,"div",79),g.Bc(6,Br,2,1,"div",79),g.Pb(),g.Bc(7,wr,2,1,"div",4),g.Bc(8,zr,10,14,"ng-container",11),g.Nb()),2&e){const e=g.Zb(2);g.xb(3),g.Fc(" ",e.i18n.user.title.phones," "),g.xb(1),g.gc("ngIf",e.canCreateLandLine&&e.canCreateMobile),g.xb(1),g.gc("ngIf",e.canCreateLandLine&&!e.canCreateMobile),g.xb(1),g.gc("ngIf",!e.canCreateLandLine&&e.canCreateMobile),g.xb(1),g.gc("ngIf",0==e.phones.length),g.xb(1),g.gc("ngForOf",e.phones)}}function Jr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addAddress()})),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.addressAdd)}}function Yr(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.user.addressNone," ")}}function Wr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removeAddress(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.addressRemove)}}function ec(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Qb(1,"div",94),g.Lb(2,"field-privacy",95),g.Bc(3,Wr,1,1,"action-button",25),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.field.privacy.name),g.xb(2),g.gc("control",e.form.get("hidden")),g.xb(1),g.gc("ngIf",t.editableFields.has("address")&&!t.maps.enabled&&g.bc(4,3,t.layout.gtxxs$))}}function tc(e,t){1&e&&g.Mb(0)}function ic(e,t){if(1&e){const e=g.Rb();g.Qb(0,"label-value",100),g.Qb(1,"static-map",75),g.Xb("imageLoaded",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).mapShown(t.form)})),g.Pb(),g.Bc(2,tc,1,0,"ng-container",101),g.ac(3,"async"),g.Pb()}if(2&e){const e=g.Zb().$implicit,t=g.Zb(3),i=g.qc(4);g.gc("label",t.i18n.general.map),g.xb(1),g.gc("address",e.form.value),g.xb(1),g.gc("ngIf",g.bc(3,4,e.form.locating$))("ngIfThen",i)}}function nc(e,t){1&e&&g.Lb(0,"div",106)}function ac(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removeAddress(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.addressRemove)}}function sc(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Lb(1,"div",107),g.Qb(2,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).locateAddress(t.form)})),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(5);g.xb(2),g.gc("label",e.i18n.general.mapView)}}function oc(e,t){if(1&e&&(g.Qb(0,"div",102),g.Bc(1,nc,1,0,"div",103),g.ac(2,"async"),g.Qb(3,"div",104),g.Qb(4,"actions",105),g.Bc(5,ac,1,1,"action-button",25),g.Bc(6,sc,3,1,"ng-container",4),g.ac(7,"async"),g.Pb(),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.xb(1),g.gc("ngIf",g.bc(2,3,t.layout.gtxs$)),g.xb(4),g.gc("ngIf",t.editableFields.has("address")),g.xb(1),g.gc("ngIf",null==e.form.get("location").value.latitude&&!1===g.bc(7,5,e.form.locating$))}}function rc(e,t){1&e&&g.Lb(0,"hr")}function cc(e,t){if(1&e&&(g.Ob(0,6),g.Lb(1,"input-field",87),g.Lb(2,"address-form",97),g.Bc(3,ec,5,5,"label-value",71),g.Bc(4,ic,4,6,"label-value",98),g.ac(5,"async"),g.Bc(6,oc,8,7,"div",99),g.ac(7,"async"),g.Bc(8,rc,1,0,"hr",4),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3);g.gc("formGroup",e.form),g.xb(1),g.gc("id","address_name"+e.idSuffix)("label",n.i18n.general.name),g.xb(1),g.gc("addressForm",e.form)("ignoreContactFields",1===n.addresses.length)("configuration",n.data.addressConfiguration)("idSuffix",e.idSuffix)("managePrivacy",!1)("binaryValues",n.data.addressBinaryValues[e.id]),g.xb(1),g.gc("ngIf",n.canManagePrivacy("address")),g.xb(1),g.gc("ngIf",n.maps.enabled&&(null!=e.form.get("location").value.latitude||g.bc(5,13,e.form.locating$))),g.xb(2),g.gc("ngIf",n.maps.enabled||g.bc(7,15,n.layout.xxs$)||!n.data.addressConfiguration.managePrivacy),g.xb(2),g.gc("ngIf",!i)}}function lc(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",77),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Qb(4,"div",86),g.Bc(5,Jr,1,1,"action-button",25),g.Pb(),g.Pb(),g.Bc(6,Yr,2,1,"div",4),g.Bc(7,cc,9,17,"ng-container",11),g.Nb()),2&e){const e=g.Zb(2);g.xb(3),g.Fc(" ",e.i18n.user.title.addresses," "),g.xb(2),g.gc("ngIf",e.canCreateAddress),g.xb(1),g.gc("ngIf",0==e.data.addresses.length),g.xb(1),g.gc("ngForOf",e.addresses)}}function bc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addContactInfo()})),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.contactInfoAdd)}}function uc(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.user.contactInfoNone," ")}}function dc(e,t){if(1&e&&g.Lb(0,"input-field",116),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("id","contact-info_landLineExtension"+e.idSuffix)("label",t.i18n.phone.extension)}}function gc(e,t){if(1&e&&g.Lb(0,"field-option",118),2&e){const e=g.Zb().$implicit;g.gc("value",e.id)("text",e.name)}}function fc(e,t){if(1&e&&(g.Ob(0),g.Bc(1,gc,1,2,"field-option",117),g.Nb()),2&e){const e=t.$implicit;g.xb(1),g.gc("ngIf",e.id)}}function mc(e,t){if(1&e&&(g.Ob(0,6),g.Lb(1,"custom-field-input",119),g.Nb()),2&e){const e=t.$implicit,i=g.Zb().$implicit,n=g.Zb(3);g.gc("formGroup",i.form.get("customValues")),g.xb(1),g.gc("field",e)("formControlName",e.internalName)("binaryValues",n.data.contactInfoBinaryValues[i.id])}}function pc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removeContactInfo(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.contactInfoRemove)}}function hc(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Qb(1,"div",94),g.Lb(2,"field-privacy",95),g.Bc(3,pc,1,1,"action-button",25),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.field.privacy.name),g.xb(2),g.gc("control",e.form.get("hidden")),g.xb(1),g.gc("ngIf",g.bc(4,3,t.layout.gtxxs$))}}function vc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",36),g.Qb(1,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).removeContactInfo(t)})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.gc("label",e.i18n.user.contactInfoRemove)}}function xc(e,t){1&e&&g.Lb(0,"hr")}function yc(e,t){if(1&e&&(g.Ob(0,6),g.Lb(1,"images-field",108),g.Lb(2,"input-field",109),g.Lb(3,"input-field",110),g.Lb(4,"input-field",111),g.Lb(5,"input-field",112),g.Bc(6,dc,1,2,"input-field",113),g.Qb(7,"single-selection-field",114),g.Bc(8,fc,2,1,"ng-container",115),g.Pb(),g.Bc(9,mc,2,4,"ng-container",11),g.Bc(10,hc,5,5,"label-value",71),g.Bc(11,vc,2,1,"div",30),g.ac(12,"async"),g.Bc(13,xc,1,0,"hr",4),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3);g.gc("formGroup",e.form),g.xb(1),g.gc("label",n.i18n.general.image)("initialImages",null==n.data.contactInfoBinaryValues[e.id]?null:n.data.contactInfoBinaryValues[e.id].image),g.xb(1),g.gc("id","contact-info_name"+e.idSuffix)("label",n.i18n.general.name),g.xb(1),g.gc("id","contact-info_email"+e.idSuffix)("label",n.i18n.user.email),g.xb(1),g.gc("id","contact-info_mobilePhone"+e.idSuffix)("label",n.i18n.phone.mobile),g.xb(1),g.gc("id","contact-info_landLinePhone"+e.idSuffix)("label",n.i18n.phone.landLine),g.xb(1),g.gc("ngIf",n.data.phoneConfiguration.extensionEnabled),g.xb(1),g.gc("id","contact-info_address"+e.idSuffix)("label",n.i18n.address.address),g.xb(1),g.gc("ngForOf",n.data.addresses),g.xb(1),g.gc("ngForOf",n.data.contactInfoConfiguration.customFields),g.xb(1),g.gc("ngIf",n.canManagePrivacy("contactInfo")),g.xb(1),g.gc("ngIf",g.bc(12,19,n.layout.xxs$)||!n.data.contactInfoConfiguration.managePrivacy),g.xb(2),g.gc("ngIf",!i)}}function Pc(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",77),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Qb(4,"div",86),g.Bc(5,bc,1,1,"action-button",25),g.Pb(),g.Pb(),g.Bc(6,uc,2,1,"div",4),g.Bc(7,yc,14,21,"ng-container",11),g.Nb()),2&e){const e=g.Zb(2);g.xb(3),g.Fc(" ",e.i18n.user.title.contactInfos," "),g.xb(2),g.gc("ngIf",e.canCreateContactInfo),g.xb(1),g.gc("ngIf",0==e.contactInfos.length),g.xb(1),g.gc("ngForOf",e.contactInfos)}}function Ic(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Bc(2,zo,3,2,"ng-container",4),g.Qb(3,"h2",5),g.Dc(4),g.Pb(),g.Ob(5,6),g.Bc(6,Xo,2,2,"label-value",7),g.Bc(7,Jo,1,2,"input-field",8),g.Bc(8,Yo,1,2,"input-field",9),g.Bc(9,er,3,4,"label-value",10),g.Bc(10,tr,2,2,"label-value",7),g.Nb(),g.Bc(11,or,2,2,"ng-container",11),g.Bc(12,pr,8,8,"ng-container",12),g.Bc(13,Ir,7,7,"ng-container",12),g.Bc(14,Qr,5,3,"ng-container",4),g.Bc(15,Xr,9,6,"ng-container",4),g.Bc(16,lc,8,4,"ng-container",4),g.Bc(17,Pc,8,4,"ng-container",4),g.Qb(18,"actions"),g.Qb(19,"action-button",13),g.Xb("action",(function(){return g.sc(e),g.Zb().saveOrConfirm()})),g.ac(20,"async"),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.editProfile)("mobileHeading",e.i18n.user.mobileTitle.editProfile)("headingActions",g.bc(1,21,e.headingActions$)),g.xb(2),g.gc("ngIf","disabled"!==e.imagesAvailability),g.xb(1),g.gc("ngClass","disabled"===e.imagesAvailability?"border-0 mt-2 mt-md-0":null),g.xb(1),g.Fc(" ",e.i18n.user.title.fields," "),g.xb(1),g.gc("formGroup",e.user),g.xb(1),g.gc("ngIf",e.operatorOfManagedUser),g.xb(1),g.gc("ngIf",e.hasField("name")),g.xb(1),g.gc("ngIf",e.hasField("username")),g.xb(1),g.gc("ngIf",e.hasField("email")),g.xb(1),g.gc("ngIf",e.hasField("email")&&e.data.userConfiguration.emailPendingValidation),g.xb(1),g.gc("ngForOf",null==e.data.userConfiguration?null:e.data.userConfiguration.customFields),g.xb(1),g.gc("ngIf",e.singleMobile),g.xb(1),g.gc("ngIf",e.singleLandLine),g.xb(1),g.gc("ngIf",e.singleAddress),g.xb(1),g.gc("ngIf","multiple"===e.landLineAvailability||"multiple"===e.mobileAvailability),g.xb(1),g.gc("ngIf","multiple"===e.addressAvailability),g.xb(1),g.gc("ngIf","disabled"!==e.contactInfoAvailability),g.xb(2),g.gc("disabled",g.bc(20,23,e.requesting$))("label",e.i18n.general.save)}}function Ec(e,t){1&e&&g.Lb(0,"spinner")}const Ac=["name","username","email"];let Cc=0,Dc=(()=>{class e extends l.a{constructor(e,t,i,n,a,s,o,r){super(e),this.usersService=t,this.imagesService=i,this.phonesService=n,this.maps=a,this.addressHelper=s,this.modal=o,this.changeDetector=r,this.ConfirmationMode=Eo.a,this.ready$=new Ct.a(!1),this.confirmationMode$=new Ct.a(null),this.createLandLinePhones=[],this.modifyLandLinePhones=[],this.createMobilePhones=[],this.modifyMobilePhones=[],this.createAddresses=[],this.modifyAddresses=[],this.createContactInfos=[],this.modifyContactInfos=[]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||c.a.SELF,this.createDeviceConfirmation=()=>({type:Me.s.EDIT_PROFILE}),this.headingActions=[new be.c("search",this.i18n.general.view,()=>this.router.navigate(["users",this.param,"profile"]),!0)],this.addSub(this.usersService.getDataForEditFullProfile({user:this.param}).subscribe(e=>{this.data=e;const t=e.userConfiguration.role,i=e.userConfiguration.details,n=this.authHelper.isSelf(i);this.byManager=!this.authHelper.isSelfOrOwner(i),this.operatorOfManagedUser="operator"===t&&!this.authHelper.isSelf(i.user),n&&this.login.user$.next({id:this.login.user.id,display:e.userConfiguration.details.display,image:Object(b.h)(e.images)?null:e.images[0]}),this.initialize(e),this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||(this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.router.navigate(["users","profile"])),this.ready$.next(!0)}))}locateControl(e){return Object(b.t)(this,e)}hasField(e){return this.enabledFields.has(e)}isRequired(e){if(!this.canEdit(e))return!1;if("name"===e||"username"===e)return!0;if("email"===e)return this.data.userConfiguration.emailRequired;{const t=this.userCustomFields.get(e);return t&&t.required}}fieldName(e){return"string"==typeof e?e:e.internalName}isEmpty(e){const t=this.fieldName(e);if("string"==typeof e)return Object(b.h)(this.user.get(t).value);{const e=this.user.get("customValues");return!e||Object(b.h)(e.get(t).value)}}canEdit(e){return this.editableFields.has(this.fieldName(e))}canManagePrivacy(e){if(!this.data.userConfiguration.enablePrivacy)return!1;switch(e){case"phone":return this.data.phoneConfiguration.managePrivacy;case"address":return this.data.addressConfiguration.managePrivacy;case"contactInfo":return this.data.contactInfoConfiguration.managePrivacy;default:return this.managePrivacyFields.has(this.fieldName(e))}}get landLineAvailability(){return this.getAvailability((this.data.phoneConfiguration||{}).maxLandLines)}get mobileAvailability(){return this.getAvailability((this.data.phoneConfiguration||{}).maxMobiles)}get addressAvailability(){return this.getAvailability((this.data.addressConfiguration||{}).maxAddresses)}get contactInfoAvailability(){return this.getAvailability((this.data.contactInfoConfiguration||{}).maxContactInfos)}get imagesAvailability(){return this.getAvailability((this.data.imageConfiguration||{}).maxImages)}getAvailability(e){return null==e||e<=0?"disabled":1===e?"single":"multiple"}saveOrConfirm(){this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.user.title.confirmation,passwordInput:this.data.confirmationPasswordInput,createDeviceConfirmation:this.createDeviceConfirmation,callback:e=>{this.save(e.confirmationPassword)}}):this.save()}save(e){const t=new h.m({user:this.user,createLandLinePhones:new h.g(this.createLandLinePhones),modifyLandLinePhones:new h.g(this.modifyLandLinePhones),createMobilePhones:new h.g(this.createMobilePhones),modifyMobilePhones:new h.g(this.modifyMobilePhones),createAddresses:new h.g(this.createAddresses),modifyAddresses:new h.g(this.modifyAddresses),createContactInfos:new h.g(this.createContactInfos),modifyContactInfos:new h.g(this.modifyContactInfos)});!e&&this.confirmationPassword&&(t.setControl("confirmationPassword",this.confirmationPassword),e=this.confirmationPassword.value),Object(b.F)(t)&&this.addSub(this.usersService.saveUserFullProfile({user:this.param,confirmationPassword:e,body:this.editForSubmit()}).subscribe(()=>{this.notification.snackBar(this.i18n.user.profileSaved),this.reload(),Object(b.y)()}))}editForSubmit(){const e={user:Object(b.s)(this.user)?this.user.value:null,createLandLinePhones:this.createLandLinePhones.map(e=>e.value),modifyLandLinePhones:this.modifyLandLinePhones.map(e=>e.value),createMobilePhones:this.createMobilePhones.map(e=>e.value),modifyMobilePhones:this.modifyMobilePhones.map(e=>e.value),removePhones:this.removedPhones,createAddresses:this.createAddresses.map(e=>e.value),modifyAddresses:this.modifyAddresses.map(e=>e.value),removeAddresses:this.removedAddresses,createContactInfos:this.createContactInfos.map(e=>e.value),modifyContactInfos:this.modifyContactInfos.map(e=>e.value),removeContactInfos:this.removedContactInfos};if("single"===this.mobileAvailability){const t=this.singleMobile.value,i=t.id;i?Object(b.h)(t.number)?e.removePhones.push(i):Object(b.s)(this.singleMobile)&&(e.modifyMobilePhones=[t]):Object(b.h)(t.number)||(e.createMobilePhones=[t])}if("single"===this.landLineAvailability){const t=this.singleLandLine.value,i=t.id;i?Object(b.h)(t.number)?e.removePhones.push(i):Object(b.s)(this.singleLandLine)&&(e.modifyLandLinePhones=[t]):Object(b.h)(t.number)||(e.createLandLinePhones=[t])}if("single"===this.addressAvailability){const t=this.singleAddress.value,i=t.id,n=this.defineSingleAddress.value;i?n?Object(b.s)(this.singleAddress)&&(e.modifyAddresses=[t]):e.removeAddresses.push(i):n&&(e.createAddresses=[t])}return e}initialize(e){this.userCustomFields=new Map,this.enabledFields=new Set,this.editableFields=new Set,this.managePrivacyFields=new Set,this.removedPhones=[],this.removedAddresses=[],this.removedContactInfos=[],e.contactInfoConfiguration&&e.contactInfoConfiguration.availability!==Me.i.DISABLED&&(e.addressConfiguration.contactInfoEnabled=!0,e.addressConfiguration.contactInfoFields=e.contactInfoConfiguration.customFields);const t=e.userConfiguration.profileFieldActions;for(const i in t){if(!t.hasOwnProperty(i))continue;this.enabledFields.add(i);const e=t[i];e.edit&&this.editableFields.add(i),e.managePrivacy&&this.managePrivacyFields.add(i);const n=this.data.userConfiguration.customFields.find(e=>e.internalName===i);n&&this.userCustomFields.set(i,n)}this.user=this.buildUserForm(),e.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("",h.G.required)),this.images=this.data.images.slice(),this.phones=[],"single"===this.mobileAvailability?(this.singleMobileManage=Object(b.h)(e.mobilePhones)?e.phoneConfiguration.mobilePhone:e.mobilePhones[0],this.singleMobile=this.buildMobileForm(this.singleMobileManage)):(e.mobilePhones||[]).forEach(e=>{const t=this.buildMobileForm(e);"multiple"===this.mobileAvailability&&(this.phones.push(e),this.addSub(t.valueChanges.subscribe(()=>{this.modifyMobilePhones.includes(t)||this.modifyMobilePhones.push(t)})))}),"single"===this.landLineAvailability?(this.singleLandLineManage=Object(b.h)(e.landLinePhones)?e.phoneConfiguration.landLinePhone:e.landLinePhones[0],this.singleLandLine=this.buildLandLineForm(this.singleLandLineManage)):(e.landLinePhones||[]).forEach(e=>{const t=this.buildLandLineForm(e);"multiple"===this.landLineAvailability&&(this.phones.push(e),this.addSub(t.valueChanges.subscribe(()=>{this.modifyLandLinePhones.includes(t)||this.modifyLandLinePhones.push(t)})))}),"single"===this.addressAvailability?(this.defineSingleAddress=this.formBuilder.control(!Object(b.h)(e.addresses)||"required"===e.addressConfiguration.availability),this.singleAddressManage=Object(b.h)(e.addresses)?e.addressConfiguration.address:e.addresses[0],this.singleAddress=this.buildAddressForm(this.singleAddressManage)):((e.addresses||[]).forEach(e=>{const t=this.buildAddressForm(e);"multiple"===this.addressAvailability&&this.addSub(t.valueChanges.subscribe(()=>{this.modifyAddresses.includes(t)||this.modifyAddresses.push(t)}))}),this.addresses=(e.addresses||[]).slice()),(e.contactInfos||[]).forEach(e=>{const t=this.buildContactInfoForm(e);this.addSub(t.valueChanges.subscribe(()=>{this.modifyContactInfos.includes(t)||this.modifyContactInfos.push(t)}))}),this.contactInfos=(e.contactInfos||[]).slice()}buildUserForm(){const e=this.data.userConfiguration,t=this.data.user,i=this.formBuilder.group({version:t.version,hiddenFields:[t.hiddenFields||[]]});for(const n of Ac)this.hasField(n)?i.setControl(n,this.formBuilder.control({value:t[n],disabled:!this.canEdit(n)},this.isRequired(n)?h.G.required:null)):i.removeControl(n);return i.setControl("customValues",this.fieldHelper.customValuesFormGroup(e.customFields,{currentValues:t.customValues,disabledProvider:e=>!this.canEdit(e.internalName)})),i}stampDataAndInitForm(e,t){e.idSuffix="_"+(e.id||Cc++),e.form=t,t.locating$=new Ct.a(!1),t.patchValue(e)}buildLandLineForm(e){e.kind=Me.Z.LAND_LINE;const t=this.data.phoneConfiguration,i=this.buildPhoneForm(1===t.maxLandLines,t.landLineAvailability===Me.i.REQUIRED);if(t.extensionEnabled){const e=this.formBuilder.control(null);this.editableFields.has("phone")||e.disable(),i.setControl("extension",e)}return this.stampDataAndInitForm(e,i),i}buildMobileForm(e){e.kind=Me.Z.MOBILE;const t=this.data.phoneConfiguration,i=this.buildPhoneForm(1===t.maxMobiles,t.mobileAvailability===Me.i.REQUIRED);return t.smsEnabled&&(i.setControl("verified",this.formBuilder.control(e.verified)),i.setControl("enabledForSms",this.formBuilder.control(e.enabledForSms))),this.stampDataAndInitForm(e,i),i}buildPhoneForm(e,t){const i=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,h.G.required],number:[null,!e||t?h.G.required:null]});return this.editableFields.has("phone")||i.disable(),i}buildAddressForm(e){const t=this.data.addressConfiguration,i=this.addressHelper.addressFormGroup(t);this.stampDataAndInitForm(e,i);for(const n of t.enabledFields){let t=e[n]||null;this.addSub(i.get(n).valueChanges.subscribe(e=>{t!==e&&i.get("location").patchValue({latitude:null,longitude:null}),t=e}))}return this.editableFields.has("address")||i.disable(),i}buildContactInfoForm(e){const t=this.data.contactInfoConfiguration,i=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,h.G.required],image:null,email:null,mobilePhone:null,landLinePhone:null,landLineExtension:null,address:null});return i.setControl("customValues",this.fieldHelper.customValuesFormGroup(t.customFields)),this.stampDataAndInitForm(e,i),i}phoneNameLabel(e){return e.kind===Me.Z.LAND_LINE?this.i18n.phone.nameLandLine:this.i18n.phone.nameMobile}phoneExample(e){return e.kind===Me.Z.LAND_LINE?this.data.phoneConfiguration.landLineExample:this.data.phoneConfiguration.mobileExample}phoneNumberLabel(e){return e.kind===Me.Z.LAND_LINE?this.i18n.phone.numberLandLine:this.i18n.phone.numberMobile}phoneHasSms(e){return!!this.data.phoneConfiguration.smsEnabled&&e.id&&e.kind===Me.Z.MOBILE&&e.number===e.form.value.number}hasExtension(e){return this.data.phoneConfiguration.extensionEnabled&&e.kind===Me.Z.LAND_LINE}get canCreateLandLine(){if("multiple"!==this.landLineAvailability||!this.editableFields.has("phone"))return!1;const e=this.data.phoneConfiguration.maxLandLines;return this.phones.filter(e=>e.kind===Me.Z.LAND_LINE).length<e}get canCreateMobile(){if("multiple"!==this.mobileAvailability||!this.editableFields.has("phone"))return!1;const e=this.data.phoneConfiguration.maxMobiles;return this.phones.filter(e=>e.kind===Me.Z.MOBILE).length<e}get canCreateAddress(){return!("multiple"!==this.addressAvailability||!this.editableFields.has("address"))&&this.addresses.length<this.data.addressConfiguration.maxAddresses}get canCreateContactInfo(){return"multiple"===this.contactInfoAvailability&&this.contactInfos.length<this.data.contactInfoConfiguration.maxContactInfos}get canUploadImages(){return this.images.length<this.data.imageConfiguration.maxImages}addMobile(){const e=Object(d.a)(this.data.phoneConfiguration.mobilePhone);e.name="",this.createMobilePhones.push(this.buildMobileForm(e)),this.phones=[e,...this.phones],this.setFocus("phone_name",e)}addLandLine(){const e=Object(d.a)(this.data.phoneConfiguration.landLinePhone);e.name="",this.createLandLinePhones.push(this.buildLandLineForm(e)),this.phones=[e,...this.phones],this.setFocus("phone_name",e)}addAddress(){const e=Object(d.a)(this.data.addressConfiguration.address);e.name="",this.createAddresses.push(this.buildAddressForm(e)),this.addresses=[e,...this.addresses],this.setFocus("address_name",e)}addContactInfo(){const e=Object(d.a)(this.data.contactInfoConfiguration.contactInfo);this.createContactInfos.push(this.buildContactInfoForm(e)),this.contactInfos=[e,...this.contactInfos],this.setFocus("contact-info_name",e)}removePhone(e){this.phones=this.phones.filter(t=>t!==e);const t=e.id;if(t)this.removedPhones.push(t);else{const t=e.form;this.createMobilePhones=this.createMobilePhones.filter(e=>e!==t),this.createLandLinePhones=this.createLandLinePhones.filter(e=>e!==t)}}removeAddress(e){this.addresses=this.addresses.filter(t=>t!==e);const t=e.id;if(t)this.removedAddresses.push(t);else{const t=e.form;this.createAddresses=this.createAddresses.filter(e=>e!==t)}}removeContactInfo(e){this.contactInfos=this.contactInfos.filter(t=>t!==e);const t=e.id;if(t)this.removedContactInfos.push(t);else{const t=e.form;this.createContactInfos=this.createContactInfos.filter(e=>e!==t)}}setFocus(e,t){const i=e+t.idSuffix;setTimeout(()=>document.getElementById(i).focus(),10)}showEnableForSms(e){return!!this.data.phoneConfiguration.smsEnabled&&(!this.byManager||e.value.verified)}maybeVerify(e,t){if(this.byManager)return;let i;if(i=this.singleMobile?this.singleMobileManage:this.phones.find(e=>e.id===t),null==i)throw new Error("Mobile phone not found: "+t);i.verified||(this.verify(i),e.preventDefault(),e.stopPropagation())}verify(e){const t=this.modal.show(So,{class:"modal-form",initialState:{phone:e}});this.addSub(t.content.verified.pipe(Object(Qo.a)(1)).subscribe(i=>{i&&this.phonesService.getPhoneDataForEdit({id:e.id,fields:["phone"]}).subscribe(i=>{const n=i.phone;n.id=e.id,n.enabledForSms=!0;const a=this.buildMobileForm(n);a.markAsTouched();const s=(this.phones||[]).findIndex(t=>t.id===e.id);if(s>=0){const t=this.phones.slice();t[s]=n,this.phones=t;const i=this.modifyMobilePhones.findIndex(t=>t.value.id===e.id),o=this.modifyMobilePhones.slice();i>=0?o[i]=a:o.push(a),this.modifyMobilePhones=o}this.singleMobile&&(this.singleMobile=a),t.hide(),this.changeDetector.detectChanges()})}))}onUploadDone(e){this.images=[...this.images,...e],this.changeDetector.detectChanges()}manageImages(){const e=this.modal.show(Ao.a,{class:"modal-form",initialState:{images:this.images}});e.content.result.pipe(Object(No.a)()).subscribe(t=>{if(!Object(b.h)(t.removedImages)){for(const e of t.removedImages)this.addSub(this.imagesService.deleteImage({idOrKey:e}).subscribe());this.images=this.images.filter(e=>!t.removedImages.includes(e.id))}!Object(b.h)(t.order)&&(this.images=t.order.map(e=>this.images.find(t=>t.id===e)),this.addSub(this.imagesService.reorderProfileImages({ids:t.order,user:this.param}).subscribe())),e.hide()})}removeAllImages(){for(const e of this.images||[])this.addSub(this.imagesService.deleteImage({idOrKey:e.id}).subscribe());this.images=[],this.changeDetector.detectChanges()}fieldSize(e){return this.fieldHelper.fieldSize(e)}locateAddress(e){const t=e.value;e.locating$.next(!0),this.addSub(this.maps.geocode(t).subscribe(t=>{e.patchValue({location:t}),this.changeDetector.detectChanges()},()=>this.mapShown(e)))}mapShown(e){e.locating$.next(!1),this.changeDetector.detectChanges()}resolveMenu(e){return this.menu.userMenu(e.userConfiguration.details,u.b.EDIT_MY_PROFILE)}fieldValue(e){const t=this.user.get("customValues").get(e.internalName).value;return this.fieldHelper.asFieldValue(e,t,this.data.userConfiguration.binaryValues)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Io.a),g.Kb(yo.a),g.Kb(Po.a),g.Kb(Do.a),g.Kb(Co.a),g.Kb(M.b),g.Kb(g.h))},e.\u0275cmp=g.Eb({type:e,selectors:[["edit-profile"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","headingActions",4,"ngIf"],["locatingSpinner",""],["last","",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"mt-4","mb-2",3,"ngClass"],[3,"formGroup"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","name",3,"label","required",4,"ngIf"],["formControlName","username",3,"label","required",4,"ngIf"],[3,"label","kind","ignoreExtraCell",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[1,"btn-main",3,"disabled","label","action"],[1,"mb-3","border-0","mt-2","mt-md-0"],[1,"d-flex","justify-content-center","justify-content-sm-start"],["size","huge","useLightbox","",3,"image","roundBorders",4,"ngIf"],["class","my-3",4,"ngIf"],["containerClass","mt-3","target","profile",3,"owner","uploadDone"],["singleUpload",""],["class","mt-3","forceRow","",4,"ngIf"],["size","huge","useLightbox","",3,"image","roundBorders"],[1,"my-3"],["forceRow","",1,"mt-3"],["outline","",3,"label","action"],["outline","",3,"label","action",4,"ngIf"],[1,"border-0","d-flex","mb-3","flex-column","flex-xs-row","justify-content-between","mt-2","mt-md-0"],[1,"mb-2","mb-xs-0"],[1,"row","no-gutters"],["class","col-12 col-xs-6 col-sm-4 col-md-3 d-flex justify-content-center justify-content-center",4,"ngFor","ngForOf"],["class","d-flex justify-content-end",4,"ngIf"],["target","profile",3,"owner","max","uploadDone"],["multiUpload",""],[1,"col-12","col-xs-6","col-sm-4","col-md-3","d-flex","justify-content-center","justify-content-center"],["size","huge","useLightbox","",1,"mb-1","mb-xs-3",3,"image","roundBorders","additionalImages"],[1,"col-12"],[1,"d-flex","justify-content-end"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","name",3,"label","required"],["formControlName","username",3,"label","required"],[3,"label","kind","ignoreExtraCell"],["formControlName","email",3,"required"],["field","email",3,"control",4,"extraCell"],["field","email",3,"control"],[3,"label","kind","labelPosition","ignoreExtraCell","fieldSize","required",4,"ngIf"],[3,"label","kind","labelPosition","ignoreExtraCell","fieldSize","required"],["hideLabel","",3,"field","formControlName","binaryValues",4,"ngIf","ngIfElse"],["plainFieldValue",""],[3,"field","control",4,"extraCell"],["hideLabel","",3,"field","formControlName","binaryValues"],[3,"fieldValue"],[3,"field","control"],["kind","field","fieldSize","small",3,"label","required","ignoreExtraCell"],["formControlName","number",3,"placeholder",4,"ngIf","ngIfElse"],["plainPhoneNumber",""],[3,"control",4,"extraCell"],["formControlName","number",3,"placeholder"],[3,"control"],[3,"label","formControl",4,"ngIf","ngIfElse"],["plainVerified",""],[3,"label","formControl"],[3,"label","formControl","click",4,"ngIf","ngIfElse"],["plainSms",""],[3,"label","formControl","click"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],[1,"mb-2"],[3,"formControl","label",4,"ngIf"],[3,"formControl","label"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy","binaryValues"],["kind","field",3,"label",4,"ngIf"],["kind","field",3,"label"],[3,"address","imageLoaded",4,"ngIf","ngIfElse"],["viewMap",""],[3,"address","imageLoaded"],["outline","",3,"label","action",4,"ngIf","ngIfElse"],[1,"mt-4","mb-2","d-flex","flex-column","flex-xs-row","justify-content-between"],["class","section-title-action","dropdown","",4,"ngIf"],["class","section-title-action",4,"ngIf"],["dropdown","",1,"section-title-action"],["dropdownToggle","","type","button","type","button","aria-controls","newPhoneDropDown",1,"btn","btn-outline-primary","dropdown-toggle"],["class","dropdown-menu dropdown-menu-right","role","listbox","id","newPhoneDropDown",4,"dropdownMenu"],["role","listbox","id","newPhoneDropDown",1,"dropdown-menu","dropdown-menu-right"],["dropDownMenu",""],[1,"dropdown-item",3,"click"],[1,"section-title-action"],["formControlName","name","required","",3,"id","label"],["type","tel","formControlName","number","required","",3,"id","label","placeholder"],["class","d-flex justify-content-end",3,"ngClass",4,"ngIf"],["formControlName","verified",3,"label",4,"ngIf","ngIfElse"],["formControlName","verified",3,"label"],["formControlName","enabledForSms",3,"label","click",4,"ngIf","ngIfElse"],["formControlName","enabledForSms",3,"label","click"],[1,"d-flex","w-100","justify-content-between"],["justifyStart","",3,"control"],[1,"d-flex","justify-content-end",3,"ngClass"],["idPrefix","address_",3,"addressForm","ignoreContactFields","configuration","idSuffix","managePrivacy","binaryValues"],["kind","field","class","pb-0",3,"label",4,"ngIf"],["class","row mt-3 no-gutters",4,"ngIf"],["kind","field",1,"pb-0",3,"label"],[4,"ngIf","ngIfThen"],[1,"row","mt-3","no-gutters"],["class","col-4",4,"ngIf"],[1,"col-12","col-sm-8"],["forceRow","",1,"mt-0"],[1,"col-4"],[1,"flex-grow-1"],["formControlName","image","target","contactInfo","separator","@","avatarSize","xlarge",3,"label","initialImages"],["formControlName","name",3,"id","label"],["formControlName","email",3,"id","label"],["formControlName","mobilePhone",3,"id","label"],["formControlName","landLinePhone",3,"id","label"],["formControlName","landLineExtension",3,"id","label",4,"ngIf"],["formControlName","address",3,"id","label"],[4,"ngFor","ngForOf"],["formControlName","landLineExtension",3,"id","label"],[3,"value","text",4,"ngIf"],[3,"value","text"],[3,"field","formControlName","binaryValues"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ic,21,25,"page-content",1),g.Pb(),g.Bc(3,Ec,1,0,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,p.q,h.w,h.n,p.s,x.a,y.a,Fo.a,we.a,Q.a,Dt.a,Ot.a,h.v,h.l,h.D,Lo.a,Bo.a,Gt.a,is.a,v.a,h.k,wo.a,Ro.a,ko.a,ko.d,ko.b,To.a,Fe.a,Le.a,Zo.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Oc=i("qEt1"),Sc=i("cvAk");function Qc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"actions",4),g.Qb(1,"action-button",5),g.Xb("action",(function(){return g.sc(e),g.Zb(2).goToLogin()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.menu.login)}}function Nc(e,t){if(1&e&&(g.Qb(0,"page-content"),g.Qb(1,"notification",2),g.Dc(2),g.Pb(),g.Bc(3,Qc,2,1,"actions",3),g.ac(4,"async"),g.Pb()),2&e){const e=g.Zb();g.xb(1),g.gc("allowClose",!1),g.xb(1),g.Fc(" ",e.i18n.user.newEmailConfirmed," "),g.xb(1),g.gc("ngIf",null==g.bc(4,3,e.login.user$))}}let Fc=(()=>{class e extends l.a{constructor(e,t){super(e),this.validationService=t}get userId(){return this.data}ngOnInit(){this.addSub(this.validationService.validateEmailChange(this.route.snapshot.params.key).subscribe(()=>{this.login.user?(this.login.logout(),this.notification.info(this.i18n.user.newEmailConfirmed)):this.data=""}))}goToLogin(){this.login.goToLoginPage("")}resolveMenu(){return this.menu.homeMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Oc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["validate-email-change"]],features:[g.ub],decls:3,vars:4,consts:[["size","medium","hideMenu","",3,"ready"],[4,"ngIf"],[3,"allowClose"],["ngClass","mt-3","forceRow","",4,"ngIf"],["ngClass","mt-3","forceRow",""],[3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Nc,5,5,"page-content",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,Sc.a,x.a,p.q,y.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Lc=i("/QoZ"),Bc=i("nUN0"),wc=i("ZvpF"),Rc=i("naJM"),kc=i("wR2l"),Tc=i("vOpc");function Zc(e,t){1&e&&g.Lb(0,"div",6)}function _c(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",6),g.Qb(2,"label-value",13),g.Lb(3,"user-link",14),g.Pb(),g.Pb(),g.Bc(4,Zc,1,0,"div",15),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("ngIf",e.layout.gtsm$)}}function Mc(e,t){1&e&&g.Mb(0)}function $c(e,t){1&e&&g.Mb(0)}const Uc=function(e,t){return{count:e,total:t}};function Hc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr"),g.Qb(1,"td"),g.Lb(2,"rating-stats",22),g.Pb(),g.Qb(3,"td",21),g.Xb("click",(function(){g.sc(e);const i=t.$implicit;return g.Zb(3).filter(i.level,!0)})),g.Bc(4,Mc,1,0,"ng-container",23),g.Pb(),g.Qb(5,"td",21),g.Xb("click",(function(){g.sc(e);const i=t.$implicit;return g.Zb(3).filter(i.level)})),g.Bc(6,$c,1,0,"ng-container",23),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3),n=g.qc(4);g.xb(2),g.gc("level",e.level)("textLeft",e.text),g.xb(2),g.gc("ngTemplateOutlet",n)("ngTemplateOutletContext",g.kc(6,Uc,null==i.allTime?null:i.allTime.counts[e.level],null==i.allTime?null:i.allTime.total)),g.xb(2),g.gc("ngTemplateOutlet",n)("ngTemplateOutletContext",g.kc(9,Uc,null==i.last30Days?null:i.last30Days.counts[e.level],null==i.last30Days?null:i.last30Days.total))}}function Gc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",16),g.Qb(1,"table",17),g.Qb(2,"thead"),g.Qb(3,"th",18),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,Hc,7,12,"tr",19),g.Qb(11,"tr"),g.Qb(12,"td",20),g.Dc(13),g.Pb(),g.Qb(14,"td",21),g.Xb("click",(function(){return g.sc(e),g.Zb(2).filter(null,!0)})),g.Dc(15),g.Pb(),g.Qb(16,"td",21),g.Xb("click",(function(){return g.sc(e),g.Zb(2).filter()})),g.Dc(17),g.Pb(),g.Pb(),g.Qb(18,"tr"),g.Qb(19,"td",20),g.Dc(20),g.Pb(),g.Qb(21,"td"),g.Dc(22),g.ac(23,"percent"),g.Pb(),g.Qb(24,"td"),g.Dc(25),g.ac(26,"percent"),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(4),g.Ec(e.i18n.reference.value),g.xb(2),g.Ec(e.i18n.reference.allTime),g.xb(2),g.Ec(e.i18n.reference.last30Days),g.xb(2),g.gc("ngForOf",e.levels),g.xb(3),g.Ec(e.i18n.reference.total),g.xb(2),g.Fc(" ",null==e.allTime?null:e.allTime.total," "),g.xb(2),g.Fc(" ",null==e.last30Days?null:e.last30Days.total,""),g.xb(3),g.Fc(" ",e.i18n.reference.percentagePositive,""),g.xb(2),g.Fc(" ",g.bc(23,10,(null==e.allTime?null:e.allTime.totalPositive)/(null==e.allTime?null:e.allTime.total)||0)," "),g.xb(3),g.Fc(" ",g.bc(26,12,(null==e.last30Days?null:e.last30Days.totalPositive)/(null==e.last30Days?null:e.last30Days.total)||0)," ")}}function qc(e,t){if(1&e&&(g.Qb(0,"mobile-result",24),g.Qb(1,"div",25),g.Qb(2,"div"),g.Qb(3,"div",26),g.Dc(4),g.Pb(),g.Qb(5,"div",27),g.Dc(6),g.ac(7,"dateTime"),g.Pb(),g.Qb(8,"div",28),g.Lb(9,"rating-stats",29),g.Pb(),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit;g.gc("avatarImage",e.relatedUser.image),g.xb(4),g.Fc(" ",e.relatedUser.display," "),g.xb(2),g.Fc(" ",g.bc(7,4,e.date)," "),g.xb(3),g.gc("level",e.level)}}function Kc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",35),g.Xb("click",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).remove(t)})),g.Lb(1,"icon",36),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.remove)}}function Vc(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"tr",32),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(3);return n.router.navigate(n.path(i))})),g.Qb(2,"td"),g.Dc(3),g.ac(4,"dateTime"),g.Pb(),g.Qb(5,"td"),g.Dc(6),g.Pb(),g.Qb(7,"td"),g.Lb(8,"rating-stats",29),g.Pb(),g.Qb(9,"td",33),g.Bc(10,Kc,2,1,"button",34),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(3),g.Ec(g.bc(4,4,e.date)),g.xb(3),g.Ec(e.relatedUser.shortDisplay),g.xb(2),g.gc("level",e.level),g.xb(2),g.gc("ngIf",i.data.manage)}}function jc(e,t){if(1&e&&(g.Qb(0,"table",30),g.Qb(1,"thead"),g.Qb(2,"th",18),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Lb(8,"th",31),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,Vc,11,6,"ng-container",19),g.ac(11,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.name),g.xb(2),g.Ec(e.i18n.reference.level.level),g.xb(3),g.gc("ngForOf",null==(i=g.bc(11,4,e.results$))?null:i.results)}}function zc(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",3),g.ac(2,"async"),g.Qb(3,"form",4),g.Qb(4,"div",5),g.Bc(5,_c,5,3,"ng-container",1),g.Qb(6,"div",6),g.Qb(7,"radio-group-field",7),g.Lb(8,"field-option",8),g.Lb(9,"field-option",8),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Bc(10,Gc,27,14,"page-content",9),g.ac(11,"async"),g.ac(12,"async"),g.Qb(13,"results-layout",10),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(14,"async"),g.Bc(15,qc,10,6,"mobile-result",11),g.Bc(16,jc,12,6,"table",12),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.reference.title.search)("mobileHeading",e.i18n.reference.mobileTitle.search)("headingActions",g.bc(2,14,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",e.data.user&&!e.isOwner),g.xb(2),g.gc("label",e.i18n.reference.direction.direction),g.xb(1),g.gc("value",e.ReferenceDirectionEnum.GIVEN)("text",e.i18n.reference.direction.given),g.xb(1),g.gc("value",e.ReferenceDirectionEnum.RECEIVED)("text",e.i18n.reference.direction.received),g.xb(1),g.gc("ngIf",g.bc(11,16,e.layout.gtsm$)&&g.bc(12,18,e.stats$)),g.xb(3),g.gc("results",g.bc(14,20,e.results$))("rendering$",e.rendering$)("toLink",e.toLink)}}const Xc=function(e){return{width:e}};function Jc(e,t){if(1&e&&(g.Qb(0,"div",40),g.Dc(1," \xa0"),g.Pb()),2&e){const e=g.Zb();g.gc("ngStyle",g.jc(1,Xc,e.count/e.total*190+"px"))}}const Yc=function(e){return{"pl-2":e}};function Wc(e,t){if(1&e&&(g.Qb(0,"div",37),g.Bc(1,Jc,2,3,"div",38),g.Qb(2,"span",39),g.Dc(3),g.Pb(),g.Pb()),2&e){const e=t.count;g.xb(1),g.gc("ngIf",e>0),g.xb(1),g.gc("ngClass",g.jc(3,Yc,e>0)),g.xb(1),g.Ec(e)}}let el=(()=>{class e extends Qe.a{constructor(e,t,i){super(e),this.referenceHelper=t,this.referencesService=i,this.ReferenceDirectionEnum=Me.ib,this.ReferenceLevelEnum=Me.jb,this.stats$=new Ct.a(null)}getFormControlNames(){return["direction","levels","period"]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.isOwner=this.authHelper.isSelf(this.param),this.addSub(this.referencesService.getUserReferencesDataForSearch({user:this.param}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),e.set&&!this.isOwner&&(this.headingActions=[new be.c("military_tech",this.i18n.reference.set,()=>{this.router.navigate(e.current?["users","references","edit",e.current.id]:["users","references","set","self",this.param])},!0)]),this.levels=[{level:Me.jb.VERY_GOOD,text:this.i18n.reference.level.veryGood},{level:Me.jb.GOOD,text:this.i18n.reference.level.good},{level:Me.jb.NEUTRAL,text:this.i18n.reference.level.neutral},{level:Me.jb.BAD,text:this.i18n.reference.level.bad},{level:Me.jb.VERY_BAD,text:this.i18n.reference.level.veryBad}],this.searchStatistics(),this.addSub(this.form.controls.direction.valueChanges.subscribe(()=>this.searchStatistics()))}searchStatistics(){this.addSub(this.referencesService.getUserReferenceStatistics({user:this.param,direction:this.form.controls.direction.value}).subscribe(e=>this.stats=e))}toSearchParams(e){return e.user=this.param,e}doSearch(e){return this.referencesService.searchUserReferences$Response(e)}filter(e,t){this.form.patchValue({levels:e?[e]:null,period:t?null:[this.dataForUiHolder.now().clone().subtract(30,"day").startOf("day").format(wc.b),null]})}get toLink(){return e=>this.path(e)}get stats(){return this.stats$.value}set stats(e){this.stats$.next(e),this.allTime=e.periods.filter(e=>null==e.period)[0],this.last30Days=e.periods.filter(e=>null!=e.period)[0]}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.referencesService.deleteReference({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}path(e){return["/users","references","view",e.id]}resolveMenu(e){return this.isOwner?u.b.REFERENCES:this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Rc.a),g.Kb(Bc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-references"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["columnData",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["formControlName","direction",3,"label"],[3,"value","text"],["mode","table",4,"ngIf"],["resultType","list",3,"results","rendering$","toLink","update"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],["mode","table"],[1,"table","table-hover","small-height"],["width","33%"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"],[1,"link","link-undecorated",3,"click"],[3,"level","textLeft"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["avatarIcon","user",3,"avatarImage"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[3,"level"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click"],[1,"actions","actions-multiple"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"],[1,"stats"],["class","bar",3,"ngStyle",4,"ngIf"],[1,"count",3,"ngClass"],[1,"bar",3,"ngStyle"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,zc,17,22,"ng-container",1),g.Pb(),g.Bc(3,Wc,4,5,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,kc.a,h.v,h.l,Le.a,$.a,U.a,H.a,Q.a,Dt.a,p.s,Tc.a,p.A,G.a,I.b,q.a,p.q,p.w],pipes:[p.b,p.C,V.a],encapsulation:2,changeDetection:0}),e})();function tl(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"dateTime"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.date),g.xb(1),g.Fc(" ",g.bc(2,2,e.data.date)," ")}}function il(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"form",3),g.Bc(4,tl,3,4,"label-value",4),g.Qb(5,"label-value",5),g.Lb(6,"user-link",6),g.Pb(),g.Qb(7,"label-value",5),g.Lb(8,"user-link",6),g.Pb(),g.Qb(9,"single-selection-field",7),g.Lb(10,"field-option",8),g.Lb(11,"field-option",8),g.Lb(12,"field-option",8),g.Lb(13,"field-option",8),g.Lb(14,"field-option",8),g.Pb(),g.Lb(15,"textarea-field",9),g.Pb(),g.Qb(16,"actions",10),g.Qb(17,"action-button",11),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(18,"async"),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.create?e.i18n.reference.title.set:e.i18n.reference.title.edit)("mobileHeading",e.create?e.i18n.reference.mobileTitle.set:e.i18n.reference.title.edit)("headingActions",g.bc(2,23,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",!e.create),g.xb(1),g.gc("label",e.i18n.reference.from),g.xb(1),g.gc("user",e.data.from),g.xb(1),g.gc("label",e.i18n.reference.to),g.xb(1),g.gc("user",e.data.to),g.xb(1),g.gc("label",e.i18n.reference.level.level),g.xb(1),g.gc("value",e.ReferenceLevelEnum.VERY_BAD)("text",e.i18n.reference.level.veryBad),g.xb(1),g.gc("value",e.ReferenceLevelEnum.BAD)("text",e.i18n.reference.level.bad),g.xb(1),g.gc("value",e.ReferenceLevelEnum.NEUTRAL)("text",e.i18n.reference.level.neutral),g.xb(1),g.gc("value",e.ReferenceLevelEnum.GOOD)("text",e.i18n.reference.level.good),g.xb(1),g.gc("value",e.ReferenceLevelEnum.VERY_GOOD)("text",e.i18n.reference.level.veryGood),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(2),g.gc("disabled",g.bc(18,25,e.requesting$))("label",e.i18n.general.submit)}}let nl=(()=>{class e extends l.a{constructor(e,t){super(e),this.referencesService=t,this.ReferenceLevelEnum=Me.jb}ngOnInit(){super.ngOnInit(),this.from=this.route.snapshot.params.from,this.to=this.route.snapshot.params.to,this.id=this.route.snapshot.params.id,this.create=null==this.id;const e=this.create?this.referencesService.getReferenceDataForSet({from:this.from,to:this.to}):this.referencesService.getReferenceDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}))}onDataInitialized(e){const t=e.reference;this.form=this.formBuilder.group({level:[t.level,h.G.required],comments:[t.comments,h.G.required],version:t.version})}save(){if(!Object(b.F)(this.form))return;const e=this.form.value,t=this.create?this.referencesService.setReference({body:e,from:this.ApiHelper.SELF,to:this.data.to.id}):this.referencesService.updateReference({id:this.id,body:e});this.addSub(t.subscribe(()=>{this.notification.snackBar(this.i18n.reference.referenceSet),history.back()}))}resolveMenu(e){return this.menu.userMenu(e.from,u.b.REFERENCES)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Bc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["set-reference"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],[3,"label",4,"ngIf"],[3,"label"],[3,"user"],["formControlName","level","required","",3,"label"],[3,"value","text"],["formControlName","comments","required","",3,"label"],["forceRow",""],[3,"disabled","label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,il,19,27,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Q.a,Dt.a,Fe.a,h.v,h.l,h.D,Le.a,St.a,x.a,y.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();function al(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"label-value",3),g.Dc(4),g.ac(5,"dateTime"),g.Pb(),g.Qb(6,"label-value",3),g.Lb(7,"user-link",4),g.Pb(),g.Qb(8,"label-value",3),g.Lb(9,"user-link",4),g.Pb(),g.Qb(10,"label-value",3),g.Lb(11,"rating-stats",5),g.Pb(),g.Qb(12,"label-value",3),g.Dc(13),g.Pb(),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.reference.title.view)("mobileHeading",e.i18n.reference.mobileTitle.view)("headingActions",g.bc(2,13,e.headingActions$)),g.xb(2),g.gc("label",e.i18n.general.date),g.xb(1),g.Fc(" ",g.bc(5,15,e.data.date)," "),g.xb(2),g.gc("label",e.i18n.reference.from),g.xb(1),g.gc("user",e.data.from),g.xb(1),g.gc("label",e.i18n.reference.to),g.xb(1),g.gc("user",e.data.to),g.xb(1),g.gc("label",e.i18n.reference.level.level),g.xb(1),g.gc("level",e.data.level),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(1),g.Fc(" ",e.data.comments," ")}}let sl=(()=>{class e extends _.a{constructor(e,t,i){super(e),this.referencesService=t,this.referenceHelper=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.referencesService.viewReference({id:this.id}).subscribe(e=>this.data=e))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.from)||this.authHelper.isSelfOrOwner(e.to);const t=[];e.canEdit&&t.push(new be.c("edit",this.i18n.general.edit,()=>this.router.navigate(["/users","references","edit",this.id]),!0)),this.headingActions=t}resolveMenu(){return this.self?u.b.REFERENCES:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Bc.a),g.Kb(Rc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-reference"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"label"],[3,"user"],[3,"level"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,al,14,17,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,Q.a,Dt.a,Tc.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var ol=i("mwYl"),rl=i("R8pA");function cl(e,t){if(1&e&&(g.Qb(0,"div",6),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.name,"")}}const ll=function(e){return{"ml-3":e}};function bl(e,t){if(1&e&&(g.Qb(0,"div",7),g.Lb(1,"input",8),g.Qb(2,"label",9),g.Qb(3,"div",10),g.Dc(4),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb().$implicit,n=g.Zb(2);g.gc("ngClass",g.jc(6,ll,i)),g.xb(1),g.gc("formControl",n.control)("id","group_"+e.id)("value",e.id),g.xb(1),g.gc("for","group_"+e.id),g.xb(2),g.Fc(" ",e.name," ")}}function ul(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div"),g.Bc(2,cl,2,1,"div",4),g.Bc(3,bl,5,8,"div",5),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(2),g.gc("ngIf",e),g.xb(1),g.gc("ngForOf",i.groupsForSet(e))}}function dl(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",2),g.Dc(2),g.Pb(),g.Bc(3,ul,4,2,"ng-container",3),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.Ec(e.i18n.user.registration.groupManager),g.xb(1),g.gc("ngForOf",e.groupSets)}}function gl(e,t){if(1&e&&g.Lb(0,"field-option",15),2&e){const e=t.$implicit;g.gc("value",e.id)("text",e.name)}}function fl(e,t){if(1&e&&(g.Qb(0,"radio-group-field",13),g.Bc(1,gl,1,2,"field-option",14),g.Pb()),2&e){const e=g.Zb(2);g.gc("formControl",e.control),g.xb(1),g.gc("ngForOf",e.groups)}}function ml(e,t){if(1&e&&(g.Qb(0,"div",21),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.description," ")}}function pl(e,t){if(1&e&&(g.Qb(0,"div",17),g.Qb(1,"div",18),g.Qb(2,"div",19),g.Lb(3,"input",8),g.Qb(4,"label",9),g.Qb(5,"div",10),g.Dc(6),g.Bc(7,ml,2,1,"div",20),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(3),g.gc("formControl",i.control)("id","group_"+e.id)("value",e.id),g.xb(1),g.gc("for","group_"+e.id),g.xb(2),g.Fc(" ",e.name," "),g.xb(1),g.gc("ngIf",e.description)}}function hl(e,t){if(1&e&&g.Bc(0,pl,8,6,"div",16),2&e){const e=g.Zb(2);g.gc("ngForOf",e.groups)}}function vl(e,t){if(1&e&&(g.Qb(0,"div",2),g.Dc(1),g.Pb(),g.Bc(2,fl,2,2,"radio-group-field",11),g.Bc(3,hl,1,1,"ng-template",null,12,g.Cc)),2&e){const e=g.qc(4),t=g.Zb();g.xb(1),g.Ec(t.i18n.user.registration.groupPublic),g.xb(1),g.gc("ngIf",t.singleLine)("ngIfElse",e)}}let xl=(()=>{class e extends Wa.a{constructor(e,t){super(e),this.login=t}ngOnInit(){super.ngOnInit(),this.singleLine=this.groups.length<=3&&0===this.groups.filter(e=>e.description).length}groupsForSet(e){return this.groups.filter(null==e?e=>null==e.groupSet:t=>t.groupSet===e.id)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(rl.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-group"]],inputs:{groupSets:"groupSets",groups:"groups",control:"control"},features:[g.ub],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["asGuest",""],[1,"mb-3"],[4,"ngFor","ngForOf"],["class","mt-3 mb-2","font-weight-bold","",4,"ngIf"],["class","custom-control custom-radio mb-1",3,"ngClass",4,"ngFor","ngForOf"],["font-weight-bold","",1,"mt-3","mb-2"],[1,"custom-control","custom-radio","mb-1",3,"ngClass"],["type","radio",1,"custom-control-input",3,"formControl","id","value"],[1,"custom-control-label",3,"for"],[1,"ml-1"],[3,"formControl",4,"ngIf","ngIfElse"],["multiLine",""],[3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["class","row mb-2",4,"ngFor","ngForOf"],[1,"row","mb-2"],[1,"col-12","col-6","col-sm-8"],[1,"custom-control","custom-radio"],["class","text-muted mt-1 mb-3",4,"ngIf"],[1,"text-muted","mt-1","mb-3"]],template:function(e,t){if(1&e&&(g.Bc(0,dl,4,2,"ng-container",0),g.Bc(1,vl,5,3,"ng-template",null,1,g.Cc)),2&e){const e=g.qc(2);g.gc("ngIf",t.login.user)("ngIfElse",e)}},directives:[p.t,p.s,p.q,h.A,h.e,h.v,h.k,kc.a,Le.a],encapsulation:2,changeDetection:0}),e})();var yl=i("n7/T");function Pl(e,t){if(1&e&&g.Lb(0,"img",6),2&e){const e=g.Zb().$implicit;g.gc("src",e.image.url,g.uc)("alt",e.name)}}const Il=function(e,t,i){return{border:e,background:t,color:i}};function El(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",3),g.Xb("click",(function(){g.sc(e);const i=t.$implicit;return g.Zb().registerWith(i)})),g.Bc(1,Pl,1,2,"img",4),g.Lb(2,"span",5),g.ac(3,"trust"),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb();g.gc("ngStyle",g.lc(5,Il,"1px solid "+e.borderColor,e.backgroundColor,e.textColor)),g.xb(1),g.gc("ngIf",e.image),g.xb(1),g.gc("innerHTML",g.bc(3,3,i.i18n.identityProvider.login(e.name)),g.tc)}}let Al=(()=>{class e extends Wa.a{constructor(e,t){super(e),this.uiLayout=t,this.continue=new g.n}registerWith(e){this.continue.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(yl.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-idp"]],inputs:{identityProviders:"identityProviders"},outputs:{continue:"continue"},features:[g.ub],decls:5,vars:5,consts:[[1,"text-center"],["type","button","class","identity-provider",3,"ngStyle","click",4,"ngFor","ngForOf"],[1,"text-muted","text-justify","my-3",3,"innerHTML"],["type","button",1,"identity-provider",3,"ngStyle","click"],["class","aria-hidden",3,"src","alt",4,"ngIf"],[3,"innerHTML"],[1,"aria-hidden",3,"src","alt"]],template:function(e,t){1&e&&(g.Qb(0,"div",0),g.Dc(1),g.Pb(),g.Bc(2,El,4,9,"button",1),g.Lb(3,"div",2),g.ac(4,"trust")),2&e&&(g.xb(1),g.Ec(t.i18n.identityProvider.registration),g.xb(1),g.gc("ngForOf",t.identityProviders),g.xb(1),g.gc("innerHTML",g.bc(4,3,t.i18n.identityProvider.registrationDisclaimer(t.uiLayout.appTitleSmall)),g.tc))},directives:[p.s,p.w,p.t],pipes:[Kt.a],encapsulation:2,changeDetection:0}),e})();var Cl=i("HDdC"),Dl=i("LRne");function Ol(e,t){if(1&e&&g.Lb(0,"avatar",17),2&e){const e=g.Zb(2);g.gc("image",e.image)}}function Sl(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb(2);g.Fc(" ",e.i18n.user.noImage," ")}}function Ql(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",21),g.Xb("action",(function(){return g.sc(e),g.Zb(3).removeImage()})),g.ac(1,"async"),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("disabled",g.bc(1,2,e.requesting$))("label",e.i18n.field.image.remove)}}function Nl(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",18),g.Qb(1,"action-button",19),g.Xb("action",(function(){return g.sc(e),g.Zb(),g.qc(11).perform()})),g.ac(2,"async"),g.Pb(),g.Bc(3,Ql,2,4,"action-button",20),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(1),g.gc("disabled",g.bc(2,3,e.requesting$))("label",e.i18n.field.image.upload),g.xb(2),g.gc("ngIf",e.image)}}function Fl(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"h2",7),g.Dc(2),g.Pb(),g.Qb(3,"div",8),g.Qb(4,"div",9),g.Qb(5,"div",10),g.Bc(6,Ol,1,1,"avatar",11),g.ac(7,"async"),g.Bc(8,Sl,1,1,"ng-template",null,12,g.Cc),g.Pb(),g.Qb(10,"image-upload",13,14),g.Xb("uploadDone",(function(t){return g.sc(e),g.Zb().onUploadDone(t[0])})),g.Pb(),g.Pb(),g.Bc(12,Nl,4,5,"div",15),g.ac(13,"async"),g.Pb(),g.Qb(14,"h2",16),g.Dc(15),g.Pb(),g.Nb()}if(2&e){const e=g.qc(9),t=g.qc(11),i=g.Zb();g.xb(2),g.Ec(i.i18n.user.title.image),g.xb(4),g.gc("ngIf",g.bc(7,5,i.image$))("ngIfElse",e),g.xb(6),g.gc("ngIf",!1===g.bc(13,7,t.uploading$)),g.xb(3),g.Ec(i.i18n.user.title.fields)}}function Ll(e,t){if(1&e&&g.Lb(0,"input-field",22),2&e){const e=g.Zb();g.gc("label",e.i18n.user.name)}}function Bl(e,t){if(1&e&&g.Lb(0,"input-field",23),2&e){const e=g.Zb();g.gc("label",e.i18n.user.username)}}function wl(e,t){if(1&e&&g.Lb(0,"field-privacy",28),2&e){const e=g.Zb(2);g.gc("control",e.form.get("hiddenFields"))}}function Rl(e,t){if(1&e&&g.Lb(0,"boolean-field",29),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.skipActivationEmail)}}function kl(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"label-value",24),g.Lb(2,"input-field",25),g.Bc(3,wl,1,1,"field-privacy",26),g.Pb(),g.Bc(4,Rl,1,1,"boolean-field",27),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("label",e.i18n.user.email)("ignoreExtraCell",!e.canManagePrivacy("email"))("required",e.data.emailRequired),g.xb(1),g.gc("required",e.data.emailRequired),g.xb(2),g.gc("ngIf",e.data.allowSetSendActivationEmail)}}function Tl(e,t){if(1&e&&g.Lb(0,"field-privacy",34),2&e){const e=g.Zb(2).$implicit,t=g.Zb();g.gc("field",e.internalName)("control",t.form.get("hiddenFields"))}}function Zl(e,t){if(1&e){const e=g.Rb();g.Qb(0,"label-value",31),g.Qb(1,"custom-field-input",32),g.Xb("imagesUploaded",(function(t){return g.sc(e),g.Zb(2).customImagesUploaded.emit(t)}))("filesUploaded",(function(t){return g.sc(e),g.Zb(2).customFilesUploaded.emit(t)})),g.Pb(),g.Bc(2,Tl,1,2,"field-privacy",33),g.Pb()}if(2&e){const e=g.Zb().$implicit,t=g.Zb();g.gc("label",e.name)("ignoreExtraCell",!t.canManagePrivacy(e))("fieldSize",e.size)("required",e.required),g.xb(1),g.gc("field",e)("formControlName",e.internalName)}}function _l(e,t){if(1&e&&(g.Ob(0,1),g.Bc(1,Zl,3,6,"label-value",30),g.Nb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("formGroup",i.form.get("customValues")),g.xb(1),g.gc("ngIf",i.canEdit(e))}}function Ml(e,t){if(1&e&&g.Lb(0,"field-privacy",38),2&e){const e=g.Zb(2);g.gc("control",e.mobileForm.get("hidden"))}}function $l(e,t){if(1&e&&(g.Qb(0,"label-value",35),g.Lb(1,"input-field",36),g.Bc(2,Ml,1,1,"field-privacy",37),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.phone.mobile)("required","required"===e.mobileAvailability)("formGroup",e.mobileForm),g.xb(1),g.gc("placeholder",e.data.phoneConfiguration.mobileExample)}}function Ul(e,t){if(1&e&&g.Lb(0,"field-privacy",38),2&e){const e=g.Zb(2);g.gc("control",e.landLineForm.get("hidden"))}}function Hl(e,t){if(1&e&&g.Lb(0,"input-field",41),2&e){const e=g.Zb(2);g.gc("label",e.i18n.phone.extension)}}function Gl(e,t){if(1&e&&(g.Ob(0,1),g.Qb(1,"label-value",39),g.Lb(2,"input-field",36),g.Bc(3,Ul,1,1,"field-privacy",37),g.Pb(),g.Bc(4,Hl,1,1,"input-field",40),g.Nb()),2&e){const e=g.Zb();g.gc("formGroup",e.landLineForm),g.xb(1),g.gc("label",e.i18n.phone.landLine)("required","required"===e.data.phoneConfiguration.landLineAvailability),g.xb(1),g.gc("placeholder",e.data.phoneConfiguration.landLineExample),g.xb(2),g.gc("ngIf",e.data.phoneConfiguration.extensionEnabled)}}function ql(e,t){if(1&e&&g.Lb(0,"boolean-field",45),2&e){const e=g.Zb(2);g.gc("formControl",e.defineAddress)("label",e.i18n.user.addressDefine)}}function Kl(e,t){if(1&e&&g.Lb(0,"address-form",46),2&e){const e=g.Zb(2);g.gc("addressForm",e.addressForm)("configuration",e.data.addressConfiguration)("managePrivacy",e.data.addressConfiguration.managePrivacy)}}function Vl(e,t){if(1&e){const e=g.Rb();g.Qb(0,"static-map",50),g.Xb("imageLoaded",(function(){return g.sc(e),g.Zb(3).mapShown()})),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("address",e.addressForm.value)}}function jl(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",19),g.Xb("action",(function(){return g.sc(e),g.Zb(3).locateAddress()})),g.ac(1,"async"),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("disabled",g.bc(1,2,e.locatingAddress$))("label",e.i18n.general.mapView)}}function zl(e,t){if(1&e&&(g.Qb(0,"label-value",47),g.Bc(1,Vl,1,1,"static-map",48),g.ac(2,"async"),g.Bc(3,jl,2,4,"ng-template",null,49,g.Cc),g.Pb()),2&e){const e=g.qc(4),t=g.Zb(2);var i;g.gc("label",t.i18n.general.map),g.xb(1),g.gc("ngIf",null!=(null==(i=g.bc(2,3,t.addressForm.get("location").valueChanges))?null:i.latitude))("ngIfElse",e)}}function Xl(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",16),g.Dc(2),g.Pb(),g.Bc(3,ql,1,2,"boolean-field",42),g.Bc(4,Kl,1,3,"address-form",43),g.Bc(5,zl,5,5,"label-value",44),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.Ec(e.i18n.address.address),g.xb(1),g.gc("ngIf","required"!==e.data.addressConfiguration.availability),g.xb(1),g.gc("ngIf",e.defineAddress.value),g.xb(1),g.gc("ngIf",e.defineAddress.value&&e.maps.enabled)}}let Jl=(()=>{class e extends Wa.a{constructor(e,t,i,n,a){super(e),this.userHelper=t,this.imagesService=i,this.maps=n,this.changeDetector=a,this.imageUploaded=new g.n,this.imageRemoved=new g.n,this.customImagesUploaded=new g.n,this.customFilesUploaded=new g.n,this.image$=new Ct.a(null),this.location$=new Ct.a(null),this.locatingAddress$=new Ct.a(!1)}get image(){return this.image$.value}set image(e){this.image$.next(e)}get location(){return this.location$.value}set location(e){this.location$.next(e)}ngOnInit(){super.ngOnInit(),this.editableFields=this.userHelper.fieldNamesByAction(this.data,"edit"),this.managePrivacyFields=this.userHelper.fieldNamesByAction(this.data,"managePrivacy")}get mobileAvailability(){return this.data.phoneConfiguration.mobileAvailability}get landLineAvailability(){return this.data.phoneConfiguration.landLineAvailability}get addressAvailability(){return this.data.addressConfiguration.availability}get imageAvailability(){return this.data.imageConfiguration.availability}onUploadDone(e){this.addSub(this.doRemoveImage().subscribe(()=>{this.image=e,this.imageUploaded.emit(this.image),this.changeDetector.detectChanges()}))}removeImage(){this.addSub(this.doRemoveImage().subscribe())}doRemoveImage(){if(this.image){const e=this.image;return this.errorHandler.requestWithCustomErrorHandler(()=>new Cl.a(t=>{this.imagesService.deleteImage({idOrKey:this.image.id}).subscribe(()=>{this.imageRemoved.emit(this.image),this.image=null,this.changeDetector.detectChanges(),t.next(e)})}))}return Object(Dl.a)(null)}canEdit(e){return this.editableFields.has(this.fieldHelper.fieldName(e))}canManagePrivacy(e){return this.managePrivacyFields.has(this.fieldHelper.fieldName(e))}locateAddress(){const e=this.addressForm.value;this.locatingAddress$.next(!0),this.addSub(this.maps.geocode(e).subscribe(e=>{this.addressForm.patchValue({location:e}),this.changeDetector.detectChanges()},()=>this.mapShown()))}mapShown(){this.locatingAddress$.next(!1),this.changeDetector.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(yo.a),g.Kb(Do.a),g.Kb(g.h))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-fields"]],inputs:{data:"data",form:"form",mobileForm:"mobileForm",landLineForm:"landLineForm",addressForm:"addressForm",defineAddress:"defineAddress",image:"image"},outputs:{imageUploaded:"imageUploaded",imageRemoved:"imageRemoved",customImagesUploaded:"customImagesUploaded",customFilesUploaded:"customFilesUploaded"},features:[g.ub],decls:9,vars:9,consts:[[4,"ngIf"],[3,"formGroup"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","username","required","",3,"label",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],["kind","field",3,"label","required","formGroup",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"border-0"],[1,"row"],[1,"col-12","col-sm-4"],[1,"d-flex","justify-content-center","justify-content-sm-start"],["size","huge","useLightbox","",3,"image",4,"ngIf","ngIfElse"],["noImage",""],["containerClass","mt-3","target","userRegistration","keepUrls","",3,"uploadDone"],["upload",""],["class","col-12 col-sm-8 mt-3 mt-sm-0 d-flex justify-content-between justify-content-sm-end align-items-end",4,"ngIf"],[1,"mt-4"],["size","huge","useLightbox","",3,"image"],[1,"col-12","col-sm-8","mt-3","mt-sm-0","d-flex","justify-content-between","justify-content-sm-end","align-items-end"],["outline","",3,"disabled","label","action"],["class","ml-3","outline","",3,"disabled","label","action",4,"ngIf"],["outline","",1,"ml-3",3,"disabled","label","action"],["formControlName","name","required","",3,"label"],["formControlName","username","required","",3,"label"],["kind","field",3,"label","ignoreExtraCell","required"],["formControlName","email",3,"required"],["field","email",3,"control",4,"extraCell"],["formControlName","skipActivationEmail",3,"label",4,"ngIf"],["field","email",3,"control"],["formControlName","skipActivationEmail",3,"label"],["kind","field",3,"label","ignoreExtraCell","fieldSize","required",4,"ngIf"],["kind","field",3,"label","ignoreExtraCell","fieldSize","required"],["hideLabel","",3,"field","formControlName","imagesUploaded","filesUploaded"],[3,"field","control",4,"extraCell"],[3,"field","control"],["kind","field",3,"label","required","formGroup"],["formControlName","number",3,"placeholder"],[3,"control",4,"extraCell"],[3,"control"],["kind","field",3,"label","required"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],["switch","",3,"formControl","label",4,"ngIf"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy",4,"ngIf"],["kind","field",3,"label",4,"ngIf"],["switch","",3,"formControl","label"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy"],["kind","field",3,"label"],[3,"address","imageLoaded",4,"ngIf","ngIfElse"],["viewMap",""],[3,"address","imageLoaded"]],template:function(e,t){1&e&&(g.Bc(0,Fl,16,9,"ng-container",0),g.Ob(1,1),g.Bc(2,Ll,1,1,"input-field",2),g.Bc(3,Bl,1,1,"input-field",3),g.Bc(4,kl,5,5,"ng-container",0),g.Nb(),g.Bc(5,_l,2,2,"ng-container",4),g.Bc(6,$l,3,4,"label-value",5),g.Bc(7,Gl,5,5,"ng-container",6),g.Bc(8,Xl,6,4,"ng-container",0)),2&e&&(g.gc("ngIf","disabled"!==t.imageAvailability),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngIf",t.canEdit("name")),g.xb(1),g.gc("ngIf",t.canEdit("username")),g.xb(1),g.gc("ngIf",t.canEdit("email")),g.xb(1),g.gc("ngForOf",t.data.customFields),g.xb(1),g.gc("ngIf","disabled"!==t.mobileAvailability),g.xb(1),g.gc("ngIf","disabled"!==t.landLineAvailability),g.xb(1),g.gc("ngIf","disabled"!==t.addressAvailability))},directives:[p.t,h.w,h.n,p.s,Fo.a,we.a,y.a,Ot.a,h.v,h.l,h.D,Q.a,Lo.a,Bo.a,v.a,Gt.a,h.k,wo.a,Ro.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Yl=i("UnhA"),Wl=i("g9Ug");const eb=["securityAnswer"];function tb(e,t){if(1&e&&(g.Qb(0,"div",10),g.Lb(1,"avatar",11),g.Pb()),2&e){const e=g.Zb();g.xb(1),g.gc("image",e.image)}}function ib(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"avatar",13),g.Pb()),2&e){const e=g.Zb();g.xb(1),g.gc("size",e.image?200:128)("image",e.image)}}function nb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.group)("value",e.group.name)}}function ab(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.name)("value",e.name)}}function sb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.username)("value",e.username)}}function ob(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.email)("value",e.email)}}function rb(e,t){if(1&e&&(g.Qb(0,"label-value",15),g.Lb(1,"format-field-value",16),g.Pb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("label",e.name),g.xb(1),g.gc("fields",i.customFields)("fieldName",e.internalName)("object",i.user)("images",i.customImages)("files",i.customFiles)}}function cb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.phone.mobile)("value",e.mobile)}}function lb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.phoneAddLandLine)("value",e.landLine)}}function bb(e,t){if(1&e&&(g.Qb(0,"label-value",15),g.Lb(1,"address-details",17),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.address.address),g.xb(1),g.gc("address",e.address)}}function ub(e,t){if(1&e&&(g.Qb(0,"div",20),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Ec(e.description)}}function db(e,t){if(1&e&&g.Lb(0,"boolean-field",21),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.passwordAssign)}}function gb(e,t){if(1&e&&g.Lb(0,"boolean-field",25),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.registration.passwordForceChange)}}function fb(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"input-field",22),g.Lb(2,"input-field",23),g.Bc(3,gb,1,1,"boolean-field",24),g.Nb()),2&e){const e=g.Zb().$implicit,t=g.Zb();g.xb(1),g.gc("label",e.name),g.xb(1),g.gc("label",t.i18n.user.passwordConfirmation(e.name)),g.xb(1),g.gc("ngIf",e.canForceChange)}}function mb(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Ob(3,7),g.Bc(4,ub,2,1,"div",18),g.Bc(5,db,1,1,"boolean-field",19),g.Bc(6,fb,4,3,"ng-container",9),g.Nb(),g.Nb()),2&e){const e=t.$implicit,i=t.index,n=g.Zb();g.xb(2),g.Ec(e.name),g.xb(1),g.gc("formGroup",n.passwordForm(i)),g.xb(1),g.gc("ngIf",e.description),g.xb(1),g.gc("ngIf",n.login.user),g.xb(1),g.gc("ngIf",n.passwordForm(i).get("defined").value)}}function pb(e,t){if(1&e&&g.Lb(0,"field-option",29),2&e){const e=t.$implicit;g.gc("value",e.internalName)("text",e.name)}}function hb(e,t){if(1&e&&g.Lb(0,"input-field",30,31),2&e){const e=g.Zb(3);g.gc("label",e.i18n.securityQuestion.answer)}}function vb(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Qb(3,"div",20),g.Dc(4),g.Pb(),g.Qb(5,"single-selection-field",26),g.Bc(6,pb,1,2,"field-option",27),g.Pb(),g.Bc(7,hb,2,1,"input-field",28),g.ac(8,"async"),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.securityQuestion.question),g.xb(2),g.Fc(" ",e.i18n.user.securityQuestionMessage," "),g.xb(1),g.gc("label",e.i18n.securityQuestion.question)("emptyOption",e.i18n.user.securityQuestionEmpty),g.xb(1),g.gc("ngForOf",e.data.securityQuestions),g.xb(1),g.gc("ngIf",!e.empty(g.bc(8,6,e.form.get("securityQuestion").valueChanges)))}}function xb(e,t){if(1&e&&(g.Qb(0,"div",35),g.Qb(1,"div",36),g.Dc(2),g.Pb(),g.Lb(3,"accept-agreements",37),g.Pb()),2&e){const e=g.Zb(3);g.xb(2),g.Ec(e.i18n.pendingAgreements.preface),g.xb(1),g.gc("agreements",e.data.agreements)}}function yb(e,t){if(1&e&&(g.Qb(0,"div",38),g.Qb(1,"div",36),g.Dc(2),g.Pb(),g.Qb(3,"div",36),g.Lb(4,"captcha",39),g.Pb(),g.Pb()),2&e){const e=g.Zb(3);g.xb(2),g.Ec(e.i18n.user.captcha),g.xb(2),g.gc("form",e.form.get("captcha"))}}function Pb(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Qb(3,"div",32),g.Bc(4,xb,4,2,"div",33),g.Bc(5,yb,5,2,"div",34),g.Pb(),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc(" ",e.i18n.user.title.registrationConfirmation," "),g.xb(2),g.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>0),g.xb(1),g.gc("ngIf",null!=e.data.captchaType)}}function Ib(e,t){if(1&e&&(g.Ob(0),g.Bc(1,vb,9,8,"ng-container",9),g.Bc(2,Pb,6,3,"ng-container",9),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("ngIf",(null==e.data.securityQuestions?null:e.data.securityQuestions.length)>0),g.xb(1),g.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>0||null!=e.data.captchaType)}}let Eb=(()=>{class e extends Wa.a{constructor(e,t){super(e),this.login=t,this.empty=b.h,this.focusSecurityAnswer=!1}ngOnInit(){if(super.ngOnInit(),Object(b.h)(this.data.securityQuestions)||this.addSub(this.form.get("securityQuestion").valueChanges.subscribe(e=>{this.focusSecurityAnswer=!Object(b.a)(e)})),!Object(b.h)(this.data.agreements)){const e=this.data.agreements.map(()=>!1);this.agreementsControl=this.formBuilder.array(e),this.addSub(this.agreementsControl.valueChanges.subscribe(e=>{const t=e.length===e.filter(e=>e).length;this.form.patchValue({acceptAgreement:t})}))}}ngAfterViewChecked(){this.focusSecurityAnswer&&(this.securityAnswer.forEach(e=>Object(b.j)(e)),this.focusSecurityAnswer=!1)}passwordForm(e){return this.form.get("passwords").controls[e]}get group(){const e=this.dataForUiHolder.dataForUi.publicRegistrationGroups||[];return 1===e.length?null:e.find(e=>e.id===this.user.group)}get name(){return(this.user.name||"").trim()}get username(){return(this.user.username||"").trim()}get email(){return(this.user.email||"").trim()}get mobile(){const e=this.user.mobilePhones||[];return Object(b.h)(e)?null:(e[0].number||"").trim()}get landLine(){const e=this.user.landLinePhones||[],t=Object(b.h)(e)?null:(e[0].number||"").trim();if(Object(b.h)(t))return"";const i=Object(b.h)(e)?null:(e[0].extension||"").trim();return""===i?t:this.i18n.phone.numberExtensionValue({number:t,extension:i})}get address(){const e=this.user.addresses||[];return Object(b.h)(e)?null:e[0]}get customFields(){return this.data.customFields.filter(e=>!Object(b.a)(this.user.customValues[e.internalName]))}get autocompletePasswords(){return(this.login.auth||{}).role?"off":"on"}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(rl.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-confirm"]],viewQuery:function(e,t){var i;1&e&&g.Hc(eb,!0),2&e&&g.pc(i=g.Yb())&&(t.securityAnswer=i)},inputs:{data:"data",form:"form",user:"user",image:"image",customImages:"customImages",customFiles:"customFiles"},features:[g.ub],decls:17,vars:17,consts:[["class","image d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["class","image ml-4 mb-3",4,"ngIf"],[1,"flex-grow-1","mb-ls"],[3,"label","value",4,"ngIf"],["valueFormat","component",3,"label",4,"ngFor","ngForOf"],["valueFormat","component",3,"label",4,"ngIf"],[3,"formGroup"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4"],["size","160","imageSize","200","useLightbox","",3,"image"],[1,"image","ml-4","mb-3"],["iconSize","128px","useLightbox","",3,"size","image"],[3,"label","value"],["valueFormat","component",3,"label"],[3,"fields","fieldName","object","images","files"],[3,"address"],["class","mb-2",4,"ngIf"],["formControlName","defined",3,"label",4,"ngIf"],[1,"mb-2"],["formControlName","defined",3,"label"],["required","","formControlName","value","type","password","autocomplete","new-password",3,"label"],["required","","formControlName","confirmationValue","type","password","autocomplete","new-password",3,"label"],["formControlName","forceChange",3,"label",4,"ngIf"],["formControlName","forceChange",3,"label"],["formControlName","securityQuestion",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","securityAnswer","required","",3,"label",4,"ngIf"],[3,"value","text"],["formControlName","securityAnswer","required","",3,"label"],["securityAnswer",""],[1,"row","no-gutters"],["class","col-12 col-sm-6 col-md-7",4,"ngIf"],["class","col-12 col-sm-6 col-md-5",4,"ngIf"],[1,"col-12","col-sm-6","col-md-7"],[1,"mb-3"],["formControlName","acceptAgreements",3,"agreements"],[1,"col-12","col-sm-6","col-md-5"],[3,"form"]],template:function(e,t){1&e&&(g.Bc(0,tb,2,1,"div",0),g.ac(1,"async"),g.Qb(2,"div",1),g.Bc(3,ib,2,2,"div",2),g.ac(4,"async"),g.Qb(5,"div",3),g.Bc(6,nb,1,2,"label-value",4),g.Bc(7,ab,1,2,"label-value",4),g.Bc(8,sb,1,2,"label-value",4),g.Bc(9,ob,1,2,"label-value",4),g.Bc(10,rb,2,6,"label-value",5),g.Bc(11,cb,1,2,"label-value",4),g.Bc(12,lb,1,2,"label-value",4),g.Bc(13,bb,2,2,"label-value",6),g.Pb(),g.Pb(),g.Qb(14,"form",7),g.Bc(15,mb,7,5,"ng-container",8),g.Bc(16,Ib,3,2,"ng-container",9),g.Pb()),2&e&&(g.gc("ngIf",t.image&&g.bc(1,13,t.layout.ltsm$)),g.xb(3),g.gc("ngIf",t.image&&g.bc(4,15,t.layout.gtxs$)),g.xb(3),g.gc("ngIf",t.group),g.xb(1),g.gc("ngIf",!t.empty(t.name)),g.xb(1),g.gc("ngIf",!t.empty(t.username)),g.xb(1),g.gc("ngIf",!t.empty(t.email)),g.xb(1),g.gc("ngForOf",t.customFields),g.xb(1),g.gc("ngIf",!t.empty(t.mobile)),g.xb(1),g.gc("ngIf",!t.empty(t.landLine)),g.xb(1),g.gc("ngIf",t.address),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngForOf",t.data.passwordTypes),g.xb(1),g.gc("ngIf",!t.login.user))},directives:[p.t,p.s,h.I,h.w,h.n,we.a,Q.a,is.a,Yl.a,v.a,h.v,h.l,Ot.a,h.D,Fe.a,Le.a,ue.a,Wl.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function Ab(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"p",0),g.ac(2,"trust"),g.Qb(3,"p"),g.Dc(4),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("innerHTML",g.bc(2,2,e.principalsHtml),g.tc),g.xb(3),g.Ec(e.passwordsMessage)}}let Cb=(()=>{class e extends Wa.a{constructor(e,t,i){super(e),this.login=t,this.userHelper=i}ngOnInit(){super.ngOnInit(),this.messageHtml=this.userHelper.registrationMessageHtml(this.result,!!this.dataForUiHolder.user),this.principalsHtml=this.userHelper.registrationPrincipalsHtml(this.result),this.passwordsMessage=this.userHelper.registrationPasswordsMessage(this.result)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(rl.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-done"]],inputs:{result:"result"},features:[g.ub],decls:3,vars:4,consts:[[3,"innerHTML"],[4,"ngIf"]],template:function(e,t){1&e&&(g.Lb(0,"p",0),g.ac(1,"trust"),g.Bc(2,Ab,5,4,"ng-container",1)),2&e&&(g.gc("innerHTML",g.bc(1,2,t.messageHtml),g.tc),g.xb(2),g.gc("ngIf",null==t.login.user&&"active"==t.result.status))},directives:[p.t],pipes:[Kt.a],encapsulation:2,changeDetection:0}),e})();function Db(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Lb(3,"registration-step-group",5),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().showIdentityProviders()})),g.ac(6,"async"),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registration)("mobileHeading",e.i18n.user.mobileTitle.registration)("mode",g.bc(1,8,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("groupSets",e.groupSets)("groups",e.groups)("control",e.group),g.xb(2),g.gc("disabled",g.bc(6,10,e.requesting$))("label",e.i18n.general.next)}}function Ob(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).backToGroup()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.previous)}}function Sb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Qb(3,"registration-step-idp",8),g.Xb("continue",(function(t){return g.sc(e),g.Zb().continueWithProvider(t)})),g.Pb(),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().continueWithProvider(null)})),g.ac(6,"async"),g.Pb(),g.Bc(7,Ob,1,1,"action-button",9),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registration)("mobileHeading",e.i18n.user.mobileTitle.registration)("mode",g.bc(1,7,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("identityProviders",e.data.identityProviders),g.xb(2),g.gc("disabled",g.bc(6,9,e.requesting$))("label",e.i18n.general.skip),g.xb(2),g.gc("ngIf",e.groups.length>1)}}function Qb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).backToIdentityProviders()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.previous)}}function Nb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Qb(3,"registration-step-fields",11),g.Xb("imageUploaded",(function(t){return g.sc(e),g.Zb().image=t}))("imageRemoved",(function(){return g.sc(e),g.Zb().image=null}))("customImagesUploaded",(function(t){return g.sc(e),g.Zb().addCustomImages(t)}))("customFilesUploaded",(function(t){return g.sc(e),g.Zb().addCustomFiles(t)})),g.Pb(),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().showConfirm()})),g.ac(6,"async"),g.Pb(),g.Bc(7,Qb,1,1,"action-button",9),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registration)("mobileHeading",e.i18n.user.mobileTitle.registration)("mode",g.bc(1,13,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("data",e.data)("form",e.form)("mobileForm",e.mobileForm)("landLineForm",e.landLineForm)("defineAddress",e.defineAddress)("addressForm",e.addressForm)("image",e.image),g.xb(2),g.gc("disabled",g.bc(6,15,e.requesting$))("label",e.i18n.general.next),g.xb(2),g.gc("ngIf",e.groups.length>1||(null==e.data.identityProviders?null:e.data.identityProviders.length)>0)}}function Fb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Lb(3,"registration-step-confirm",12),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().register()})),g.ac(6,"async"),g.Pb(),g.Qb(7,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb().backToFields()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registrationConfirmation)("mobileHeading",e.i18n.user.mobileTitle.registrationConfirmation)("mode",g.bc(1,12,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("data",e.data)("form",e.confirmForm)("user",e.userNew)("image",e.image)("customImages",e.customImages)("customFiles",e.customFiles),g.xb(2),g.gc("disabled",g.bc(6,14,e.requesting$))("label",e.i18n.general.submit),g.xb(2),g.gc("label",e.i18n.general.previous)}}function Lb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb(2).reload()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.registerAnotherUser)}}function Bb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb(2).viewProfile()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.viewProfile)}}function wb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb(2).goToLogin()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.menu.login)}}function Rb(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Lb(3,"registration-step-done",13),g.ac(4,"async"),g.Pb(),g.Qb(5,"actions",6),g.Bc(6,Lb,1,1,"action-button",14),g.Bc(7,Bb,1,1,"action-button",14),g.Bc(8,wb,1,1,"action-button",14),g.Pb(),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registrationDone)("mobileHeading",e.i18n.user.mobileTitle.registrationDone)("mode",g.bc(1,7,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("result",g.bc(4,9,e.result$)),g.xb(3),g.gc("ngIf",e.login.user),g.xb(1),g.gc("ngIf",e.login.user),g.xb(1),g.gc("ngIf",!e.login.user)}}function kb(e,t){1&e&&(g.Qb(0,"page-content"),g.Lb(1,"spinner"),g.Pb())}let Tb=(()=>{class e extends l.a{constructor(e,t,i,n,a){super(e),this.usersService=t,this.userHelper=i,this.imagesService=n,this.nextRequestState=a,this.steps=["group","idp","fields","confirm","done"],this.customImages=[],this.customFiles=[],this.asyncValidatorsEnabled=!1,this.step$=new Ct.a(null),this.result$=new Ct.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}get result(){return this.result$.value}set result(e){this.result$.next(e)}ngOnInit(){super.ngOnInit();const e=(this.login.auth||{}).role;if(null==e){const e=this.dataForUiHolder.dataForUi;let t;if(t=this.layout.ltmd?e.smallScreenRegistrationWizard:this.layout.md?e.mediumScreenRegistrationWizard:e.largeScreenRegistrationWizard,t)return void this.router.navigate(["wizards","registration",c.a.internalNameOrId(t)],{replaceUrl:!0});this.initializeGroups(e.publicRegistrationGroups)}else this.addSub(this.usersService.getUserDataForSearch({broker:e===Me.kb.BROKER?c.a.SELF:null,fields:["groupsForRegistration"]}).subscribe(e=>{this.groupSets=e.groupsForRegistration.filter(e=>e.kind===Me.A.GROUP_SET),e.groupsForRegistration.find(e=>e.kind!==Me.A.GROUP_SET&&null==e.groupSet)&&this.groupSets.unshift(null),this.initializeGroups(e.groupsForRegistration.filter(e=>e.kind!==Me.A.GROUP_SET))}))}initializeGroups(e){null==this.groups&&(this.groups=e,Object(b.h)(this.groups)?this.router.navigateByUrl("/"):(this.group=new h.j(e[0].id,h.G.required),1===e.length?(this.steps=this.steps.filter(e=>"group"!==e),this.showIdentityProviders()):this.step="group"))}ngOnDestroy(){super.ngOnDestroy(),this.image&&(URL.revokeObjectURL(this.image.url),this.errorHandler.requestWithCustomErrorHandler(()=>{this.addSub(this.imagesService.deleteImage({idOrKey:this.image.id}).subscribe())}))}showIdentityProviders(){this.addSub(this.usersService.getUserDataForNew({group:this.group.value,fields:["-agreements.content"]}).subscribe(e=>{this.data=e,Object(b.h)(e.identityProviders)?this.showFields():this.step="idp"}))}continueWithProvider(e){e?this.authHelper.identityProviderPopup(e,"register",this.group.value).pipe(Object(No.a)()).subscribe(e=>{switch(e.status){case Me.B.REGISTRATION_DONE:this.nextRequestState.replaceSession(e.sessionToken).pipe(Object(No.a)()).subscribe(()=>{Object(b.B)(!0),this.dataForUiHolder.initialize().subscribe(e=>{Object(b.B)(!1),c.a.isRestrictedAccess(e)||this.router.navigateByUrl("")})});break;case Me.B.REGISTRATION_DATA:this.identityProviderRequestId=e.requestId,this.data.captchaType=null;const t=this.data.user;if(e.name&&(t.name=e.name),e.username&&(t.username=e.username),e.email&&(t.email=e.email),e.mobilePhone&&(t.mobilePhones=[{number:e.mobilePhone}]),e.landLinePhone&&(t.landLinePhones=[{number:e.landLinePhone,extension:e.landLineExtension}]),e.customValues){t.customValues||(t.customValues={});for(const i of Object.keys(e.customValues))t.customValues[i]=e.customValues[i]}e.image&&(t.images=[e.image.id],this.image=e.image),this.showFields();break;default:this.notification.error(e.errorMessage||this.i18n.error.general)}}):this.showFields()}showFields(){this.prepareForms(this.data),Object(b.k)()}backToGroup(){this.form=null,this.data=null,this.step="group"}backToIdentityProviders(){this.data&&!Object(b.h)(this.data.identityProviders)?this.step="idp":this.backToGroup()}backToFields(){this.confirmForm=null,this.step="fields"}prepareForms(e){let t;this.form=this.formBuilder.group({group:this.group.value,hiddenFields:[e.user.hiddenFields||[]]}),[this.mobileForm,this.landLineForm]=this.userHelper.setupRegistrationForm(this.form,e,!this.login.user),[this.addressForm,this.defineAddress,t]=this.userHelper.registrationAddressForm(e.addressConfiguration),t.forEach(e=>this.addSub(e)),this.data=e,this.step="fields"}showConfirm(){const e=new h.m({user:this.form});this.mobileForm&&e.setControl("mobile",this.mobileForm),this.landLineForm&&e.setControl("landLine",this.landLineForm),this.addressForm&&this.defineAddress.value&&e.setControl("address",this.addressForm),this.asyncValidatorsEnabled=!0;const t=Object(b.F)(e,!0);this.addSub(Object(b.u)(t).subscribe(e=>{this.asyncValidatorsEnabled=!1,e?this.doShowConfirm():Object(b.l)()}))}doShowConfirm(){const e=this.data;this.confirmForm=this.formBuilder.group({});const t=this.userHelper.passwordRegistrationForms(e);this.confirmForm.setControl("passwords",this.formBuilder.array(t)),Object(b.h)(e.securityQuestions)||(this.confirmForm.setControl("securityQuestion",this.formBuilder.control("")),this.confirmForm.setControl("securityAnswer",this.formBuilder.control("",this.userHelper.securityAnswerValidation))),Object(b.h)(e.agreements)||this.confirmForm.setControl("acceptAgreements",this.formBuilder.control([])),null!=e.captchaType&&this.confirmForm.setControl("captcha",this.authHelper.captchaFormGroup()),this.step="confirm",Object(b.y)()}register(){const e=Object(b.F)(this.confirmForm,!0);this.addSub(Object(b.u)(e).subscribe(e=>{e?this.addSub(this.usersService.createUser({body:this.userNew}).subscribe(e=>{this.result=e,this.image=null,this.step="done"})):Object(b.l)()}))}get userNew(){const e=this.form.value;e.identityProviderRequestId=this.identityProviderRequestId;const t=(this.mobileForm||{}).value,i=(this.landLineForm||{}).value,n=(this.addressForm||{}).value;return this.image&&(e.images=[this.image.id]),t&&!Object(b.a)(t.number)&&(e.mobilePhones=[t]),i&&!Object(b.a)(i.number)&&(e.landLinePhones=[i]),n&&this.defineAddress.value&&(e.addresses=[n]),Object(b.e)(this.confirmForm.value,e),e}goToLogin(){this.login.goToLoginPage("")}viewProfile(){const e=this.result;e&&this.router.navigate(["users",e.user.id,"profile"])}addCustomImages(e){this.customImages=[...this.customImages,...e]}addCustomFiles(e){this.customFiles=[...this.customFiles,...e]}resolveMenu(){switch(this.dataForUiHolder.role){case Me.kb.ADMINISTRATOR:return u.b.ADMIN_REGISTRATION;case Me.kb.BROKER:return u.b.BROKER_REGISTRATION;default:return u.b.PUBLIC_REGISTRATION}}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Io.a),g.Kb(T.a),g.Kb(yo.a),g.Kb(ol.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["user-registration"]],features:[g.ub],decls:9,vars:11,consts:[["size","large",3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1"],[3,"groupSets","groups","control"],["forceRow",""],[3,"disabled","label","action"],[3,"identityProviders","continue"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[3,"data","form","mobileForm","landLineForm","defineAddress","addressForm","image","imageUploaded","imageRemoved","customImagesUploaded","customFilesUploaded"],[3,"data","form","user","image","customImages","customFiles"],[3,"result"],[3,"label","action",4,"ngIf"],[3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.ac(2,"async"),g.Bc(3,Db,7,12,"page-content",1),g.Bc(4,Sb,8,11,"page-content",1),g.Bc(5,Nb,8,17,"page-content",1),g.Bc(6,Fb,8,16,"page-content",1),g.Bc(7,Rb,9,11,"page-content",1),g.Bc(8,kb,2,0,"page-content",2),g.Pb()),2&e&&(g.gc("ready",g.bc(1,7,t.step$))("ngSwitch",g.bc(2,9,t.step$)),g.xb(3),g.gc("ngSwitchCase","group"),g.xb(1),g.gc("ngSwitchCase","idp"),g.xb(1),g.gc("ngSwitchCase","fields"),g.xb(1),g.gc("ngSwitchCase","confirm"),g.xb(1),g.gc("ngSwitchCase","done"))},directives:[f.a,p.x,p.y,p.z,m.a,xl,x.a,y.a,Al,p.t,Jl,Eb,Cb,Zo.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function Zb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content"),g.Lb(1,"registration-step-done",2),g.Qb(2,"actions"),g.Qb(3,"action-button",3),g.Xb("action",(function(){return g.sc(e),g.Zb().goToLogin()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("result",e.result),g.xb(2),g.gc("label",e.i18n.menu.login)}}let _b=(()=>{class e extends l.a{constructor(e,t){super(e),this.validationService=t}get result(){return this.data}ngOnInit(){this.addSub(this.validationService.validateUserRegistration({key:this.route.snapshot.params.key}).subscribe(e=>{this.data=e}))}goToLogin(){this.login.goToLoginPage("")}resolveMenu(){return this.menu.homeMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Oc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["validate-registration"]],features:[g.ub],decls:3,vars:4,consts:[["size","medium","hideMenu","",3,"ready"],[4,"ngIf"],[3,"result"],[3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Zb,4,2,"page-content",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,Cb,x.a,y.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Mb=i("oWwz");const $b=["field"],Ub=function(){return{excludeContacts:!0}};let Hb=(()=>{class e extends Wa.a{constructor(e,t,i){super(e),this.modalRef=t,this.contactsService=i,this.done=new g.n,this.control=new h.j(null,h.G.required)}addContact(){if(Object(b.F)(this.control),!this.control.valid)return;const e=this.field.selection;this.addSub(this.contactsService.createContact({user:c.a.SELF,body:{contact:this.control.value}}).subscribe(()=>{this.done.emit(e),this.modalRef.hide()}))}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.a),g.Kb(Mb.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["add-contact-dialog"]],viewQuery:function(e,t){var i;1&e&&g.yc($b,!0),2&e&&g.pc(i=g.Yb())&&(t.field=i.first)},outputs:{done:"done"},features:[g.ub],decls:8,vars:12,consts:[["focused","",3,"filters","allowContacts","allowPrincipal","formControl","label"],["field",""],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Lb(2,"user-field",0,1),g.Qb(4,"actions",2),g.Qb(5,"action-button",3),g.Xb("action",(function(){return t.addContact()})),g.ac(6,"async"),g.Pb(),g.Qb(7,"action-button",4),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Ec(t.i18n.user.title.addContact),g.xb(1),g.gc("filters",g.ic(11,Ub))("allowContacts",!1)("allowPrincipal",!1)("formControl",t.control)("label",t.i18n.user.contact),g.xb(3),g.gc("disabled",g.bc(6,9,t.requesting$))("label",t.i18n.general.submit),g.xb(2),g.gc("label",t.i18n.general.cancel))},directives:[Be.a,qt.a,h.v,h.k,x.a,y.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Gb=i("+HmS");const qb=["usersResults"];function Kb(e,t){1&e&&g.Mb(0)}const Vb=function(e){return{"d-none":e}};function jb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.ac(2,"async"),g.Qb(3,"div",4),g.Lb(4,"result-type-field",5),g.ac(5,"async"),g.Pb(),g.Pb(),g.Qb(6,"users-results",6,7),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(8,"async"),g.ac(9,"async"),g.ac(10,"async"),g.ac(11,"async"),g.Pb()}if(2&e){const e=g.Zb();g.gc("ngClass",g.jc(25,Vb,g.bc(1,11,e.layout.xxs$)))("heading",e.i18n.user.title.contactList)("mobileHeading",e.i18n.user.mobileTitle.contactList)("headingActions",g.bc(2,13,e.headingActions$)),g.xb(4),g.gc("formControl",e.resultTypeControl)("allowedResultTypes",g.bc(5,15,e.allowedResultTypes$)),g.xb(2),g.gc("ngClass",g.jc(27,Vb,g.bc(8,17,e.rendering$)))("results",g.bc(9,19,e.results$))("rendering$",e.rendering$)("data",g.bc(10,21,e.data$))("resultType",g.bc(11,23,e.resultType$))}}let zb=(()=>{class e extends Qe.a{constructor(e,t,i){super(e),this.modal=t,this.contactsService=i,this.ResultType=Ya.a}getFormControlNames(){return["user","keywords"]}getInitialResultType(){return this.layout.xxs?Ya.a.LIST:Ya.a.TILES}ngOnInit(){super.ngOnInit(),this.allowedResultTypes=[Ya.a.TILES,Ya.a.LIST],this.stateManager.cache("data",this.contactsService.getContactListDataForSearch({user:c.a.SELF})).subscribe(e=>{this.data=e})}toSearchParams(e){return e.user=c.a.SELF,e}doSearch(e){return this.contactsService.searchContactList$Response(e)}onDataInitialized(e){super.onDataInitialized(e);const t=(e.fieldsInList||[]).slice();t.includes("display")||(t.unshift("display"),e.fieldsInList=t),(((this.login.auth||{}).permissions||{}).users||{}).search&&(this.headingActions=[new be.c("add",this.i18n.general.addNew,()=>this.addNew(),!0)])}addNew(){const e=this.modal.show(Hb,{class:"modal-form"});this.addSub(e.content.done.subscribe(e=>{this.notification.snackBar(this.i18n.user.profile.addContactDone(e.display)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.CONTACTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.b),g.Kb(Mb.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["contact-list"]],viewQuery:function(e,t){var i;1&e&&g.Hc(qb,!0),2&e&&g.pc(i=g.Yb())&&(t.usersResults=i.first)},features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"ngClass","heading","mobileHeading","headingActions"],[1,"filters-row"],[3,"formControl","allowedResultTypes"],["resultKind","contact",3,"ngClass","results","rendering$","data","resultType","update"],["usersResults",""]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Kb,1,0,"ng-container",1),g.Pb(),g.Bc(3,jb,12,29,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,p.q,Gb.a,h.v,h.k,Es],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Xb=i("9AzD"),Jb=i("fe3a"),Yb=i("uao2");function Wb(e,t){1&e&&g.Mb(0)}function eu(e,t){if(1&e&&(g.Qb(0,"div",14),g.Qb(1,"label-value",15),g.Lb(2,"user-link",16),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.broker)}}function tu(e,t){1&e&&g.Lb(0,"div",17)}function iu(e,t){if(1&e&&(g.Qb(0,"div",14),g.Lb(1,"input-field",18),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.general.keywords)}}function nu(e,t){if(1&e&&g.Lb(0,"field-option",21),2&e){const e=t.$implicit,i=g.Zb(4);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function au(e,t){if(1&e&&(g.Qb(0,"div",14),g.Qb(1,"multi-selection-field",19),g.Bc(2,nu,1,5,"field-option",20),g.Pb(),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("label",e.i18n.user.groupFilter),g.xb(1),g.gc("ngForOf",e.data.groups)}}function su(e,t){if(1&e&&(g.Qb(0,"div",14),g.Lb(1,"max-distance-field",31),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.gc("data",e.data.searchByDistanceData)("label",e.i18n.general.distanceFilter)}}function ou(e,t){if(1&e&&g.Lb(0,"field-option",34),2&e){const e=t.$implicit,i=g.Zb(5);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function ru(e,t){if(1&e&&(g.Qb(0,"div",14),g.Qb(1,"multi-selection-field",32),g.Bc(2,ou,1,4,"field-option",33),g.Pb(),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.assignedProducts),g.xb(1),g.gc("ngForOf",e.data.products)}}function cu(e,t){if(1&e&&g.Lb(0,"field-option",34),2&e){const e=t.$implicit,i=g.Zb(5);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function lu(e,t){if(1&e&&(g.Qb(0,"div",14),g.Qb(1,"multi-selection-field",35),g.Bc(2,cu,1,4,"field-option",33),g.Pb(),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.acceptedAgreements),g.xb(1),g.gc("ngForOf",e.data.agreements)}}function bu(e,t){if(1&e&&g.Lb(0,"field-option",34),2&e){const e=t.$implicit,i=g.Zb(5);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function uu(e,t){if(1&e&&(g.Qb(0,"div",14),g.Qb(1,"multi-selection-field",36),g.Bc(2,bu,1,4,"field-option",33),g.Pb(),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.notAcceptedAgreements),g.xb(1),g.gc("ngForOf",e.data.agreements)}}function du(e,t){if(1&e&&(g.Qb(0,"div",14),g.Lb(1,"user-field",37),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters())("allowContacts",!1)}}function gu(e,t){if(1&e&&(g.Qb(0,"div",14),g.Lb(1,"basic-profile-field-filter",38),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(4);g.xb(1),g.gc("field",e)("formControl",i.form.get("profileFields").get(e.field))}}function fu(e,t){if(1&e&&(g.Qb(0,"div",14),g.Lb(1,"custom-field-filter",38),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(4);g.xb(1),g.gc("field",e)("formControl",i.form.get("profileFields").get(e.internalName))}}function mu(e,t){if(1&e&&(g.Ob(0),g.Bc(1,su,2,2,"div",6),g.Bc(2,ru,3,3,"div",6),g.Bc(3,lu,3,3,"div",6),g.Bc(4,uu,3,3,"div",6),g.Qb(5,"div",14),g.Lb(6,"multi-selection-field",22),g.Pb(),g.Qb(7,"div",23),g.Qb(8,"div",14),g.Lb(9,"date-field",24),g.Pb(),g.Qb(10,"div",14),g.Lb(11,"date-field",25),g.Pb(),g.Pb(),g.Qb(12,"div",23),g.Qb(13,"div",14),g.Lb(14,"date-field",26),g.Pb(),g.Qb(15,"div",14),g.Lb(16,"date-field",27),g.Pb(),g.Pb(),g.Qb(17,"div",23),g.Qb(18,"div",14),g.Lb(19,"date-field",28),g.Pb(),g.Qb(20,"div",14),g.Lb(21,"date-field",29),g.Pb(),g.Pb(),g.Bc(22,du,2,3,"div",6),g.Bc(23,gu,2,2,"div",30),g.Bc(24,fu,2,2,"div",30),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("ngIf",e.data.searchByDistanceData),g.xb(1),g.gc("ngIf",(null==e.data.products?null:e.data.products.length)>1),g.xb(1),g.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>1),g.xb(1),g.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>1),g.xb(2),g.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions)("emptyLabel",e.i18n.general.notApplied),g.xb(3),g.gc("label",e.i18n.user.creationBegin),g.xb(2),g.gc("label",e.i18n.user.creationEnd),g.xb(3),g.gc("label",e.i18n.user.beginUserActivationDate),g.xb(2),g.gc("label",e.i18n.user.endUserActivationDate),g.xb(3),g.gc("label",e.i18n.user.beginLastLoginDate),g.xb(2),g.gc("label",e.i18n.user.endLastLoginDate),g.xb(1),g.gc("ngIf",!e.isBrokeringSearch),g.xb(1),g.gc("ngForOf",e.data.basicFields),g.xb(1),g.gc("ngForOf",e.customFieldsInSearch)}}function pu(e,t){if(1&e&&(g.Ob(0),g.Bc(1,au,3,2,"div",6),g.Bc(2,mu,25,16,"ng-container",8),g.ac(3,"async"),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),g.xb(1),g.gc("ngIf",g.bc(3,2,e.moreFilters$))}}function hu(e,t){if(1&e&&(g.Qb(0,"div",39),g.Qb(1,"single-selection-field",40),g.Lb(2,"field-option",41),g.Lb(3,"field-option",42),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("formControl",e.form.get("orderBy"))("display",e.i18n.general.orderBy)("emptyOption",e.i18n.general.orderByRelevance),g.xb(1),g.gc("text",e.i18n.user.orderBy.alphabeticallyAsc),g.xb(1),g.gc("text",e.i18n.user.orderBy.alphabeticallyDesc)}}function vu(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"form",4),g.Qb(3,"div",5),g.Bc(4,eu,3,2,"div",6),g.Bc(5,tu,1,0,"div",7),g.ac(6,"async"),g.Bc(7,iu,2,1,"div",6),g.Bc(8,pu,4,4,"ng-container",8),g.ac(9,"async"),g.Pb(),g.Pb(),g.Qb(10,"div",9),g.Qb(11,"div",10),g.Lb(12,"result-type-field",11),g.ac(13,"async"),g.Pb(),g.Bc(14,hu,4,5,"div",12),g.ac(15,"async"),g.ac(16,"async"),g.Pb(),g.Pb(),g.Qb(17,"users-results",13),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(18,"async"),g.ac(19,"async"),g.ac(20,"async"),g.ac(21,"async"),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.heading)("mobileHeading",e.mobileHeading)("headingActions",g.bc(1,16,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",!e.self&&e.broker),g.xb(1),g.gc("ngIf",g.bc(6,18,e.layout.gtsm$)&&!e.self&&e.broker),g.xb(2),g.gc("ngIf",e.data.allowKeywords),g.xb(1),g.gc("ngIf",g.bc(9,20,e.layout.gtxxs$)),g.xb(4),g.gc("allowedResultTypes",g.bc(13,22,e.allowedResultTypes$))("formControl",e.resultTypeControl),g.xb(2),g.gc("ngIf",g.bc(15,24,e.layout.gtxxs$)&&"map"!==g.bc(16,26,e.resultType$)),g.xb(3),g.gc("results",g.bc(18,28,e.results$))("rendering$",e.rendering$)("data",g.bc(19,30,e.data$))("resultType",g.bc(20,32,e.resultType$))("referencePoint",(g.bc(21,34,e.form.valueChanges)||e.form.value).distanceFilter)}}var xu=function(e){return e[e.Public=0]="Public",e[e.Member=1]="Member",e[e.Admin=2]="Admin",e[e.Broker=3]="Broker",e}({});let yu=(()=>{class e extends Qe.a{constructor(e,t,i,n){super(e),this.usersService=t,this.userHelper=i,this.countriesResolve=n,this.ResultType=Ya.a,this.UserSearchKind=xu,this.empty=b.h}getFormControlNames(){return["keywords","groups","customValues","distanceFilter","orderBy","statuses","beginActivationPeriod","endActivationPeriod","beginCreationPeriod","endCreationPeriod","beginLastLoginPeriod","endLastLoginPeriod","notAcceptedAgreements","acceptedAgreements","products","brokers"]}getInitialResultType(){const e=this.uiLayout.getBreakpointConfiguration("defaultUsersResultType");return e&&this.allowedResultTypes.includes(e)?e:this.layout.xxs?Ya.a.LIST:Ya.a.TILES}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||c.a.SELF,this.self=this.authHelper.isSelf(this.param);const e=this.login.auth,t=null==e?null:e.role,i=this.router.url;i.includes("search")?this.kind=null==t?xu.Public:t===Me.kb.ADMINISTRATOR?xu.Admin:xu.Member:i.includes("brokerings")&&(this.kind=xu.Broker),this.manager=[xu.Admin,xu.Broker].includes(this.kind);const n=[xu.Public,xu.Member].includes(this.kind);n?(this.heading=this.i18n.user.title.directory,this.mobileHeading=this.i18n.user.mobileTitle.directory):this.kind===xu.Broker?this.self?(this.heading=this.i18n.user.title.myBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.myBrokerings):(this.heading=this.i18n.user.title.userBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.userBrokerings):this.kind===xu.Admin&&(this.heading=this.i18n.user.title.search,this.mobileHeading=this.i18n.user.mobileTitle.search);const a=((e||{}).permissions||{}).users||{};if(this.canSearch=this.kind===xu.Broker||!!a.search,this.canViewMap=n&&a.map,!this.canSearch&&!this.canViewMap)return void this.errorHandler.handleForbiddenError({});const s=[];this.canSearch&&(s.push(Ya.a.TILES),s.push(Ya.a.LIST)),(this.canViewMap||this.manager)&&s.push(Ya.a.MAP),this.allowedResultTypes=s,this.countries$=this.countriesResolve.data,this.resultType=this.getInitialResultType(),this.onResultTypeChanged(this.resultType,null)}get statusOptions(){return Object.values(Me.Nb).map(e=>({value:e,text:this.userHelper.userStatus(e)}))}shouldUpdateOnResultTypeChange(){return!1}onResultTypeChanged(e,t){const i=e===Ya.a.MAP;(i!==(t===Ya.a.MAP)||null==t)&&(this.data=null,this.resetPage());const n=e=>{Object(b.h)(e.fieldsInList)&&(e.fieldsInList=["display"]),this.doIgnoringUpdate(()=>{this.customFieldsInSearch=e.customFields.filter(t=>e.fieldsInSearch.includes(t.internalName)),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(e.basicFields,this.customFieldsInSearch)),!this.broker&&e.broker&&(this.broker=e.broker),this.data=e,this.headingActions=[...Object(b.h)(e.fieldsInSearch)?[]:[this.moreFiltersAction],...this.exportHelper.headingActions(this.data.exportFormats,e=>this.usersService.exportUsers$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value))))]})};null==this.data&&(this.rendering=!0,i&&!this.manager?this.stateManager.cache("dataForMap",this.usersService.getDataForMapDirectory()).subscribe(n):this.stateManager.cache("dataForSearch",this.usersService.getUserDataForSearch({fromMenu:!0,broker:this.kind===xu.Broker?this.param:null})).subscribe(n))}get isBrokeringSearch(){return this.kind===xu.Broker}toSearchParams(e){const t=Object.assign({},e);this.kind===xu.Broker&&(t.brokers=[this.param]),t.activationPeriod=c.a.dateRangeFilter(e.beginActivationPeriod,e.endActivationPeriod),t.creationPeriod=c.a.dateRangeFilter(e.beginCreationPeriod,e.endCreationPeriod),t.lastLoginPeriod=c.a.dateRangeFilter(e.beginLastLoginPeriod,e.endLastLoginPeriod),t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields);const i=e.distanceFilter;i&&(t.maxDistance=i.maxDistance,t.latitude=i.latitude,t.longitude=i.longitude);const n=this.resultType===Ya.a.MAP;return t.fromMenu=this.kind!==xu.Broker,n&&(t.pageSize=99999,t.addressResult=Me.Eb.ALL),t}userSearchFilters(){return{roles:[Me.kb.BROKER]}}doSearch(e){return this.resultType!==Ya.a.MAP||this.manager?this.usersService.searchUsers$Response(e):this.usersService.searchMapDirectory$Response(e)}resolveMenu(){switch(this.kind){case xu.Broker:return u.b.MY_BROKERED_USERS;case xu.Public:return u.b.PUBLIC_DIRECTORY;default:return u.b.SEARCH_USERS}}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Io.a),g.Kb(T.a),g.Kb(s.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-users"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-md-6",4,"ngIf"],[4,"ngIf"],[1,"row","filters-row"],[1,"col-12","col-xs-7","col-md-9"],[3,"allowedResultTypes","formControl"],["class","col-12 col-xs-5 col-md-3",4,"ngIf"],[3,"results","rendering$","data","resultType","referencePoint","update"],[1,"col-12","col-md-6"],["labelPosition","side",3,"label"],[3,"user"],[1,"col-md-6"],["labelPosition","side","formControlName","keywords",3,"label"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions","emptyLabel"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["labelPosition","side","formControlName","products",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","acceptedAgreements",3,"emptyLabel","label"],["labelPosition","side","formControlName","notAcceptedAgreements",3,"emptyLabel","label"],["labelPosition","side","formControlName","brokers",3,"label","filters","allowContacts"],["labelPosition","side",3,"field","formControl"],[1,"col-12","col-xs-5","col-md-3"],[3,"formControl","display","emptyOption"],["value","alphabeticallyAsc",3,"text"],["value","alphabeticallyDesc",3,"text"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Wb,1,0,"ng-container",1),g.Pb(),g.Bc(3,vu,22,36,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Gb.a,h.v,h.k,Es,Q.a,Dt.a,Ot.a,h.l,ut.a,p.s,Le.a,Ne.a,Xb.a,Be.a,Jb.a,Yb.a,Fe.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Pu=i("XS/k");function Iu(e,t){1&e&&g.Mb(0)}function Eu(e,t){if(1&e&&(g.Qb(0,"div",11),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Gc(" ",t.i18n.general.performedBy,": ",e.by.display," ")}}function Au(e,t){if(1&e&&(g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Bc(3,Eu,2,2,"div",10),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("date",null==e.period?null:e.period.date),g.xb(2),g.Gc(" ",i.i18n.general.status,": ",i.userHelper.userStatus(e.status)," "),g.xb(1),g.gc("ngIf",e.by)}}function Cu(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td"),g.Dc(2),g.ac(3,"date"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(g.bc(3,3,null==e.period?null:e.period.begin)),g.xb(3),g.Ec(i.userHelper.userStatus(e.status)),g.xb(2),g.Ec(null==e.by?null:e.by.display)}}function Du(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Pb(),g.Qb(8,"tbody"),g.Bc(9,Cu,8,5,"tr",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function Ou(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Lb(1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,Au,4,4,"mobile-result",6),g.Bc(4,Du,10,4,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.userStatus.title.historyOperator:e.i18n.userStatus.title.historyUser)("mobileHeading",e.operator?e.i18n.userStatus.mobileTitle.historyOperator:e.i18n.userStatus.mobileTitle.historyUser),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)}}let Su=(()=>{class e extends _.a{constructor(e,t,i){super(e),this.userStatusService=t,this.userHelper=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Pu.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-status-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Iu,1,0,"ng-container",1),g.Pb(),g.Bc(3,Ou,5,4,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,$.a,U.a,H.a,G.a,p.s],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function Qu(e,t){if(1&e&&g.Lb(0,"field-option",11),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",e)("text",i.userHelper.userStatus(e))}}function Nu(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Lb(1,"hr"),g.Qb(2,"form",6),g.Qb(3,"single-selection-field",7),g.Bc(4,Qu,1,2,"field-option",8),g.Pb(),g.Lb(5,"textarea-field",9),g.Pb(),g.Qb(6,"actions"),g.Qb(7,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(2);g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("label",e.i18n.userStatus.new),g.xb(1),g.gc("ngForOf",e.data.possibleNewStatuses),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(2),g.gc("label",e.i18n.general.submit)}}function Fu(e,t){if(1&e&&(g.Qb(0,"page-content",2),g.ac(1,"async"),g.Lb(2,"user-info",3),g.Qb(3,"label-value",4),g.Dc(4),g.Pb(),g.Bc(5,Nu,8,5,"ng-container",5),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.userStatus.title.statusOperator:e.i18n.userStatus.title.statusUser)("mobileHeading",e.operator?e.i18n.userStatus.mobileTitle.statusOperator:e.i18n.userStatus.mobileTitle.statusUser)("headingActions",g.bc(1,7,e.headingActions$)),g.xb(2),g.gc("user",e.data.user),g.xb(1),g.gc("label",e.i18n.userStatus.current),g.xb(1),g.Fc(" ",e.userHelper.userStatus(e.data.status)," "),g.xb(1),g.gc("ngIf",e.editable)}}let Lu=(()=>{class e extends _.a{constructor(e,t,i){super(e),this.userStatusService=t,this.userHelper=i}get editable(){return!Object(b.h)(this.data.possibleNewStatuses)}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["-history"]}).subscribe(e=>{this.data=e})),this.form=this.formBuilder.group({status:[null,h.G.required],comment:null}),this.headingActions=[new be.c("history",this.i18n.general.viewHistory,()=>this.router.navigate(["users",this.param,"status","history"]),!0)]}save(){if(Object(b.F)(this.form),!this.form.valid)return;const e=this.form.value.status;let t;const i=this.data.user,n=this.userHelper.isOperator(i);switch(e){case Me.Nb.ACTIVE:t=this.i18n.userStatus.confirm.active(i.display);break;case Me.Nb.BLOCKED:t=this.i18n.userStatus.confirm.blocked(i.display);break;case Me.Nb.DISABLED:t=this.i18n.userStatus.confirm.disabled(i.display);break;case Me.Nb.REMOVED:t=this.i18n.userStatus.confirm.removed(i.display);break;case Me.Nb.PURGED:t=this.i18n.userStatus.confirm.purged(i.display)}let a;a=n?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,this.notification.confirm({title:a,message:t,callback:()=>this.submit(e)})}submit(e){const t=this.data.user.display;this.addSub(this.userStatusService.changeUserStatus({user:this.param,body:this.form.value}).subscribe(()=>{let i;switch(e){case Me.Nb.ACTIVE:i=this.i18n.userStatus.done.active(t);break;case Me.Nb.BLOCKED:i=this.i18n.userStatus.done.blocked(t);break;case Me.Nb.DISABLED:i=this.i18n.userStatus.done.disabled(t);break;case Me.Nb.REMOVED:i=this.i18n.userStatus.done.removed(t);break;case Me.Nb.PURGED:i=this.i18n.userStatus.done.purged(t)}this.notification.snackBar(i),this.reload()}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Pu.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-status"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","status","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[3,"label","action"],[3,"value","text"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Fu,6,9,"page-content",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,Q.a,h.I,h.w,h.n,Fe.a,h.v,h.l,h.D,p.s,St.a,x.a,y.a,Le.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Bu=i("piyO"),wu=i("Aw04");function Ru(e,t){if(1&e&&(g.Qb(0,"label-value",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.general.user),g.xb(1),g.Fc(" ",e.user.display," ")}}function ku(e,t){if(1&e&&g.Lb(0,"user-field",11),2&e){const e=g.Zb();g.gc("label",e.i18n.general.user)}}function Tu(e,t){if(1&e&&g.Lb(0,"field-option",14),2&e){const e=t.$implicit;g.gc("value",e.id)("text",e.name)}}function Zu(e,t){if(1&e&&(g.Qb(0,"single-selection-field",12),g.Bc(1,Tu,1,2,"field-option",13),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.general.operator)("emptyOption",e.i18n.general.notSet),g.xb(1),g.gc("ngForOf",g.bc(2,3,e.operators$))}}function _u(e,t){if(1&e&&g.Lb(0,"boolean-field",15),2&e){const e=g.Zb();g.gc("label",e.i18n.token.action.activate)}}function Mu(e,t){1&e&&g.Dc(0,"\xa0")}let $u=(()=>{class e extends Wa.a{constructor(e,t,i,n){super(e),this.modalRef=t,this.tokensService=i,this.operatorsService=n,this.operators$=new Ct.a(null),this.canActivate$=new Ct.a(null)}ngOnInit(){this.canActivate$.next(!!this.user),this.form=this.formBuilder.group({user:this.user?this.user.id:null,operator:null,value:[null,h.G.required],activateNow:!1}),this.user||this.form.get("user").valueChanges.subscribe(()=>this.fillOperatorsField())}fillOperatorsField(){const e=this.form.get("user").value;e?(this.canActivate$.next(!0),this.operatorsService.searchUserOperators$Response({user:e,skipTotalCount:!0,pageSize:9999999}).subscribe(e=>{var t;e.ok&&(null===(t=e.body)||void 0===t?void 0:t.length)>0?this.operators$.next(e.body):this.operators$.next(null)})):(this.canActivate$.next(!1),this.operators$.next(null))}submit(){if(Object(b.F)(this.form),!this.form.valid)return;const e=Object(d.a)(this.form.value);e.operator&&(e.user=e.operator,delete e.operator),this.tokensService.createToken({type:this.type.id,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.created),this.updateAction()}),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.a),g.Kb(Bu.a),g.Kb(Qa.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["create-token"]],inputs:{type:"type",user:"user",required:"required",updateAction:"updateAction"},features:[g.ub],decls:16,vars:18,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],["formControlName","user",3,"label",4,"ngIf"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["required","","formControlName","value",3,"mask","label","placeholder"],["formControlName","activateNow",3,"label",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["kind","fieldView","labelPosition","side",3,"label"],["formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","activateNow",3,"label"]],template:function(e,t){var i;1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Qb(2,"form",0),g.Bc(3,Ru,2,2,"label-value",1),g.Bc(4,ku,1,1,"user-field",2),g.Bc(5,Zu,3,5,"single-selection-field",3),g.ac(6,"async"),g.Lb(7,"input-field",4),g.Bc(8,_u,1,1,"boolean-field",5),g.ac(9,"async"),g.Qb(10,"actions",6),g.Qb(11,"action-button",7),g.Xb("action",(function(){return t.submit()})),g.ac(12,"async"),g.Pb(),g.Bc(13,Mu,1,0,"ng-template",null,8,g.Cc),g.Qb(15,"action-button",9),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Ec(t.i18n.token.title.new(t.type.name)),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngIf",t.user),g.xb(1),g.gc("ngIf",!t.user),g.xb(1),g.gc("ngIf",(null==(i=g.bc(6,12,t.operators$))?null:i.length)>0),g.xb(2),g.gc("mask",t.type.mask)("label",t.i18n.token.value)("placeholder",t.type.mask?t.type.mask:""),g.xb(1),g.gc("ngIf",g.bc(9,14,t.canActivate$)),g.xb(3),g.gc("label",t.i18n.general.submit)("disabled",g.bc(12,16,t.requesting$)),g.xb(4),g.gc("label",t.i18n.general.cancel))},directives:[h.I,h.w,h.n,p.t,Ot.a,h.D,h.v,h.l,wu.a,x.a,y.a,Q.a,Be.a,Fe.a,p.s,Le.a,v.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function Uu(e,t){if(1&e&&g.Lb(0,"user-info",7),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function Hu(e,t){if(1&e&&(g.Qb(0,"label-value",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.gc("label",t.i18n.general.operator),g.xb(1),g.Fc(" ",null!=e.user&&e.user.user?e.user.display:""," ")}}function Gu(e,t){if(1&e){const e=g.Rb();g.Qb(0,"mobile-result"),g.Qb(1,"div",8),g.Qb(2,"div"),g.Bc(3,Hu,2,2,"label-value",9),g.Qb(4,"label-value",10),g.Dc(5),g.Pb(),g.Qb(6,"label-value",10),g.Dc(7),g.ac(8,"date"),g.Pb(),g.Qb(9,"label-value",10),g.Dc(10),g.ac(11,"date"),g.Pb(),g.Qb(12,"label-value",10),g.Dc(13),g.ac(14,"date"),g.Pb(),g.Qb(15,"label-value",10),g.Dc(16),g.Pb(),g.Pb(),g.Qb(17,"div",11),g.Qb(18,"button",12),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(2);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Lb(19,"icon",13),g.Pb(),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("ngIf",!i.self),g.xb(1),g.gc("label",i.isNfc()?i.i18n.token.label:i.i18n.token.value),g.xb(1),g.Fc(" ",e.value," "),g.xb(1),g.gc("label",i.i18n.token.creationDate),g.xb(1),g.Fc(" ",g.bc(8,12,e.creationDate)," "),g.xb(2),g.gc("label",i.i18n.token.activationDate),g.xb(1),g.Fc(" ",g.bc(11,14,e.activationDate)," "),g.xb(2),g.gc("label",i.i18n.token.expiryDate),g.xb(1),g.Fc(" ",g.bc(14,16,e.expiryDate)," "),g.xb(2),g.gc("label",i.i18n.general.status),g.xb(1),g.Fc(" ",i.statusDisplay(e.status)," "),g.xb(2),g.gc("tooltip",i.i18n.general.view)}}function qu(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Ec(e.i18n.general.operator)}}function Ku(e,t){if(1&e&&(g.Qb(0,"td"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc("",null!=e.user&&e.user.user?e.user.display:""," ")}}function Vu(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",16),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Bc(1,Ku,2,1,"td",1),g.Qb(2,"td"),g.Dc(3),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.ac(6,"date"),g.Pb(),g.Qb(7,"td"),g.Dc(8),g.ac(9,"date"),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.ac(12,"date"),g.Pb(),g.Qb(13,"td"),g.Dc(14),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngIf",!i.self),g.xb(2),g.Ec(e.value),g.xb(2),g.Ec(g.bc(6,6,e.creationDate)),g.xb(3),g.Ec(g.bc(9,8,e.activationDate)),g.xb(3),g.Ec(g.bc(12,10,e.expiryDate)),g.xb(3),g.Ec(i.statusDisplay(e.status))}}function ju(e,t){if(1&e&&(g.Qb(0,"table",14),g.Qb(1,"thead"),g.Bc(2,qu,2,1,"th",1),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Qb(9,"th"),g.Dc(10),g.Pb(),g.Qb(11,"th"),g.Dc(12),g.Pb(),g.Pb(),g.Qb(13,"tbody"),g.Bc(14,Vu,15,12,"tr",15),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("ngIf",!e.self),g.xb(2),g.Ec(e.isNfc()?e.i18n.token.label:e.i18n.token.value),g.xb(2),g.Ec(e.i18n.token.creationDate),g.xb(2),g.Ec(e.i18n.token.activationDate),g.xb(2),g.Ec(e.i18n.token.expiryDate),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.gc("ngForOf",e.data.tokens)}}function zu(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,Uu,1,1,"user-info",3),g.Pb(),g.Qb(4,"results-layout",4),g.Bc(5,Gu,20,18,"mobile-result",5),g.Bc(6,ju,15,7,"table",6),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",null==e.data?null:e.data.type.pluralName)("mobileHeading",null==e.data?null:e.data.type.pluralName)("headingActions",g.bc(2,6,e.headingActions$))("mode",e.self?"empty":"normal"),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.tokens)}}let Xu=(()=>{class e extends l.a{constructor(e,t,i,n){super(e),this.modal=t,this.userHelper=i,this.tokenService=n}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getUserTokens({user:this.user,type:this.type}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.self=this.authHelper.isSelf(e.user),this.canCreate()&&e.type.physicalType!==Me.ab.NFC_TAG&&(this.headingActions=[new be.c("add",this.i18n.general.add,()=>{this.modal.show($u,{class:"modal-form",initialState:{type:e.type,user:e.user,required:!0,updateAction:()=>this.reload()}})},!0)]),this.canActivate()&&(this.headingActions=[new be.c("how_to_reg",this.i18n.token.action.activate,()=>{this.notification.confirm({title:this.i18n.token.action.activate,customFields:[{internalName:"value",name:this.i18n.token.value,type:Me.p.STRING,pattern:e.type.mask,required:!0}],callback:e=>this.tokenService.activateToken({user:this.user,type:this.type,body:e.customValues.value}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.expiryChanged),this.reload()})})},!0)])}isNfc(){return this.data.type.physicalType===Me.ab.NFC_TAG}canCreate(){var e;return!this.self&&(null===(e=this.dataForUiHolder.auth.permissions.tokens.user.find(e=>e.type.id===this.type))||void 0===e?void 0:e.create)}canActivate(){var e;return!!this.self&&(null===(e=this.dataForUiHolder.auth.permissions.tokens.my.find(e=>e.type.id===this.type))||void 0===e?void 0:e.activate)}statusDisplay(e){return this.userHelper.tokenStatus(e)}view(e){return["/users","tokens","view",e.id]}resolveMenu(e){return this.authHelper.isSelf(e.user)?new u.a(u.b.MY_TOKENS,{tokenType:e.type}):e.user.user&&this.authHelper.isSelf(e.user.user)?u.b.MY_OPERATORS:this.dataForUiHolder.role===Me.kb.BROKER?u.b.MY_BROKERED_USERS:u.b.SEARCH_USERS}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.b),g.Kb(T.a),g.Kb(Bu.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-token"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],["labelPosition","above",3,"label",4,"ngIf"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","search"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,zu,7,8,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,U.a,H.a,P.a,G.a,Q.a,I.b,q.a,p.s],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function Ju(e,t){1&e&&g.Mb(0)}function Yu(e,t){if(1&e&&g.Lb(0,"field-option",20),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function Wu(e,t){if(1&e&&(g.Qb(0,"div",6),g.Qb(1,"multi-selection-field",18),g.Bc(2,Yu,1,5,"field-option",19),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.user.groupFilter),g.xb(1),g.gc("ngForOf",e.data.groups)}}function ed(e,t){if(1&e){const e=g.Rb();g.Qb(0,"mobile-result"),g.Qb(1,"div",21),g.Qb(2,"div"),g.Qb(3,"label-value",22),g.Dc(4),g.Pb(),g.Qb(5,"label-value",22),g.Dc(6),g.Pb(),g.Qb(7,"label-value",22),g.Dc(8),g.ac(9,"date"),g.Pb(),g.Qb(10,"label-value",22),g.Dc(11),g.ac(12,"date"),g.Pb(),g.Qb(13,"label-value",22),g.Dc(14),g.ac(15,"date"),g.Pb(),g.Qb(16,"label-value",22),g.Dc(17),g.Pb(),g.Pb(),g.Qb(18,"div",23),g.Qb(19,"button",24),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(2);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Lb(20,"icon",25),g.Pb(),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("label",i.i18n.general.user),g.xb(1),g.Fc(" ",e.user?e.user.display:i.i18n.token.unassigned," "),g.xb(1),g.gc("label",i.isNfc()?i.i18n.token.label:i.i18n.token.value),g.xb(1),g.Fc(" ",e.value," "),g.xb(1),g.gc("label",i.i18n.token.creationDate),g.xb(1),g.Fc(" ",g.bc(9,13,e.creationDate)," "),g.xb(2),g.gc("label",i.i18n.token.activationDate),g.xb(1),g.Fc(" ",g.bc(12,15,e.activationDate)," "),g.xb(2),g.gc("label",i.i18n.token.expiryDate),g.xb(1),g.Fc(" ",g.bc(15,17,e.expiryDate)," "),g.xb(2),g.gc("label",i.i18n.general.status),g.xb(1),g.Fc(" ",i.statusDisplay(e.status)," "),g.xb(2),g.gc("tooltip",i.i18n.general.view)}}function td(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",28),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Qb(1,"td"),g.Dc(2),g.Pb(),g.Qb(3,"td"),g.Dc(4),g.Pb(),g.Qb(5,"td"),g.Dc(6),g.ac(7,"date"),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.ac(10,"date"),g.Pb(),g.Qb(11,"td"),g.Dc(12),g.ac(13,"date"),g.Pb(),g.Qb(14,"td"),g.Dc(15),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(e.user?e.user.display:i.i18n.token.unassigned),g.xb(2),g.Ec(e.value),g.xb(2),g.Ec(g.bc(7,6,e.creationDate)),g.xb(3),g.Ec(g.bc(10,8,e.activationDate)),g.xb(3),g.Ec(g.bc(13,10,e.expiryDate)),g.xb(3),g.Ec(i.statusDisplay(e.status))}}function id(e,t){if(1&e&&(g.Qb(0,"table",26),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Qb(8,"th"),g.Dc(9),g.Pb(),g.Qb(10,"th"),g.Dc(11),g.Pb(),g.Qb(12,"th"),g.Dc(13),g.Pb(),g.Pb(),g.Qb(14,"tbody"),g.Bc(15,td,16,12,"tr",27),g.ac(16,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(3),g.Ec(e.i18n.general.user),g.xb(2),g.Ec(e.isNfc()?e.i18n.token.label:e.i18n.token.value),g.xb(2),g.Ec(e.i18n.token.creationDate),g.xb(2),g.Ec(e.i18n.token.activationDate),g.xb(2),g.Ec(e.i18n.token.expiryDate),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.gc("ngForOf",null==(i=g.bc(16,7,e.results$))?null:i.results)}}function nd(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"form",4),g.Qb(3,"div",5),g.Qb(4,"div",6),g.Lb(5,"user-field",7),g.Pb(),g.Lb(6,"div",8),g.Qb(7,"div",6),g.Lb(8,"date-field",9),g.Pb(),g.Qb(9,"div",6),g.Lb(10,"date-field",10),g.Pb(),g.Lb(11,"div",8),g.Qb(12,"div",6),g.Lb(13,"date-field",11),g.Pb(),g.Qb(14,"div",6),g.Lb(15,"date-field",12),g.Pb(),g.Pb(),g.Qb(16,"div",6),g.Lb(17,"multi-selection-field",13),g.Pb(),g.Bc(18,Wu,3,2,"div",14),g.Pb(),g.Pb(),g.Qb(19,"results-layout",15),g.ac(20,"async"),g.Bc(21,ed,21,19,"mobile-result",16),g.Bc(22,id,17,9,"table",17),g.Pb()),2&e){const e=g.Zb();g.gc("heading",null==e.data?null:e.data.type.pluralName)("mobileHeading",null==e.data?null:e.data.type.pluralName)("headingActions",g.bc(1,15,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(3),g.gc("label",e.i18n.general.user),g.xb(3),g.gc("label",e.i18n.token.activationBeginDate),g.xb(2),g.gc("label",e.i18n.token.activationEndDate),g.xb(3),g.gc("label",e.i18n.token.expiryBeginDate),g.xb(2),g.gc("label",e.i18n.token.expiryEndDate),g.xb(2),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.status)("fieldOptions",e.statusOptions),g.xb(1),g.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),g.xb(1),g.gc("results",g.bc(20,17,e.results$))("rendering$",e.rendering$)}}let ad=(()=>{class e extends Qe.a{constructor(e,t,i,n){super(e),this.userHelper=t,this.modal=i,this.tokenService=n}getFormControlNames(){return["user","statuses","groups","activationBeginDate","activationEndDate","expiryBeginDate","expiryEndDate"]}ngOnInit(){super.ngOnInit(),this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getGeneralTokensDataForSearch({type:this.type}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),e.type.physicalType!==Me.ab.NFC_TAG&&(this.headingActions=[new be.c("add",this.i18n.general.add,()=>{this.modal.show($u,{class:"modal-form",initialState:{type:e.type,updateAction:()=>this.reload()}})},!0)])}doSearch(e){return this.tokenService.searchGeneralTokens$Response(e)}toSearchParams(e){const t=e;return t.type=this.type,t.activationPeriod=c.a.dateRangeFilter(e.activationBeginDate,e.activationEndDate),t.expiryPeriod=c.a.dateRangeFilter(e.expiryBeginDate,e.expiryEndDate),t}get statusOptions(){return Object.values(Me.vb).map(e=>({value:e,text:this.statusDisplay(e)}))}statusDisplay(e){return this.userHelper.tokenStatus(e)}isNfc(){return this.data.type.physicalType===Me.ab.NFC_TAG}view(e){return["/users","tokens","view",e.id]}resolveMenu(e){return new u.a(u.b.USER_TOKENS,{tokenType:e.type})}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(M.b),g.Kb(Bu.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-token"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","user",3,"label"],[1,"w-100"],["labelPosition","side","formControlName","activationBeginDate","minDate","past100","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","activationEndDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expiryBeginDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expiryEndDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],[3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","search"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ju,1,0,"ng-container",1),g.Pb(),g.Bc(3,nd,23,19,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,h.I,h.w,h.n,Be.a,h.v,h.l,Ne.a,ut.a,$.a,U.a,H.a,p.s,Le.a,G.a,Q.a,I.b,q.a],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function sd(e,t){if(1&e&&g.Lb(0,"field-option",9),2&e){const e=t.$implicit;g.gc("value",e.id)("text",e.display)}}function od(e,t){if(1&e&&(g.Qb(0,"single-selection-field",7),g.Bc(1,sd,1,2,"field-option",8),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.general.operator)("emptyOption",e.i18n.general.notSet),g.xb(1),g.gc("ngForOf",g.bc(2,3,e.operators$))}}function rd(e,t){1&e&&g.Dc(0,"\xa0")}let cd=(()=>{class e extends Wa.a{constructor(e,t,i,n){super(e),this.modalRef=t,this.tokensService=i,this.operatorsService=n,this.operators$=new Ct.a(null)}ngOnInit(){this.form=this.formBuilder.group({user:[null,h.G.required],operator:null}),this.form.get("user").valueChanges.subscribe(e=>this.fillOperatorsField(e))}fillOperatorsField(e){this.operatorsService.searchUserOperators$Response({user:e.id,skipTotalCount:!0,pageSize:999999}).subscribe(e=>{this.operators$.next(e.ok?e.body:null)})}submit(){if(Object(b.F)(this.form),!this.form.valid)return;const e=Object(d.a)(this.form.value);this.tokensService.assignToken({id:this.token,user:e.operator?e.operator:e.user}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.assigned),this.updateAction()}),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(M.a),g.Kb(Bu.a),g.Kb(Qa.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["assign-token"]],inputs:{token:"token",updateAction:"updateAction"},features:[g.ub],decls:12,vars:11,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["required","","formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"]],template:function(e,t){var i;1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Qb(2,"form",0),g.Lb(3,"user-field",1),g.Bc(4,od,3,5,"single-selection-field",2),g.ac(5,"async"),g.Qb(6,"actions",3),g.Qb(7,"action-button",4),g.Xb("action",(function(){return t.submit()})),g.ac(8,"async"),g.Pb(),g.Bc(9,rd,1,0,"ng-template",null,5,g.Cc),g.Qb(11,"action-button",6),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Ec(t.i18n.token.title.assign),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("label",t.i18n.general.user),g.xb(1),g.gc("ngIf",(null==(i=g.bc(5,7,t.operators$))?null:i.length)>0),g.xb(3),g.gc("label",t.i18n.general.submit)("disabled",g.bc(8,9,t.requesting$)),g.xb(4),g.gc("label",t.i18n.general.cancel))},directives:[h.I,h.w,h.n,Be.a,h.D,h.v,h.l,p.t,x.a,y.a,Fe.a,p.s,Le.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function ld(e,t){if(1&e&&(g.Qb(0,"label-value",7),g.Lb(1,"user-link",8),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",null!=e.data.user&&e.data.user.user?e.data.user.user:e.data.user)}}function bd(e,t){if(1&e&&(g.Qb(0,"label-value",7),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.operator),g.xb(1),g.Fc(" ",e.data.user.display," ")}}function ud(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.creationDate),g.xb(1),g.Fc(" ",g.bc(2,2,e.data.creationDate)," ")}}function dd(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.category),g.xb(1),g.Fc(" ",g.bc(2,2,e.data.activationDate)," ")}}function gd(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.status),g.xb(1),g.Fc(" ",e.statusDisplay(e.data.status)," ")}}function fd(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.token.activationDeadline),g.xb(1),g.Fc(" ",e.data.activationDeadline?g.bc(2,2,e.data.activationDeadline):e.i18n.token.noDeadline," ")}}function md(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.token.expiryDate),g.xb(1),g.Fc(" ",e.data.expiryDate?g.bc(2,2,e.data.expiryDate):e.i18n.token.noExpiryDate," ")}}function pd(e,t){1&e&&(g.Lb(0,"img",12),g.ac(1,"trust")),2&e&&g.gc("src",g.cc(1,1,t.ngIf,"url"),g.uc)}function hd(e,t){if(1&e&&(g.Qb(0,"div"),g.Lb(1,"hr",9),g.Qb(2,"div",10),g.Bc(3,pd,2,4,"img",11),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.gc("ngIf",g.bc(4,1,e.qrCodeUrl$))}}function vd(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",3),g.Bc(2,ld,2,2,"label-value",4),g.Bc(3,bd,2,2,"label-value",4),g.Qb(4,"label-value",5),g.Dc(5),g.Pb(),g.Bc(6,ud,3,4,"label-value",6),g.Bc(7,dd,3,4,"label-value",6),g.Bc(8,gd,2,2,"label-value",6),g.Bc(9,fd,3,4,"label-value",6),g.Bc(10,md,3,4,"label-value",6),g.Bc(11,hd,5,3,"div",2),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.gc("ngIf",e.showUser()),g.xb(1),g.gc("ngIf",null==e.data.user?null:e.data.user.user),g.xb(1),g.gc("label",e.valueLabel()),g.xb(1),g.Fc(" ",e.data.value," "),g.xb(1),g.gc("ngIf",e.data.creationDate),g.xb(1),g.gc("ngIf",e.data.activationDate),g.xb(1),g.gc("ngIf",e.data.status),g.xb(1),g.gc("ngIf",e.showDeadLine()),g.xb(1),g.gc("ngIf",e.showExpiryDate()),g.xb(1),g.gc("ngIf",e.isQrCode(e.data))}}const xd=[{path:"",children:[{path:"search",component:yu},{path:"brokerings",component:yu,canActivate:[o.a]},{path:":user/brokerings",component:yu,canActivate:[o.a]},{path:":user/brokers",component:tt,canActivate:[o.a]},{path:":user/brokers/history",component:lt,canActivate:[o.a]},{path:":user/brokers/new",component:Ge,canActivate:[o.a]},{path:":user/profile",component:Lc.b,resolve:{countries:s.a}},{path:":user/profile/edit",component:Dc,canActivate:[o.a],resolve:{countries:s.a}},{path:"operators",component:Ns,canActivate:[o.a]},{path:":user/operators",component:Ns,canActivate:[o.a]},{path:":user/operators/registration",component:Ja,canActivate:[o.a]},{path:"operators/:user",component:Lc.b,canActivate:[o.a]},{path:"operators/:user/edit",component:Dc,canActivate:[o.a]},{path:":user/status",component:Lu,canActivate:[o.a]},{path:":user/status/history",component:Su,canActivate:[o.a]},{path:":user/group",component:Qi,canActivate:[o.a]},{path:":user/group/history",component:Ci,canActivate:[o.a]},{path:":user/agreements",component:Oe,canActivate:[o.a]},{path:":user/agreements/history",component:le,canActivate:[o.a]},{path:"operator-groups",component:Cn,canActivate:[o.a]},{path:":user/operator-groups",component:Cn,canActivate:[o.a]},{path:":user/operator-groups/new",component:Xn,canActivate:[o.a]},{path:"operator-groups/:id",component:Sa,canActivate:[o.a]},{path:"operator-groups/:id/edit",component:Xn,canActivate:[o.a]},{path:"contacts",component:zb,canActivate:[o.a]},{path:"contacts/:user",component:Lc.b,canActivate:[o.a],resolve:{countries:s.a}},{path:":user/passwords",component:zs,canActivate:[o.a]},{path:":user/identity-providers",component:Ki,canActivate:[o.a]},{path:"registration",component:Tb,resolve:{countries:s.a}},{path:"validate-registration/:key",component:_b},{path:"connected",component:Et},{path:"alerts",component:_e},{path:"validate-email-change/:key",component:Fc},{path:":user/notification-settings",component:vn,canActivate:[o.a]},{path:"documents",component:Ut,canActivate:[o.a]},{path:":user/documents/search",component:bi,canActivate:[o.a]},{path:"documents/edit/:id",component:Bt,canActivate:[o.a]},{path:"documents/view/:id",component:hi,canActivate:[o.a]},{path:":user/documents/new",component:Bt,canActivate:[o.a]},{path:"documents/process-dynamic/:id",component:Xt,canActivate:[o.a]},{path:":user/tokens/:type",component:Xu,canActivate:[o.a]},{path:"tokens/search/:type",component:ad,canActivate:[o.a]},{path:"tokens/view/:id",component:(()=>{class e extends _.a{constructor(e,t,i,n){super(e),this.userHelper=t,this.modal=i,this.tokenService=n,this.qrCodeUrl$=new Ct.a(null)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.tokenService.viewToken({id:this.id}).subscribe(e=>this.data=e))}isQrCode(e){return e.type.physicalType===Me.ab.QR_CODE}onDataInitialized(e){this.isQrCode(e)&&this.getTokenQrCodeUrl();const t=[];e.assign&&t.push(new be.c("account_box",this.i18n.token.action.assign,()=>{e.status===Me.vb.UNASSIGNED&&this.modal.show(cd,{class:"modal-form",initialState:{token:this.id,updateAction:()=>this.reload()}})})),e.setActivationDeadline&&t.push(new be.c("calendar_today",this.i18n.token.action.changeDeadline,()=>{this.notification.confirm({title:this.i18n.token.action.changeDeadline,customFields:[{internalName:"deadline",name:this.i18n.token.activationDeadline,type:Me.p.DATE,required:!0}],callback:e=>this.tokenService.setTokenActivationDeadline({id:this.id,date:e.customValues.deadline}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.deadlineChanged))})})),e.setExpiryDate&&t.push(new be.c("calendar_today",this.i18n.token.action.changeExpiry,()=>{this.notification.confirm({title:this.i18n.token.action.changeExpiry,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:Me.p.DATE,required:!0}],callback:e=>this.tokenService.setTokenExpiryDate({id:this.id,date:e.customValues.expiry}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.expiryChanged))})})),e.block&&t.push(new be.c("lock",this.i18n.token.action.block,()=>{this.tokenService.blockToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.blocked))})),e.unblock&&t.push(new be.c("lock_open",this.i18n.token.action.unblock,()=>{this.tokenService.unblockToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.unblocked))})),e.activate&&t.push(new be.c("how_to_reg",this.i18n.token.action.activate,()=>{this.tokenService.activatePendingToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.activated))})),e.cancel&&t.push(new be.c("cancel",this.i18n.token.action.cancel,()=>{this.notification.confirm({title:this.i18n.token.action.cancel,message:this.i18n.token.action.message.cancel,callback:()=>this.tokenService.cancelToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.canceled))})})),this.headingActions=t}notifyDoneAndReload(e){this.notification.snackBar(e),this.reload()}getTokenQrCodeUrl(){this.addSub(this.tokenService.getTokenQrCode({id:this.id,size:Me.D.MEDIUM}).subscribe(e=>this.qrCodeUrl$.next(URL.createObjectURL(e))))}statusDisplay(e){return this.userHelper.tokenStatus(e)}showUser(){var e;return!(this.authHelper.isSelf(this.data.user)||(null===(e=this.data.user)||void 0===e?void 0:e.user)&&this.authHelper.isSelf(this.data.user.user))}valueLabel(){return this.data.type.physicalType===Me.ab.NFC_TAG?this.i18n.token.label:this.i18n.token.value}showDeadLine(){return this.data.status===Me.vb.ACTIVATION_EXPIRED||this.data.status===Me.vb.PENDING}showExpiryDate(){return[Me.vb.ACTIVE,Me.vb.BLOCKED,Me.vb.CANCELED,Me.vb.EXPIRED].includes(this.data.status)}resolveMenu(e){return this.dataForUiHolder.role===Me.kb.ADMINISTRATOR?new u.a(u.b.USER_TOKENS,{tokenType:e.type}):this.authHelper.isSelf(e.user)?new u.a(u.b.MY_TOKENS,{tokenType:e.type}):e.user.user&&this.authHelper.isSelf(e.user.user)?u.b.MY_OPERATORS:this.dataForUiHolder.role===Me.kb.BROKER?u.b.MY_BROKERED_USERS:u.b.SEARCH_USERS}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(M.b),g.Kb(Bu.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-token"]],features:[g.ub],decls:5,vars:9,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],[3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.ac(3,"async"),g.Bc(4,vd,12,10,"ng-container",2),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,5,t.data$)),g.xb(2),g.gc("heading",t.i18n.token.title.view(null==t.data?null:t.data.type.name))("mobileHeading",t.i18n.token.mobileTitle.view(null==t.data?null:t.data.type.name))("headingActions",g.bc(3,7,t.headingActions$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,m.a,p.t,Q.a,Dt.a],pipes:[p.b,K.a,Kt.a],encapsulation:2,changeDetection:0}),e})(),canActivate:[o.a]},{path:":user/product-assignment",component:go,canActivate:[o.a]},{path:":user/product-assignment/history",component:xo,canActivate:[o.a]},{path:":user/privacy-settings",component:R,canActivate:[o.a]},{path:":user/privacy-settings/edit",component:S,canActivate:[o.a]},{path:":user/references/search",component:el,canActivate:[o.a]},{path:"references/view/:id",component:sl,canActivate:[o.a]},{path:"references/set/:from/:to",component:nl,canActivate:[o.a]},{path:"references/edit/:id",component:nl,canActivate:[o.a]}]}];let yd=(()=>{class e{}return e.\u0275mod=g.Ib({type:e}),e.\u0275inj=g.Hb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(xd)],a.i]}),e})(),Pd=(()=>{class e{}return e.\u0275mod=g.Ib({type:e}),e.\u0275inj=g.Hb({factory:function(t){return new(t||e)},imports:[[yd,n.a]]}),e})()}}]);