(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{bnt4:function(t,e,i){"use strict";i.r(e),i.d(e,"PersonalModule",(function(){return V}));var s=i("iInd"),n=i("IbW5"),a=i("wgiT"),r=i("tAww"),o=i("rCAV"),l=i("v4xg"),c=i("QH++"),u=i("cp0P"),h=i("SxV6"),b=i("zP0r"),d=i("8Y7J"),p=i("3qho"),g=i("I0FJ"),m=i("s7LF"),f=i("yHfF"),v=i("Zilp"),y=i("IbGL"),T=i("Ae/X"),w=i("iM3x"),I=i("978R"),S=i("SVse"),x=i("sifq"),F=i("H4pW"),C=i("/kmK");function R(t,e){if(1&t&&(d.Qb(0,"mobile-result",8),d.Qb(1,"div",9),d.Dc(2),d.Pb(),d.Qb(3,"div",10),d.Dc(4),d.ac(5,"dateTime"),d.Pb(),d.Pb()),2&t){const t=e.$implicit;d.gc("avatarImage",null==t.relatedUser?null:t.relatedUser.image),d.xb(1),d.gc("tooltip",t.message),d.xb(1),d.Ec(t.subject),d.xb(1),d.gc("tooltip",t.message),d.xb(1),d.Fc(" ",d.bc(5,5,t.date)," ")}}const A=function(t){return{"font-weight-bold":t}},P=function(t,e){return{"pb-0":t,"border-0":e}};function $(t,e){if(1&t){const t=d.Rb();d.Ob(0),d.Qb(1,"tr",15),d.Xb("click",(function(){d.sc(t);const i=e.$implicit;return d.Zb(2).rowClick(i)})),d.Qb(2,"td",16),d.ac(3,"async"),d.ac(4,"async"),d.Lb(5,"avatar",17),d.Pb(),d.Qb(6,"td"),d.Dc(7),d.ac(8,"dateTime"),d.Pb(),d.Qb(9,"td"),d.Dc(10),d.Pb(),d.Qb(11,"td",13),d.Qb(12,"button",18),d.Xb("click",(function(i){d.sc(t);const s=e.$implicit;return d.Zb(2).remove(s),i.stopPropagation()})),d.Lb(13,"icon",19),d.Pb(),d.Pb(),d.Pb(),d.Nb()}if(2&t){const t=e.$implicit,i=d.Zb(2);d.xb(1),d.gc("ngClass",d.jc(13,A,!t.read)),d.xb(1),d.gc("ngClass",d.kc(15,P,d.bc(3,7,i.layout.xxs$),d.bc(4,9,i.layout.xxs$))),d.xb(3),d.gc("image",null==t.relatedUser?null:t.relatedUser.image)("tooltip",null==t.relatedUser?null:t.relatedUser.display),d.xb(2),d.Ec(d.bc(8,11,t.date)),d.xb(3),d.Ec(t.message),d.xb(2),d.gc("tooltip",i.i18n.notification.actions.remove)}}function O(t,e){if(1&t&&(d.Qb(0,"table",11),d.Qb(1,"thead"),d.Lb(2,"th",12),d.Qb(3,"th"),d.Dc(4),d.Pb(),d.Qb(5,"th"),d.Dc(6),d.Pb(),d.Lb(7,"th",13),d.Pb(),d.Qb(8,"tbody"),d.Bc(9,$,14,18,"ng-container",14),d.ac(10,"async"),d.Pb(),d.Pb()),2&t){const t=d.Zb();var i;d.xb(4),d.Ec(t.i18n.general.date),d.xb(2),d.Ec(t.i18n.notification.message),d.xb(3),d.gc("ngForOf",null==(i=d.bc(10,3,t.results$))?null:i.results)}}let k=(()=>{class t extends l.a{constructor(t,e){super(t),this.notificationsService=e}ngOnInit(){super.ngOnInit(),this.data={},this.addSub(this.notificationsService.markAsViewed().pipe(Object(h.a)()).subscribe(()=>{const t=this.notification.notificationsStatus$,e=Object.assign({},t.value);e.lastViewDate=this.dataForUiHolder.now().toISOString(),e.newNotifications=0,t.next(e),this.addSub(this.notification.notificationsStatus$.pipe(Object(b.a)(1)).subscribe(()=>this.update()))})),this.addSub(this.results$.subscribe(t=>{const e=[],i=(t?t.results:null)||[];i.filter(t=>!t.read).length>0&&e.push(new r.c("done_all",this.i18n.notification.actions.markAllRead,()=>this.markAllRead())),i.length>0&&e.push(new r.c("clear",this.i18n.notification.actions.removeAll,()=>this.removeAll())),this.headingActions=e}))}rowClick(t){this.addSub(this.notificationsService.markNotificationsAsRead({ids:[t.id]}).subscribe());const e=this.path(t);e&&this.router.navigateByUrl(e)}remove(t){this.addSub(this.notificationsService.deleteNotification({id:t.id}).subscribe(()=>this.update()))}path(t){return o.a.notificationPath(t)}markAllRead(){this.addSub(this.notificationsService.markNotificationsAsRead({ids:this.ids}).subscribe(()=>this.update()))}removeAll(){const t=[];for(const e of this.ids)t.push(this.notificationsService.deleteNotification({id:e}));this.addSub(Object(u.a)(t).pipe(Object(h.a)()).subscribe(()=>this.update()))}get ids(){return this.results&&this.results.results?this.results.results.map(t=>t.id):[]}getFormControlNames(){return["onlyUnread"]}toSearchParams(t){return t}doSearch(t){return this.notificationsService.searchNotifications$Response(t)}get onClick(){return t=>this.rowClick(t)}resolveMenu(){return c.b.NOTIFICATIONS}}return t.\u0275fac=function(e){return new(e||t)(d.Kb(d.r),d.Kb(a.a))},t.\u0275cmp=d.Eb({type:t,selectors:[["search-notifications"]],features:[d.ub],decls:11,vars:12,consts:[["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","sideForced","formControlName","onlyUnread",3,"label"],["resultType","list",3,"results","onClick","rendering$","update"],["avatarIcon","notifications_none",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarIcon","notifications_none",3,"avatarImage"],[1,"cell-main",3,"tooltip"],[1,"cell-cell-date",3,"tooltip"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"actions"],[4,"ngFor","ngForOf"],[3,"ngClass","click"],[1,"avatar",3,"ngClass"],["icon","notifications_none",3,"image","tooltip"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"]],template:function(t,e){1&t&&(d.Qb(0,"page-layout"),d.Qb(1,"page-content",0),d.ac(2,"async"),d.Qb(3,"form",1),d.Qb(4,"div",2),d.Qb(5,"div",3),d.Lb(6,"boolean-field",4),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(7,"results-layout",5),d.Xb("update",(function(t){return e.update(t)})),d.ac(8,"async"),d.Bc(9,R,6,7,"mobile-result",6),d.Bc(10,O,11,5,"table",7),d.Pb(),d.Pb()),2&t&&(d.xb(1),d.gc("heading",e.i18n.notification.title)("mobileHeading",e.i18n.notification.mobileTitle)("headingActions",d.bc(2,8,e.headingActions$)),d.xb(2),d.gc("formGroup",e.form),d.xb(3),d.gc("label",e.i18n.notification.onlyUnread),d.xb(1),d.gc("results",d.bc(8,10,e.results$))("onClick",e.onClick)("rendering$",e.rendering$))},directives:[p.a,g.a,m.I,m.w,m.n,f.a,m.v,m.l,v.a,y.a,T.a,w.a,I.b,S.s,S.q,x.a,F.a],pipes:[S.b,C.a],encapsulation:2,changeDetection:0}),t})();var L=i("uuU0"),E=i("wR2l"),Q=i("chz4");const U=[{path:"",children:[{path:"notifications",component:k,canActivate:[n.a],data:{menu:c.b.NOTIFICATIONS}},{path:"settings",component:(()=>{class t extends L.a{constructor(t){super(t)}ngOnInit(){super.ngOnInit(),this.darkThemeControl=new m.j(this.layout.darkTheme),this.addSub(this.darkThemeControl.valueChanges.subscribe(t=>{this.layout.darkTheme=t}))}resolveMenu(){return c.b.SETTINGS}}return t.\u0275fac=function(e){return new(e||t)(d.Kb(d.r))},t.\u0275cmp=d.Eb({type:t,selectors:[["manage-settings"]],features:[d.ub],decls:5,vars:8,consts:[["last","",3,"heading","mobileHeading"],[3,"label","formControl"],[3,"value","text"]],template:function(t,e){1&t&&(d.Qb(0,"page-layout"),d.Qb(1,"page-content",0),d.Qb(2,"radio-group-field",1),d.Lb(3,"field-option",2),d.Lb(4,"field-option",2),d.Pb(),d.Pb(),d.Pb()),2&t&&(d.xb(1),d.gc("heading",e.i18n.setting.title)("mobileHeading",e.i18n.setting.mobileTitle),d.xb(1),d.gc("label",e.i18n.setting.theme)("formControl",e.darkThemeControl),d.xb(1),d.gc("value",!1)("text",e.i18n.setting.themeLight),d.xb(1),d.gc("value",!0)("text",e.i18n.setting.themeDark))},directives:[p.a,g.a,E.a,m.v,m.k,Q.a],encapsulation:2,changeDetection:0}),t})(),canActivate:[n.a],data:{menu:c.b.SETTINGS}}]}];let N=(()=>{class t{}return t.\u0275mod=d.Ib({type:t}),t.\u0275inj=d.Hb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(U)],s.i]}),t})();var M=i("Se2V");let V=(()=>{class t{}return t.\u0275mod=d.Ib({type:t}),t.\u0275inj=d.Hb({factory:function(e){return new(e||t)},imports:[[N,M.a]]}),t})()},v4xg:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var s=i("s7LF"),n=i("mwYl"),a=i("tAww"),r=i("rCAV"),o=i("uuU0"),l=i("Ky6R"),c=i("TFmz"),u=i("Muja"),h=i("2Vo4"),b=i("Kj3r"),d=i("8Y7J");let p=(()=>{class t extends o.a{constructor(t){super(t),this.ResultType=c.a,this.resultType$=new h.a(null),this.resultTypeControl=new s.j(null),this.results$=new h.a(null),this.allowedResultTypes$=new h.a([c.a.LIST]),this.rendering$=new h.a(!1),this.moreFilters$=new h.a(!1),this.ignoreNextUpdate=!1,this.nextRequestState=t.get(n.a);const e={page:0};e.resultType=this.getInitialResultType();for(const i of this.getFormControlNames()||[])e[i]=null;this.form=this.formBuilder.group(e)}getInitialFormValue(t){return t.query||{}}onDataInitialized(t){this.form.patchValue(this.getInitialFormValue(t)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe(t=>{const e=this.previousResultType;this.previousResultType=t,this.resultType$.next(t),this.shouldUpdateOnResultTypeChange(t,e)&&this.update(),null!=e&&e===t||(this.rendering=!0,this.stateManager.set("resultType",t),this.onResultTypeChanged(t,e))})),setTimeout(()=>{this.addSub(this.form.valueChanges.pipe(Object(b.a)(r.a.DEBOUNCE_TIME)).subscribe(t=>{this.shouldUpdateOnChange(t)&&this.update(),this.previousValue=t}),!0),this.previousResultType!==c.a.CATEGORIES&&this.update()},1)}shouldUpdateOnResultTypeChange(t,e){return t!==c.a.CATEGORIES&&([c.a.LIST,c.a.TILES].includes(e)!==[c.a.LIST,c.a.TILES].includes(t)||e===c.a.MAP!=(t===c.a.MAP))}shouldUpdateOnChange(t){return!Object(u.a)(this.previousValue,t)}get results(){return this.results$.value}set results(t){this.results$.next(t)}get rendering(){return this.rendering$.value}set rendering(t){this.rendering$.next(t)}get allowedResultTypes(){return this.allowedResultTypes$.value}set allowedResultTypes(t){this.allowedResultTypes$.next(t)}get moreFilters(){return this.moreFilters$.value}set moreFilters(t){this.moreFilters$.next(t)}get pageData(){const t=this.form.value;return{page:t.page,pageSize:t.pageSize}}set pageData(t){this.form.patchValue(t)}get resultType(){return this.resultTypeControl.value}set resultType(t){null==t&&(t=this.getInitialResultType()),this.resultTypeControl.setValue(t)}ngOnInit(){super.ngOnInit(),this.resultType=this.getInitialResultType()}get moreFiltersAction(){return this._moreFiltersAction||(this._moreFiltersAction=new a.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),()=>{this.moreFilters=!this.moreFilters,this._moreFiltersAction.icon=this.moreFilters?this.showLessFiltersIcon():this.showMoreFiltersIcon(),this._moreFiltersAction.label=this.moreFilters?this.showLessFiltersLabel():this.showMoreFiltersLabel()},!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}showMoreFiltersLabel(){return this.i18n.general.showMoreFilters}showLessFiltersLabel(){return this.i18n.general.showLessFilters}showMoreFiltersIcon(){return"filter_list"}showLessFiltersIcon(){return"filter_list"}onResultTypeChanged(t,e){}getInitialResultType(){return c.a.LIST}update(t){if(this.ignoreNextUpdate)return;t&&(this.form.patchValue(t,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;const e=this.form.value;e.pageSize=this.uiLayout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(e)).subscribe(t=>{this.resultType===c.a.CATEGORIES&&(this.resultType=this.allowedResultTypes.find(t=>t!==c.a.CATEGORIES)),this.results=l.a.from(t)}))}resetPage(t=!1){this.form.patchValue({page:0},{emitEvent:t})}doIgnoringUpdate(t){this.ignoreNextUpdate=!0;try{t()}finally{this.ignoreNextUpdate=!1}}}return t.\u0275fac=function(e){return new(e||t)(d.Kb(d.r))},t.\u0275dir=d.Fb({type:t,features:[d.ub]}),t})()}}]);