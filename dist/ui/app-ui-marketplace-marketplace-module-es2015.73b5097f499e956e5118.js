(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{QScs:function(e,t,i){"use strict";i.r(t),i.d(t,"MarketplaceModule",(function(){return Cc}));var a=i("iInd"),n=i("s7LF"),r=i("Etr0"),c=i("uuU0"),s=i("ObUu"),o=i("QH++"),l=i("8Y7J"),b=i("3qho"),d=i("SVse"),u=i("I0FJ"),m=i("JFlR"),g=i("Ls5z"),f=i("sifq"),h=i("YG2p"),p=i("UXR7"),v=i("OTwK"),y=i("/kmK");function x(e,t){if(1&e&&(l.Qb(0,"div",11),l.Lb(1,"avatar",12),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("roundBorders",!1)("zoom",!1)("image",e.data.advertisement.image)}}function P(e,t){if(1&e&&(l.Qb(0,"div",13),l.Lb(1,"avatar",12),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("roundBorders",!1)("zoom",!1)("image",e.data.advertisement.image)}}function I(e,t){if(1&e&&l.Lb(0,"textarea-field",14),2&e){const e=l.Zb(2);l.gc("formControl",e.answer)}}function Q(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",e.data.answer," ")}}function D(e,t){if(1&e){const e=l.Rb();l.Qb(0,"actions"),l.Qb(1,"action-button",15),l.Xb("action",(function(){return l.sc(e),l.Zb(2).submit()})),l.ac(2,"async"),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(2);l.xb(1),l.gc("disabled",l.bc(2,2,e.requesting$))("label",e.i18n.general.submit)}}const S=function(e){return{"pt-1":e}};function k(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"page-content",2),l.Bc(2,x,2,3,"div",3),l.ac(3,"async"),l.Qb(4,"div",4),l.Bc(5,P,2,3,"div",5),l.ac(6,"async"),l.Qb(7,"div",6),l.Qb(8,"label-value",7),l.Dc(9),l.Pb(),l.Qb(10,"label-value",7),l.Lb(11,"user-link",8),l.Pb(),l.Qb(12,"label-value",7),l.Dc(13),l.ac(14,"dateTime"),l.Pb(),l.Qb(15,"label-value",7),l.Dc(16),l.Pb(),l.Qb(17,"label-value",9),l.Bc(18,I,1,1,"textarea-field",10),l.Bc(19,Q,2,1,"ng-container",1),l.Pb(),l.Pb(),l.Pb(),l.Bc(20,D,3,4,"actions",1),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.answerQuestion)("mobileHeading",e.i18n.ad.mobileTitle.answerQuestion),l.xb(1),l.gc("ngIf",e.data.advertisement.image&&l.bc(3,18,e.layout.ltsm$)),l.xb(3),l.gc("ngIf",e.data.advertisement.image&&l.bc(6,20,e.layout.gtxs$)),l.xb(3),l.gc("label",e.i18n.ad.name),l.xb(1),l.Fc(" ",e.data.advertisement.name," "),l.xb(1),l.gc("label",e.i18n.general.by),l.xb(1),l.gc("user",e.data.user),l.xb(1),l.gc("label",e.i18n.general.date),l.xb(1),l.Fc(" ",l.bc(14,22,e.data.questionDate)," "),l.xb(2),l.gc("label",e.i18n.ad.question),l.xb(1),l.Fc(" ",e.data.question," "),l.xb(1),l.gc("ngClass",l.jc(24,S,!e.data.answer))("label",e.i18n.ad.answer)("required",!e.data.answer),l.xb(1),l.gc("ngIf",!e.data.answer),l.xb(1),l.gc("ngIf",e.data.answer),l.xb(1),l.gc("ngIf",!e.data.answer)}}let w=(()=>{class e extends c.a{constructor(e,t){super(e),this.adQuestionService=t,this.answer=new n.j(null,n.G.required)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.adQuestionService.getAdQuestion({id:this.id}).subscribe(e=>this.data=e))}submit(){Object(s.F)(this.answer),this.answer.valid&&this.addSub(this.adQuestionService.answerAdQuestion({id:this.id,body:this.answer.value}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.questionAnswered),this.router.navigate(["/marketplace","unanswered-questions"],{replaceUrl:!0})}))}resolveMenu(){return o.b.UNANSWERED_QUESTIONS}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(r.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["answer-form"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],["class","d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["class","image ml-4",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label"],[3,"user"],[3,"ngClass","label","required"],["required","true",3,"formControl",4,"ngIf"],[1,"d-flex","justify-content-center","mt-2","mb-4"],["size","120","useLightbox","",3,"roundBorders","zoom","image"],[1,"image","ml-4"],["required","true",3,"formControl"],[3,"disabled","label","action"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,k,21,26,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,m.a,g.a,d.q,f.a,h.a,n.D,n.v,n.k,p.a,v.a],pipes:[d.b,y.a],encapsulation:2,changeDetection:0}),e})();var C=i("XDzf"),O=i("r1tM"),F=i("MYKl"),B=i("FdgP"),L=i("9d5G"),N=i("XIp8"),A=i("2Vo4"),T=i("wR2l"),$=i("chz4"),Z=i("N7zh"),E=i("qCwG"),M=i("Kj3r"),R=i("Zilp"),H=i("IbGL"),q=i("Ae/X"),G=i("iM3x"),V=i("978R"),j=i("H4pW"),z=i("iXUt"),K=i("I9hm");function U(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",9),l.Qb(1,"button",10),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(2).changeQuantity.emit([null,i,!1]),t.stopPropagation(),t.preventDefault()})),l.Lb(2,"icon",11),l.Pb(),l.Qb(3,"button",12),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(2).remove.emit(i),t.stopPropagation(),t.preventDefault()})),l.Lb(4,"icon",13),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(3);l.xb(1),l.gc("tooltip",e.i18n.ad.changeQuantity),l.xb(2),l.gc("tooltip",e.i18n.general.remove)}}function X(e,t){if(1&e&&(l.Qb(0,"mobile-result",5),l.Qb(1,"div",6),l.Qb(2,"div"),l.Qb(3,"div",7),l.Dc(4),l.ac(5,"currency"),l.Pb(),l.Qb(6,"div",7),l.Dc(7),l.Pb(),l.Qb(8,"div",7),l.Dc(9),l.ac(10,"currency"),l.Pb(),l.Qb(11,"div",7),l.Dc(12),l.Pb(),l.Pb(),l.Bc(13,U,5,2,"div",8),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(2);l.gc("avatarImage",e.product.image)("title",e.product.name),l.xb(4),l.Gc(" ",i.i18n.transaction.amount,": ",l.cc(5,11,e.totalPrice,i.currency)," "),l.xb(3),l.Gc(" ",i.i18n.ad.number,": ",e.product.productNumber," "),l.xb(2),l.Gc(" ",i.i18n.ad.unitPrice,": ",l.cc(10,14,e.price,i.currency)," "),l.xb(3),l.Gc(" ",i.i18n.ad.quantity,": ",i.resolveQuantityLabel(e)," "),l.xb(1),l.gc("ngIf",i.detailed)}}function _(e,t){1&e&&l.Lb(0,"table")}function W(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"results-layout",2),l.Bc(2,X,14,17,"mobile-result",3),l.Bc(3,_,1,0,"table",4),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("results",e.items)("toLink",e.detailed?e.toLink:null)("embedded",!0)}}function Y(e,t){1&e&&l.Lb(0,"th",22)}function J(e,t){if(1&e&&l.Lb(0,"decimal-field",33),2&e){const e=l.Zb(2).$implicit,t=l.Zb(2);l.gc("formControlName",e.id)("minRange",t.minItemsRange(e))("maxRange",t.maxItemsRange(e))("customValueLabel",t.i18n.ad.customQuantity)("scale",e.product.allowDecimalQuantity?2:0)}}function ee(e,t){if(1&e&&(l.Qb(0,"form",31),l.Bc(1,J,1,5,"decimal-field",32),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(2);l.gc("formGroup",t.form),l.xb(1),l.gc("ngIf",t.isAvailable(e))}}function te(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.Nb()),2&e){const e=l.Zb().$implicit,t=l.Zb(2);l.xb(1),l.Fc(" ",t.resolveQuantityLabel(e)," ")}}function ie(e,t){if(1&e){const e=l.Rb();l.Qb(0,"button",10),l.Xb("click",(function(t){l.sc(e);const i=l.Zb(2).$implicit;return l.Zb(2).changeQuantity.emit([null,i,!1]),t.stopPropagation()})),l.Lb(1,"icon",11),l.Pb()}if(2&e){const e=l.Zb(4);l.gc("tooltip",e.i18n.ad.changeQuantity)}}const ae=function(e){return{"border-bottom-0":e}},ne=function(e){return{"ml-3":e}};function re(e,t){if(1&e){const e=l.Rb();l.Qb(0,"td",34),l.Bc(1,ie,2,1,"button",35),l.ac(2,"async"),l.Qb(3,"button",36),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(2).remove.emit(i),t.stopPropagation()})),l.ac(4,"async"),l.Lb(5,"icon",13),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(),t=e.last,i=e.$implicit,a=l.Zb(2);l.gc("ngClass",l.jc(8,ae,t)),l.xb(1),l.gc("ngIf",!a.useForm(l.bc(2,4,a.layout.gtsm$))&&a.isAvailable(i)),l.xb(2),l.gc("tooltip",a.i18n.general.remove)("ngClass",l.jc(10,ne,!a.useForm(l.bc(4,6,a.layout.gtsm$))&&a.isAvailable(i)))}}const ce=function(e,t,i){return{"pb-0":e,"border-0":t,"border-bottom-0":i}},se=function(e,t){return{link:e,"border-bottom-0":t}},oe=function(e){return{"text-decoration":e}};function le(e,t){if(1&e){const e=l.Rb();l.Qb(0,"tr"),l.Qb(1,"td",23),l.ac(2,"async"),l.ac(3,"async"),l.Lb(4,"avatar",24),l.Pb(),l.Qb(5,"td",25),l.Xb("click",(function(){l.sc(e);const i=t.$implicit;return l.Zb(2).navigate(i)})),l.Qb(6,"span"),l.Dc(7),l.Pb(),l.Pb(),l.Qb(8,"td",26),l.Dc(9),l.Pb(),l.Qb(10,"td",26),l.Bc(11,ee,2,2,"form",27),l.ac(12,"async"),l.Bc(13,te,2,1,"ng-container",28),l.ac(14,"async"),l.Pb(),l.Qb(15,"td",29),l.Dc(16),l.ac(17,"currency"),l.Pb(),l.Qb(18,"td",29),l.Dc(19),l.ac(20,"currency"),l.Pb(),l.Bc(21,re,6,12,"td",30),l.Pb()}if(2&e){const e=t.$implicit,i=t.last,a=l.Zb(2);l.xb(1),l.gc("ngClass",l.lc(30,ce,l.bc(2,16,a.layout.xxs$),l.bc(3,18,a.layout.xxs$),i)),l.xb(3),l.gc("image",e.product.image)("tooltip",e.product.name),l.xb(1),l.gc("ngClass",l.kc(34,se,a.detailed,i))("ngStyle",l.jc(37,oe,a.isAvailable(e)?"":"line-through")),l.xb(2),l.Ec(e.product.name),l.xb(1),l.gc("ngClass",l.jc(39,ae,i)),l.xb(1),l.Fc(" ",e.product.productNumber,""),l.xb(1),l.gc("ngClass",l.jc(41,ae,i)),l.xb(1),l.gc("ngIf",a.useForm(l.bc(12,20,a.layout.gtsm$))),l.xb(2),l.gc("ngIf",!a.useForm(l.bc(14,22,a.layout.gtsm$))),l.xb(2),l.gc("ngClass",l.jc(43,ae,i)),l.xb(1),l.Fc(" ",l.cc(17,24,e.price,a.currency)," "),l.xb(2),l.gc("ngClass",l.jc(45,ae,i)),l.xb(1),l.Fc(" ",l.cc(20,27,e.totalPrice,a.currency),""),l.xb(2),l.gc("ngIf",a.detailed)}}function be(e,t){if(1&e&&(l.Qb(0,"h2",14),l.Dc(1),l.Pb(),l.Qb(2,"table",15),l.Qb(3,"thead"),l.Qb(4,"th",16),l.Dc(5),l.Pb(),l.Qb(6,"th",17),l.Dc(7),l.Pb(),l.Qb(8,"th",18),l.Dc(9),l.Pb(),l.Qb(10,"th",19),l.Dc(11),l.Pb(),l.Qb(12,"th",19),l.Dc(13),l.Pb(),l.Bc(14,Y,1,0,"th",20),l.Pb(),l.Qb(15,"tbody"),l.Bc(16,le,22,47,"tr",21),l.Pb(),l.Pb()),2&e){const e=l.Zb();l.xb(1),l.Fc("",e.i18n.ad.products," "),l.xb(4),l.Ec(e.i18n.ad.product),l.xb(2),l.Ec(e.i18n.ad.number),l.xb(2),l.Ec(e.i18n.ad.quantity),l.xb(2),l.Ec(e.i18n.ad.unitPrice),l.xb(2),l.Ec(e.i18n.transaction.amount),l.xb(1),l.gc("ngIf",e.detailed),l.xb(2),l.gc("ngForOf",e.items)}}let de=(()=>{class e extends E.a{constructor(e,t){super(e),this.marketplaceHelper=t,this.changeQuantity=new l.n,this.remove=new l.n}ngOnInit(){super.ngOnInit(),this.detailed&&(this.form=this.formBuilder.group({}),this.items.forEach(e=>{const t=this.formBuilder.control(e.quantity,{updateOn:"blur"});this.form.addControl(e.id,t),setTimeout(()=>{this.addSub(t.valueChanges.pipe(Object(M.a)(this.ApiHelper.DEBOUNCE_TIME)).subscribe(t=>{this.changeQuantity.emit([t,e,!0])}),!0)},1)}))}useForm(e){return this.detailed&&e}isAvailable(e){return e.availability===C.pb.AVAILABLE}path(e){return["/marketplace","view",e.product.id]}get toLink(){return e=>this.path(e)}navigate(e){this.detailed&&this.router.navigate(this.path(e))}minItemsRange(e){return e.product.allowDecimalQuantity?null:e.product.minAllowedInCart?+e.product.minAllowedInCart:1}maxItemsRange(e){return e.product.allowDecimalQuantity?null:e.product.maxAllowedInCart?+e.product.maxAllowedInCart:e.product.minAllowedInCart?+e.product.minAllowedInCart+10:10}resolveQuantityLabel(e){switch(e.availability){case C.pb.AVAILABLE:return this.marketplaceHelper.getFormattedQuantity(e);case C.pb.OUT_OF_STOCK:return this.i18n.ad.outOfStock;case C.pb.UNAVAILABLE:return this.i18n.ad.itemNotAvailable}return""}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(B.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["shopping-cart-items"]],inputs:{detailed:"detailed",items:"items",currency:"currency"},outputs:{changeQuantity:"changeQuantity",remove:"remove"},features:[l.ub],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["largeTable",""],["resultType","list",3,"results","toLink","embedded"],["avatarIcon","shopping_basket",3,"avatarImage","title",4,"mobileResult"],[4,"resultTable"],["avatarIcon","shopping_basket",3,"avatarImage","title"],[1,"d-flex"],[1,"cell-text"],["class","ml-auto text-right d-flex flex-column",4,"ngIf"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","edit"],[1,"btn","btn-icon","mt-2",3,"tooltip","click"],["icon","delete"],[1,"mt-4","mb-2"],[1,"table","table-hover"],["colspan","2",1,"avatar","no-border"],[1,"no-border"],["width","10%",1,"no-border"],[1,"text-right","no-border"],["class","actions no-border",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions","no-border"],[1,"avatar",3,"ngClass"],["icon","shopping_basket",3,"image","tooltip"],["width","30%",3,"ngClass","ngStyle","click"],[3,"ngClass"],[3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"text-right",3,"ngClass"],["class","actions actions-multiple",3,"ngClass",4,"ngIf"],[3,"formGroup"],[3,"formControlName","minRange","maxRange","customValueLabel","scale",4,"ngIf"],[3,"formControlName","minRange","maxRange","customValueLabel","scale"],[1,"actions","actions-multiple",3,"ngClass"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","ngClass","click"]],template:function(e,t){if(1&e&&(l.Bc(0,W,4,3,"ng-container",0),l.ac(1,"async"),l.Bc(2,be,17,8,"ng-template",null,1,l.Cc)),2&e){const e=l.qc(3);l.gc("ngIf",l.bc(1,2,t.layout.ltsm$))("ngIfElse",e)}},directives:[d.t,R.a,H.a,q.a,G.a,V.b,j.a,d.s,d.q,f.a,d.w,n.I,n.w,n.n,z.a,n.v,n.l],pipes:[d.b,K.a],encapsulation:2,changeDetection:0}),e})();var ue=i("lS/A"),me=i("bBjs");function ge(e,t){if(1&e&&l.Lb(0,"field-option",11),2&e){const e=t.$implicit;l.gc("value",e.id)("text",e.name)}}function fe(e,t){if(1&e&&(l.Qb(0,"label-value",13),l.Dc(1),l.Pb()),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.minDeliveryTime),l.xb(1),l.Fc(" ",e.format.formatTimeInterval(e.deliveryMethod.minDeliveryTime)," ")}}function he(e,t){if(1&e&&(l.Qb(0,"label-value",13),l.Dc(1),l.Pb()),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.maxDeliveryTime),l.xb(1),l.Fc(" ",e.format.formatTimeInterval(e.deliveryMethod.maxDeliveryTime)," ")}}function pe(e,t){if(1&e&&(l.Ob(0),l.Bc(1,fe,2,2,"label-value",12),l.Bc(2,he,2,2,"label-value",12),l.Qb(3,"label-value",13),l.Dc(4),l.ac(5,"currency"),l.Pb(),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("ngIf",e.deliveryMethod.minDeliveryTime),l.xb(1),l.gc("ngIf",e.deliveryMethod.maxDeliveryTime),l.xb(1),l.gc("label",e.i18n.ad.price),l.xb(1),l.Fc(" ",e.negotiated?e.i18n.ad.negotiated:l.cc(5,4,e.deliveryMethod.chargeAmount,e.deliveryMethod.chargeCurrency)," ")}}function ve(e,t){if(1&e){const e=l.Rb();l.Qb(0,"page-content",3),l.ac(1,"async"),l.Qb(2,"form",4),l.Qb(3,"div",5),l.Qb(4,"radio-group-field",6),l.Bc(5,ge,1,2,"field-option",7),l.Pb(),l.Pb(),l.Pb(),l.Qb(6,"h2"),l.Dc(7),l.Pb(),l.Bc(8,pe,6,7,"ng-container",8),l.ac(9,"async"),l.Qb(10,"actions",9),l.Qb(11,"action-button",10),l.Xb("action",(function(){return l.sc(e),l.Zb().next()})),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=l.Zb();l.gc("heading",e.i18n.ad.title.deliveryMethod)("mobileHeading",e.i18n.ad.mobileTitle.deliveryMethod)("mode",l.bc(1,10,e.layout.ltsm$)?"fullHeight":"normal"),l.xb(2),l.gc("formGroup",e.form),l.xb(2),l.gc("asColumn",e.data.deliveryMethods.length>3)("label",e.i18n.ad.chooseDeliveryMethod),l.xb(1),l.gc("ngForOf",e.data.deliveryMethods),l.xb(2),l.Ec(e.i18n.ad.deliveryInformation),l.xb(1),l.gc("ngIf",l.bc(9,12,e.deliveryMethod$)),l.xb(3),l.gc("label",e.i18n.general.next)}}function ye(e,t){if(1&e&&l.Lb(0,"field-option",11),2&e){const e=t.$implicit;l.gc("value",e.id)("text",e.name)}}function xe(e,t){1&e&&l.Dc(0,"\xa0")}function Pe(e,t){if(1&e){const e=l.Rb();l.Qb(0,"action-button",19),l.Xb("action",(function(){return l.sc(e),l.Zb(2).back()})),l.Pb()}if(2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.back)}}function Ie(e,t){if(1&e){const e=l.Rb();l.Qb(0,"page-content",3),l.ac(1,"async"),l.Qb(2,"form",4),l.Qb(3,"div",5),l.Qb(4,"radio-group-field",14),l.Bc(5,ye,1,2,"field-option",7),l.Pb(),l.Pb(),l.Pb(),l.Lb(6,"hr"),l.Qb(7,"div",5),l.Lb(8,"address-form",15),l.Pb(),l.Qb(9,"h2"),l.Dc(10),l.Pb(),l.Qb(11,"form",4),l.Lb(12,"textarea-field",16),l.Pb(),l.Qb(13,"actions",9),l.Qb(14,"action-button",10),l.Xb("action",(function(){return l.sc(e),l.Zb().next()})),l.Pb(),l.Bc(15,xe,1,0,"ng-template",null,17,l.Cc),l.Bc(17,Pe,1,1,"action-button",18),l.Pb(),l.Pb()}if(2&e){const e=l.Zb();l.gc("heading",e.i18n.ad.title.deliveryAddress)("mobileHeading",e.i18n.ad.mobileTitle.deliveryAddress)("mode",l.bc(1,13,e.layout.ltsm$)?"fullHeight":"normal"),l.xb(2),l.gc("formGroup",e.form),l.xb(2),l.gc("asColumn",e.data.addresses.length>3)("label",e.i18n.ad.chooseDeliveryAddress),l.xb(1),l.gc("ngForOf",e.data.addresses),l.xb(3),l.gc("addressForm",e.addressForm)("configuration",e.data.addressConfiguration),l.xb(2),l.Ec(e.i18n.ad.remarks),l.xb(1),l.gc("formGroup",e.form),l.xb(3),l.gc("label",e.i18n.general.next),l.xb(3),l.gc("ngIf",e.data.deliveryMethods.length>1)}}function Qe(e,t){if(1&e&&l.Lb(0,"field-option",11),2&e){const e=t.$implicit;l.gc("value",e.id)("text",e.name)}}function De(e,t){1&e&&l.Dc(0,"\xa0")}function Se(e,t){if(1&e){const e=l.Rb();l.Qb(0,"page-content",3),l.ac(1,"async"),l.Qb(2,"form",4),l.Qb(3,"radio-group-field",20),l.Bc(4,Qe,1,2,"field-option",7),l.Pb(),l.Pb(),l.Qb(5,"actions",9),l.Qb(6,"action-button",10),l.Xb("action",(function(){return l.sc(e),l.Zb().next()})),l.Pb(),l.Bc(7,De,1,0,"ng-template",null,17,l.Cc),l.Qb(9,"action-button",19),l.Xb("action",(function(){return l.sc(e),l.Zb().back()})),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=l.Zb();l.gc("heading",e.i18n.ad.title.paymentType)("mobileHeading",e.i18n.ad.mobileTitle.paymentType)("mode",l.bc(1,9,e.layout.ltsm$)?"fullHeight":"normal"),l.xb(2),l.gc("formGroup",e.form),l.xb(1),l.gc("asColumn",!0)("label",e.i18n.ad.choosePaymentType),l.xb(1),l.gc("ngForOf",e.data.paymentTypes),l.xb(2),l.gc("label",e.i18n.general.next),l.xb(3),l.gc("label",e.i18n.general.back)}}function ke(e,t){1&e&&l.Lb(0,"hr",28)}function we(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Bc(1,ke,1,0,"hr",26),l.ac(2,"async"),l.Qb(3,"form",4),l.Qb(4,"confirmation-password",27),l.Xb("confirmationModeChanged",(function(t){return l.sc(e),l.Zb(2).confirmationMode$.next(t)}))("confirmed",(function(t){return l.sc(e),l.Zb(2).submit(t)})),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.Zb(2);l.xb(1),l.gc("ngIf",l.bc(2,4,e.layout.gtxxs$)),l.xb(2),l.gc("formGroup",e.form),l.xb(1),l.gc("passwordInput",e.data.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}function Ce(e,t){if(1&e){const e=l.Rb();l.Qb(0,"action-button",29),l.Xb("action",(function(){return l.sc(e),l.Zb(2).next()})),l.ac(1,"async"),l.Pb()}if(2&e){const e=l.Zb(2);l.gc("disabled",l.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function Oe(e,t){1&e&&l.Dc(0,"\xa0")}function Fe(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"page-content",3),l.ac(2,"async"),l.Qb(3,"label-value",13),l.Lb(4,"user-link",21),l.Pb(),l.Qb(5,"label-value",13),l.Dc(6),l.ac(7,"currency"),l.Pb(),l.Lb(8,"hr"),l.Qb(9,"label-value",22),l.Dc(10),l.ac(11,"currency"),l.Pb(),l.Qb(12,"label",23),l.Dc(13),l.Pb(),l.Lb(14,"shopping-cart-items",24),l.Bc(15,we,5,6,"ng-container",8),l.Qb(16,"actions",9),l.Bc(17,Ce,2,4,"action-button",25),l.ac(18,"async"),l.Bc(19,Oe,1,0,"ng-template",null,17,l.Cc),l.Qb(21,"action-button",19),l.Xb("action",(function(){return l.sc(e),l.Zb().back()})),l.Pb(),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.qc(20),t=l.Zb();l.xb(1),l.gc("heading",t.i18n.ad.title.confirmOrder)("mobileHeading",t.i18n.ad.mobileTitle.confirmOrder)("mode",l.bc(2,16,t.layout.ltsm$)?"fullHeight":"normal"),l.xb(2),l.gc("label",t.i18n.ad.seller),l.xb(1),l.gc("user",t.data.cart.seller),l.xb(1),l.gc("label",t.i18n.ad.deliveryPrice),l.xb(1),l.Fc(" ",t.negotiated?t.i18n.ad.toBeConfirmedBySeller:l.cc(7,18,t.deliveryMethod.chargeAmount,t.deliveryMethod.chargeCurrency)," "),l.xb(3),l.gc("label",t.i18n.ad.total),l.xb(1),l.Fc(" ",l.cc(11,21,t.totalPrice,t.data.cart.currency)," "),l.xb(3),l.Fc(" ",t.negotiated?t.i18n.ad.deliveryPriceToBeConfirmed:t.i18n.ad.reserveAmount," "),l.xb(1),l.gc("items",t.data.cart.items)("currency",t.data.cart.currency),l.xb(1),l.gc("ngIf",!t.negotiated&&t.data.confirmationPasswordInput),l.xb(2),l.gc("ngIf",t.negotiated||l.bc(18,24,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),l.xb(4),l.gc("label",t.i18n.general.back)}}let Be=(()=>{class e extends c.a{constructor(e,t,i,a){super(e),this.shoppingCartService=t,this.addressHelper=i,this.marketplaceHelper=a,this.ConfirmationMode=L.a,this.step$=new A.a(null),this.deliveryMethod$=new A.a(null),this.address$=new A.a(null),this.confirmationMode$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.addSub(this.shoppingCartService.getShoppingCartDataForCheckout({id:this.route.snapshot.params.id}).subscribe(e=>{this.data=e}))}onDataInitialized(e){const t=!Object(s.h)(e.deliveryMethods);if(this.form=this.formBuilder.group({remarks:null}),this.step=e.deliveryMethods.length>1?"delivery":"address",this.confirmationPassword=this.formBuilder.control(null),this.form.setControl("confirmationPassword",this.confirmationPassword),t){const t=this.formBuilder.control(e.deliveryMethods);this.form.addControl("deliveryMethod",t),this.addSub(t.valueChanges.subscribe(t=>this.updateDeliveryMethod(t,e))),t.setValue(e.deliveryMethods[0].id,{emitEvent:!0})}e.addresses.push({id:"customAddress",name:this.i18n.ad.customAddress});const i=this.formBuilder.control(e.addresses);if(this.form.addControl("address",i),this.addSub(i.valueChanges.subscribe(t=>this.updateAddress(t,e))),this.addressForm=this.addressHelper.addressFormGroup(e.addressConfiguration),i.setValue(e.addresses[0].id,{emitEvent:!0}),!Object(s.h)(e.paymentTypes)){const t=this.formBuilder.control(e.paymentTypes);this.form.addControl("paymentType",t),t.setValue(e.paymentTypes[0].id,{emitEvent:!0})}}updateDeliveryMethod(e,t){this.deliveryMethod=t.deliveryMethods.find(t=>t.id===e)}updateAddress(e,t){this.address=t.addresses.find(t=>t.id===e),"customAddress"===this.address.id?this.addressForm.reset():this.addressForm.patchValue(this.address)}resolveMenu(){return o.b.SHOPPING_CART}next(){switch(this.step){case"delivery":this.step="address";break;case"address":this.step=this.data.paymentTypes.length>1?"payment":"confirm";break;case"payment":this.step="confirm";break;case"confirm":this.submit()}}back(){switch(this.step){case"confirm":this.step=this.data.paymentTypes.length>1?"payment":"address";break;case"payment":this.step="address";break;case"address":this.data.deliveryMethods.length>1&&(this.step="delivery")}}submit(e){if(e&&this.confirmationPassword.setValue(e),!Object(s.F)(this.confirmationPassword))return;const t=Object(N.a)(this.form.value);delete t.address,t.deliveryAddress=this.addressForm.value,this.addSub(this.shoppingCartService.checkoutShoppingCart({id:this.data.cart.id,body:t,confirmationPassword:this.confirmationPassword.value}).subscribe(e=>{this.marketplaceHelper.cartItems=e,this.notification.snackBar(this.i18n.ad.orderWaitingForSellersApproval),this.menu.navigate({menu:new o.a(o.b.PURCHASES),replaceUrl:!0})}))}get step(){return this.step$.value}set step(e){this.step$.next(e)}get deliveryMethod(){return this.deliveryMethod$.value}set deliveryMethod(e){this.deliveryMethod$.next(e)}get address(){return this.address$.value}set address(e){this.address$.next(e)}get totalPrice(){const e=+this.data.cart.totalPrice;return this.negotiated?e:+this.deliveryMethod.chargeAmount+e}get negotiated(){return null==this.deliveryMethod||null==this.deliveryMethod.chargeAmount}get createDeviceConfirmation(){return()=>({type:C.s.SHOPPING_CART_CHECKOUT,seller:this.ApiHelper.accountOwner(this.data.cart.seller),amount:this.totalPrice,paymentType:this.form.value.paymentType})}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(O.a),l.Kb(F.a),l.Kb(B.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["cart-checkout"]],features:[l.ub],decls:7,vars:10,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","mode"],[3,"formGroup"],[1,"mb-4"],["formControlName","deliveryMethod",3,"asColumn","label"],[3,"value","text",4,"ngFor","ngForOf"],[4,"ngIf"],["forceRow",""],[3,"label","action"],[3,"value","text"],[3,"label",4,"ngIf"],[3,"label"],["formControlName","address",3,"asColumn","label"],[3,"addressForm","configuration"],["formControlName","remarks"],["spacer",""],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],["formControlName","paymentType",3,"asColumn","label"],[3,"user"],[1,"totalAmount",3,"label"],[1,"any-label-value","notice","text-muted"],[3,"items","currency"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["class","mt-0",4,"ngIf"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"],[1,"mt-0"],[3,"disabled","label","action"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.ac(2,"async"),l.Bc(3,ve,12,14,"page-content",1),l.Bc(4,Ie,18,15,"page-content",1),l.Bc(5,Se,10,11,"page-content",1),l.Bc(6,Fe,22,26,"ng-container",2),l.Pb()),2&e&&(l.gc("ready",l.bc(1,6,t.data$))("ngSwitch",l.bc(2,8,t.step$)),l.xb(3),l.gc("ngSwitchCase","delivery"),l.xb(1),l.gc("ngSwitchCase","address"),l.xb(1),l.gc("ngSwitchCase","payment"),l.xb(1),l.gc("ngSwitchCase","confirm"))},directives:[b.a,d.x,d.y,u.a,n.I,n.w,n.n,T.a,n.v,n.l,d.s,d.t,p.a,v.a,$.a,m.a,Z.a,h.a,g.a,de,ue.a,me.a],pipes:[d.b,K.a],encapsulation:2,changeDetection:0}),e})();function Le(e,t){if(1&e&&(l.Qb(0,"mobile-result",7),l.Qb(1,"div"),l.Qb(2,"div",8),l.Dc(3),l.Pb(),l.Qb(4,"div",9),l.Dc(5),l.Pb(),l.Qb(6,"div",9),l.Dc(7),l.Pb(),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(3);l.gc("avatarImage",e.seller.image),l.xb(3),l.Fc(" ",e.seller.display," "),l.xb(2),l.Fc(" ",e.currency.name," "),l.xb(2),l.Fc(" ",e.items.length+" "+(e.items.length>1?i.i18n.ad.items:i.i18n.ad.item)," ")}}const Ne=function(e,t){return{"pb-0":e,"border-0":t}};function Ae(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"tr",13),l.Xb("click",(function(){l.sc(e);const i=t.$implicit,a=l.Zb(4);return a.router.navigate(a.path(i))})),l.Qb(2,"td",14),l.ac(3,"async"),l.ac(4,"async"),l.Lb(5,"avatar",15),l.Pb(),l.Qb(6,"td"),l.Qb(7,"a",16),l.Dc(8),l.Pb(),l.Pb(),l.Qb(9,"td"),l.Dc(10),l.Pb(),l.Qb(11,"td"),l.Dc(12),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=t.$implicit,i=l.Zb(4);l.xb(2),l.gc("ngClass",l.kc(11,Ne,l.bc(3,7,i.layout.xxs$),l.bc(4,9,i.layout.xxs$))),l.xb(3),l.gc("image",e.seller.image)("tooltip",e.seller.display),l.xb(2),l.gc("routerLink",i.path(e)),l.xb(1),l.Fc(" ",e.seller.shortDisplay," "),l.xb(2),l.Fc(" ",e.currency.name," "),l.xb(2),l.Fc(" ",e.items.length," ")}}function Te(e,t){if(1&e&&(l.Qb(0,"table",10),l.Qb(1,"thead"),l.Lb(2,"th",11),l.Qb(3,"th"),l.Dc(4),l.Pb(),l.Qb(5,"th"),l.Dc(6),l.Pb(),l.Qb(7,"th"),l.Dc(8),l.Pb(),l.Pb(),l.Qb(9,"tbody"),l.Bc(10,Ae,13,14,"ng-container",12),l.Pb(),l.Pb()),2&e){const e=l.Zb(3);l.xb(4),l.Ec(e.i18n.ad.seller),l.xb(2),l.Ec(e.i18n.general.currency),l.xb(2),l.Ec(e.i18n.ad.items),l.xb(2),l.gc("ngForOf",e.data)}}function $e(e,t){if(1&e&&(l.Qb(0,"results-layout",4),l.Bc(1,Le,8,4,"mobile-result",5),l.Bc(2,Te,11,4,"table",6),l.Pb()),2&e){const e=l.Zb(2);l.gc("results",e.data)("toLink",e.toLink)}}function Ze(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Ob(3),l.Dc(4),l.Nb(),l.Pb(),l.Bc(5,$e,3,2,"results-layout",3),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.shoppingCart)("mobileHeading",e.i18n.ad.mobileTitle.shoppingCart)("headingActions",l.bc(2,5,e.headingActions$)),l.xb(3),l.Fc(" ",e.data.length>0?e.i18n.ad.chooseSeller:e.i18n.ad.cartEmpty," "),l.xb(1),l.gc("ngIf",e.data.length>0)}}let Ee=(()=>{class e extends c.a{constructor(e,t){super(e),this.shoppingCartService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.shoppingCartService.getShoppingCarts({}).subscribe(e=>{this.data=e}))}onDataInitialized(e){1===e.length&&this.router.navigate(this.path(e[0]),{replaceUrl:!0})}resolveMenu(){return o.b.SHOPPING_CART}get toLink(){return e=>this.path(e)}path(e){return["/marketplace","cart",e.id]}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(O.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["list-shopping-cart"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"results","toLink",4,"ngIf"],[3,"results","toLink"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarIcon","user",3,"avatarImage"],[1,"cell-main"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"],[3,"routerLink"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Ze,6,7,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,R.a,H.a,q.a,G.a,d.s,d.q,f.a,V.b,a.h],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();var Me=i("a/z7"),Re=i("tAww");function He(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.Fc(" ",e.i18n.ad.cartEmpty," ")}}function qe(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"label-value",4),l.Lb(2,"user-link",5),l.Pb(),l.Qb(3,"label-value",6),l.Dc(4),l.ac(5,"currency"),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("label",e.i18n.ad.seller),l.xb(1),l.gc("user",e.data.seller),l.xb(1),l.gc("label",e.i18n.ad.total),l.xb(1),l.Fc(" ",l.cc(5,4,e.data.totalPrice,e.data.currency)," ")}}function Ge(e,t){1&e&&l.Mb(0)}function Ve(e,t){if(1&e&&(l.Ob(0),l.Bc(1,Ge,1,0,"ng-container",7),l.Nb()),2&e){l.Zb();const e=l.qc(12);l.xb(1),l.gc("ngTemplateOutlet",e)}}function je(e,t){1&e&&l.Mb(0)}function ze(e,t){if(1&e&&(l.Ob(0),l.Bc(1,je,1,0,"ng-container",7),l.Nb()),2&e){l.Zb();const e=l.qc(12);l.xb(1),l.gc("ngTemplateOutlet",e)}}function Ke(e,t){if(1&e){const e=l.Rb();l.Qb(0,"shopping-cart-items",8),l.Xb("changeQuantity",(function(t){return l.sc(e),l.Zb().changeQuantity(t)}))("remove",(function(t){return l.sc(e),l.Zb().remove(t)})),l.Pb()}if(2&e){const e=l.Zb();l.gc("detailed",!0)("items",e.data.items)("currency",e.data.currency)}}let Ue=(()=>{class e extends c.a{constructor(e,t,i){super(e),this.shoppingCartService=t,this.marketplaceHelper=i,this.emptyCart$=new A.a(!1)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.errorHandler.requestWithCustomErrorHandler(t=>{const i=e.details?this.shoppingCartService.getShoppingCartDetails({id:this.id}):this.shoppingCartService.adjustAndGetShoppingCartDetails({id:this.id});e.details=!1,this.addSub(i.subscribe(e=>{this.data=e},e=>{e.status===Me.a.NOT_FOUND||e.status===Me.a.FORBIDDEN?this.emptyCart$.next(!0):t(e)}))})}onDataInitialized(e){this.headingActions=[new Re.c("local_mall",this.i18n.ad.checkout,()=>this.checkout(),!0)],this.checkMessages(e)}checkMessages(e){const t=new Set;e.items.forEach(e=>{e.availability===C.pb.UNAVAILABLE?this.unavailable=!0:e.availability===C.pb.OUT_OF_STOCK?this.outOfStock=!0:null!=e.quantityAdjustment&&t.add(e.quantityAdjustment)});let i="";this.unavailable&&(i+=this.i18n.ad.itemsNoLongerAvailable),this.outOfStock&&(i+=this.i18n.ad.itemsOutOfStock),t.forEach(e=>{switch(e){case C.qb.MAX:i+=this.i18n.ad.adjustedQuantity.max;break;case C.qb.MIN:i+=this.i18n.ad.adjustedQuantity.min;break;case C.qb.STOCK:i+=this.i18n.ad.adjustedQuantity.stock}}),e.insufficientBalance&&(i+=this.i18n.ad.lowBalance(e.currency.name)),""!==i&&this.notification.warning(this.i18n.ad.articlesNotice(i),!0,!1)}checkout(){this.unavailable||this.outOfStock||this.data.insufficientBalance?this.notification.error(this.i18n.ad.error.cannotProceedToCheckout):this.router.navigate(["/marketplace","checkout",this.id])}isAvailable(e){return e.availability===C.pb.AVAILABLE}remove(e){this.addSub(this.shoppingCartService.removeItemFromShoppingCart({ad:e.product.id}).subscribe(e=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload(),this.marketplaceHelper.cartItems=e}))}changeQuantity(t){const i=i=>{0!=+i&&this.addSub(this.shoppingCartService.modifyItemQuantityOnShoppingCart({ad:t[1].product.id,quantity:+i}).subscribe(t=>{e.details=!0,this.reload(),this.marketplaceHelper.cartItems=t}))};t[2]?i(t[0]):this.notification.confirm({title:this.i18n.ad.changeQuantity,labelPosition:"above",customFields:[{internalName:"quantity",name:this.i18n.ad.quantity,type:t[1].product.allowDecimalQuantity?C.p.DECIMAL:C.p.INTEGER,defaultValue:this.marketplaceHelper.getFormattedQuantity(t[1])}],callback:e=>i(+e.customValues.quantity)})}resolveQuantityLabel(e){switch(e.availability){case C.pb.AVAILABLE:return this.marketplaceHelper.getFormattedQuantity(e);case C.pb.OUT_OF_STOCK:return this.i18n.ad.outOfStock;case C.pb.UNAVAILABLE:return this.i18n.ad.itemNotAvailable}return""}resolveMenu(){return o.b.SHOPPING_CART}}return e.details=!1,e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(O.a),l.Kb(B.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["view-cart"]],features:[l.ub],decls:13,vars:18,consts:[[3,"ready"],["mode","filters","mode","viewForm",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["cartItems",""],[3,"label"],[3,"user"],[1,"totalAmount",3,"label"],[4,"ngTemplateOutlet"],[3,"detailed","items","currency","changeQuantity","remove"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.ac(2,"async"),l.Qb(3,"page-content",1),l.ac(4,"async"),l.Bc(5,He,2,1,"ng-container",2),l.Bc(6,qe,6,7,"ng-container",2),l.Bc(7,Ve,2,1,"ng-container",2),l.ac(8,"async"),l.Pb(),l.Bc(9,ze,2,1,"ng-container",2),l.ac(10,"async"),l.Pb(),l.Bc(11,Ke,1,3,"ng-template",null,3,l.Cc)),2&e&&(l.gc("ready",l.bc(1,8,t.data$)||l.bc(2,10,t.emptyCart$)),l.xb(3),l.gc("heading",t.i18n.ad.title.shoppingCart)("mobileHeading",t.i18n.ad.mobileTitle.shoppingCart)("headingActions",l.bc(4,12,t.headingActions$)),l.xb(2),l.gc("ngIf",!t.data),l.xb(1),l.gc("ngIf",t.data),l.xb(1),l.gc("ngIf",!l.bc(8,14,t.layout.ltsm$)&&t.data),l.xb(2),l.gc("ngIf",l.bc(10,16,t.layout.ltsm$)&&t.data))},directives:[b.a,u.a,d.t,m.a,g.a,d.A,de],pipes:[d.b,K.a],encapsulation:2,changeDetection:0}),e})();var Xe=i("RvQX"),_e=i("DIHi"),We=i("yHfF"),Ye=i("0C6t"),Je=i("WYBn");function et(e,t){if(1&e&&(l.Qb(0,"radio-group-field",15),l.Lb(1,"field-option",16),l.Lb(2,"field-option",17),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.chargeType),l.xb(1),l.gc("text",e.i18n.ad.fixed),l.xb(1),l.gc("text",e.i18n.ad.negotiated)}}function tt(e,t){if(1&e&&(l.Qb(0,"label-value",18),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.chargeType),l.xb(1),l.Fc(" ",e.data.deliveryMethod.chargeType===e.DeliveryMethodChargeTypeEnum.FIXED?e.i18n.ad.fixed:e.i18n.ad.negotiated," ")}}function it(e,t){if(1&e&&l.Lb(0,"field-option",21),2&e){const e=t.$implicit,i=l.Zb(3);l.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function at(e,t){if(1&e&&(l.Qb(0,"single-selection-field",19),l.Bc(1,it,1,4,"field-option",20),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.currency),l.xb(1),l.gc("ngForOf",e.data.currencies)}}function nt(e,t){if(1&e&&l.Lb(0,"decimal-field",22),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.deliveryPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function rt(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Qb(3,"form",3),l.Lb(4,"input-field",4),l.Bc(5,et,3,3,"radio-group-field",5),l.Bc(6,tt,2,2,"label-value",6),l.Bc(7,at,2,2,"single-selection-field",7),l.ac(8,"async"),l.Bc(9,nt,1,4,"decimal-field",8),l.ac(10,"async"),l.Lb(11,"boolean-field",9),l.Lb(12,"time-interval-field",10),l.Lb(13,"time-interval-field",11),l.Lb(14,"textarea-field",12),l.Pb(),l.Qb(15,"actions",13),l.Qb(16,"action-button",14),l.Xb("action",(function(){return l.sc(e),l.Zb().save()})),l.ac(17,"async"),l.Pb(),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.create?e.i18n.ad.title.deliveryMethodNew:e.i18n.ad.title.deliveryMethod)("mobileHeading",e.create?e.i18n.ad.mobileTitle.deliveryMethodNew:e.i18n.ad.mobileTitle.deliveryMethod)("headingActions",l.bc(2,15,e.headingActions$)),l.xb(2),l.gc("formGroup",e.form),l.xb(1),l.gc("label",e.i18n.general.name),l.xb(1),l.gc("ngIf",e.create),l.xb(1),l.gc("ngIf",!e.create),l.xb(1),l.gc("ngIf","fixed"===(l.bc(8,17,e.form.get("chargeType").valueChanges)||e.form.get("chargeType").value)&&e.data.currencies&&e.data.currencies.length>1),l.xb(2),l.gc("ngIf",l.bc(10,19,e.currency$)),l.xb(2),l.gc("label",e.i18n.general.enabled),l.xb(1),l.gc("label",e.i18n.ad.minDeliveryTime),l.xb(1),l.gc("label",e.i18n.ad.maxDeliveryTime),l.xb(1),l.gc("label",e.i18n.general.details),l.xb(2),l.gc("disabled",l.bc(17,21,e.requesting$))("label",e.i18n.general.submit)}}let ct=(()=>{class e extends c.a{constructor(e,t){super(e),this.deliveryMethodService=t,this.DeliveryMethodChargeTypeEnum=C.q,this.currency$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.id=this.route.snapshot.params.id,this.create=null==this.id;const e=this.create?this.deliveryMethodService.getDeliveryMethodDataForNew({user:this.user}):this.deliveryMethodService.getDeliveryMethodDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=e.deliveryMethod;this.form=this.formBuilder.group({name:[t.name,n.G.required],chargeType:t.chargeType,chargeCurrency:t.chargeCurrency,chargeAmount:t.chargeAmount,enabled:t.enabled,minDeliveryTime:t.minDeliveryTime,maxDeliveryTime:[t.maxDeliveryTime,n.G.required],description:[t.description,n.G.required],version:t.version}),this.updateCurrency(e),this.addSub(this.form.controls.chargeType.valueChanges.subscribe(()=>this.updateCurrency(e))),this.addSub(this.form.controls.chargeCurrency.valueChanges.subscribe(()=>this.updateCurrency(e)))}updateCurrency(e){if(Object(s.h)(e.currencies)||this.form.controls.chargeType.value!==C.q.FIXED)this.currency=null,this.form.patchValue({chargeCurrency:null,chargeAmount:null},{emitEvent:!1}),this.form.controls.chargeCurrency.clearValidators(),this.form.controls.chargeAmount.clearValidators();else{const t=this.form.controls.chargeCurrency.value;this.currency=e.currencies.find(e=>e.id===t||e.internalName===t)||e.currencies[0],this.form.patchValue({chargeCurrency:this.currency.id},{emitEvent:!1}),this.form.controls.chargeCurrency.setValidators(n.G.required),this.form.controls.chargeAmount.setValidators(n.G.required)}}save(){if(!Object(s.F)(this.form))return;const e=this.form.value,t=this.create?this.deliveryMethodService.createDeliveryMethod({body:e,user:this.user}):this.deliveryMethodService.updateDeliveryMethod({id:this.id,body:e});this.addSub(t.subscribe(()=>{this.notification.snackBar(this.create?this.i18n.ad.deliveryMethodCreated:this.i18n.ad.deliveryMethodSaved),history.back()}))}resolveMenu(e){return this.menu.userMenu(e.user,o.b.DELIVERY_METHODS)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Xe.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["edit-delivery-method"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["formControlName","name","required","",3,"label"],["formControlName","chargeType",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],["formControlName","chargeCurrency","required","",3,"label",4,"ngIf"],["formControlName","chargeAmount","fieldSize","full","required","",3,"label","scale","prefix","suffix",4,"ngIf"],["formControlName","enabled",3,"label"],["formControlName","minDeliveryTime",3,"label"],["formControlName","maxDeliveryTime","required","",3,"label"],["formControlName","description","required","",3,"label"],["forceRow",""],[3,"disabled","label","action"],["formControlName","chargeType",3,"label"],["value","fixed",3,"text"],["value","negotiated",3,"text"],[3,"label"],["formControlName","chargeCurrency","required","",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","chargeAmount","fieldSize","full","required","",3,"label","scale","prefix","suffix"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,rt,18,23,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,n.I,n.w,n.n,_e.a,n.v,n.l,n.D,We.a,Ye.a,h.a,p.a,v.a,T.a,$.a,m.a,Je.a,d.s,z.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();var st=i("s7Af");function ot(e,t){if(1&e&&l.Lb(0,"user-info",7),2&e){const e=l.Zb(2);l.gc("user",e.data.user)}}function lt(e,t){if(1&e&&(l.Qb(0,"div",10),l.Dc(1),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(2);l.xb(1),l.Gc(" ",t.i18n.ad.minDeliveryTime,": ",t.format.formatTimeInterval(e.minDeliveryTime),"")}}function bt(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",13),l.Qb(1,"button",14),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(2).remove(i),t.stopPropagation(),t.preventDefault()})),l.Lb(2,"icon",15),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(3);l.xb(1),l.gc("tooltip",e.i18n.general.remove)}}function dt(e,t){if(1&e&&(l.Qb(0,"mobile-result"),l.Qb(1,"div",8),l.Qb(2,"div"),l.Qb(3,"div",9),l.Dc(4),l.Pb(),l.Qb(5,"div",10),l.Dc(6),l.Pb(),l.Qb(7,"div",10),l.Dc(8),l.ac(9,"currency"),l.Pb(),l.Bc(10,lt,2,2,"div",11),l.Qb(11,"div",10),l.Dc(12),l.Pb(),l.Qb(13,"div",10),l.Dc(14),l.Pb(),l.Pb(),l.Bc(15,bt,3,1,"div",12),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(2);l.xb(4),l.Ec(e.name),l.xb(2),l.Gc(" ",i.i18n.ad.chargeType,": ",i.resolveChargeTypeLabel(e.chargeType),""),l.xb(2),l.Gc(" ",i.i18n.ad.price,": ",l.cc(9,11,e.chargeAmount,e.chargeCurrency),""),l.xb(2),l.gc("ngIf",e.minDeliveryTime),l.xb(2),l.Gc(" ",i.i18n.ad.maxDeliveryTime,": ",i.format.formatTimeInterval(e.maxDeliveryTime),""),l.xb(2),l.Gc(" ",i.i18n.general.enabled,": ",e.enabled?i.i18n.general.yes:i.i18n.general.no,""),l.xb(1),l.gc("ngIf",i.data.canManage)}}function ut(e,t){1&e&&l.Lb(0,"th",20)}function mt(e,t){if(1&e){const e=l.Rb();l.Qb(0,"td",20),l.Qb(1,"button",14),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(3).remove(i),t.stopPropagation()})),l.Lb(2,"icon",15),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(4);l.xb(1),l.gc("tooltip",e.i18n.general.remove)}}function gt(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"tr",21),l.Xb("click",(function(){l.sc(e);const i=t.$implicit,a=l.Zb(3);return a.router.navigate(a.viewPath(i))})),l.Qb(2,"td"),l.Dc(3),l.Pb(),l.Qb(4,"td"),l.Dc(5),l.Pb(),l.Qb(6,"td",17),l.Dc(7),l.ac(8,"currency"),l.Pb(),l.Qb(9,"td"),l.Dc(10),l.Pb(),l.Qb(11,"td"),l.Dc(12),l.Pb(),l.Qb(13,"td"),l.Dc(14),l.Pb(),l.Bc(15,mt,3,1,"td",18),l.Pb(),l.Nb()}if(2&e){const e=t.$implicit,i=l.Zb(3);l.xb(3),l.Fc(" ",e.name," "),l.xb(2),l.Fc(" ",i.resolveChargeTypeLabel(e.chargeType)," "),l.xb(2),l.Fc(" ",l.cc(8,7,e.chargeAmount,e.chargeCurrency)," "),l.xb(3),l.Fc(" ",i.format.formatTimeInterval(e.minDeliveryTime)," "),l.xb(2),l.Fc(" ",i.format.formatTimeInterval(e.maxDeliveryTime)," "),l.xb(2),l.Fc(" ",e.enabled?i.i18n.general.yes:i.i18n.general.no," "),l.xb(1),l.gc("ngIf",i.data.canManage)}}function ft(e,t){if(1&e&&(l.Qb(0,"table",16),l.Qb(1,"thead"),l.Qb(2,"th"),l.Dc(3),l.Pb(),l.Qb(4,"th"),l.Dc(5),l.Pb(),l.Qb(6,"th",17),l.Dc(7),l.Pb(),l.Qb(8,"th"),l.Dc(9),l.Pb(),l.Qb(10,"th"),l.Dc(11),l.Pb(),l.Qb(12,"th"),l.Dc(13),l.Pb(),l.Bc(14,ut,1,0,"th",18),l.Pb(),l.Qb(15,"tbody"),l.Bc(16,gt,16,10,"ng-container",19),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.xb(3),l.Ec(e.i18n.general.name),l.xb(2),l.Ec(e.i18n.ad.chargeType),l.xb(2),l.Ec(e.i18n.ad.price),l.xb(2),l.Ec(e.i18n.ad.minDeliveryTime),l.xb(2),l.Ec(e.i18n.ad.maxDeliveryTime),l.xb(2),l.Ec(e.i18n.general.enabled),l.xb(1),l.gc("ngIf",e.data.canManage),l.xb(2),l.gc("ngForOf",e.data.deliveryMethods)}}function ht(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Bc(3,ot,1,1,"user-info",3),l.Pb(),l.Qb(4,"results-layout",4),l.Bc(5,dt,16,14,"mobile-result",5),l.Bc(6,ft,17,8,"table",6),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.deliveryMethods)("mobileHeading",e.i18n.ad.mobileTitle.deliveryMethods)("headingActions",l.bc(2,7,e.headingActions$))("mode",e.self?"empty":"normal"),l.xb(2),l.gc("ngIf",!e.self),l.xb(1),l.gc("results",e.data.deliveryMethods)("toLink",e.toLink)}}let pt=(()=>{class e extends c.a{constructor(e,t){super(e),this.deliveryMethodService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.addSub(this.deliveryMethodService.getUserDeliveryMethodsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user),e.canCreate&&(this.headingActions=[new Re.c("add",this.i18n.general.addNew,()=>{this.router.navigate(["/marketplace",this.param,"delivery-methods","new"])},!0)])}viewPath(e){return["/marketplace","delivery-methods","view",e.id]}get toLink(){return e=>this.viewPath(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.name),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.deliveryMethodService.deleteDeliveryMethod({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.name)),this.reload()}))}resolveChargeTypeLabel(e){switch(e){case C.q.FIXED:return this.i18n.ad.fixed;case C.q.NEGOTIATED:return this.i18n.ad.negotiated}return""}resolveMenu(e){return this.menu.userMenu(e.user,o.b.DELIVERY_METHODS)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Xe.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["list-delivery-methods"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],["class","cell-text",4,"ngIf"],["class","ml-auto text-right",4,"ngIf"],[1,"ml-auto","text-right"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],["class","actions",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,ht,7,9,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,R.a,H.a,q.a,st.a,G.a,V.b,j.a,d.s],pipes:[d.b,K.a],encapsulation:2,changeDetection:0}),e})();var vt=i("Pm8L");function yt(e,t){if(1&e&&(l.Qb(0,"label-value",8),l.Lb(1,"user-link",9),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.user)}}function xt(e,t){if(1&e&&(l.Qb(0,"label-value",6),l.Dc(1),l.ac(2,"currency"),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.price),l.xb(1),l.Fc(" ",l.cc(2,2,e.data.chargeAmount,e.data.chargeCurrency)," ")}}function Pt(e,t){if(1&e&&(l.Qb(0,"label-value",6),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.minDeliveryTime),l.xb(1),l.Fc(" ",e.format.formatTimeInterval(e.data.minDeliveryTime)," ")}}function It(e,t){if(1&e&&(l.Ob(0,10),l.Qb(1,"h2",11),l.Dc(2),l.Pb(),l.Qb(3,"div",12),l.Dc(4),l.Pb(),l.Nb()),2&e){const e=l.Zb(2);l.xb(2),l.Fc(" ",e.i18n.general.description," "),l.xb(2),l.Fc(" ",e.data.description," ")}}function Qt(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Bc(3,yt,2,2,"label-value",3),l.Lb(4,"label-value",4),l.Lb(5,"label-value",4),l.Bc(6,xt,3,5,"label-value",5),l.Bc(7,Pt,2,2,"label-value",5),l.Qb(8,"label-value",6),l.Dc(9),l.Pb(),l.Qb(10,"label-value",6),l.Dc(11),l.Pb(),l.Bc(12,It,5,2,"ng-container",7),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.deliveryMethod)("mobileHeading",e.i18n.ad.mobileTitle.deliveryMethod)("headingActions",l.bc(2,15,e.headingActions$)),l.xb(2),l.gc("ngIf",!e.self),l.xb(1),l.gc("label",e.i18n.general.name)("value",e.data.name),l.xb(1),l.gc("label",e.i18n.ad.chargeType)("value",e.resolveChargeTypeLabel()),l.xb(1),l.gc("ngIf",e.data.chargeAmount),l.xb(1),l.gc("ngIf",e.data.minDeliveryTime),l.xb(1),l.gc("label",e.i18n.ad.maxDeliveryTime),l.xb(1),l.Fc(" ",e.format.formatTimeInterval(e.data.maxDeliveryTime)," "),l.xb(1),l.gc("label",e.i18n.general.enabled),l.xb(1),l.Fc(" ",e.data.enabled?e.i18n.general.yes:e.i18n.general.no," "),l.xb(1),l.gc("ngIf",e.data.description)}}let Dt=(()=>{class e extends vt.a{constructor(e,t){super(e),this.deliveryMethodService=t}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.deliveryMethodService.viewDeliveryMethod({id:this.id}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=[];e.canEdit&&t.push(new Re.c("edit",this.i18n.general.edit,()=>this.router.navigate(["/marketplace","delivery-methods","edit",this.id]),!0)),this.headingActions=t}resolveChargeTypeLabel(){switch(this.data.chargeType){case C.q.FIXED:return this.i18n.ad.fixed;case C.q.NEGOTIATED:return this.i18n.ad.negotiated}return""}resolveMenu(e){return this.menu.userMenu(e.user,o.b.DELIVERY_METHODS)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Xe.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["view-delivery-method"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],[3,"label",4,"ngIf"],[3,"label"],["class","d-flex justify-content-start",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"],[1,"d-flex","justify-content-start"],[1,"mt-3"],[1,"break-nl"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Qt,13,17,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,m.a,g.a],pipes:[d.b,K.a],encapsulation:2,changeDetection:0}),e})();var St=i("zlpg"),kt=i("lQxg"),wt=i("bER3"),Ct=i("SxV6"),Ot=i("LqlI"),Ft=i("6g1M"),Bt=i("lrfU"),Lt=i("pz1b"),Nt=i("4APx"),At=i("Y+zs"),Tt=i("Aw04"),$t=i("yL40");function Zt(e,t){if(1&e){const e=l.Rb();l.Qb(0,"action-button",31),l.Xb("action",(function(){return l.sc(e),l.Zb(),l.qc(12).perform()})),l.Pb()}if(2&e){const e=l.Zb(3);l.gc("label",e.i18n.field.image.upload)}}function Et(e,t){if(1&e&&(l.Qb(0,"div",32),l.Lb(1,"avatar",33),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(3);l.xb(1),l.gc("image",e)("roundBorders",!1)("additionalImages",i.images)}}function Mt(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"div",34),l.Dc(2),l.Pb(),l.Nb()),2&e){const e=l.Zb(3);l.xb(2),l.Fc(" ",e.i18n.field.image.noImages," ")}}function Rt(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",35),l.Qb(1,"action-button",31),l.Xb("action",(function(){return l.sc(e),l.Zb(3).manageImages()})),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(3);l.xb(1),l.gc("label",e.i18n.field.image.manage)}}function Ht(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"h2",23),l.Qb(2,"div",24),l.Dc(3),l.Pb(),l.Bc(4,Zt,1,1,"action-button",25),l.ac(5,"async"),l.Pb(),l.Qb(6,"div",26),l.Bc(7,Et,2,3,"div",27),l.ac(8,"async"),l.Bc(9,Mt,3,1,"ng-container",1),l.Pb(),l.Bc(10,Rt,2,1,"div",28),l.Qb(11,"image-upload",29,30),l.Xb("uploadDone",(function(t){return l.sc(e),l.Zb(2).onUploadDone(t)})),l.Pb(),l.Nb()}if(2&e){const e=l.qc(12),t=l.Zb(2);l.xb(3),l.Fc(" ",t.i18n.general.images," "),l.xb(1),l.gc("ngIf",t.canUploadImages&&!1===l.bc(5,8,e.uploading$)),l.xb(3),l.gc("ngForOf",l.bc(8,10,t.images$)),l.xb(2),l.gc("ngIf",0===t.images.length),l.xb(1),l.gc("ngIf",t.images.length>0),l.xb(1),l.gc("max",t.data.maxImages)("owner",t.id)("user",t.data.owner.id)}}function qt(e,t){1&e&&l.Lb(0,"hr",36)}function Gt(e,t){if(1&e&&(l.Qb(0,"label-value",37),l.Lb(1,"user-link",38),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.owner)}}function Vt(e,t){if(1&e&&(l.Qb(0,"label-value",37),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.status),l.xb(1),l.Fc(" ",e.status," ")}}function jt(e,t){if(1&e&&(l.Qb(0,"label-value",37),l.Dc(1),l.ac(2,"date"),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.creationDate),l.xb(1),l.Fc(" ",l.bc(2,2,e.creationDate)," ")}}function zt(e,t){if(1&e&&l.Lb(0,"field-option",41),2&e){const e=t.$implicit,i=l.Zb(3);l.zc(e.leaf?"leaf":"parent"),l.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)("level",e.level)("disabled",!e.leaf)}}function Kt(e,t){if(1&e&&(l.Qb(0,"single-selection-field",39),l.Bc(1,zt,1,8,"field-option",40),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.category),l.xb(1),l.gc("ngForOf",e.categories)}}function Ut(e,t){if(1&e&&l.Lb(0,"field-option",41),2&e){const e=t.$implicit,i=l.Zb(3);l.zc("hierarchy "+(e.leaf?"leaf":"parent")),l.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)("level",e.level)("disabled",!e.leaf)}}function Xt(e,t){if(1&e&&(l.Qb(0,"multi-selection-field",39),l.Bc(1,Ut,1,8,"field-option",40),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.categories),l.xb(1),l.gc("ngForOf",e.categories)}}function _t(e,t){if(1&e&&l.Lb(0,"field-option",44),2&e){const e=t.$implicit,i=l.Zb(3);l.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function Wt(e,t){if(1&e&&(l.Qb(0,"single-selection-field",42),l.Bc(1,_t,1,4,"field-option",43),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.currency)("required",e.webshop),l.xb(1),l.gc("ngForOf",e.data.currencies)}}function Yt(e,t){if(1&e&&l.Lb(0,"decimal-field",45),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.price)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("required",e.webshop)}}function Jt(e,t){if(1&e&&l.Lb(0,"decimal-field",50),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.promotionalPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function ei(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"label-value",46),l.Qb(2,"div",11),l.Qb(3,"div",12),l.Lb(4,"date-field",47),l.Pb(),l.Qb(5,"div",14),l.Dc(6),l.Pb(),l.Qb(7,"div",15),l.Lb(8,"date-field",48),l.Pb(),l.Pb(),l.Pb(),l.Bc(9,Jt,1,4,"decimal-field",49),l.ac(10,"async"),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.ad.promotionalPeriod),l.xb(5),l.Fc(" ",e.i18n.general.periodTo," "),l.xb(3),l.gc("ngIf",l.bc(10,3,e.currency$))}}function ti(e,t){if(1&e&&l.Lb(0,"custom-field-input",51),2&e){const e=t.$implicit,i=l.Zb(2);l.gc("field",e)("formControl",i.form.get("customValues").get(e.internalName))("binaryValues",i.binaryValues)}}function ii(e,t){if(1&e&&l.Lb(0,"field-option",54),2&e){const e=t.$implicit;l.gc("value",e.id)("id",e.id)("text",e.name)}}function ai(e,t){if(1&e&&(l.Qb(0,"multi-selection-field",52),l.Bc(1,ii,1,3,"field-option",53),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.showAddressOnMap),l.xb(1),l.gc("ngForOf",e.data.addresses)}}function ni(e,t){if(1&e&&(l.Ob(0),l.Lb(1,"decimal-field",64),l.Lb(2,"decimal-field",65),l.Nb()),2&e){const e=l.Zb(3);l.xb(1),l.gc("label",e.i18n.ad.stockQuantity)("scale",e.decimalQuantity),l.xb(1),l.gc("label",e.i18n.ad.lowStockNotification)("scale",e.decimalQuantity)}}function ri(e,t){if(1&e&&l.Lb(0,"input-field",66),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.productNumber)("mask",e.mask)("placeholder",e.mask)}}function ci(e,t){if(1&e&&l.Lb(0,"field-option",54),2&e){const e=t.$implicit;l.gc("value",e.id)("id",e.id)("text",e.name)}}function si(e,t){if(1&e&&(l.Qb(0,"multi-selection-field",67),l.Bc(1,ci,1,3,"field-option",53),l.Pb()),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.deliveryMethods)("emptyLabel",0===e.deliveryMethods$.value.length?e.i18n.ad.noDeliveryMethodsAvailable:null),l.xb(1),l.gc("ngForOf",e.deliveryMethods$.value)}}function oi(e,t){if(1&e&&(l.Ob(0),l.Lb(1,"boolean-field",55),l.Qb(2,"radio-group-field",56),l.Lb(3,"field-option",57),l.Lb(4,"field-option",58),l.Lb(5,"field-option",59),l.Pb(),l.Bc(6,ni,3,4,"ng-container",1),l.ac(7,"async"),l.Lb(8,"decimal-field",60),l.Lb(9,"decimal-field",61),l.Bc(10,ri,1,3,"input-field",62),l.Bc(11,si,2,3,"multi-selection-field",63),l.ac(12,"async"),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.ad.allowDecimalQuantity),l.xb(1),l.gc("label",e.i18n.ad.stockType),l.xb(1),l.gc("text",e.i18n.ad.available),l.xb(1),l.gc("text",e.i18n.ad.notAvailable),l.xb(1),l.gc("text",e.i18n.ad.quantity),l.xb(1),l.gc("ngIf","quantity"===(e.form.value||l.bc(7,12,e.form.valueChanges)).stockType),l.xb(2),l.gc("label",e.i18n.ad.maxAllowedInCart)("scale",e.decimalQuantity),l.xb(1),l.gc("label",e.i18n.ad.minAllowedInCart)("scale",e.decimalQuantity),l.xb(1),l.gc("ngIf",e.requiredProductNumber),l.xb(1),l.gc("ngIf",l.bc(12,14,e.deliveryMethods$))}}function li(e,t){if(1&e){const e=l.Rb();l.Qb(0,"action-button",68),l.Xb("action",(function(){return l.sc(e),l.Zb(2).save(!0)})),l.ac(1,"async"),l.Pb()}if(2&e){const e=l.Zb(2);l.gc("disabled",l.bc(1,2,e.requesting$))("label",e.i18n.ad.saveAndInsertNew)}}function bi(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Qb(3,"form",3),l.Bc(4,Ht,13,12,"ng-container",1),l.Bc(5,qt,1,0,"hr",4),l.Bc(6,Gt,2,2,"label-value",5),l.Bc(7,Vt,2,2,"label-value",5),l.Bc(8,jt,3,4,"label-value",5),l.Lb(9,"input-field",6),l.Bc(10,Kt,2,2,"single-selection-field",7),l.Bc(11,Xt,2,2,"multi-selection-field",7),l.Bc(12,Wt,2,3,"single-selection-field",8),l.Bc(13,Yt,1,5,"decimal-field",9),l.ac(14,"async"),l.Qb(15,"label-value",10),l.ac(16,"async"),l.Qb(17,"div",11),l.Qb(18,"div",12),l.Lb(19,"date-field",13),l.Pb(),l.Qb(20,"div",14),l.Dc(21),l.Pb(),l.Qb(22,"div",15),l.Lb(23,"date-field",16),l.Pb(),l.Pb(),l.Pb(),l.Lb(24,"boolean-field",17),l.Bc(25,ei,11,5,"ng-container",1),l.ac(26,"async"),l.Lb(27,"html-field",18),l.Bc(28,ti,1,3,"custom-field-input",19),l.Bc(29,ai,2,2,"multi-selection-field",20),l.Bc(30,oi,13,16,"ng-container",1),l.Pb(),l.Qb(31,"actions"),l.Qb(32,"action-button",21),l.Xb("action",(function(){return l.sc(e),l.Zb().save()})),l.Pb(),l.Bc(33,li,2,4,"action-button",22),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.create?e.i18n.ad.title.new:e.i18n.ad.title.edit)("mobileHeading",e.create?e.i18n.ad.mobileTitle.new:e.i18n.ad.mobileTitle.edit)("headingActions",l.bc(2,25,e.headingActions$)),l.xb(2),l.gc("formGroup",e.form),l.xb(1),l.gc("ngIf",e.data.maxImages>0),l.xb(1),l.gc("ngIf",e.data.maxImages>0),l.xb(1),l.gc("ngIf",!e.self),l.xb(1),l.gc("ngIf",!e.create),l.xb(1),l.gc("ngIf",!e.create),l.xb(1),l.gc("label",e.i18n.general.name),l.xb(1),l.gc("ngIf",1==e.data.maxCategoriesPerAd),l.xb(1),l.gc("ngIf",e.data.maxCategoriesPerAd>1),l.xb(1),l.gc("ngIf",e.data.currencies&&e.data.currencies.length>1),l.xb(1),l.gc("ngIf",l.bc(14,27,e.currency$)),l.xb(2),l.gc("label",e.i18n.ad.publicationPeriod)("fieldSize",l.bc(16,29,e.layout.ltsm$)?"medium":""),l.xb(6),l.Fc(" ",e.i18n.general.periodTo," "),l.xb(3),l.gc("label",e.i18n.ad.setPromotionalPeriod),l.xb(1),l.gc("ngIf",l.bc(26,31,e.form.get("setPromotionalPeriod").valueChanges)||e.form.get("setPromotionalPeriod").value),l.xb(2),l.gc("label",e.i18n.general.description),l.xb(1),l.gc("ngForOf",e.data.customFields),l.xb(1),l.gc("ngIf",e.data.addresses),l.xb(1),l.gc("ngIf",e.webshop),l.xb(2),l.gc("label",e.i18n.general.save),l.xb(1),l.gc("ngIf",e.data.canCreateNew)}}let di=(()=>{class e extends c.a{constructor(e,t,i,a,n,r){super(e),this.imagesService=t,this.modal=i,this.changeDetector=a,this.marketplaceHelper=n,this.marketplaceService=r,this.categories=[],this.images$=new A.a([]),this.currency$=new A.a(null),this.deliveryMethods$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.basedOnId=this.route.snapshot.queryParams.basedOnId,this.id=this.route.snapshot.params.id,this.kind=this.route.snapshot.paramMap.get("kind"),this.create=null==this.id;const e=this.create?this.marketplaceService.getAdDataForNew({basedOnId:this.basedOnId,user:this.route.snapshot.params.user,kind:this.kind}):this.marketplaceService.getAdDataForEdit({ad:this.id});this.addSub(e.subscribe(e=>{!this.create&&e.maxImages>0?this.addSub(this.imagesService.listAdImages({ad:this.id}).subscribe(t=>{this.images=t,this.mainImage=this.images.length>0?this.ApiHelper.internalNameOrId(this.images[0]):null,this.data=e})):this.data=e}))}onDataInitialized(e){this.kind=e.kind,this.webshop=this.kind===C.c.WEBSHOP,this.self=this.authHelper.isSelfOrOwner(e.user),this.owner=this.self?this.ApiHelper.SELF:e.user.id,this.marketplaceHelper.populateCategories(this.categories,e.categories,0);const t=e.advertisement,i=t,a=t.categories&&1===e.maxCategoriesPerAd?t.categories[0]:t.categories,r=e.webshopSettings||{};this.requiredProductNumber=this.webshop&&!r.productNumberGenerated,this.mask=r.productNumberGenerated?"":r.productNumberMask;const c=Object(s.h)(e.currencies)?null:e.currencies[0];this.form=this.formBuilder.group({name:[t.name,n.G.required],categories:[a,n.G.required],currency:[c?this.ApiHelper.internalNameOrId(c):null,n.G.required],price:[t.price,this.webshop?n.G.required:null],publicationBeginDate:[t.publicationPeriod.begin,n.G.required],publicationEndDate:[t.publicationPeriod.end,n.G.required],setPromotionalPeriod:null!=t.promotionalPeriod,promotionalBeginDate:t.promotionalPeriod?t.promotionalPeriod.begin:null,promotionalEndDate:t.promotionalPeriod?t.promotionalPeriod.end:null,promotionalPrice:t.promotionalPrice,description:[t.description,n.G.required],maxAllowedInCart:t.maxAllowedInCart,minAllowedInCart:t.minAllowedInCart,allowDecimalQuantity:t.allowDecimalQuantity,unlimitedStock:!!this.create||t.unlimitedStock,stockQuantity:t.stockQuantity,minStockQuantityToNotify:t.minStockQuantityToNotify,productNumber:[t.productNumber,this.requiredProductNumber?n.G.required:null],version:i.version,stockType:this.webshop?this.resolveStockType(t):null,id:this.id,kind:this.kind}),this.form.addControl("addresses",this.formBuilder.control(t.addresses)),this.form.addControl("deliveryMethods",this.formBuilder.control(t.deliveryMethods)),this.form.addControl("customValues",this.fieldHelper.customValuesFormGroup(e.customFields,{currentValues:t.customValues})),this.addSub(this.form.get("currency").valueChanges.subscribe(t=>{this.updateCurrency(t,e),this.updateDeliveryMethods(e)})),this.currency=c,this.addSub(this.form.controls.stockType.valueChanges.subscribe(()=>this.updateStockControls())),this.uploadedImages=[],this.updateDeliveryMethods(e),this.updateStockControls()}resolveMenu(e){return this.self?e.kind===C.c.SIMPLE?o.b.SEARCH_USER_ADS:o.b.SEARCH_USER_WEBSHOP:this.menu.userMenu(e.user,o.b.SEARCH_ADS)}updateStockControls(){if(this.webshop){const e=this.form.controls.stockType.value;"available"===e||"notAvailable"===e?this.form.controls.stockQuantity.clearValidators():this.form.controls.stockQuantity.setValidators(n.G.required),this.form.controls.stockQuantity.updateValueAndValidity()}}updateCurrency(e,t){this.currency=t.currencies.find(t=>t.id===e||t.internalName===e)}updateDeliveryMethods(e){this.deliveryMethods$.next(e.deliveryMethods.filter(e=>null==e.chargeCurrency||e.chargeCurrency.id===(this.currency||{}).id))}resolveStockType(e){return this.create||e.unlimitedStock?"available":e.stockQuantity?"quantity":"notAvailable"}get status(){return this.marketplaceHelper.resolveStatusLabel(this.data.status)}save(e){if(!Object(s.F)(this.form))return;const t=Object(N.a)(this.form.value);t.publicationPeriod=this.ApiHelper.datePeriod(t.publicationBeginDate,t.publicationEndDate),delete t.publicationBeginDate,delete t.publicationEndDate,t.promotionalPeriod=t.setPromotionalPeriod?this.ApiHelper.datePeriod(t.promotionalBeginDate,t.promotionalEndDate):null,delete t.setPromotionalPeriod,delete t.promotionalBeginDate,delete t.promotionalEndDate,null==t.promotionalPeriod&&delete t.promotionalPrice,this.webshop&&(t.unlimitedStock="available"===t.stockType,"quantity"!==t.stockType&&(t.stockQuantity=null),delete t.stockType);const i=t=>{this.notification.snackBar(this.i18n.ad.adSaved),e?this.router.navigate(["/marketplace",this.owner,this.data.kind,"new"],{replaceUrl:!0,queryParams:{basedOnId:t||this.id}}):this.basedOnId?this.router.navigate(["/marketplace","edit",t],{replaceUrl:!0}):history.back()};if(this.data.requiresAuthorization&&this.self&&(t.submitForAuthorization=!1),this.create)t.images=this.uploadedImages.map(e=>e.id),this.addSub(this.marketplaceService.createAd({user:this.owner,body:t}).subscribe(i));else{const e=this.marketplaceService.updateAd({ad:this.id,body:t});this.mainImageChanged()?this.addSub(this.marketplaceService.getAdDataForEdit({ad:this.id,fields:["advertisement.version"]}).subscribe(a=>{t.version=a.advertisement.version,this.addSub(e.subscribe(i))})):this.addSub(e.subscribe(i))}}mainImageChanged(){const e=this.images.length>0?this.ApiHelper.internalNameOrId(this.images[0]):null;return null==this.mainImage&&null==e&&this.hasRemovedImages||this.mainImage!==e}manageImages(){const e=this.modal.show(wt.a,{class:"modal-form",initialState:{images:this.images,manageAfterConfirm:this.create}});e.content.result.pipe(Object(Ct.a)()).subscribe(t=>{if(this.hasRemovedImages=!Object(s.h)(t.removedImages),this.hasRemovedImages){for(const e of t.removedImages)this.addSub(this.imagesService.deleteImage({idOrKey:e}).subscribe());this.images=this.images.filter(e=>!t.removedImages.includes(e.id)),this.uploadedImages=this.uploadedImages.filter(e=>!t.removedImages.includes(e.id))}!Object(s.h)(t.order)&&(this.images=t.order.map(e=>this.images.find(t=>t.id===e)),this.create||this.addSub(this.imagesService.reorderAdImages({ids:t.order,ad:this.id}).subscribe())),e.hide()})}onUploadDone(e){this.images=[...this.images,...e],this.uploadedImages=[...this.uploadedImages||[],...e],this.changeDetector.detectChanges()}get canUploadImages(){return this.images.length<this.data.maxImages}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}get images(){return this.images$.value}set images(e){this.images$.next(e)}get creationDate(){return this.data.creationDate}get binaryValues(){return this.data.binaryValues}get decimalQuantity(){return this.form.controls.allowDecimalQuantity.value?2:0}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(St.a),l.Kb(Ot.b),l.Kb(l.h),l.Kb(B.a),l.Kb(kt.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["edit-ad"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["class","mt-4 mb-2",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","name","required","",3,"label"],["formControlName","categories","required","",3,"label",4,"ngIf"],["formControlName","currency",3,"label","required",4,"ngIf"],["formControlName","price",3,"label","scale","prefix","suffix","required",4,"ngIf"],["kind","field","required","",3,"label","fieldSize"],[1,"d-flex","flex-column","flex-sm-row","flex-wrap"],[1,"flex-grow"],["labelPosition","side","formControlName","publicationBeginDate","minDate","past5","fieldSize","full"],[1,"mx-2","d-flex","align-items-center"],[1,"flex-grow","mt-2","mt-xl-0"],["labelPosition","side","formControlName","publicationEndDate","minDate","past5","fieldSize","full"],["formControlName","setPromotionalPeriod",3,"label"],["formControlName","description","required","",3,"label"],[3,"field","formControl","binaryValues",4,"ngFor","ngForOf"],["formControlName","addresses",3,"label",4,"ngIf"],[3,"label","action"],["outline","",3,"disabled","label","action",4,"ngIf"],[1,"border-0","d-flex","mb-3","flex-column","flex-xs-row","justify-content-between","mt-2","mt-md-0"],[1,"mb-2","mb-xs-0"],["outline","",3,"label","action",4,"ngIf"],[1,"row","no-gutters"],["class","col-12 col-xs-6 col-sm-4 col-md-3 d-flex justify-content-center justify-content-center",4,"ngFor","ngForOf"],["class","d-flex justify-content-end",4,"ngIf"],["target","marketplace",3,"max","owner","user","uploadDone"],["multiUpload",""],["outline","",3,"label","action"],[1,"col-12","col-xs-6","col-sm-4","col-md-3","d-flex","justify-content-center","justify-content-center"],["size","huge","useLightbox","",1,"mb-1","mb-xs-3",3,"image","roundBorders","additionalImages"],[1,"col-12"],[1,"d-flex","justify-content-end"],[1,"mt-4","mb-2"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","categories","required","",3,"label"],[3,"value","id","internalName","text","style","level","disabled",4,"ngFor","ngForOf"],[3,"value","id","internalName","text","level","disabled"],["formControlName","currency",3,"label","required"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","price",3,"label","scale","prefix","suffix","required"],["kind","field",3,"label"],["labelPosition","side","formControlName","promotionalBeginDate","minDate","past5","fieldSize","full"],["labelPosition","side","formControlName","promotionalEndDate","minDate","past5","fieldSize","full"],["formControlName","promotionalPrice",3,"label","scale","prefix","suffix",4,"ngIf"],["formControlName","promotionalPrice",3,"label","scale","prefix","suffix"],[3,"field","formControl","binaryValues"],["formControlName","addresses",3,"label"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],["formControlName","allowDecimalQuantity",3,"label"],["formControlName","stockType",3,"label"],["value","available",3,"text"],["value","notAvailable",3,"text"],["value","quantity",3,"text"],["formControlName","maxAllowedInCart",3,"label","scale"],["formControlName","minAllowedInCart",3,"label","scale"],["type","text","formControlName","productNumber","required","",3,"label","mask","placeholder",4,"ngIf"],["formControlName","deliveryMethods",3,"label","emptyLabel",4,"ngIf"],["formControlName","stockQuantity","required","",3,"label","scale"],["formControlName","minStockQuantityToNotify",3,"label","scale"],["type","text","formControlName","productNumber","required","",3,"label","mask","placeholder"],["formControlName","deliveryMethods",3,"label","emptyLabel"],["outline","",3,"disabled","label","action"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,bi,34,33,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,n.I,n.w,n.n,_e.a,n.v,n.l,n.D,m.a,Ft.a,We.a,Bt.a,d.s,p.a,v.a,Lt.a,f.a,g.a,Je.a,$.a,Nt.a,z.a,At.a,n.k,T.a,Tt.a],pipes:[d.b,$t.a],encapsulation:2,changeDetection:0}),e})();var ui=i("7NTk"),mi=i("USuC"),gi=i("JbOn");function fi(e,t){if(1&e&&(l.Qb(0,"label-value",18),l.Lb(1,"user-link",19),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.user)}}function hi(e,t){if(1&e&&l.Lb(0,"field-option",20),2&e){const e=t.$implicit,i=l.Zb(2);l.zc(e.leaf?"leaf":"parent"),l.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)("level",e.level)("disabled",!e.leaf)}}function pi(e,t){if(1&e&&l.Lb(0,"field-option",23),2&e){const e=t.$implicit,i=l.Zb(3);l.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function vi(e,t){if(1&e&&(l.Qb(0,"single-selection-field",21),l.Bc(1,pi,1,4,"field-option",22),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.currency),l.xb(1),l.gc("ngForOf",e.data.currencies)}}function yi(e,t){if(1&e&&l.Lb(0,"decimal-field",24),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.minPrice)("textRight",!1)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function xi(e,t){if(1&e&&l.Lb(0,"decimal-field",25),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.maxPrice)("textRight",!1)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function Pi(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Bc(3,fi,2,2,"label-value",3),l.Qb(4,"form",4),l.Lb(5,"input-field",5),l.Lb(6,"text-selection-field",6),l.Qb(7,"single-selection-field",7),l.Lb(8,"field-option",8),l.Lb(9,"field-option",9),l.Pb(),l.Lb(10,"user-field",10),l.Qb(11,"single-selection-field",11),l.Bc(12,hi,1,8,"field-option",12),l.Pb(),l.Bc(13,vi,2,2,"single-selection-field",13),l.Bc(14,yi,1,5,"decimal-field",14),l.ac(15,"async"),l.Bc(16,xi,1,5,"decimal-field",15),l.ac(17,"async"),l.Pb(),l.Qb(18,"actions",16),l.Qb(19,"action-button",17),l.Xb("action",(function(){return l.sc(e),l.Zb().save()})),l.ac(20,"async"),l.Pb(),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.create?e.i18n.ad.title.adInterestNew:e.i18n.ad.title.adInterest)("mobileHeading",e.create?e.i18n.ad.mobileTitle.adInterestNew:e.i18n.ad.mobileTitle.adInterest)("headingActions",l.bc(2,19,e.headingActions$)),l.xb(2),l.gc("ngIf",!e.self),l.xb(1),l.gc("formGroup",e.form),l.xb(1),l.gc("label",e.i18n.general.name),l.xb(1),l.gc("label",e.i18n.general.keywords),l.xb(1),l.gc("label",e.i18n.general.type)("emptyOption",e.i18n.general.all),l.xb(1),l.gc("text",e.i18n.ad.type.simple),l.xb(1),l.gc("text",e.i18n.ad.type.webshop),l.xb(1),l.gc("label",e.i18n.general.by),l.xb(1),l.gc("label",e.i18n.ad.category),l.xb(1),l.gc("ngForOf",e.categories),l.xb(1),l.gc("ngIf",e.data.currencies&&e.data.currencies.length>1),l.xb(1),l.gc("ngIf",l.bc(15,21,e.currency$)),l.xb(2),l.gc("ngIf",l.bc(17,23,e.currency$)),l.xb(3),l.gc("disabled",l.bc(20,25,e.requesting$))("label",e.i18n.general.submit)}}let Ii=(()=>{class e extends c.a{constructor(e,t,i){super(e),this.adInterestService=t,this.marketplaceHelper=i,this.categories=[],this.currency$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.id=this.route.snapshot.params.id,this.create=null==this.id;const e=this.create?this.adInterestService.getAdInterestDataForNew({user:this.user}):this.adInterestService.getAdInterestDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=e.adInterest,i=t.currency?t.currency:Object(s.h)(e.currencies)?null:this.ApiHelper.internalNameOrId(e.currencies[0]);this.marketplaceHelper.populateCategories(this.categories,e.categories,0),this.form=this.formBuilder.group({name:[t.name,n.G.required],keywords:[t.keywords,null],kind:t.kind,category:t.category,user:t.user,minPrice:t.minPrice,maxPrice:t.maxPrice,currency:i,version:t.version}),this.updateCurrency(e),this.addSub(this.form.controls.currency.valueChanges.subscribe(()=>this.updateCurrency(e)))}updateCurrency(e){const t=this.form.controls.currency.value;this.currency=e.currencies.find(e=>e.id===t||e.internalName===t)||e.currencies[0]}save(){if(!Object(s.F)(this.form))return;const e=this.form.value,t=this.create?this.adInterestService.createAdInterest({body:e,user:this.user}):this.adInterestService.updateAdInterest({id:this.id,body:e});this.addSub(t.subscribe(()=>{this.notification.snackBar(this.create?this.i18n.ad.adInterestCreated:this.i18n.ad.adInterestSaved),history.back()}))}resolveMenu(e){return this.menu.userMenu(e.user,o.b.AD_INTERESTS)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(ui.a),l.Kb(B.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["edit-ad-interest"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"label",4,"ngIf"],[3,"formGroup"],["formControlName","name","required","",3,"label"],["formControlName","keywords",3,"label"],["formControlName","kind",3,"label","emptyOption"],["value","simple",3,"text"],["value","webshop",3,"text"],["formControlName","user",3,"label"],["formControlName","category",3,"label"],[3,"value","id","internalName","text","style","level","disabled",4,"ngFor","ngForOf"],["formControlName","currency",3,"label",4,"ngIf"],["formControlName","minPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix",4,"ngIf"],["formControlName","maxPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix",4,"ngIf"],["forceRow",""],[3,"disabled","label","action"],[3,"label"],[3,"user"],[3,"value","id","internalName","text","level","disabled"],["formControlName","currency",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","minPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix"],["formControlName","maxPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Pi,21,27,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,n.I,n.w,n.n,_e.a,n.v,n.l,n.D,mi.a,Je.a,$.a,gi.a,d.s,p.a,v.a,m.a,g.a,z.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();function Qi(e,t){if(1&e&&l.Lb(0,"user-info",7),2&e){const e=l.Zb(2);l.gc("user",e.data.user)}}function Di(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",11),l.Qb(1,"button",12),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(2).remove(i),t.stopPropagation(),t.preventDefault()})),l.Lb(2,"icon",13),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(3);l.xb(1),l.gc("tooltip",e.i18n.general.remove)}}function Si(e,t){if(1&e&&(l.Qb(0,"mobile-result"),l.Qb(1,"div",8),l.Qb(2,"div",9),l.Dc(3),l.Pb(),l.Bc(4,Di,3,1,"div",10),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(2);l.xb(3),l.Ec(e.name),l.xb(1),l.gc("ngIf",i.data.canManage)}}function ki(e,t){1&e&&l.Lb(0,"th",17)}function wi(e,t){if(1&e){const e=l.Rb();l.Qb(0,"td",17),l.Qb(1,"button",12),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(3).remove(i),t.stopPropagation()})),l.Lb(2,"icon",13),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(4);l.xb(1),l.gc("tooltip",e.i18n.general.remove)}}function Ci(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"tr",18),l.Xb("click",(function(){l.sc(e);const i=t.$implicit,a=l.Zb(3);return a.router.navigate(a.viewPath(i))})),l.Qb(2,"td"),l.Dc(3),l.Pb(),l.Bc(4,wi,3,1,"td",15),l.Pb(),l.Nb()}if(2&e){const e=t.$implicit,i=l.Zb(3);l.xb(3),l.Fc(" ",e.name," "),l.xb(1),l.gc("ngIf",i.data.canManage)}}function Oi(e,t){if(1&e&&(l.Qb(0,"table",14),l.Qb(1,"thead"),l.Qb(2,"th"),l.Dc(3),l.Pb(),l.Bc(4,ki,1,0,"th",15),l.Pb(),l.Qb(5,"tbody"),l.Bc(6,Ci,5,2,"ng-container",16),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.xb(3),l.Ec(e.i18n.general.name),l.xb(1),l.gc("ngIf",e.data.canManage),l.xb(2),l.gc("ngForOf",e.data.adInterests)}}function Fi(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Bc(3,Qi,1,1,"user-info",3),l.Pb(),l.Qb(4,"results-layout",4),l.Bc(5,Si,5,2,"mobile-result",5),l.Bc(6,Oi,7,3,"table",6),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.adInterests)("mobileHeading",e.i18n.ad.mobileTitle.adInterests)("headingActions",l.bc(2,7,e.headingActions$))("mode",e.self?"empty":"normal"),l.xb(2),l.gc("ngIf",!e.self),l.xb(1),l.gc("results",e.data.adInterests)("toLink",e.toLink)}}let Bi=(()=>{class e extends c.a{constructor(e,t){super(e),this.adInterestService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.addSub(this.adInterestService.getUserAdInterestsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user),e.canCreate&&(this.headingActions=[new Re.c("add",this.i18n.general.addNew,()=>{this.router.navigate(["/marketplace",this.param,"ad-interests","new"])},!0)])}viewPath(e){return["/marketplace","ad-interests","view",e.id]}get toLink(){return e=>this.viewPath(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.name),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.adInterestService.deleteAdInterest({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.name)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,o.b.AD_INTERESTS)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(ui.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["list-ad-interests"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],[1,"cell-main"],["class","ml-auto text-right",4,"ngIf"],[1,"ml-auto","text-right"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],["class","actions",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Fi,7,9,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,R.a,H.a,q.a,st.a,G.a,V.b,j.a,d.s],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();function Li(e,t){if(1&e&&(l.Qb(0,"label-value",6),l.Lb(1,"user-link",7),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.user)}}function Ni(e,t){if(1&e&&l.Lb(0,"label-value",4),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.keywords)("value",e.data.keywords.join(", "))}}function Ai(e,t){if(1&e&&l.Lb(0,"label-value",4),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.type)("value",e.resolveKindLabel())}}function Ti(e,t){if(1&e&&l.Lb(0,"label-value",4),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.category)("value",e.data.category.name)}}function $i(e,t){if(1&e&&(l.Qb(0,"label-value",6),l.Lb(1,"user-link",7),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.by),l.xb(1),l.gc("user",e.data.user)}}const Zi=function(e,t){return{min:e,max:t}};function Ei(e,t){if(1&e&&l.Lb(0,"label-value",4),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.price)("value",e.format.formatRange(l.kc(2,Zi,e.data.minPrice,e.data.maxPrice),e.data.currency))}}function Mi(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Bc(3,Li,2,2,"label-value",3),l.Lb(4,"label-value",4),l.Qb(5,"h2"),l.Dc(6),l.Pb(),l.Bc(7,Ni,1,2,"label-value",5),l.Bc(8,Ai,1,2,"label-value",5),l.Bc(9,Ti,1,2,"label-value",5),l.Bc(10,$i,2,2,"label-value",3),l.Bc(11,Ei,1,5,"label-value",5),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.adInterests)("mobileHeading",e.i18n.ad.mobileTitle.adInterests)("headingActions",l.bc(2,12,e.headingActions$)),l.xb(2),l.gc("ngIf",!e.self),l.xb(1),l.gc("label",e.i18n.general.name)("value",e.data.name),l.xb(2),l.Ec(e.i18n.ad.matchFields),l.xb(1),l.gc("ngIf",!e.empty(e.data.keywords)),l.xb(1),l.gc("ngIf",e.data.kind),l.xb(1),l.gc("ngIf",e.data.category),l.xb(1),l.gc("ngIf",e.data.user),l.xb(1),l.gc("ngIf",e.data.minPrice||e.data.maxPrice)}}let Ri=(()=>{class e extends vt.a{constructor(e,t){super(e),this.adInterestService=t,this.empty=s.h}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.adInterestService.viewAdInterest({id:this.id}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=[];e.canEdit&&t.push(new Re.c("edit",this.i18n.general.edit,()=>this.router.navigate(["/marketplace","ad-interests","edit",this.id]),!0)),this.headingActions=t}resolveMenu(e){return this.menu.userMenu(e.user,o.b.AD_INTERESTS)}resolveKindLabel(){return this.data.kind===C.c.SIMPLE?this.i18n.ad.type.simple:this.i18n.ad.type.webshop}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(ui.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["view-ad-interest"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"label",4,"ngIf"],[3,"label","value"],[3,"label","value",4,"ngIf"],[3,"label"],[3,"user"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Mi,12,14,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,m.a,g.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();var Hi=i("ucoc"),qi=i("Ky6R"),Gi=i("oj/z");const Vi=function(e){return{"text-decoration":e,"max-width":"75%"}};function ji(e,t){if(1&e&&(l.Qb(0,"mobile-result",7),l.Qb(1,"div",8),l.Qb(2,"div",9),l.Dc(3),l.ac(4,"currency"),l.Pb(),l.Qb(5,"div",10),l.Dc(6),l.Pb(),l.Pb(),l.Lb(7,"div",11),l.Qb(8,"div",12),l.Dc(9),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.Zb();l.gc("avatarImage",e.image),l.xb(3),l.Fc(" ",l.cc(4,6,e.promotionalPrice||e.price,i.currency)," "),l.xb(2),l.gc("ngStyle",l.jc(9,Vi,i.isOutOfStock(e)?"line-through":"")),l.xb(1),l.Fc(" ",e.name," "),l.xb(3),l.Gc(" ",i.i18n.ad.stock,": ",i.resolveStockLabel(e),"")}}const zi=function(e){return{"text-decoration":e}},Ki=function(e){return{"text-muted":e}};function Ui(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"tr",18),l.Xb("click",(function(){l.sc(e);const i=t.$implicit;return l.Zb(2).addProduct(i)})),l.Qb(2,"td",14),l.Lb(3,"avatar",19),l.Pb(),l.Qb(4,"td",20),l.Qb(5,"span",21),l.Dc(6),l.Pb(),l.Pb(),l.Qb(7,"td",22),l.Dc(8),l.Pb(),l.Qb(9,"td",16),l.Dc(10),l.ac(11,"currency"),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=t.$implicit,i=l.Zb(2);l.xb(3),l.gc("image",e.image),l.xb(1),l.gc("ngStyle",l.jc(9,zi,i.isOutOfStock(e)?"line-through":"")),l.xb(2),l.Ec(e.name),l.xb(1),l.gc("ngClass",l.jc(11,Ki,i.isOutOfStock(e))),l.xb(1),l.Fc(" ",i.resolveStockLabel(e),""),l.xb(2),l.Fc(" ",l.cc(11,6,e.promotionalPrice||e.price,i.currency)," ")}}function Xi(e,t){if(1&e&&(l.Qb(0,"table",13),l.Qb(1,"thead"),l.Lb(2,"th",14),l.Qb(3,"th",15),l.Dc(4),l.Pb(),l.Qb(5,"th"),l.Dc(6),l.Pb(),l.Qb(7,"th",16),l.Dc(8),l.Pb(),l.Pb(),l.Qb(9,"tbody"),l.Bc(10,Ui,12,13,"ng-container",17),l.ac(11,"async"),l.Pb(),l.Pb()),2&e){const e=l.Zb();var i;l.xb(4),l.Ec(e.i18n.ad.product),l.xb(2),l.Ec(e.i18n.ad.stockQuantity),l.xb(2),l.Ec(e.i18n.ad.price),l.xb(2),l.gc("ngForOf",null==(i=l.bc(11,4,e.results$))?null:i.results)}}function _i(e,t){1&e&&l.Lb(0,"spinner",23)}const Wi=function(){return{"min-height":"44vh"}};let Yi=(()=>{class e extends E.a{constructor(e,t,i){super(e),this.modalRef=t,this.marketplaceService=i,this.pageSize=8,this.select=new l.n,this.results$=new A.a(null),this.rendering$=new A.a(!1)}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({keywords:null}),this.addSub(this.form.controls.keywords.valueChanges.subscribe(()=>this.update())),this.update()}update(e){this.rendering=!0,this.results=null,this.addSub(this.doSearch(e).subscribe(e=>this.results=qi.a.from(e)))}get onClick(){return e=>this.addProduct(e)}addProduct(e){this.isOutOfStock(e)||(this.notification.snackBar(this.i18n.ad.addedProductOrder),this.select.emit(e))}doSearch(e){const t=e||{};return this.marketplaceService.searchUserAds$Response({user:this.ApiHelper.SELF,kind:C.c.WEBSHOP,currency:this.currency.id,statuses:[C.e.ACTIVE],pageSize:t.pageSize||this.pageSize,page:t.page||0,keywords:this.form.controls.keywords.value})}close(){this.modalRef.hide()}get results(){return this.results$.value}set results(e){this.results$.next(e)}get rendering(){return this.rendering$.value}set rendering(e){this.rendering$.next(e)}resolveStockLabel(e){if(!e.unlimitedStock){const t=+e.stockQuantity||0;return 0===t?this.i18n.ad.outOfStock:this.format.formatAsNumber(e.stockQuantity,t%1==0?0:2)}return this.i18n.ad.unlimited}isOutOfStock(e){return this.resolveStockLabel(e)===this.i18n.ad.outOfStock}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Ot.a),l.Kb(kt.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["search-products"]],inputs:{currency:"currency"},outputs:{select:"select"},features:[l.ub],decls:12,vars:11,consts:[[1,"mb-2","mb-md-0",3,"formGroup"],["formControlName","keywords",3,"label"],["resultType","list",3,"results","onClick","rendering$","ngStyle","update"],["avatarIcon","shopping_basket",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"label","action"],["spinner",""],["avatarIcon","shopping_basket",3,"avatarImage"],[1,"cell-date-amount"],[1,"cell-amount"],[1,"cell-date","cell-main",3,"ngStyle"],[1,"clearfix"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","35%"],[1,"text-right"],[4,"ngFor","ngForOf"],[3,"click"],["icon","shopping_basket",3,"image"],[3,"ngStyle"],[1,"ellipsis-clamp-2"],[3,"ngClass"],[1,"mx-auto","my-3"]],template:function(e,t){1&e&&(l.Qb(0,"h1"),l.Dc(1),l.Pb(),l.Qb(2,"form",0),l.Lb(3,"input-field",1),l.Pb(),l.Qb(4,"results-layout",2),l.Xb("update",(function(e){return t.update(e)})),l.ac(5,"async"),l.Bc(6,ji,10,11,"mobile-result",3),l.Bc(7,Xi,12,6,"table",4),l.Pb(),l.Qb(8,"actions"),l.Qb(9,"action-button",5),l.Xb("action",(function(){return t.close()})),l.Pb(),l.Pb(),l.Bc(10,_i,1,0,"ng-template",null,6,l.Cc)),2&e&&(l.xb(1),l.Ec(t.i18n.ad.addProducts),l.xb(1),l.gc("formGroup",t.form),l.xb(1),l.gc("label",t.i18n.general.keywords),l.xb(1),l.gc("results",l.bc(5,8,t.results$))("onClick",t.onClick)("rendering$",t.rendering$)("ngStyle",l.ic(10,Wi)),l.xb(5),l.gc("label",t.i18n.general.close))},directives:[n.I,n.w,n.n,_e.a,n.v,n.l,R.a,d.w,H.a,q.a,p.a,v.a,G.a,d.s,f.a,d.q,Gi.a],pipes:[d.b,K.a],encapsulation:2,changeDetection:0}),e})();var Ji=i("/uUt");function ea(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.ac(2,"currency"),l.Nb()),2&e){const e=l.Zb().$implicit,t=l.Zb(2);l.xb(1),l.Fc(" ",l.cc(2,1,t.rowTotal(e),t.currency)," ")}}const ta=function(){return{"max-width":"130px"}};function ia(e,t){if(1&e){const e=l.Rb();l.Qb(0,"tr"),l.Qb(1,"td"),l.Dc(2),l.Pb(),l.Qb(3,"td",19),l.Xb("click",(function(){l.sc(e);const i=t.$implicit;return l.Zb(2).navigate(i)})),l.Qb(4,"span",20),l.Dc(5),l.Pb(),l.Pb(),l.Qb(6,"td",21),l.Dc(7),l.ac(8,"currency"),l.Pb(),l.Qb(9,"td",21),l.Lb(10,"decimal-field",22),l.Pb(),l.Qb(11,"td",21),l.Lb(12,"decimal-field",22),l.Pb(),l.Qb(13,"td",21),l.Lb(14,"decimal-field",23),l.Pb(),l.Qb(15,"td",24),l.Bc(16,ea,3,4,"ng-container",13),l.ac(17,"async"),l.Pb(),l.Qb(18,"td",25),l.Qb(19,"button",26),l.Xb("click",(function(){l.sc(e);const i=t.$implicit;return l.Zb(2).remove(i)})),l.Lb(20,"icon",27),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit,i=l.Zb(2);l.xb(2),l.Fc("",e.product.productNumber," "),l.xb(1),l.gc("ngStyle",l.ic(21,ta)),l.xb(2),l.Ec(e.product.name),l.xb(2),l.Fc(" ",l.cc(8,16,e.product.price,i.currency)," "),l.xb(3),l.gc("formControl",i.form.controls[i.discount(e)])("scale",2),l.xb(2),l.gc("formControl",i.form.controls[i.price(e)])("scale",i.currency.decimalDigits),l.xb(2),l.gc("formControl",i.form.controls[i.quantity(e)])("minRange",e.product.allowDecimalQuantity?null:1)("maxRange",e.product.allowDecimalQuantity?null:10)("customValueLabel",i.i18n.ad.customQuantity)("scale",e.product.allowDecimalQuantity?2:0),l.xb(1),l.gc("ngStyle",l.ic(22,ta)),l.xb(1),l.gc("ngIf",l.bc(17,19,i.form.valueChanges)||e.totalPrice),l.xb(3),l.gc("tooltip",i.i18n.general.remove)}}function aa(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.ac(2,"currency"),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",l.cc(2,1,e.subtotal,e.currency)," ")}}function na(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",e.i18n.ad.deliveryMethod+": "+(e.deliveryMethod.name||"")," ")}}function ra(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.ac(2,"currency"),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",e.deliveryMethod.price?l.cc(2,1,e.deliveryMethod.price,e.currency):e.i18n.general.notSet," ")}}function ca(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.ac(2,"currency"),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",l.cc(2,1,e.total,e.currency)," ")}}function sa(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"form",2),l.Qb(2,"table",3),l.Qb(3,"thead"),l.Qb(4,"th",4),l.Dc(5),l.Pb(),l.Qb(6,"th",5),l.Dc(7),l.Pb(),l.Qb(8,"th",6),l.Dc(9),l.Pb(),l.Qb(10,"th",6),l.Dc(11),l.Pb(),l.Qb(12,"th",6),l.Dc(13),l.Pb(),l.Qb(14,"th",6),l.Dc(15),l.Pb(),l.Qb(16,"th",7),l.Dc(17),l.Pb(),l.Lb(18,"th",8),l.Pb(),l.Qb(19,"tbody"),l.Bc(20,ia,21,23,"tr",9),l.Qb(21,"tr",10),l.Qb(22,"td",11),l.Dc(23),l.Pb(),l.Qb(24,"td",12),l.Bc(25,aa,3,4,"ng-container",13),l.ac(26,"async"),l.Pb(),l.Lb(27,"td"),l.Pb(),l.Qb(28,"tr",10),l.Qb(29,"td"),l.Bc(30,na,2,1,"ng-container",13),l.ac(31,"async"),l.Pb(),l.Qb(32,"td",14),l.Bc(33,ra,3,4,"ng-container",13),l.ac(34,"async"),l.Pb(),l.Lb(35,"td"),l.Pb(),l.Qb(36,"tr",15),l.Qb(37,"td",16),l.Dc(38),l.Pb(),l.Qb(39,"td",17),l.Bc(40,ca,3,4,"ng-container",13),l.ac(41,"async"),l.ac(42,"async"),l.Pb(),l.Lb(43,"td",18),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("formGroup",e.form),l.xb(4),l.Ec(e.i18n.ad.number),l.xb(1),l.gc("ngStyle",l.ic(33,ta)),l.xb(1),l.Fc(" ",e.i18n.ad.product,""),l.xb(2),l.Fc("",e.i18n.ad.basePrice," "),l.xb(2),l.Fc("",e.i18n.ad.discount," "),l.xb(2),l.Ec(e.i18n.ad.price),l.xb(2),l.Fc("",e.i18n.ad.quantity," "),l.xb(1),l.gc("ngStyle",l.ic(34,ta)),l.xb(1),l.Fc(" ",e.i18n.transaction.amount,""),l.xb(3),l.gc("ngForOf",e.data),l.xb(2),l.yb("colspan",4),l.xb(1),l.Fc(" ",e.i18n.ad.subtotal,""),l.xb(1),l.yb("colspan",3),l.xb(1),l.gc("ngIf",l.bc(26,23,e.form.valueChanges)||e.data),l.xb(4),l.yb("colspan",4),l.xb(1),l.gc("ngIf",l.bc(31,25,e.deliveryMethod$)),l.xb(2),l.yb("colspan",3),l.xb(1),l.gc("ngIf",l.bc(34,27,e.deliveryMethod$)),l.xb(4),l.yb("colspan",4),l.xb(1),l.Fc(" ",e.i18n.ad.total,""),l.xb(1),l.yb("colspan",3),l.xb(1),l.gc("ngIf",l.bc(41,29,e.deliveryMethod$)||l.bc(42,31,e.form.valueChanges)||e.data)}}function oa(e,t){if(1&e&&(l.Qb(0,"div"),l.Dc(1),l.Pb()),2&e){const e=l.Zb();l.xb(1),l.Ec(e.i18n.ad.itemsNone)}}let la=(()=>{class e extends E.a{constructor(e){super(e),this.data$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.products$.subscribe(e=>{this.form=this.formBuilder.group({}),Object(s.h)(e)||e.forEach(e=>{const t=this.formBuilder.control(this.calculateDiscount(e,+e.price));this.form.addControl(this.discount(e),t);const i=this.formBuilder.control(e.price);this.form.addControl(this.price(e),i),this.addSub(t.valueChanges.pipe(Object(Ji.a)(),Object(M.a)(550)).subscribe(t=>this.applyDiscount(e,t))),this.addSub(i.valueChanges.pipe(Object(Ji.a)(),Object(M.a)(550)).subscribe(t=>this.applyPrice(e,t)));const a=this.formBuilder.control(e.quantity);this.form.addControl(this.quantity(e),a),this.addSub(a.valueChanges.pipe(Object(Ji.a)(),Object(M.a)(550)).subscribe(t=>e.quantity=t))}),this.data=e})}applyDiscount(e,t){let i;i=t<0?+e.product.price:t>100?0:+e.product.price-t/100*+e.product.price,this.form.controls[this.price(e)].setValue(i,{emitEvent:!1}),e.price=i.toString()}applyPrice(e,t){const i=this.calculateDiscount(e,t);t>+e.price?this.form.controls[this.price(e)].setValue(+e.price,{emitEvent:!1,onlySelf:!0}):e.price=t?t.toString():"0",this.form.controls[this.discount(e)].setValue(i,{emitEvent:!1})}calculateDiscount(e,t){const i=100*(1-t/+e.product.price);return i<0?0:i>100?100:i}discount(e){return e.product.id+"_discount"}quantity(e){return e.product.id+"_quantity"}price(e){return e.product.id+"_price"}rowTotal(e){return this.form.value[this.quantity(e)]*this.form.value[this.price(e)]}get subtotal(){let e=0;return this.data$.value.forEach(t=>e+=this.rowTotal(t)),e}get total(){const e=this.deliveryMethod?this.deliveryMethod.price:"";return this.subtotal+(Object(s.h)(e)?0:+e)}get deliveryMethod(){return this.deliveryMethod$.value}get data(){return this.data$.value}set data(e){this.data$.next(e)}navigate(e){return this.router.navigate(["/marketplace","view",e.product.id])}remove(e){const t=this.products$.value.filter(t=>t.product.id!==e.product.id);this.products$.next(t)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r))},e.\u0275cmp=l.Eb({type:e,selectors:[["order-products"]],inputs:{products$:"products$",deliveryMethod$:"deliveryMethod$",currency:"currency"},features:[l.ub],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["noProducts",""],[3,"formGroup"],[1,"table","table-hover"],["width","13%",1,"no-border"],["width","13%",1,"no-border",3,"ngStyle"],["width","13%",1,"no-border","text-right"],[1,"no-border","text-right","ellipsis",3,"ngStyle"],[1,"actions"],[4,"ngFor","ngForOf"],[1,"no-hover"],[1,"table-head-color"],[1,"table-head-color","text-right","ellipsis"],[4,"ngIf"],[1,"text-right","ellipsis"],[1,"totalAmount","no-hover"],[1,"border-bottom-0","label","label-value-label"],[1,"border-bottom-0","text-right","label-value-value","ellipsis"],[1,"border-bottom-0"],[1,"link",3,"ngStyle","click"],[1,"ellipsis-clamp-2"],[1,"text-right"],[3,"formControl","scale"],[3,"formControl","minRange","maxRange","customValueLabel","scale"],[1,"text-right","ellipsis",3,"ngStyle"],[1,"actions","actions-multiple"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","delete"]],template:function(e,t){if(1&e&&(l.Bc(0,sa,44,35,"ng-container",0),l.ac(1,"async"),l.Bc(2,oa,2,1,"ng-template",null,1,l.Cc)),2&e){const e=l.qc(3);l.gc("ngIf",l.bc(1,2,t.data$)&&t.data.length>0)("ngIfElse",e)}},directives:[d.t,n.I,n.w,n.n,d.w,d.s,z.a,n.v,n.k,V.b,j.a],pipes:[d.b,K.a],encapsulation:2,changeDetection:0}),e})();function ba(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"label-value",3),l.Dc(2),l.Pb(),l.Qb(3,"label-value",3),l.Dc(4),l.ac(5,"dateTime"),l.Pb(),l.Qb(6,"label-value",3),l.Dc(7),l.Pb(),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.ad.number),l.xb(1),l.Fc(" ",e.number," "),l.xb(1),l.gc("label",e.i18n.general.date),l.xb(1),l.Fc(" ",l.bc(5,6,e.creationDate)," "),l.xb(2),l.gc("label",e.i18n.general.status),l.xb(1),l.Fc(" ",e.resolveStatusLabel()," ")}}function da(e,t){if(1&e&&l.Lb(0,"field-option",24),2&e){const e=t.$implicit;l.gc("value",e.name)("text",e.name)}}function ua(e,t){if(1&e&&l.Lb(0,"field-option",24),2&e){const e=t.$implicit,i=l.Zb(2);l.gc("value",i.resolveAddressId(e))("text",e.name)}}const ma=function(e){return{"section-title-action":e}};function ga(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"page-content",2),l.Bc(2,ba,8,8,"ng-container",1),l.Qb(3,"label-value",3),l.Lb(4,"user-link",4),l.Pb(),l.Qb(5,"div",5),l.Qb(6,"h2",6),l.Qb(7,"div",7),l.Dc(8),l.Pb(),l.Qb(9,"div",8),l.ac(10,"async"),l.Qb(11,"action-button",9),l.Xb("action",(function(){return l.sc(e),l.Zb().addProducts()})),l.Pb(),l.Pb(),l.Pb(),l.Lb(12,"order-products",10),l.Qb(13,"h2",11),l.Dc(14),l.Pb(),l.Qb(15,"single-selection-field",12),l.Bc(16,da,1,2,"field-option",13),l.Pb(),l.Lb(17,"div",14),l.Qb(18,"div",5),l.Lb(19,"input-field",15),l.Lb(20,"decimal-field",16),l.Lb(21,"time-interval-field",17),l.Lb(22,"time-interval-field",18),l.Pb(),l.Qb(23,"h2",11),l.Dc(24),l.Pb(),l.Qb(25,"single-selection-field",19),l.Bc(26,ua,1,2,"field-option",13),l.Pb(),l.Lb(27,"div",14),l.Lb(28,"address-form",20),l.Qb(29,"h2"),l.Dc(30),l.Pb(),l.Lb(31,"textarea-field",21),l.Pb(),l.Qb(32,"actions"),l.Qb(33,"action-button",22),l.Xb("action",(function(){return l.sc(e),l.Zb().save()})),l.ac(34,"async"),l.Pb(),l.Qb(35,"action-button",23),l.Xb("action",(function(){return l.sc(e),l.Zb().save(!0)})),l.ac(36,"async"),l.Pb(),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.create?e.i18n.ad.title.newOrder:e.i18n.ad.title.order)("mobileHeading",e.create?e.i18n.ad.mobileTitle.newOrder:e.i18n.ad.mobileTitle.order),l.xb(1),l.gc("ngIf",!e.create),l.xb(1),l.gc("label",e.i18n.ad.buyer),l.xb(1),l.gc("user",e.data.buyer),l.xb(1),l.gc("formGroup",e.form),l.xb(3),l.Fc(" ",e.i18n.ad.products," "),l.xb(1),l.gc("ngClass",l.jc(41,ma,l.bc(10,35,e.layout.gtsm$))),l.xb(2),l.gc("label",e.i18n.ad.addProducts),l.xb(1),l.gc("products$",e.products$)("deliveryMethod$",e.deliveryMethod$)("currency",e.currency),l.xb(2),l.Ec(e.i18n.ad.deliveryMethod),l.xb(1),l.gc("emptyOption",e.i18n.ad.customDeliveryMethod)("label",e.i18n.ad.chooseDeliveryMethod),l.xb(1),l.gc("ngForOf",e.data.deliveryMethods),l.xb(2),l.gc("formGroup",e.deliveryForm),l.xb(1),l.gc("label",e.i18n.general.name),l.xb(1),l.gc("label",e.i18n.ad.deliveryPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),l.xb(1),l.gc("label",e.i18n.ad.minDeliveryTime),l.xb(1),l.gc("label",e.i18n.ad.maxDeliveryTime),l.xb(2),l.Ec(e.i18n.ad.deliveryAddress),l.xb(1),l.gc("emptyOption",e.i18n.ad.customAddress)("label",e.i18n.ad.chooseDeliveryAddress),l.xb(1),l.gc("ngForOf",e.data.addresses),l.xb(2),l.gc("addressForm",e.addressForm)("configuration",e.data.addressConfiguration),l.xb(2),l.Ec(e.i18n.ad.remarks),l.xb(3),l.gc("disabled",l.bc(34,37,e.requesting$))("label",e.i18n.ad.submitToBuyer),l.xb(2),l.gc("disabled",l.bc(36,39,e.requesting$))("label",e.i18n.ad.saveDraft)}}let fa=(()=>{class e extends c.a{constructor(e,t,i,a,n){super(e),this.orderService=t,this.marketplaceHelper=i,this.addressHelper=a,this.modal=n,this.products$=new A.a(null),this.deliveryMethod$=new A.a(null),this.address$=new A.a(null)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.queryParams.buyer,t=this.route.snapshot.queryParams.currency;this.id=this.route.snapshot.params.id,this.user=this.route.snapshot.params.user,this.create=null==this.id;const i=this.create?this.orderService.getOrderDataForNew({buyer:e,user:this.user,currency:t}):this.orderService.getOrderDataForEdit({order:this.id});this.addSub(i.subscribe(e=>{this.data=e}))}onDataInitialized(e){this.form=this.formBuilder.group({remarks:e.order.remarks}),this.create&&!Object(s.h)(e.deliveryMethods)&&1===e.deliveryMethods.length&&(e.order.deliveryMethod=e.deliveryMethods[0]),this.deliveryForm=this.formBuilder.group({name:[null,n.G.required],price:[null,n.G.required],minTime:null,maxTime:[null,n.G.required]}),this.addSub(this.deliveryForm.valueChanges.subscribe(e=>this.deliveryMethod=e)),this.deliveryForm.patchValue(e.order.deliveryMethod);const t=this.formBuilder.control(e.deliveryMethods);this.form.addControl("deliveryMethod",t),e.order.deliveryMethod&&t.setValue(e.order.deliveryMethod.name),this.addSub(t.valueChanges.subscribe(t=>this.updateDelivery(t,e))),this.create&&!Object(s.h)(e.addresses)&&1===e.addresses.length&&(e.order.deliveryAddress=e.addresses[0]),this.addressForm=this.addressHelper.addressFormGroup(e.addressConfiguration),this.addressForm.patchValue(e.order.deliveryAddress);const i=this.formBuilder.control(e.addresses);this.form.addControl("address",i),this.address=e.order.deliveryAddress;const a=this.resolveAddressId(this.address);i.setValue(e.addresses.find(e=>a===this.resolveAddressId(e))?a:null),this.addSub(i.valueChanges.subscribe(t=>this.updateAddress(t,e)));const r=[];(e.items||[]).forEach(t=>{const i=e.order.items.filter(e=>e.product===t.id)[0];r.push({price:i.price,totalPrice:+i.price*+i.quantity,quantity:i.quantity,product:t})}),this.products=r}updateAddress(e,t){null==e?(this.addressForm.reset(),this.address=null):(this.address=t.addresses.find(t=>e===this.resolveAddressId(t)),this.addressForm.patchValue(this.address))}addProducts(){const e=this.modal.show(Yi,{class:"modal-form modal-form-medium",initialState:{currency:this.currency}});this.addSub(e.content.select.subscribe(e=>{this.addProduct(e)}))}addProduct(e){const t=this.products||[];let i=t.find(t=>t.product.id===e.id);null!=i?i.quantity=(+i.quantity+1).toString():(e.price=e.promotionalPrice||e.price,i={price:e.price,totalPrice:e.price,quantity:"1",product:e},t.push(i)),this.products=t}resolveAddressId(e){return null==e?null:[e.addressLine1,e.addressLine2,e.buildingNumber,e.city,e.complement,e.country,e.neighborhood,e.poBox,e.region,e.street,e.zip].join("")}updateDelivery(e,t){if(null==e)this.deliveryForm.reset();else{const i=t.deliveryMethods.find(t=>e===t.name);this.deliveryForm.patchValue(this.deliveryMethod?{name:i.name,price:i.chargeAmount||null,minTime:i.minDeliveryTime,maxTime:i.maxDeliveryTime}:null)}}get address(){return this.address$.value}set address(e){this.address$.next(e)}get products(){return this.products$.value}set products(e){this.products$.next(e)}get deliveryMethod(){return this.deliveryMethod$.value}set deliveryMethod(e){this.deliveryMethod$.next(e)}get currency(){return this.create?this.data.currencies[0]:this.data.currency}save(e){const t=this.data.order;t.items=[],this.products.forEach(e=>{t.items.push({price:e.price,product:e.product.id,quantity:e.quantity})}),t.deliveryMethod=this.deliveryForm.value,t.deliveryAddress=this.addressForm.value,t.remarks=this.form.controls.remarks.value,t.draft=e||!1;const i=()=>{this.notification.snackBar(e?this.i18n.ad.orderSavedAsDraft:this.i18n.ad.orderSubmittedToBuyer),history.back()},a=()=>{this.addSub(this.create?this.orderService.createOrder({user:this.user,body:t}).subscribe(i):this.orderService.updateOrder({order:this.id,body:t}).subscribe(i))};e?a():this.notification.confirm({message:this.i18n.ad.submitToBuyerConfirmation,callback:a})}resolveStatusLabel(){return this.marketplaceHelper.resolveOrderStatusLabel(this.data.status)}resolveMenu(){return o.b.SALES}get number(){return this.data.number}get creationDate(){return this.data.creationDate}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Hi.a),l.Kb(B.a),l.Kb(F.a),l.Kb(Ot.b))},e.\u0275cmp=l.Eb({type:e,selectors:[["sale-form"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],[3,"label"],[3,"user"],[3,"formGroup"],[1,"mt-3","mb-2","d-flex","flex-column","flex-xs-row","justify-content-between"],[1,"mb-2","mb-xs-0"],[3,"ngClass"],["outline","",3,"label","action"],[3,"products$","deliveryMethod$","currency"],[1,"mt-2"],["formControlName","deliveryMethod",3,"emptyOption","label"],[3,"value","text",4,"ngFor","ngForOf"],[1,"any-label-value"],["formControlName","name","required","",3,"label"],["formControlName","price","fieldSize","full","required","",3,"label","scale","prefix","suffix"],["formControlName","minTime",3,"label"],["formControlName","maxTime","required","",3,"label"],["formControlName","address",3,"emptyOption","label"],[3,"addressForm","configuration"],["formControlName","remarks"],[3,"disabled","label","action"],["outline","",3,"disabled","label","action"],[3,"value","text"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,ga,37,43,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,m.a,g.a,n.w,n.n,d.q,v.a,la,Je.a,n.v,n.l,d.s,_e.a,n.D,z.a,Ye.a,Z.a,h.a,p.a,$.a],pipes:[d.b,y.a],encapsulation:2,changeDetection:0}),e})();var ha=i("R8pA"),pa=i("rCAV"),va=i("v4xg"),ya=i("TFmz"),xa=i("+HmS"),Pa=i("lDE4");function Ia(e,t){if(1&e){const e=l.Rb();l.Qb(0,"a",5),l.Xb("click",(function(i){l.sc(e);const a=t.$implicit;return l.Zb().emit(a,i)})),l.Dc(1),l.Pb()}if(2&e){const e=t.$implicit;l.xb(1),l.Fc(" ",e.name,"\n")}}let Qa=(()=>{class e extends E.a{constructor(e,t){super(e),this.modalRef=t,this.select=new l.n}emit(e,t){this.select.emit(e),t.preventDefault(),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Ot.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["show-sub-categories"]],inputs:{category:"category",image:"image",icon:"icon",color:"color"},outputs:{select:"select"},features:[l.ub],decls:8,vars:6,consts:[[1,"d-flex","justify-content-center"],["size","medium",3,"image","icon","iconColor"],["href","#",1,"ml-3","pt-1","flex-grow-1","undecorated",3,"click"],["class","d-block mb-1 undecorated","href","#",3,"click",4,"ngFor","ngForOf"],["outline","",3,"label","action"],["href","#",1,"d-block","mb-1","undecorated",3,"click"]],template:function(e,t){1&e&&(l.Qb(0,"h1",0),l.Lb(1,"avatar",1),l.Qb(2,"a",2),l.Xb("click",(function(e){return t.emit(t.category,e)})),l.Dc(3),l.Pb(),l.Pb(),l.Bc(4,Ia,2,1,"a",3),l.Qb(5,"actions"),l.Lb(6,"span"),l.Qb(7,"action-button",4),l.Xb("action",(function(){return t.modalRef.hide()})),l.Pb(),l.Pb()),2&e&&(l.xb(1),l.gc("image",t.image)("icon",t.icon)("iconColor",t.color),l.xb(2),l.Fc(" ",t.category.name," "),l.xb(1),l.gc("ngForOf",t.category.children),l.xb(3),l.gc("label",t.i18n.general.cancel))},directives:[f.a,d.s,p.a,v.a],encapsulation:2,changeDetection:0}),e})();var Da=i("L/K/"),Sa=i("7nZW"),ka=i("XvX2"),wa=i("5Wk5"),Ca=i("oOvo"),Oa=i("IJ5G"),Fa=i("cLCZ");function Ba(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"a",13),l.Xb("click",(function(i){l.sc(e);const a=t.$implicit,n=l.Zb(2);return i.preventDefault(),n.selectCategory(a)})),l.Dc(2),l.Pb(),l.Nb()}if(2&e){const e=t.$implicit;l.xb(2),l.Fc(" ",e.name," ")}}function La(e,t){if(1&e){const e=l.Rb();l.Qb(0,"a",14),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit,a=l.Zb();return t.preventDefault(),a.showAllChildren(i)})),l.Dc(1),l.Pb()}if(2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",e.i18n.ad.showAllCategories," ")}}function Na(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",6),l.Qb(1,"div",7),l.Qb(2,"a",8),l.Xb("click",(function(i){l.sc(e);const a=t.$implicit,n=l.Zb();return i.preventDefault(),n.selectCategory(a)})),l.Lb(3,"avatar",9),l.Dc(4),l.Pb(),l.Pb(),l.Qb(5,"div",10),l.Bc(6,Ba,3,1,"ng-container",11),l.Pb(),l.Bc(7,La,2,1,"a",12),l.ac(8,"async"),l.Pb()}if(2&e){const e=t.$implicit,i=l.Zb();l.xb(3),l.gc("image",i.categoryImage(e))("icon",i.categoryIcon(e))("iconColor",i.categoryColor(e)),l.xb(1),l.Fc(" ",e.name," "),l.xb(2),l.gc("ngForOf",i.categoryChildren(e)),l.xb(1),l.gc("ngIf",l.bc(8,6,i.layout.gtxxs$)&&i.hasMoreChildren(e))}}function Aa(e,t){if(1&e&&(l.Qb(0,"span",21),l.Dc(1),l.ac(2,"number"),l.Pb()),2&e){const e=l.Zb(2).$implicit,t=l.Zb();l.xb(1),l.Fc(" ",l.cc(2,1,e.price,t.decimals(e))," ")}}function Ta(e,t){if(1&e&&(l.Qb(0,"div",19),l.Bc(1,Aa,3,4,"span",20),l.Dc(2),l.ac(3,"currency"),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb();l.xb(1),l.gc("ngIf",e.promotionalPrice),l.xb(1),l.Fc(" ",l.cc(3,2,e.promotionalPrice||e.price,t.lookupCurrency(e))," ")}}function $a(e,t){if(1&e&&(l.Qb(0,"div",22),l.Lb(1,"format-field-value",23),l.Pb()),2&e){const e=t.$implicit,i=l.Zb().$implicit,a=l.Zb();l.xb(1),l.gc("fields",a.data.customFields)("plainText",!0)("fieldName",e)("object",i)}}function Za(e,t){if(1&e&&(l.Qb(0,"mobile-result",15),l.Bc(1,Ta,4,5,"div",16),l.Qb(2,"div",17),l.Dc(3),l.Pb(),l.Qb(4,"div",17),l.Dc(5),l.Pb(),l.Bc(6,$a,2,4,"div",18),l.Pb()),2&e){const e=t.$implicit,i=l.Zb();l.gc("avatarImage",e.image),l.xb(1),l.gc("ngIf",e.price),l.xb(2),l.Fc(" ",e.name," "),l.xb(2),l.Fc(" ",i.i18n.ad.byOwner(e.owner.display)," "),l.xb(1),l.gc("ngForOf",i.data.fieldsInList)}}function Ea(e,t){if(1&e&&(l.Qb(0,"th",29),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.Ec(e.i18n.ad.owner)}}function Ma(e,t){if(1&e&&(l.Qb(0,"th"),l.Dc(1),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(2);l.xb(1),l.Ec(i.fieldName(e))}}function Ra(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"td",25),l.Lb(2,"avatar",33),l.Pb(),l.Qb(3,"td"),l.Dc(4),l.Pb(),l.Nb()),2&e){const e=l.Zb().$implicit;l.xb(2),l.gc("image",e.owner.image),l.xb(2),l.Fc(" ",e.owner.display," ")}}function Ha(e,t){if(1&e&&(l.Qb(0,"td"),l.Lb(1,"format-field-value",23),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(2).$implicit,a=l.Zb(2);l.xb(1),l.gc("fields",a.data.customFields)("plainText",!0)("fieldName",e)("object",i)}}function qa(e,t){if(1&e&&(l.Ob(0),l.Bc(1,Ha,2,4,"td",11),l.Nb()),2&e){const e=l.Zb(3);l.xb(1),l.gc("ngForOf",e.data.fieldsInList)}}function Ga(e,t){if(1&e&&(l.Qb(0,"span",21),l.Dc(1),l.ac(2,"number"),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(2);l.xb(1),l.Fc(" ",l.cc(2,1,e.price,t.decimals(e))," ")}}function Va(e,t){if(1&e){const e=l.Rb();l.Qb(0,"tr",30),l.Xb("click",(function(){l.sc(e);const i=t.$implicit,a=l.Zb(2);return a.router.navigate(a.path(i))})),l.Qb(1,"td",25),l.Lb(2,"avatar",31),l.Pb(),l.Qb(3,"td"),l.Dc(4),l.Pb(),l.Bc(5,Ra,5,2,"ng-container",32),l.Bc(6,qa,2,1,"ng-container",32),l.ac(7,"async"),l.Qb(8,"td",27),l.Bc(9,Ga,3,4,"span",20),l.Dc(10),l.ac(11,"currency"),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit,i=l.Zb(2);l.xb(2),l.gc("image",e.image),l.xb(2),l.Fc(" ",e.name," "),l.xb(1),l.gc("ngIf",!i.singleUser),l.xb(1),l.gc("ngIf",l.bc(7,6,i.layout.gtxs$)),l.xb(3),l.gc("ngIf",e.promotionalPrice),l.xb(1),l.Fc(" ",l.cc(11,8,e.promotionalPrice||e.price,i.lookupCurrency(e))," ")}}function ja(e,t){if(1&e&&(l.Qb(0,"table",24),l.Qb(1,"thead"),l.Lb(2,"th",25),l.Qb(3,"th"),l.Dc(4),l.Pb(),l.Bc(5,Ea,2,1,"th",26),l.Bc(6,Ma,2,1,"th",11),l.Qb(7,"th",27),l.Dc(8),l.Pb(),l.Pb(),l.Qb(9,"tbody"),l.Bc(10,Va,12,11,"tr",28),l.Pb(),l.Pb()),2&e){const e=l.Zb();l.xb(4),l.Ec(e.i18n.ad.name),l.xb(1),l.gc("ngIf",!e.singleUser),l.xb(1),l.gc("ngForOf",e.data.fieldsInList),l.xb(2),l.Ec(e.i18n.ad.price),l.xb(2),l.gc("ngForOf",null==e.results?null:e.results.results)}}function za(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"div",38),l.Qb(2,"avatar",39),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit,a=l.Zb();return t.preventDefault(),a.router.navigate(["users",i.owner.id,"profile"])})),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.Zb().$implicit;l.xb(2),l.gc("image",e.owner.image)("tooltip",e.owner.display)}}function Ka(e,t){if(1&e&&(l.Qb(0,"span",21),l.Dc(1),l.ac(2,"number"),l.Pb()),2&e){const e=l.Zb(2).$implicit,t=l.Zb();l.xb(1),l.Fc(" ",l.cc(2,1,e.price,t.decimals(e))," ")}}function Ua(e,t){if(1&e&&(l.Qb(0,"div",40),l.Bc(1,Ka,3,4,"span",20),l.Dc(2),l.ac(3,"currency"),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb();l.xb(1),l.gc("ngIf",e.promotionalPrice),l.xb(1),l.Fc(" ",l.cc(3,2,e.promotionalPrice||e.price,t.lookupCurrency(e))," ")}}function Xa(e,t){1&e&&(l.Qb(0,"div",40),l.Lb(1,"br"),l.Pb())}function _a(e,t){if(1&e&&(l.Qb(0,"tiled-result",34),l.Bc(1,za,3,2,"ng-container",32),l.Bc(2,Ua,4,5,"div",35),l.Bc(3,Xa,2,0,"ng-template",null,36,l.Cc),l.Qb(5,"div",37),l.Dc(6),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.qc(4),a=l.Zb();l.gc("image",e.image)("zoom",!0),l.xb(1),l.gc("ngIf",!a.singleUser),l.xb(1),l.gc("ngIf",e.price)("ngIfElse",i),l.xb(4),l.Fc(" ",e.name," ")}}function Wa(e,t){if(1&e&&(l.Qb(0,"span",21),l.Dc(1),l.ac(2,"number"),l.Pb()),2&e){const e=l.Zb(2).$implicit,t=l.Zb();l.xb(1),l.Fc(" ",l.cc(2,1,e.price,t.decimals(e))," ")}}function Ya(e,t){if(1&e&&(l.Qb(0,"div",44),l.Bc(1,Wa,3,4,"span",20),l.Dc(2),l.ac(3,"currency"),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb();l.xb(1),l.gc("ngIf",e.promotionalPrice),l.xb(1),l.Fc(" ",l.cc(3,2,e.promotionalPrice||e.price,t.lookupCurrency(e))," ")}}function Ja(e,t){if(1&e&&(l.Qb(0,"map-result",41),l.Qb(1,"div",42),l.Dc(2),l.Pb(),l.Bc(3,Ya,4,5,"div",43),l.Qb(4,"div"),l.Dc(5),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=t.address,a=l.Zb();l.gc("image",e.image)("address",i),l.xb(2),l.Ec(e.name),l.xb(1),l.gc("ngIf",e.price),l.xb(2),l.Ec(a.i18n.ad.byOwner(e.owner.display))}}let en=(()=>{class e extends E.a{constructor(e,t){super(e),this.modal=t,this.clazz="flex-grow-1 d-flex",this._singleUser=!1,this.update=new l.n,this.categorySelected=new l.n}get singleUser(){return this._singleUser}set singleUser(e){this._singleUser=Object(s.E)(e)}toAddress(e){return e.address}toMarkerTitle(e){return e.name}fieldName(e){return(this.data.customFields.find(t=>t.internalName===e)||{}).name}path(e){return["/marketplace","view",e.id]}lookupCurrency(e){return this.data.currencies.find(t=>t.internalName===e.currency||t.id===e.currency)}decimals(e){return(this.lookupCurrency(e)||{}).decimalDigits||0}selectCategory(e){null!=e.id?(this.resultType=this.layout.xxs?ya.a.LIST:ya.a.TILES,this.results=null,this.categorySelected.emit(e)):this.resultType=ya.a.CATEGORIES}categoryConfiguration(e){let t=null;return e.internalName&&(t=(Pa.a.adCategories||{})[e.internalName]),null==e&&(t=(Pa.a.adCategories||{})[e.id]),t||{}}categoryColor(e){return this.categoryConfiguration(e).color}categoryIcon(e){return this.categoryConfiguration(e).icon}categoryImage(e){return this.categoryIcon(e)?null:e.image}categoryChildren(e){const t=e.children||[];return this.layout.xxs||t.length<=5?t:t.slice(0,5)}hasMoreChildren(e){return(e.children||[]).length>5}showAllChildren(e){const t=this.modal.show(Qa,{class:"modal-form modal-small",initialState:{category:e,image:this.categoryImage(e),icon:this.categoryIcon(e),color:this.categoryColor(e)}});this.addSub(t.content.select.subscribe(e=>{this.selectCategory(e)}))}get toLink(){return e=>this.path(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Ot.b))},e.\u0275cmp=l.Eb({type:e,selectors:[["ads-results"]],hostVars:2,hostBindings:function(e,t){2&e&&l.zb(t.clazz)},inputs:{resultType:"resultType",rendering$:"rendering$",singleUser:"singleUser",data:"data",results:"results",referencePoint:"referencePoint"},outputs:{update:"update",categorySelected:"categorySelected"},features:[l.ub],decls:6,vars:8,consts:[[3,"categories","results","rendering$","resultType","referencePoint","toAddress","toMarkerTitle","toLink","update"],["class","card",4,"resultCategory"],["avatarIcon","shopping_basket",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["icon","shopping_basket",3,"image","zoom",4,"resultTile"],[3,"image","address",4,"resultInfoWindow"],[1,"card"],[1,"category-title"],["href","#",1,"category-title-text",3,"click"],["size","small",3,"image","icon","iconColor"],[1,"card-body"],[4,"ngFor","ngForOf"],["class","category-footer","href","#",3,"click",4,"ngIf"],["href","#",1,"sub-category-text",3,"click"],["href","#",1,"category-footer",3,"click"],["avatarIcon","shopping_basket",3,"avatarImage"],["class","cell-main",4,"ngIf"],[1,"cell-text"],["class","cell-small",4,"ngFor","ngForOf"],[1,"cell-main"],["class","promo-price",4,"ngIf"],[1,"promo-price"],[1,"cell-small"],[3,"fields","plainText","fieldName","object"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["colspan","2",4,"ngIf"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],["colspan","2"],[3,"click"],["icon","shopping_basket",3,"image"],[4,"ngIf"],[3,"image"],["icon","shopping_basket",3,"image","zoom"],["class","card-title",4,"ngIf","ngIfElse"],["blankPrice",""],[1,"card-text"],[1,"tile-floating-avatar"],["icon","user_full","size","medium-large",1,"solid-icon",3,"image","tooltip","click"],[1,"card-title"],[3,"image","address"],[1,"font-weight-bold","mb-2"],["class","font-weight-bold",4,"ngIf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(l.Qb(0,"results-layout",0),l.Xb("update",(function(e){return t.update.emit(e)})),l.Bc(1,Na,9,8,"div",1),l.Bc(2,Za,7,5,"mobile-result",2),l.Bc(3,ja,11,5,"table",3),l.Bc(4,_a,7,6,"tiled-result",4),l.Bc(5,Ja,6,5,"map-result",5),l.Pb()),2&e&&l.gc("categories",t.data.categories)("results",t.results)("rendering$",t.rendering$)("resultType",t.resultType)("referencePoint",t.referencePoint)("toAddress",t.toAddress)("toMarkerTitle",t.toMarkerTitle)("toLink",t.toLink)},directives:[R.a,Da.a,H.a,q.a,Sa.a,ka.a,f.a,d.s,d.t,G.a,wa.a,Ca.a,V.b,Oa.a],pipes:[d.b,K.a,Fa.a],encapsulation:2,changeDetection:0}),e})();var tn=i("9AzD"),an=i("uao2"),nn=i("fe3a");function rn(e,t){1&e&&l.Mb(0)}function cn(e,t){if(1&e&&(l.Qb(0,"div",6),l.Lb(1,"max-distance-field",17),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("data",e.data.searchByDistanceData)("label",e.i18n.general.distanceFilter)}}function sn(e,t){if(1&e&&l.Lb(0,"field-option",25),2&e){const e=l.Zb(3);l.gc("text",e.i18n.ad.status.pending)}}function on(e,t){if(1&e&&(l.Qb(0,"div",6),l.Qb(1,"multi-selection-field",18),l.Lb(2,"field-option",19),l.Lb(3,"field-option",20),l.Bc(4,sn,1,1,"field-option",21),l.Lb(5,"field-option",22),l.Lb(6,"field-option",23),l.Lb(7,"field-option",24),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.general.status),l.xb(1),l.gc("text",e.i18n.ad.status.active),l.xb(1),l.gc("text",e.i18n.ad.status.disabled),l.xb(1),l.gc("ngIf",e.canViewPending),l.xb(1),l.gc("text",e.i18n.ad.status.expired),l.xb(1),l.gc("text",e.i18n.ad.status.hidden),l.xb(1),l.gc("text",e.i18n.ad.status.scheduled)}}function ln(e,t){if(1&e&&(l.Qb(0,"div",6),l.Lb(1,"custom-field-filter",27),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(3);l.xb(1),l.gc("field",e)("formControl",i.form.get("customValues").get(e.internalName))}}function bn(e,t){if(1&e&&(l.Ob(0),l.Bc(1,ln,2,2,"div",26),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("ngForOf",e.basicFields)}}function dn(e,t){if(1&e&&(l.Qb(0,"div",6),l.Lb(1,"custom-field-filter",27),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(3);l.xb(1),l.gc("field",e)("formControl",i.form.get("customValues").get(e.internalName))}}function un(e,t){if(1&e&&(l.Qb(0,"div",6),l.Lb(1,"basic-profile-field-filter",27),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(3);l.xb(1),l.gc("field",e)("formControl",i.form.get("profileFields").get(e.field))}}function mn(e,t){if(1&e&&(l.Qb(0,"div",6),l.Lb(1,"custom-field-filter",27),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(3);l.xb(1),l.gc("field",e)("formControl",i.form.get("profileFields").get(e.internalName))}}function gn(e,t){if(1&e&&l.Lb(0,"field-option",35),2&e){const e=l.Zb(4);l.gc("text",e.i18n.ad.type.simple)}}function fn(e,t){if(1&e&&l.Lb(0,"field-option",36),2&e){const e=l.Zb(4);l.gc("text",e.i18n.ad.type.webshop)}}function hn(e,t){if(1&e&&(l.Qb(0,"div",6),l.Qb(1,"single-selection-field",32),l.Bc(2,gn,1,1,"field-option",33),l.Bc(3,fn,1,1,"field-option",34),l.Pb(),l.Pb()),2&e){const e=l.Zb(3);l.xb(1),l.gc("label",e.i18n.general.type)("emptyOption",e.i18n.general.notApplied),l.xb(1),l.gc("ngIf",e.marketplacePermissions.userSimple.view),l.xb(1),l.gc("ngIf",e.marketplacePermissions.userWebshop.view)}}function pn(e,t){if(1&e&&l.Lb(0,"field-option",39),2&e){const e=t.$implicit,i=l.Zb(4);l.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function vn(e,t){if(1&e&&(l.Qb(0,"div",6),l.Qb(1,"multi-selection-field",37),l.Bc(2,pn,1,5,"field-option",38),l.Pb(),l.Pb()),2&e){const e=l.Zb(3);l.xb(1),l.gc("label",e.i18n.user.groupFilter),l.xb(1),l.gc("ngForOf",e.data.groups)}}function yn(e,t){if(1&e&&l.Lb(0,"field-option",42),2&e){const e=t.$implicit,i=l.Zb(5);l.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function xn(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"div",6),l.Qb(2,"single-selection-field",40),l.Bc(3,yn,1,4,"field-option",41),l.Pb(),l.Pb(),l.Nb()),2&e){const e=l.Zb(4);l.xb(2),l.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),l.xb(1),l.gc("ngForOf",e.data.currencies)}}function Pn(e,t){if(1&e&&(l.Ob(0),l.Lb(1,"div",29),l.Qb(2,"div",6),l.Lb(3,"decimal-field",43),l.Pb(),l.Qb(4,"div",6),l.Lb(5,"decimal-field",44),l.Pb(),l.Nb()),2&e){const e=l.Zb(4);l.xb(3),l.gc("label",e.i18n.ad.minPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),l.xb(2),l.gc("label",e.i18n.ad.maxPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function In(e,t){if(1&e&&(l.Ob(0),l.Bc(1,xn,4,3,"ng-container",9),l.Bc(2,Pn,6,8,"ng-container",9),l.ac(3,"async"),l.Nb()),2&e){const e=l.Zb(3);l.xb(1),l.gc("ngIf",e.data.currencies.length>1),l.xb(1),l.gc("ngIf",l.bc(3,2,e.currency$))}}function Qn(e,t){if(1&e&&(l.Ob(0),l.Bc(1,dn,2,2,"div",26),l.Bc(2,un,2,2,"div",26),l.Bc(3,mn,2,2,"div",26),l.Bc(4,hn,4,4,"div",8),l.Bc(5,vn,3,2,"div",8),l.Qb(6,"div",6),l.Lb(7,"boolean-field",28),l.Pb(),l.Bc(8,In,4,4,"ng-container",9),l.Lb(9,"div",29),l.Qb(10,"div",6),l.Lb(11,"date-field",30),l.Pb(),l.Qb(12,"div",6),l.Lb(13,"date-field",31),l.Pb(),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("ngForOf",e.advancedFields),l.xb(1),l.gc("ngForOf",e.data.basicProfileFields),l.xb(1),l.gc("ngForOf",e.data.customProfileFields),l.xb(1),l.gc("ngIf",e.marketplacePermissions.userSimple.view||e.marketplacePermissions.userWebshop.view),l.xb(1),l.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),l.xb(2),l.gc("label",e.i18n.ad.hasImages),l.xb(1),l.gc("ngIf",!e.hidePrice),l.xb(3),l.gc("label",e.i18n.ad.beginDate),l.xb(2),l.gc("label",e.i18n.ad.endDate)}}function Dn(e,t){if(1&e&&(l.Qb(0,"div",45),l.Qb(1,"single-selection-field",46),l.Lb(2,"field-option",47),l.Lb(3,"field-option",48),l.Lb(4,"field-option",49),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("formControl",e.form.get("orderBy"))("display",e.i18n.general.orderBy)("emptyOption",e.i18n.general.orderByRelevance),l.xb(1),l.gc("text",e.i18n.ad.orderBy.date),l.xb(1),l.gc("text",e.i18n.ad.orderBy.priceAsc),l.xb(1),l.gc("text",e.i18n.ad.orderBy.priceDesc)}}function Sn(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.Nb()),2&e){const e=l.Zb().$implicit;l.xb(1),l.Ec(e.name)}}function kn(e,t){if(1&e){const e=l.Rb();l.Qb(0,"a",54),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit,a=l.Zb(3);return t.preventDefault(),a.onCategorySelected(i)})),l.Dc(1),l.Pb()}if(2&e){const e=l.Zb().$implicit;l.xb(1),l.Ec(e.name)}}const wn=function(e){return{active:e}};function Cn(e,t){if(1&e&&(l.Qb(0,"li",52),l.Bc(1,Sn,2,1,"ng-container",9),l.Bc(2,kn,2,1,"a",53),l.Pb()),2&e){const e=t.last;l.gc("ngClass",l.jc(3,wn,e)),l.xb(1),l.gc("ngIf",e),l.xb(1),l.gc("ngIf",!e)}}function On(e,t){if(1&e&&(l.Qb(0,"nav",50),l.Qb(1,"ol",50),l.Bc(2,Cn,3,5,"li",51),l.ac(3,"async"),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.xb(2),l.gc("ngForOf",l.bc(3,1,e.categoryTrail$))}}const Fn=function(){return["tiles","list"]};function Bn(e,t){if(1&e){const e=l.Rb();l.Qb(0,"page-content",3),l.ac(1,"async"),l.Qb(2,"form",4),l.Qb(3,"div",5),l.Qb(4,"div",6),l.Lb(5,"input-field",7),l.Pb(),l.Bc(6,cn,2,2,"div",8),l.Bc(7,on,8,7,"div",8),l.Bc(8,bn,2,1,"ng-container",9),l.ac(9,"async"),l.Bc(10,Qn,14,9,"ng-container",9),l.ac(11,"async"),l.Pb(),l.Pb(),l.Qb(12,"div",10),l.Qb(13,"div",11),l.Lb(14,"result-type-field",12),l.ac(15,"async"),l.Pb(),l.Bc(16,Dn,5,6,"div",13),l.ac(17,"async"),l.Pb(),l.Pb(),l.Qb(18,"page-content",14),l.ac(19,"async"),l.Bc(20,On,4,3,"nav",15),l.ac(21,"async"),l.Pb(),l.Qb(22,"ads-results",16),l.Xb("update",(function(t){return l.sc(e),l.Zb().update(t)}))("categorySelected",(function(t){return l.sc(e),l.Zb().onCategorySelected(t)})),l.ac(23,"async"),l.ac(24,"async"),l.ac(25,"async"),l.ac(26,"async"),l.Pb()}if(2&e){const e=l.Zb();var i,a;l.gc("heading",e.i18n.ad.title.search)("mobileHeading",e.i18n.ad.mobileTitle.search)("headingActions",l.bc(1,19,e.headingActions$)),l.xb(2),l.gc("formGroup",e.form),l.xb(3),l.gc("label",e.i18n.general.keywords),l.xb(1),l.gc("ngIf",e.data.searchByDistanceData),l.xb(1),l.gc("ngIf",e.manager),l.xb(1),l.gc("ngIf",l.bc(9,21,e.layout.gtxxs$)),l.xb(2),l.gc("ngIf",l.bc(11,23,e.moreFilters$)),l.xb(4),l.gc("allowedResultTypes",l.bc(15,25,e.allowedResultTypes$))("formControl",e.resultTypeControl),l.xb(2),l.gc("ngIf",l.bc(17,27,e.layout.gtxxs$)&&l.ic(41,Fn).includes(e.resultType)),l.xb(2),l.gc("ngClass",null!=(i=l.bc(19,29,e.categoryTrail$))&&i.length?"":"d-none"),l.xb(2),l.gc("ngIf",(null==(a=l.bc(21,31,e.categoryTrail$))?null:a.length)>0),l.xb(2),l.gc("results",l.bc(23,33,e.results$))("rendering$",e.rendering$)("data",l.bc(24,35,e.data$))("resultType",l.bc(25,37,e.resultType$))("referencePoint",(l.bc(26,39,e.form.valueChanges)||e.form.value).distanceFilter)}}let Ln=(()=>{class e extends va.a{constructor(e,t,i){super(e),this.marketplaceService=t,this.loginService=i,this.categoryTrail$=new A.a(null),this.currency$=new A.a(null)}getFormControlNames(){return["keywords","statuses","groups","category","customValues","distanceFilter","orderBy","kind","hasImages","minAmount","maxAmount","currency","beginDate","endDate"]}getInitialResultType(){const e=this.uiLayout.getBreakpointConfiguration("defaultAdsResultType");return e&&this.allowedResultTypes.includes(e)?e:this.layout.xxs?ya.a.LIST:ya.a.CATEGORIES}getInitialFormValue(e){const t=super.getInitialFormValue(e);return(t.maxDistance||t.latitude||t.longitude)&&(t.distanceFilter=t),t}ngOnInit(){super.ngOnInit(),this.allowedResultTypes=this.layout.xxs?[ya.a.CATEGORIES,ya.a.LIST]:[ya.a.CATEGORIES,ya.a.TILES,ya.a.LIST,ya.a.MAP],this.resultType=this.getInitialResultType(),this.stateManager.cache("data",this.marketplaceService.getAdDataForSearch({})).subscribe(e=>{this.data=e})}onDataInitialized(e){this.marketplacePermissions=((this.dataForUiHolder.auth||{}).permissions||{}).marketplace||{};const t=t=>e.customFields.find(e=>e.internalName===t);this.basicFields=e.fieldsInBasicSearch.map(t),this.advancedFields=e.fieldsInAdvancedSearch.map(t),this.form.setControl("customValues",this.fieldHelper.customFieldsForSearchFormGroup(e.customFields)),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(e.basicProfileFields,e.customProfileFields)),this.headingActions=[this.moreFiltersAction],this.addSub(this.form.get("currency").valueChanges.subscribe(t=>this.updateCurrency(t,e))),Object(s.h)(e.currencies)||1!==e.currencies.length||(this.currency=e.currencies[0]),super.onDataInitialized(e)}doSearch(e){return this.marketplaceService.searchAds$Response(e)}toSearchParams(e){const t=Object.assign({},e),i=this.resultType===ya.a.MAP;t.customFields=this.fieldHelper.toCustomValuesFilter(e.customValues),t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields),t.addressResult=i?C.b.ALL:C.b.NONE;const a=e.distanceFilter;return a&&(t.maxDistance=a.maxDistance,t.latitude=a.latitude,t.longitude=a.longitude,t.addressResult=C.b.NEAREST),t.publicationPeriod=pa.a.dateRangeFilter(e.beginDate,e.endDate),t.priceRange=pa.a.rangeFilter(e.minAmount,e.maxAmount),i&&(t.pageSize=99999),t}onResultTypeChanged(e,t){e===ya.a.CATEGORIES?(this.form.patchValue({category:null},{emitEvent:!1}),this.categoryTrail$.next([])):e===ya.a.MAP!=(t===ya.a.MAP)&&this.form.patchValue({page:0},{emitEvent:!1})}onCategorySelected(e){const t=pa.a.internalNameOrId(e),i=[];if(t){this.form.patchValue({category:t}),i.unshift(e);const a=this.findParent(e);a&&i.unshift(a),i.unshift({name:this.i18n.ad.rootCategory})}else this.form.patchValue({category:t},{emitEvent:!1}),this.resultType=ya.a.CATEGORIES;this.categoryTrail$.next(i)}findParent(e){for(const t of this.data.categories)if(t.children.includes(e))return t;return null}resolveMenu(){return this.login.user?o.b.SEARCH_ADS:o.b.PUBLIC_MARKETPLACE}updateCurrency(e,t){this.currency=t.currencies.find(t=>t.id===e||t.internalName===e)}get manager(){return this.dataForUiHolder.role===C.kb.ADMINISTRATOR||this.dataForUiHolder.role===C.kb.BROKER&&!Object(s.h)(this.data.query.brokers)}get canViewPending(){return this.marketplacePermissions.userSimple.viewPending||this.marketplacePermissions.userWebshop.viewPending}get hidePrice(){return this.data.hidePrice||null==this.loginService.user}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(kt.a),l.Kb(ha.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["search-ads"]],features:[l.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","no-gutters"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords",3,"label"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[1,"row","no-gutters","filters-row"],[1,"col-12","col-xs-7","col-md-9"],[3,"allowedResultTypes","formControl"],["class","col-12 col-xs-5 col-md-3",4,"ngIf"],[3,"ngClass"],["class","breadcrumb",4,"ngIf"],[3,"results","rendering$","data","resultType","referencePoint","update","categorySelected"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["labelPosition","side","formControlName","statuses",3,"label"],["value","active",3,"text"],["value","disabled",3,"text"],["value","pending",3,"text",4,"ngIf"],["value","expired",3,"text"],["value","hidden",3,"text"],["value","scheduled",3,"text"],["value","pending",3,"text"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side",3,"field","formControl"],["labelPosition","sideForced","formControlName","hasImages",3,"label"],[1,"w-100"],["labelPosition","side","formControlName","beginDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","endDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","kind",3,"label","emptyOption"],["value","simple",3,"text",4,"ngIf"],["value","webshop",3,"text",4,"ngIf"],["value","simple",3,"text"],["value","webshop",3,"text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","scale","prefix","suffix"],[1,"col-12","col-xs-5","col-md-3"],[3,"formControl","display","emptyOption"],["value","date",3,"text"],["value","priceAsc",3,"text"],["value","priceDesc",3,"text"],[1,"breadcrumb"],["class","breadcrumb-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"breadcrumb-item",3,"ngClass"],["href","#",3,"click",4,"ngIf"],["href","#",3,"click"]],template:function(e,t){if(1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,rn,1,0,"ng-container",1),l.Pb(),l.Bc(3,Bn,27,42,"ng-template",null,2,l.Cc)),2&e){const e=l.qc(4);l.gc("ready",l.bc(1,3,t.data$)),l.xb(2),l.gc("ngIf",t.data)("ngIfThen",e)}},directives:[b.a,d.t,u.a,n.I,n.w,n.n,_e.a,n.v,n.l,xa.a,n.k,d.q,en,tn.a,Nt.a,$.a,d.s,an.a,We.a,Ft.a,nn.a,Je.a,z.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();function Nn(e,t){1&e&&l.Lb(0,"div",9)}function An(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"div",9),l.Qb(2,"label-value",28),l.Lb(3,"user-link",29),l.Pb(),l.Pb(),l.Bc(4,Nn,1,0,"div",30),l.Nb()),2&e){const e=l.Zb(3);l.xb(2),l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.user),l.xb(1),l.gc("ngIf",e.layout.gtsm$)}}function Tn(e,t){if(1&e&&l.Lb(0,"field-option",31),2&e){const e=l.Zb(3);l.gc("text",e.i18n.ad.orderStatus.draft)}}function $n(e,t){if(1&e&&(l.Qb(0,"form",7),l.Qb(1,"div",8),l.Bc(2,An,5,3,"ng-container",1),l.Qb(3,"div",9),l.Qb(4,"single-selection-field",10),l.Bc(5,Tn,1,1,"field-option",11),l.Lb(6,"field-option",12),l.Lb(7,"field-option",13),l.Lb(8,"field-option",14),l.Lb(9,"field-option",15),l.Lb(10,"field-option",16),l.Lb(11,"field-option",17),l.Lb(12,"field-option",18),l.Lb(13,"field-option",19),l.Lb(14,"field-option",20),l.Lb(15,"field-option",21),l.Pb(),l.Pb(),l.Qb(16,"div",9),l.Lb(17,"user-field",22),l.Pb(),l.Qb(18,"div",23),l.Qb(19,"div",9),l.Lb(20,"date-field",24),l.Pb(),l.Qb(21,"div",9),l.Lb(22,"date-field",25),l.Pb(),l.Pb(),l.Qb(23,"div",9),l.Lb(24,"input-field",26),l.Pb(),l.Qb(25,"div",9),l.Lb(26,"input-field",27),l.Pb(),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.gc("formGroup",e.form),l.xb(2),l.gc("ngIf",e.data.user&&!e.authHelper.isSelfOrOwner(e.data.user)),l.xb(2),l.gc("label",e.i18n.general.status)("emptyOption",!0),l.xb(1),l.gc("ngIf",e.sales&&e.isOwner),l.xb(1),l.gc("text",!e.sales&&e.isOwner?e.i18n.ad.requiringMyConfirmation:e.i18n.ad.waitingForBuyersApproval),l.xb(1),l.gc("text",e.sales&&e.isOwner?e.i18n.ad.requiringMyConfirmation:e.i18n.ad.waitingForSellersApproval),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.completed),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.rejectedByBuyer),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.rejectedBySeller),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.paymentPending),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.paymentDenied),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.paymentCanceled),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.paymentExpired),l.xb(1),l.gc("text",e.i18n.ad.orderStatus.disposed),l.xb(2),l.gc("label",e.sales?e.i18n.ad.buyer:e.i18n.ad.seller),l.xb(3),l.gc("label",e.i18n.general.beginDate),l.xb(2),l.gc("label",e.i18n.general.endDate),l.xb(2),l.gc("label",e.i18n.ad.order),l.xb(2),l.gc("label",e.i18n.ad.productNumber)}}function Zn(e,t){if(1&e&&(l.Qb(0,"mobile-result"),l.Qb(1,"div",32),l.Qb(2,"div"),l.Qb(3,"div",33),l.Dc(4),l.Pb(),l.Qb(5,"div",34),l.Dc(6),l.ac(7,"date"),l.Pb(),l.Qb(8,"div",35),l.Dc(9),l.Pb(),l.Pb(),l.Qb(10,"div",36),l.Dc(11),l.ac(12,"currency"),l.Pb(),l.Pb(),l.Pb()),2&e){const e=t.$implicit;l.xb(4),l.Fc(" ",e.number," "),l.xb(2),l.Fc(" ",l.bc(7,4,e.creationDate)," "),l.xb(3),l.Fc(" ",e.relatedUser.shortDisplay," "),l.xb(2),l.Fc(" ",l.cc(12,6,e.totalPrice,e.currency)," ")}}function En(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"tr",40),l.Xb("click",(function(){l.sc(e);const i=t.$implicit,a=l.Zb(3);return a.router.navigate(a.path(i))})),l.Qb(2,"td"),l.Dc(3),l.Pb(),l.Qb(4,"td"),l.Dc(5),l.Pb(),l.Qb(6,"td"),l.Dc(7),l.ac(8,"date"),l.Pb(),l.Qb(9,"td"),l.Dc(10),l.Pb(),l.Qb(11,"td",38),l.Dc(12),l.ac(13,"currency"),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=t.$implicit,i=l.Zb(3);l.xb(3),l.Ec(e.number),l.xb(2),l.Ec(i.resolveStatusLabel(e)),l.xb(2),l.Ec(l.bc(8,5,e.creationDate)),l.xb(3),l.Ec(e.relatedUser.shortDisplay),l.xb(2),l.Fc(" ",l.cc(13,7,e.totalPrice,e.currency),"")}}function Mn(e,t){if(1&e&&(l.Qb(0,"table",37),l.Qb(1,"thead"),l.Qb(2,"th"),l.Dc(3),l.Pb(),l.Qb(4,"th"),l.Dc(5),l.Pb(),l.Qb(6,"th"),l.Dc(7),l.Pb(),l.Qb(8,"th"),l.Dc(9),l.Pb(),l.Qb(10,"th",38),l.Dc(11),l.Pb(),l.Pb(),l.Qb(12,"tbody"),l.Bc(13,En,14,10,"ng-container",39),l.ac(14,"async"),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);var i;l.xb(3),l.Ec(e.i18n.ad.order),l.xb(2),l.Ec(e.i18n.general.status),l.xb(2),l.Ec(e.i18n.general.date),l.xb(2),l.Ec(e.sales?e.i18n.ad.buyer:e.i18n.ad.seller),l.xb(2),l.Ec(e.i18n.ad.total),l.xb(2),l.gc("ngForOf",null==(i=l.bc(14,6,e.results$))?null:i.results)}}function Rn(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.ac(3,"async"),l.ac(4,"async"),l.Bc(5,$n,27,20,"form",3),l.ac(6,"async"),l.ac(7,"async"),l.Pb(),l.Qb(8,"results-layout",4),l.Xb("update",(function(t){return l.sc(e),l.Zb().update(t)})),l.ac(9,"async"),l.Bc(10,Zn,13,9,"mobile-result",5),l.Bc(11,Mn,15,8,"table",6),l.Pb(),l.Nb()}if(2&e){const e=l.Zb();l.xb(1),l.gc("mode",l.bc(2,8,e.moreFilters$)||!1===l.bc(3,10,e.layout.ltsm$)?"filters":"emptyFilters")("heading",e.sales?e.i18n.ad.title.sales:e.i18n.ad.title.purchases)("mobileHeading",e.sales?e.i18n.ad.mobileTitle.sales:e.i18n.ad.mobileTitle.purchases)("headingActions",l.bc(4,12,e.headingActions$)),l.xb(4),l.gc("ngIf",l.bc(6,14,e.moreFilters$)||!1===l.bc(7,16,e.layout.ltsm$)),l.xb(3),l.gc("results",l.bc(9,18,e.results$))("rendering$",e.rendering$)("toLink",e.toLink)}}let Hn=(()=>{class e extends va.a{constructor(e,t,i){super(e),this.marketplaceHelper=t,this.orderService=i,this.showForm$=new A.a(!1)}getFormControlNames(){return["statuses","periodBegin","periodEnd","relatedUser","number","productNumber"]}ngOnInit(){super.ngOnInit(),this.sales="sales"===this.route.snapshot.url[1].path,this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.isOwner=this.authHelper.isSelf(this.param),this.addSub(this.orderService.getOrderDataForSearch({user:this.param,sales:this.sales}).subscribe(e=>this.data=e))}toSearchParams(e){return e.user=this.param,e.sales=this.sales,(e.periodBegin||e.periodEnd)&&(e.creationPeriod=this.ApiHelper.dateRangeFilter(e.periodBegin,e.periodEnd)),e}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=this.initActions(e),this.addSub(this.layout.ltsm$.subscribe(()=>{this.headingActions=this.initActions(e)}))}initActions(e){const t=[];if(this.sales&&e.canCreateNew){const e=new Re.c("add",this.i18n.general.addNew,()=>this.addNew(),!0);t.push(e)}return this.layout.ltsm&&t.push(this.moreFiltersAction),t}addNew(){this.notification.confirm({title:this.i18n.ad.title.newOrder,labelPosition:"above",customFields:this.newOrderFields(),callback:e=>{this.addSub(this.orderService.getOrderDataForNew({buyer:e.customValues.buyer,user:this.param,currency:e.customValues.currency}).subscribe(()=>{this.router.navigate(["marketplace",this.param,"sale","new"],{queryParams:{buyer:e.customValues.buyer,currency:e.customValues.currency}})}))}})}newOrderFields(){const e=[{internalName:"buyer",name:this.i18n.ad.buyer,type:C.p.LINKED_ENTITY,control:C.n.ENTITY_SELECTION,linkedEntityType:C.H.USER,hasValuesList:!1,required:!0}];return!Object(s.h)(this.data.currencies)&&this.data.currencies.length>1&&e.push({internalName:"currency",name:this.i18n.general.currency,type:C.p.SINGLE_SELECTION,control:C.n.SINGLE_SELECTION,hasValuesList:!0,defaultValue:this.data.currencies[0].id,possibleValues:this.data.currencies.map(e=>({id:e.id,value:e.name})),required:!0}),e}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}doSearch(e){return this.orderService.searchUserOrders$Response(e)}get toLink(){return e=>this.path(e)}path(e){return e.status===C.Q.DRAFT?["/marketplace","sale",e.id]:["/marketplace","order",e.id]}resolveStatusLabel(e){return this.marketplaceHelper.resolveOrderStatusLabel(e.status)}resolveMenu(e){return this.isOwner?this.sales?o.b.SALES:o.b.PURCHASES:this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(B.a),l.Kb(Hi.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["search-orders"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[1,"no-padding",3,"mode","heading","mobileHeading","headingActions"],["class","filters-form filters-form-separator",3,"formGroup",4,"ngIf"],["resultType","list",3,"results","rendering$","toLink","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","statuses",3,"label","emptyOption"],["value","draft",3,"text",4,"ngIf"],["value","pendingBuyer",3,"text"],["value","pendingSeller",3,"text"],["value","completed",3,"text"],["value","rejectedByBuyer",3,"text"],["value","rejectedBySeller",3,"text"],["value","paymentPending",3,"text"],["value","paymentDenied",3,"text"],["value","paymentCanceled",3,"text"],["value","paymentExpired",3,"text"],["value","disposed",3,"text"],["labelPosition","side","formControlName","relatedUser",3,"label"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","periodBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","number","fieldSize","full",3,"label"],["labelPosition","side","formControlName","productNumber","fieldSize","full",3,"label"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],["value","draft",3,"text"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[1,"ml-auto"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Rn,12,20,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,R.a,H.a,q.a,n.I,n.w,n.n,Je.a,n.v,n.l,$.a,gi.a,Ft.a,_e.a,m.a,g.a,G.a,d.s],pipes:[d.b,$t.a,K.a],encapsulation:2,changeDetection:0}),e})();function qn(e,t){if(1&e&&(l.Qb(0,"div",6),l.Qb(1,"single-selection-field",7),l.Lb(2,"field-option",8),l.Lb(3,"field-option",9),l.Pb(),l.Pb()),2&e){const e=l.Zb();l.xb(1),l.gc("label",e.i18n.general.type),l.xb(1),l.gc("text",e.i18n.ad.type.simple),l.xb(1),l.gc("text",e.i18n.ad.type.webshop)}}function Gn(e,t){if(1&e){const e=l.Rb();l.Qb(0,"mobile-result",10),l.Qb(1,"div",11),l.Qb(2,"div"),l.Qb(3,"div",12),l.Dc(4),l.Pb(),l.Qb(5,"div",13),l.Dc(6),l.ac(7,"dateTime"),l.Pb(),l.Qb(8,"div",14),l.Dc(9),l.Pb(),l.Pb(),l.Qb(10,"div",15),l.Qb(11,"button",16),l.Xb("click",(function(i){l.sc(e);const a=t.$implicit;return l.Zb().remove(a),i.stopPropagation(),i.preventDefault()})),l.Lb(12,"icon",17),l.Pb(),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit,i=l.Zb();l.gc("avatarImage",e.advertisement.image),l.xb(4),l.Fc(" ",e.advertisement.name," "),l.xb(2),l.Fc(" ",l.bc(7,5,e.questionDate)," "),l.xb(3),l.Fc(" ",e.question," "),l.xb(2),l.gc("tooltip",i.i18n.general.remove)}}const Vn=function(e,t){return{"pb-0":e,"border-0":t}};function jn(e,t){if(1&e){const e=l.Rb();l.Qb(0,"tr",23),l.Xb("click",(function(){l.sc(e);const i=t.$implicit,a=l.Zb(2);return a.router.navigate(a.path(i))})),l.Qb(1,"td",24),l.ac(2,"async"),l.ac(3,"async"),l.Lb(4,"avatar",25),l.Pb(),l.Qb(5,"td",26),l.Qb(6,"span",23),l.Xb("click",(function(){l.sc(e);const i=t.$implicit;return l.Zb(2).navigateToAd(i)})),l.Dc(7),l.Pb(),l.Pb(),l.Qb(8,"td"),l.Dc(9),l.Pb(),l.Qb(10,"td"),l.Dc(11),l.ac(12,"date"),l.Pb(),l.Qb(13,"td",27),l.Qb(14,"button",28),l.Xb("click",(function(i){l.sc(e);const a=t.$implicit;return l.Zb(2).remove(a),i.stopPropagation()})),l.Lb(15,"icon",17),l.Pb(),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit,i=l.Zb(2);l.xb(1),l.gc("ngClass",l.kc(13,Vn,l.bc(2,7,i.layout.xxs$),l.bc(3,9,i.layout.xxs$))),l.xb(3),l.gc("image",e.advertisement.image)("tooltip",e.advertisement.name),l.xb(3),l.Ec(e.advertisement.name),l.xb(2),l.Fc(" ",e.question," "),l.xb(2),l.Fc(" ",l.bc(12,11,e.questionDate)," "),l.xb(3),l.gc("tooltip",i.i18n.general.remove)}}function zn(e,t){if(1&e&&(l.Qb(0,"table",18),l.Qb(1,"thead"),l.Lb(2,"th",19),l.Qb(3,"th",20),l.Dc(4),l.Pb(),l.Qb(5,"th"),l.Dc(6),l.Pb(),l.Qb(7,"th"),l.Dc(8),l.Pb(),l.Lb(9,"th",21),l.Pb(),l.Qb(10,"tbody"),l.Bc(11,jn,16,16,"tr",22),l.ac(12,"async"),l.Pb(),l.Pb()),2&e){const e=l.Zb();var i;l.xb(4),l.Ec(e.i18n.ad.name),l.xb(2),l.Ec(e.i18n.ad.question),l.xb(2),l.Ec(e.i18n.general.date),l.xb(3),l.gc("ngForOf",null==(i=l.bc(12,4,e.results$))?null:i.results)}}let Kn=(()=>{class e extends va.a{constructor(e,t){super(e),this.adQuestionService=t}ngOnInit(){super.ngOnInit();const e=((this.dataForUiHolder.auth||{}).permissions||{}).marketplace||{},t=e.myWebshop||{};this.simpleQuestions=(e.mySimple||{}).questions,this.webshopQuestions=t.questions,this.data={}}getFormControlNames(){return["kind"]}path(e){return["/marketplace","unanswered-questions","view",e.id]}get toLink(){return e=>this.path(e)}navigate(e){this.router.navigate(this.path(e))}navigateToAd(e){this.router.navigate(["/marketplace","view",e.advertisement.id])}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.adQuestionService.deleteAdQuestion({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}getInitialFormValue(e){const t=super.getInitialFormValue(e);return this.simpleQuestions?t.kind=C.c.SIMPLE:this.webshopQuestions&&(t.kind=C.c.WEBSHOP),t}toSearchParams(e){return e.user="self",e}doSearch(e){return this.adQuestionService.searchUnansweredAdQuestions$Response(e)}resolveMenu(){return o.b.UNANSWERED_QUESTIONS}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(r.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["search-unanswered-questions"]],features:[l.ub],decls:8,vars:10,consts:[[1,"no-padding",3,"mode","heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],["class","col-12 col-md-6",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["avatarIcon","shopping_basket",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","kind",3,"label"],["value","simple",3,"text"],["value","webshop",3,"text"],["avatarIcon","shopping_basket",3,"avatarImage"],[1,"d-flex"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon","mt-2",3,"tooltip","click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","30%"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],["icon","shopping_basket",3,"image","tooltip"],[1,"link"],[1,"actions","actions-multiple"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout"),l.Qb(1,"page-content",0),l.Qb(2,"form",1),l.Bc(3,qn,4,3,"div",2),l.Pb(),l.Pb(),l.Qb(4,"results-layout",3),l.Xb("update",(function(e){return t.update(e)})),l.ac(5,"async"),l.Bc(6,Gn,13,7,"mobile-result",4),l.Bc(7,zn,13,6,"table",5),l.Pb(),l.Pb()),2&e&&(l.xb(1),l.gc("mode",t.simpleQuestions&&t.webshopQuestions?"filters":"empty")("heading",t.i18n.ad.title.unansweredQuestions)("mobileHeading",t.i18n.ad.mobileTitle.unansweredQuestions),l.xb(1),l.gc("formGroup",t.form),l.xb(1),l.gc("ngIf",t.simpleQuestions&&t.webshopQuestions),l.xb(1),l.gc("results",l.bc(5,8,t.results$))("toLink",t.toLink)("rendering$",t.rendering$))},directives:[b.a,u.a,n.I,n.w,n.n,d.t,R.a,H.a,q.a,Je.a,n.v,n.l,$.a,G.a,V.b,j.a,d.s,d.q,f.a],pipes:[d.b,y.a,$t.a],encapsulation:2,changeDetection:0}),e})();var Un=i("/QoZ");function Xn(e,t){1&e&&l.Mb(0)}function _n(e,t){if(1&e&&(l.Qb(0,"div",7),l.Qb(1,"label-value",26),l.Lb(2,"user-link",27),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.user)}}function Wn(e,t){if(1&e&&(l.Qb(0,"div",7),l.Lb(1,"input-field",28),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.ad.productNumber)}}function Yn(e,t){if(1&e&&l.Lb(0,"field-option",29),2&e){const e=l.Zb(2);l.gc("text",e.i18n.ad.status.draft)}}function Jn(e,t){if(1&e&&l.Lb(0,"field-option",30),2&e){const e=l.Zb(2);l.gc("text",e.i18n.ad.status.pending)}}function er(e,t){if(1&e){const e=l.Rb();l.Qb(0,"page-content",3),l.ac(1,"async"),l.Qb(2,"form",4),l.Qb(3,"div",5),l.Bc(4,_n,3,2,"div",6),l.Qb(5,"div",7),l.Lb(6,"input-field",8),l.Pb(),l.Bc(7,Wn,2,1,"div",6),l.Qb(8,"div",7),l.Qb(9,"single-selection-field",9),l.Lb(10,"field-option",10),l.Lb(11,"field-option",11),l.Lb(12,"field-option",12),l.Lb(13,"field-option",13),l.Lb(14,"field-option",14),l.Pb(),l.Pb(),l.Qb(15,"div",7),l.Qb(16,"multi-selection-field",15),l.Lb(17,"field-option",16),l.Lb(18,"field-option",17),l.Bc(19,Yn,1,1,"field-option",18),l.Bc(20,Jn,1,1,"field-option",19),l.Lb(21,"field-option",20),l.Lb(22,"field-option",21),l.Lb(23,"field-option",22),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(24,"div",23),l.Lb(25,"result-type-field",24),l.ac(26,"async"),l.Pb(),l.Pb(),l.Qb(27,"ads-results",25),l.Xb("update",(function(t){return l.sc(e),l.Zb().update(t)})),l.ac(28,"async"),l.ac(29,"async"),l.ac(30,"async"),l.Pb()}if(2&e){const e=l.Zb();l.gc("heading",e.resolveHeading(!1))("mobileHeading",e.resolveHeading(!0))("headingActions",l.bc(1,29,e.headingActions$)),l.xb(2),l.gc("formGroup",e.form),l.xb(2),l.gc("ngIf",!e.self),l.xb(2),l.gc("label",e.i18n.general.keywords),l.xb(1),l.gc("ngIf",!e.simple),l.xb(2),l.gc("label",e.i18n.general.orderBy)("emptyOption",e.i18n.general.noOptionSelected),l.xb(1),l.gc("text",e.i18n.ad.orderBy.date),l.xb(1),l.gc("text",e.i18n.ad.orderBy.distance),l.xb(1),l.gc("text",e.i18n.ad.orderBy.priceDesc),l.xb(1),l.gc("text",e.i18n.ad.orderBy.priceAsc),l.xb(1),l.gc("text",e.i18n.ad.orderBy.relevance),l.xb(2),l.gc("label",e.i18n.general.status)("emptyLabel",e.i18n.general.all),l.xb(1),l.gc("text",e.i18n.ad.status.active),l.xb(1),l.gc("text",e.i18n.ad.status.disabled),l.xb(1),l.gc("ngIf",e.canViewDraft),l.xb(1),l.gc("ngIf",e.canViewPending),l.xb(1),l.gc("text",e.i18n.ad.status.expired),l.xb(1),l.gc("text",e.i18n.ad.status.hidden),l.xb(1),l.gc("text",e.i18n.ad.status.scheduled),l.xb(2),l.gc("formControl",e.resultTypeControl)("allowedResultTypes",l.bc(26,31,e.allowedResultTypes$)),l.xb(2),l.gc("results",l.bc(28,33,e.results$))("rendering$",e.rendering$)("data",l.bc(29,35,e.data$))("resultType",l.bc(30,37,e.resultType$))}}let tr=(()=>{class e extends va.a{constructor(e,t){super(e),this.marketplaceService=t}getFormControlNames(){return["keywords","user","orderBy","statuses","productNumber"]}getInitialResultType(){return ya.a.TILES}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.kind=this.route.snapshot.paramMap.get("kind"),this.allowedResultTypes=[ya.a.TILES,ya.a.LIST],this.addSub(this.marketplaceService.getUserAdsDataForSearch({user:this.param,kind:this.kind}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.self=this.authHelper.isSelfOrOwner(e.user),this.shortName=Object(s.G)(e.user.display,Un.a),e.createNew&&(this.headingActions=[new Re.c("add",this.i18n.general.addNew,()=>this.router.navigate(["/marketplace",this.param,this.kind,"ad","new"]),!0)])}toSearchParams(e){const t=e;return t.user=this.param,t.kind=this.kind,t}resolveHeading(e){return this.self?this.simple?e?this.i18n.ad.mobileTitle.myAdvertisements:this.i18n.ad.title.myAdvertisements:e?this.i18n.ad.mobileTitle.myWebshop:this.i18n.ad.title.myWebshop:this.simple?e?this.i18n.ad.mobileTitle.viewAdvertisements:this.i18n.ad.title.viewAdvertisements:e?this.i18n.ad.mobileTitle.viewWebshop:this.i18n.ad.title.viewWebshop}doSearch(e){return this.marketplaceService.searchUserAds$Response(e)}resolveMenu(){return this.param===this.ApiHelper.SELF?this.simple?o.b.SEARCH_USER_ADS:o.b.SEARCH_USER_WEBSHOP:o.b.SEARCH_ADS}get simple(){return this.kind===C.c.SIMPLE}get canViewPending(){const e=((this.dataForUiHolder.auth||{}).permissions||{}).marketplace||{};return this.data.requiresAuthorization&&(this.self||(this.simple?e.userSimple.viewPending:e.userWebshop.viewPending))}get canViewDraft(){return this.data.requiresAuthorization&&!this.isManager}get isManager(){return!self&&(this.dataForUiHolder.role===C.kb.BROKER||this.dataForUiHolder.role===C.kb.ADMINISTRATOR)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(kt.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["user-ads"]],features:[l.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords","fieldSize","full",3,"label"],["labelPosition","side","formControlName","orderBy",3,"label","emptyOption"],["value","date",3,"text"],["value","distance",3,"text"],["value","priceDesc",3,"text"],["value","priceAsc",3,"text"],["value","relevance",3,"text"],["labelPosition","side","formControlName","statuses",3,"label","emptyLabel"],["value","active",3,"text"],["value","disabled",3,"text"],["value","draft",3,"text",4,"ngIf"],["value","pending",3,"text",4,"ngIf"],["value","expired",3,"text"],["value","hidden",3,"text"],["value","scheduled",3,"text"],[1,"filters-row"],[3,"formControl","allowedResultTypes"],["singleUser","",3,"results","rendering$","data","resultType","update"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["labelPosition","side","formControlName","productNumber","fieldSize","full",3,"label"],["value","draft",3,"text"],["value","pending",3,"text"]],template:function(e,t){if(1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Xn,1,0,"ng-container",1),l.Pb(),l.Bc(3,er,31,39,"ng-template",null,2,l.Cc)),2&e){const e=l.qc(4);l.gc("ready",l.bc(1,3,t.data$)),l.xb(2),l.gc("ngIf",t.data)("ngIfThen",e)}},directives:[b.a,d.t,u.a,n.I,n.w,n.n,_e.a,n.v,n.l,Je.a,$.a,Nt.a,xa.a,n.k,en,m.a,g.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();var ir=i("/J7N");function ar(e,t){if(1&e&&(l.Qb(0,"label-value",12),l.Lb(1,"user-link",13),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.user)}}function nr(e,t){if(1&e&&l.Lb(0,"input-field",14),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.productNumberMask)}}function rr(e,t){if(1&e&&(l.Ob(0),l.Lb(1,"input-field",15),l.Lb(2,"decimal-field",16),l.Lb(3,"input-field",17),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.ad.prefix),l.xb(1),l.gc("label",e.i18n.ad.length)("textRight",!1),l.xb(1),l.gc("label",e.i18n.ad.suffix)}}function cr(e,t){if(1&e){const e=l.Rb();l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Bc(3,ar,2,2,"label-value",3),l.Qb(4,"form",4),l.Qb(5,"radio-group-field",5),l.Lb(6,"field-option",6),l.Lb(7,"field-option",7),l.Pb(),l.Bc(8,nr,1,1,"input-field",8),l.ac(9,"async"),l.Qb(10,"radio-group-field",9),l.Lb(11,"field-option",6),l.Lb(12,"field-option",7),l.Pb(),l.Bc(13,rr,4,4,"ng-container",1),l.ac(14,"async"),l.Pb(),l.Qb(15,"actions",10),l.Qb(16,"action-button",11),l.Xb("action",(function(){return l.sc(e),l.Zb().save()})),l.ac(17,"async"),l.Pb(),l.Pb(),l.Pb(),l.Nb()}if(2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.webshopSettings)("mobileHeading",e.i18n.ad.mobileTitle.webshopSettings)("headingActions",l.bc(2,15,e.headingActions$)),l.xb(2),l.gc("ngIf",!e.self),l.xb(1),l.gc("formGroup",e.form),l.xb(1),l.gc("label",e.i18n.ad.productNumber),l.xb(1),l.gc("text",e.i18n.ad.generated),l.xb(1),l.gc("text",e.i18n.ad.manual),l.xb(1),l.gc("ngIf","manual"===(l.bc(9,17,e.form.get("productGenerationType").valueChanges)||e.form.get("productGenerationType").value)),l.xb(2),l.gc("label",e.i18n.ad.orderNumber),l.xb(1),l.gc("text",e.i18n.ad.generated),l.xb(1),l.gc("text",e.i18n.ad.manual),l.xb(1),l.gc("ngIf","manual"===(l.bc(14,19,e.form.get("orderGenerationType").valueChanges)||e.form.get("orderGenerationType").value)),l.xb(3),l.gc("disabled",l.bc(17,21,e.requesting$))("label",e.i18n.general.submit)}}let sr=(()=>{class e extends c.a{constructor(e,t){super(e),this.webshopSettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.webshopSettingsService.viewWebshopSettings({user:this.user}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user),this.form=this.formBuilder.group({productNumberGenerated:e.productNumberGenerated,productGenerationType:e.productNumberGenerated?"generated":"manual",productNumberMask:e.productNumberMask,customOrderNumberFormat:e.customOrderNumberFormat,orderGenerationType:e.customOrderNumberFormat?"manual":"generated",orderNumberInnerLength:e.orderNumberInnerLength,orderNumberPrefix:e.orderNumberPrefix,orderNumberSuffix:e.orderNumberSuffix}),this.addSub(this.form.controls.productGenerationType.valueChanges.subscribe(()=>this.updateMaskControl())),this.addSub(this.form.controls.orderGenerationType.valueChanges.subscribe(()=>this.updateOrderControls())),this.updateMaskControl(),this.updateOrderControls()}updateMaskControl(){"generated"===this.form.controls.productGenerationType.value?this.form.controls.productNumberMask.clearValidators():this.form.controls.productNumberMask.setValidators(n.G.required),this.form.controls.productNumberMask.updateValueAndValidity()}updateOrderControls(){const e=[this.form.controls.orderNumberInnerLength,this.form.controls.orderNumberPrefix,this.form.controls.orderNumberSuffix];e.forEach("generated"===this.form.controls.orderGenerationType.value?e=>e.clearValidators():e=>e.setValidators(n.G.required)),e.forEach(e=>e.updateValueAndValidity())}save(){if(!Object(s.F)(this.form))return;const e=Object(N.a)(this.form.value);e.productNumberGenerated="generated"===this.form.controls.productGenerationType.value,delete e.productGenerationType,e.customOrderNumberFormat="manual"===this.form.controls.orderGenerationType.value,delete e.orderGenerationType,this.addSub(this.webshopSettingsService.updateWebshopSettings({user:this.user,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.webshopSettingsSaved)}))}resolveMenu(e){return this.menu.userMenu(e.user,o.b.WEBSHOP_SETTINGS)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(ir.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["edit-webshop-settings"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],["class","mb-3","labelPosition","side",3,"label",4,"ngIf"],[3,"formGroup"],["formControlName","productGenerationType",3,"label"],["value","generated",3,"text"],["value","manual",3,"text"],["formControlName","productNumberMask","required","",3,"label",4,"ngIf"],["formControlName","orderGenerationType",3,"label"],["forceRow",""],[3,"disabled","label","action"],["labelPosition","side",1,"mb-3",3,"label"],[3,"user"],["formControlName","productNumberMask","required","",3,"label"],["formControlName","orderNumberPrefix","fieldSize","small","required","",3,"label"],["formControlName","orderNumberInnerLength","fieldSize","small","required","",3,"label","textRight"],["formControlName","orderNumberSuffix","fieldSize","small","required","",3,"label"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,cr,18,23,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,n.I,n.w,n.n,T.a,n.v,n.l,$.a,p.a,v.a,m.a,g.a,_e.a,n.D,z.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();function or(e,t){if(1&e&&(l.Qb(0,"label-value",6),l.Lb(1,"user-link",7),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.user),l.xb(1),l.gc("user",e.data.user)}}function lr(e,t){if(1&e&&l.Lb(0,"label-value",4),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.productNumberMask)("value",e.data.productNumberMask)}}function br(e,t){1&e&&l.Lb(0,"hr")}function dr(e,t){if(1&e&&(l.Ob(0),l.Lb(1,"label-value",4),l.Lb(2,"label-value",4),l.Lb(3,"label-value",4),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.ad.prefix)("value",e.data.orderNumberPrefix),l.xb(1),l.gc("label",e.i18n.ad.length)("value",e.data.orderNumberInnerLength),l.xb(1),l.gc("label",e.i18n.ad.suffix)("value",e.data.orderNumberSuffix)}}function ur(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"page-content",2),l.ac(2,"async"),l.Bc(3,or,2,2,"label-value",3),l.Lb(4,"label-value",4),l.Bc(5,lr,1,2,"label-value",5),l.Bc(6,br,1,0,"hr",1),l.Lb(7,"label-value",4),l.Bc(8,dr,4,6,"ng-container",1),l.Pb(),l.Nb()),2&e){const e=l.Zb();l.xb(1),l.gc("heading",e.i18n.ad.title.webshopSettings)("mobileHeading",e.i18n.ad.mobileTitle.webshopSettings)("headingActions",l.bc(2,11,e.headingActions$)),l.xb(2),l.gc("ngIf",!e.self),l.xb(1),l.gc("label",e.i18n.ad.productNumber)("value",e.data.productNumberGenerated?e.i18n.ad.generated:e.i18n.ad.manual),l.xb(1),l.gc("ngIf",!e.data.productNumberGenerated),l.xb(1),l.gc("ngIf",!e.data.productNumberGenerated||e.data.customOrderNumberFormat),l.xb(1),l.gc("label",e.i18n.ad.orderNumber)("value",e.data.customOrderNumberFormat?e.i18n.ad.manual:e.i18n.ad.generated),l.xb(1),l.gc("ngIf",e.data.customOrderNumberFormat)}}let mr=(()=>{class e extends vt.a{constructor(e,t){super(e),this.webshopSettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.webshopSettingsService.viewWebshopSettings({user:this.user}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=[];e.canEdit&&(t.push(new Re.c("edit",this.i18n.general.edit,()=>this.router.navigate(["/marketplace",this.user,"webshop-settings","edit"]),!0)),this.headingActions=t)}resolveMenu(e){return this.menu.userMenu(e.user,o.b.WEBSHOP_SETTINGS)}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(ir.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["view-webshop-settings"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],[3,"label","value",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,ur,9,13,"ng-container",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,m.a,g.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();var gr=i("xBqp"),fr=i("Ewue"),hr=i("AH7H"),pr=i("Kiu2"),vr=i("nznZ");function yr(e,t){if(1&e&&l.Lb(0,"profile-images",19),2&e){const e=l.Zb(2);l.gc("image",e.ad.image)("additionalImages",e.ad.additionalImages)}}function xr(e,t){if(1&e&&l.Lb(0,"profile-images",20),2&e){const e=l.Zb(2);l.gc("image",e.ad.image)("additionalImages",e.ad.additionalImages)}}function Pr(e,t){1&e&&(l.Ob(0),l.Dc(1," > "),l.Nb())}function Ir(e,t){if(1&e&&(l.Ob(0),l.Bc(1,Pr,2,0,"ng-container",13),l.Dc(2),l.Nb()),2&e){const e=t.$implicit,i=t.first;l.xb(1),l.gc("ngIf",!i),l.xb(1),l.Fc(" ",e.name," ")}}function Qr(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"div"),l.Bc(2,Ir,3,2,"ng-container",10),l.Pb(),l.Nb()),2&e){const e=t.$implicit,i=l.Zb(2);l.xb(2),l.gc("ngForOf",i.categoryLevels(e))}}function Dr(e,t){if(1&e&&(l.Qb(0,"label-value",9),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.general.status),l.xb(1),l.Fc(" ",e.status," ")}}function Sr(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"label-value",9),l.Qb(2,"span"),l.Dc(3),l.ac(4,"date"),l.Qb(5,"span",21),l.Dc(6," - "),l.Pb(),l.Dc(7),l.ac(8,"date"),l.Pb(),l.Pb(),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("label",e.i18n.ad.publicationPeriod),l.xb(2),l.Ec(l.bc(4,3,e.data.publicationPeriod.begin)),l.xb(4),l.Ec(l.bc(8,5,e.data.publicationPeriod.end))}}function kr(e,t){1&e&&l.Lb(0,"custom-field-value",22),2&e&&l.gc("fieldValue",t.$implicit)}function wr(e,t){if(1&e&&(l.Qb(0,"label-value",9),l.Dc(1),l.Pb()),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.stockQuantity),l.xb(1),l.Fc(" ",e.stock," ")}}function Cr(e,t){if(1&e&&(l.Qb(0,"label-value",9),l.Dc(1),l.Pb()),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.minAllowedInCart),l.xb(1),l.Fc(" ",e.formatStock(e.data.minAllowedInCart)," ")}}function Or(e,t){if(1&e&&(l.Qb(0,"label-value",9),l.Dc(1),l.Pb()),2&e){const e=l.Zb(3);l.gc("label",e.i18n.ad.maxAllowedInCart),l.xb(1),l.Fc(" ",e.formatStock(e.data.maxAllowedInCart)," ")}}function Fr(e,t){if(1&e&&(l.Ob(0),l.Bc(1,wr,2,2,"label-value",12),l.Bc(2,Cr,2,2,"label-value",12),l.Bc(3,Or,2,2,"label-value",12),l.Qb(4,"label-value",9),l.Dc(5),l.Pb(),l.Nb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("ngIf",!e.data.unlimitedStock),l.xb(1),l.gc("ngIf",e.data.minAllowedInCart),l.xb(1),l.gc("ngIf",e.data.maxAllowedInCart),l.xb(1),l.gc("label",e.i18n.ad.productNumber),l.xb(1),l.Fc(" ",e.data.productNumber," ")}}function Br(e,t){if(1&e&&(l.Ob(0),l.Dc(1),l.ac(2,"currency"),l.Qb(3,"span",25),l.Dc(4),l.ac(5,"currency"),l.Pb(),l.Nb()),2&e){const e=l.Zb(3);l.xb(1),l.Fc(" ",l.cc(2,2,e.ad.promotionalPrice,e.ad.currency)," "),l.xb(3),l.Fc(" ",l.cc(5,5,e.ad.price,e.ad.currency)," ")}}function Lr(e,t){if(1&e&&(l.Qb(0,"label-value",23),l.Bc(1,Br,6,8,"ng-container",24),l.Pb()),2&e){const e=l.Zb(2),t=l.qc(4);l.gc("label",e.i18n.ad.price),l.xb(1),l.gc("ngIf",e.ad.promotionalPrice)("ngIfElse",t)}}function Nr(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"h2",16),l.Dc(2),l.Pb(),l.Lb(3,"hr",17),l.Dc(4),l.Nb()),2&e){const e=l.Zb(2);l.xb(2),l.Fc(" ",e.i18n.ad.authorizationNotes," "),l.xb(2),l.Fc(" ",e.ad.lastAuthorizationComments," ")}}function Ar(e,t){if(1&e&&(l.Qb(0,"label-value",9),l.Dc(1),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(3);l.gc("label",t.i18n.ad.minDeliveryTime),l.xb(1),l.Fc(" ",t.format.formatTimeInterval(e.minDeliveryTime)," ")}}function Tr(e,t){if(1&e&&(l.Qb(0,"label-value",9),l.Dc(1),l.ac(2,"currency"),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(3);l.gc("label",t.i18n.ad.price),l.xb(1),l.Fc(" ",l.cc(2,2,e.chargeAmount,t.ad.currency)," ")}}function $r(e,t){if(1&e&&(l.Qb(0,"label-value",9),l.Dc(1),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(3);l.gc("label",t.i18n.general.description),l.xb(1),l.Fc(" ",e.description," ")}}const Zr=function(e){return{"pt-2":e}};function Er(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"h3",27),l.Dc(2),l.Pb(),l.Bc(3,Ar,2,2,"label-value",12),l.Qb(4,"label-value",9),l.Dc(5),l.Pb(),l.Bc(6,Tr,3,5,"label-value",12),l.Bc(7,$r,2,2,"label-value",12),l.Nb()),2&e){const e=t.$implicit,i=t.first,a=l.Zb(3);l.xb(1),l.gc("ngClass",l.jc(7,Zr,!i)),l.xb(1),l.Fc(" ",e.name," "),l.xb(1),l.gc("ngIf",e.minDeliveryTime),l.xb(1),l.gc("label",a.i18n.ad.maxDeliveryTime),l.xb(1),l.Fc(" ",a.format.formatTimeInterval(e.maxDeliveryTime)," "),l.xb(1),l.gc("ngIf",a.hasFixedDeliveryPrice(e)),l.xb(1),l.gc("ngIf",e.description)}}function Mr(e,t){if(1&e&&(l.Qb(0,"div"),l.Qb(1,"h2",26),l.Dc(2),l.Pb(),l.Bc(3,Er,8,9,"ng-container",10),l.Pb()),2&e){const e=l.Zb(2);l.xb(2),l.Fc(" ",e.i18n.ad.deliveryMethods," "),l.xb(1),l.gc("ngForOf",e.data.deliveryMethods)}}function Rr(e,t){if(1&e){const e=l.Rb();l.Qb(0,"div",39),l.Qb(1,"a",40),l.Xb("click",(function(t){l.sc(e);const i=l.Zb().$implicit;return l.Zb(3).removeQuestion(i.id),t.preventDefault()})),l.Lb(2,"icon",41),l.Pb(),l.Pb()}if(2&e){const e=l.Zb(4);l.xb(1),l.gc("tooltip",e.i18n.ad.removeQuestion)}}function Hr(e,t){if(1&e&&(l.Qb(0,"div",42),l.Qb(1,"div",31),l.Lb(2,"icon",43),l.Pb(),l.Qb(3,"div",33),l.Dc(4),l.Qb(5,"div",35),l.Dc(6),l.ac(7,"dateTime"),l.Pb(),l.Pb(),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(3);l.xb(4),l.Fc(" ",e.answer," "),l.xb(2),l.Gc(" ",t.data.owner.display," - ",l.bc(7,3,e.answerDate),"")}}function qr(e,t){1&e&&l.Lb(0,"hr",44)}function Gr(e,t){if(1&e&&(l.Ob(0),l.Qb(1,"div",30),l.Qb(2,"div",31),l.Lb(3,"icon",32),l.Pb(),l.Qb(4,"div",33),l.Qb(5,"span",34),l.Dc(6),l.Pb(),l.Qb(7,"div",35),l.Dc(8),l.ac(9,"dateTime"),l.Pb(),l.Pb(),l.Bc(10,Rr,3,1,"div",36),l.Pb(),l.Bc(11,Hr,8,5,"div",37),l.Bc(12,qr,1,0,"hr",38),l.Nb()),2&e){const e=t.$implicit,i=t.last,a=l.Zb(3);l.xb(6),l.Ec(e.question),l.xb(2),l.Gc("",e.user.display," - ",l.bc(9,6,e.questionDate),""),l.xb(2),l.gc("ngIf",a.canRemoveQuestion(e)),l.xb(1),l.gc("ngIf",e.answer),l.xb(1),l.gc("ngIf",!i)}}function Vr(e,t){if(1&e&&(l.Qb(0,"div"),l.Qb(1,"h2",28),l.Qb(2,"div",29),l.Dc(3),l.Pb(),l.Pb(),l.Bc(4,Gr,13,8,"ng-container",10),l.Pb()),2&e){const e=l.Zb(2);l.xb(3),l.Fc(" ",e.i18n.ad.questionsAndAnswers," "),l.xb(1),l.gc("ngForOf",e.data.questions)}}const jr=function(){return[]};function zr(e,t){if(1&e&&(l.Qb(0,"page-content",3),l.ac(1,"async"),l.Bc(2,yr,1,2,"profile-images",4),l.ac(3,"async"),l.Qb(4,"div",5),l.Bc(5,xr,1,2,"profile-images",6),l.ac(6,"async"),l.Qb(7,"div",7),l.Lb(8,"label-value",8),l.Qb(9,"label-value",9),l.Bc(10,Qr,3,1,"ng-container",10),l.Pb(),l.Qb(11,"label-value",9),l.Lb(12,"user-link",11),l.Pb(),l.Bc(13,Dr,2,2,"label-value",12),l.Bc(14,Sr,9,7,"ng-container",13),l.Bc(15,kr,1,1,"custom-field-value",14),l.Bc(16,Fr,6,5,"ng-container",13),l.Bc(17,Lr,2,3,"label-value",15),l.Pb(),l.Pb(),l.Bc(18,Nr,5,2,"ng-container",13),l.Qb(19,"h2",16),l.Dc(20),l.Pb(),l.Lb(21,"hr",17),l.Lb(22,"rich-text-container",18),l.Bc(23,Mr,4,2,"div",13),l.Bc(24,Vr,5,2,"div",13),l.Pb()),2&e){const e=l.Zb();l.gc("heading",e.title)("mobileHeading",e.i18n.ad.mobileTitle.details)("headingActions",l.bc(1,21,e.headingActions$)),l.xb(2),l.gc("ngIf",e.ad.image&&l.bc(3,23,e.layout.ltsm$)),l.xb(3),l.gc("ngIf",e.ad.image&&l.bc(6,25,e.layout.gtxs$)),l.xb(3),l.gc("label",e.i18n.ad.name)("value",e.ad.name),l.xb(1),l.gc("label",e.categoryLabel),l.xb(1),l.gc("ngForOf",e.ad.categories||l.ic(27,jr)),l.xb(1),l.gc("label",e.i18n.ad.owner),l.xb(1),l.gc("user",e.ad.owner),l.xb(1),l.gc("ngIf",e.status),l.xb(1),l.gc("ngIf",e.data.publicationPeriod),l.xb(1),l.gc("ngForOf",e.ad.customValues),l.xb(1),l.gc("ngIf",e.webshop),l.xb(1),l.gc("ngIf",e.ad.price),l.xb(1),l.gc("ngIf",e.data.lastAuthorizationComments),l.xb(2),l.Fc("",e.i18n.general.description," "),l.xb(2),l.gc("value",e.ad.description),l.xb(1),l.gc("ngIf",e.data.deliveryMethods&&e.data.deliveryMethods.length>0),l.xb(1),l.gc("ngIf",e.questionsEnabled)}}function Kr(e,t){if(1&e&&(l.Dc(0),l.ac(1,"currency")),2&e){const e=l.Zb();l.Fc(" ",l.cc(1,1,e.ad.price,e.ad.currency),"\n")}}let Ur=(()=>{class e extends vt.a{constructor(e,t,i,a,n,r,c,s){super(e),this.modal=t,this.operationHelper=i,this.loginService=a,this.adQuestionService=n,this.marketplaceHelper=r,this.marketplaceService=c,this.shoppingCartService=s}get ad(){return this.data}ngOnInit(){super.ngOnInit(),this.guest=null==this.loginService.user,this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.marketplaceService.viewAd({ad:this.id}).subscribe(e=>{this.data=e}))}doRemove(){this.addSub(this.marketplaceService.deleteAd({ad:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(this.ad.name)),history.back()}))}updateStatus(e,t,i){this.addSub(e.subscribe(()=>{this.notification.snackBar(t),i&&this.dataForUiHolder.role===C.kb.BROKER&&!this.authHelper.isSelfOrOwner(this.data.user)||this.dataForUiHolder.role===C.kb.ADMINISTRATOR?history.back():this.reload(),this.reload()}))}addToCart(){this.addSub(this.shoppingCartService.addItemToShoppingCart({ad:this.ad.id}).subscribe(e=>{this.notification.snackBar(e===this.marketplaceHelper.cartItems?this.i18n.ad.addedProductAlreadyInCart:this.i18n.ad.addedProduct),this.marketplaceHelper.cartItems=e}))}onDataInitialized(e){this.webshop=e.kind===C.c.WEBSHOP,this.hasStatus=!this.guest&&(this.authHelper.isSelfOrOwner(e.user)||this.dataForUiHolder.role===C.kb.ADMINISTRATOR||this.dataForUiHolder.role===C.kb.BROKER);const t=[];if(e.canEdit){const e=new Re.c("edit",this.i18n.general.edit,()=>{this.router.navigate(["/marketplace","edit",this.id])},!0);t.push(e)}e.canBuy&&t.push(new Re.c("add_shopping_cart",this.i18n.ad.addToCart,()=>this.addToCart())),e.canAsk&&t.push(new Re.c("chat",this.i18n.ad.askQuestion,()=>this.ask())),e.canHide&&t.push(new Re.c("lock",this.i18n.ad.hide,()=>this.updateStatus(this.marketplaceService.hideAd({ad:this.id}),this.i18n.ad.adHidden))),e.canUnhide&&t.push(new Re.c("public",this.i18n.ad.unhide,()=>this.updateStatus(this.marketplaceService.unhideAd({ad:this.id}),this.i18n.ad.adUnhidden))),e.canRequestAuthorization&&t.push(new Re.c("gavel",this.i18n.ad.submitForAuthorization,()=>this.updateStatus(this.marketplaceService.submitAdForAuthorization({ad:this.id}),this.i18n.ad.pendingForAuth))),e.canSetAsDraft&&t.push(new Re.c("edit",this.i18n.ad.setAsDraft,()=>this.updateStatus(this.marketplaceService.setAdAsDraft({ad:this.id}),this.i18n.ad.backToDraft,!0))),e.canApprove&&t.push(new Re.c("thumb_up_alt",this.i18n.ad.authorize,()=>this.updateStatus(this.marketplaceService.approveAd({ad:this.id}),this.i18n.ad.authorized))),e.canReject&&t.push(new Re.c("thumb_down_alt",this.i18n.ad.reject,()=>this.reject())),e.canRemove&&t.push(new Re.c("clear",this.i18n.general.remove,()=>{this.notification.confirm({message:this.i18n.general.removeConfirm(this.ad.name),callback:()=>this.doRemove()})})),this.exportHelper.headingActions(e.exportFormats,t=>this.marketplaceService.exportAd$Response({format:t.internalName,ad:e.id})).forEach(e=>t.push(e));for(const i of e.operations||[])t.push(this.operationHelper.headingAction(i,e.id));this.headingActions=t,this.title=Object(s.G)(e.name,60)}reject(){const e=this.modal.show(gr.a,{class:"modal-form",initialState:{title:this.i18n.ad.reject}});this.addSub(e.content.done.subscribe(e=>{this.updateStatus(this.marketplaceService.rejectAd({ad:this.id,body:e}),this.i18n.ad.rejected,!0)}))}get categoryLabel(){return 1===(this.ad.categories||[]).length?this.i18n.ad.category:this.i18n.ad.categories}get status(){return this.ad.status?this.marketplaceHelper.resolveStatusLabel(this.ad.status):null}get stock(){return this.data.unlimitedStock?"":0===(+this.data.stockQuantity||0)?this.i18n.ad.outOfStock:this.formatStock(this.data.stockQuantity)}get questionsEnabled(){return!this.guest&&this.data.questionsEnabled&&this.data.questions.length>0}canRemoveQuestion(e){return!this.guest&&(this.dataForUiHolder.role===C.kb.ADMINISTRATOR?this.data.canEdit:!!(this.dataForUiHolder.role===C.kb.BROKER||this.authHelper.isSelfOrOwner(this.data.user)||this.authHelper.isSelfOrOwner(e.user)&&this.dataForUiHolder.role!==C.kb.OPERATOR)&&this.data.canEdit&&Object(s.h)(e.answer))}hasFixedDeliveryPrice(e){return e.chargeType===C.q.FIXED}formatStock(e){return this.format.numberToFixed(e,this.data.allowDecimal?2:0)||""}categoryLevels(e){const t=[];for(;null!=e;)t.unshift(e),e=e.parent;return t}ask(){const e=this.modal.show(gr.a,{class:"modal-form",initialState:{title:this.i18n.ad.askQuestion}});this.addSub(e.content.done.subscribe(e=>{Object(s.h)(e)||this.addSub(this.adQuestionService.createAdQuestion({ad:this.id,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.questionAsked),this.reload()}))}))}resolveMenu(){return o.b.SEARCH_ADS}removeQuestion(e){this.addSub(this.adQuestionService.deleteAdQuestion({id:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.questionRemoved),this.reload()}))}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Ot.b),l.Kb(fr.a),l.Kb(ha.a),l.Kb(r.a),l.Kb(B.a),l.Kb(kt.a),l.Kb(O.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["view-ad"]],features:[l.ub],decls:5,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["plainPrice",""],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"image","additionalImages",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["icon","shopping_basket",3,"image","additionalImages",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label","value"],[3,"label"],[4,"ngFor","ngForOf"],[3,"user"],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["class","totalAmount",3,"label",4,"ngIf"],[1,"d-none","d-sm-block","my-ls","pt-ls"],[1,"d-block","d-sm-none"],["autoHeight","",3,"value"],[3,"image","additionalImages"],["icon","shopping_basket",3,"image","additionalImages"],[1,"d-inline","pl-2","pr-2"],[3,"fieldValue"],[1,"totalAmount",3,"label"],[4,"ngIf","ngIfElse"],[1,"promo-price"],[1,"mt-3"],[3,"ngClass"],[1,"d-flex","mb-ls","flex-column","flex-xs-row","justify-content-between","mt-ls"],[1,"mb-2","mb-xs-0"],[1,"d-flex","flex-row","pb-1"],[1,"d-flex"],["size","1rem","icon","chat"],[1,"pl-2",2,"line-height","1rem"],[1,"font-weight-bold"],[2,"font-size","0.6rem"],["class","d-flex","style","margin-left: auto",4,"ngIf"],["class","d-flex flex-row pb-1 pt-1",4,"ngIf"],["class","inner-separator pb-1",4,"ngIf"],[1,"d-flex",2,"margin-left","auto"],["href","#",1,"icon",3,"tooltip","click"],["size","1rem","icon","delete"],[1,"d-flex","flex-row","pb-1","pt-1"],["size","1rem","icon","comment"],[1,"inner-separator","pb-1"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,zr,25,28,"page-content",1),l.Pb(),l.Bc(3,Kr,2,4,"ng-template",null,2,l.Cc)),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,m.a,d.s,g.a,hr.a,pr.a,vr.a,d.q,j.a,V.b],pipes:[d.b,$t.a,K.a,y.a],encapsulation:2,changeDetection:0}),e})();function Xr(e,t){1&e&&l.Mb(0)}function _r(e,t){if(1&e&&(l.Qb(0,"label-value",8),l.Lb(1,"user-link",9),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.seller),l.xb(1),l.gc("user",e.data.seller)}}function Wr(e,t){if(1&e&&(l.Qb(0,"label-value",8),l.Lb(1,"user-link",9),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.buyer),l.xb(1),l.gc("user",e.data.buyer)}}function Yr(e,t){if(1&e&&(l.Qb(0,"mobile-result"),l.Qb(1,"div",10),l.Dc(2),l.Pb(),l.Qb(3,"div",11),l.Dc(4),l.ac(5,"dateTime"),l.Pb(),l.Qb(6,"div",12),l.Dc(7),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(2);l.xb(2),l.Fc(" ",i.resolveStatusLabel(e.status)," "),l.xb(2),l.Fc(" ",l.bc(5,4,e.date)," "),l.xb(3),l.Gc(" ",i.i18n.general.by," ",e.by.shortDisplay," ")}}function Jr(e,t){if(1&e&&(l.Qb(0,"tr"),l.Qb(1,"td"),l.Dc(2),l.ac(3,"dateTime"),l.Pb(),l.Qb(4,"td"),l.Dc(5),l.Pb(),l.Qb(6,"td"),l.Dc(7),l.Pb(),l.Qb(8,"td"),l.Dc(9),l.Pb(),l.Pb()),2&e){const e=t.$implicit,i=l.Zb(3);l.xb(2),l.Ec(l.bc(3,4,e.date)),l.xb(3),l.Ec(i.resolveStatusLabel(e.status)),l.xb(2),l.Ec(e.by.shortDisplay),l.xb(2),l.Ec(e.remarks)}}function ec(e,t){if(1&e&&(l.Qb(0,"table",13),l.Qb(1,"thead"),l.Qb(2,"th"),l.Dc(3),l.Pb(),l.Qb(4,"th"),l.Dc(5),l.Pb(),l.Qb(6,"th"),l.Dc(7),l.Pb(),l.Qb(8,"th"),l.Dc(9),l.Pb(),l.Pb(),l.Qb(10,"tbody"),l.Bc(11,Jr,10,6,"tr",14),l.Pb(),l.Pb()),2&e){const e=l.Zb(2);l.xb(3),l.Ec(e.i18n.general.date),l.xb(2),l.Ec(e.i18n.general.status),l.xb(2),l.Ec(e.i18n.general.by),l.xb(2),l.Ec(e.i18n.ad.remarks),l.xb(2),l.gc("ngForOf",e.data.history)}}function tc(e,t){if(1&e&&(l.Qb(0,"page-content",3),l.Bc(1,_r,2,2,"label-value",4),l.Bc(2,Wr,2,2,"label-value",4),l.Pb(),l.Qb(3,"results-layout",5),l.Bc(4,Yr,8,6,"mobile-result",6),l.Bc(5,ec,12,5,"table",7),l.Pb()),2&e){const e=l.Zb();l.gc("heading",e.i18n.ad.title.history)("mobileHeading",e.i18n.ad.mobileTitle.history),l.xb(1),l.gc("ngIf",!e.seller),l.xb(1),l.gc("ngIf",!e.buyer),l.xb(1),l.gc("results",e.data.history)("onClick",e.onClick)}}let ic=(()=>{class e extends vt.a{constructor(e,t,i){super(e),this.marketplaceHelper=t,this.orderService=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.orderService.viewOrder({order:this.id,fields:["seller","buyer","history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.seller=this.authHelper.isSelfOrOwner(e.seller),this.buyer=!this.seller&&this.authHelper.isSelfOrOwner(e.buyer)}get onClick(){return e=>null!=e}resolveStatusLabel(e){return this.marketplaceHelper.resolveOrderStatusLabel(e)}resolveMenu(){return this.buyer?o.b.PURCHASES:this.seller?o.b.SALES:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(B.a),l.Kb(Hi.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["view-order-history"]],features:[l.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"label",4,"ngIf"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"label"],[3,"user"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Xr,1,0,"ng-container",1),l.Pb(),l.Bc(3,tc,6,6,"ng-template",null,2,l.Cc)),2&e){const e=l.qc(4);l.gc("ready",l.bc(1,3,t.data$)),l.xb(2),l.gc("ngIf",t.data)("ngIfThen",e)}},directives:[b.a,d.t,u.a,R.a,H.a,q.a,m.a,g.a,G.a,d.s],pipes:[d.b,y.a],encapsulation:2,changeDetection:0}),e})();function ac(e,t){if(1&e&&l.Lb(0,"input-field",9),2&e){const e=l.Zb();l.gc("label",e.i18n.general.name)}}let nc=(()=>{class e extends E.a{constructor(e,t){super(e),this.modalRef=t,this.done=new l.n}ngOnInit(){this.form=this.formBuilder.group({name:[this.name,n.G.required],chargeAmount:[this.chargeAmount,n.G.required],minTime:this.minTime,maxTime:[this.maxTime,n.G.required],remarks:""})}submit(){this.done.emit(this.form.value),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Ot.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["set-delivery-method"]],inputs:{name:"name",chargeAmount:"chargeAmount",minTime:"minTime",maxTime:"maxTime",currency:"currency"},outputs:{done:"done"},features:[l.ub],decls:12,vars:15,consts:[[3,"formGroup"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","chargeAmount","fieldSize","full","required","",3,"label","scale","prefix","suffix"],["formControlName","minTime",3,"label"],["formControlName","maxTime","required","",3,"label"],["formControlName","remarks",3,"label"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action"],["formControlName","name","required","",3,"label"]],template:function(e,t){1&e&&(l.Qb(0,"h1"),l.Dc(1),l.Pb(),l.Qb(2,"form",0),l.Bc(3,ac,1,1,"input-field",1),l.Lb(4,"decimal-field",2),l.Lb(5,"time-interval-field",3),l.Lb(6,"time-interval-field",4),l.Lb(7,"textarea-field",5),l.Pb(),l.Qb(8,"actions",6),l.Qb(9,"action-button",7),l.Xb("action",(function(){return t.submit()})),l.ac(10,"async"),l.Pb(),l.Qb(11,"action-button",8),l.Xb("action",(function(){return t.modalRef.hide()})),l.Pb(),l.Pb()),2&e&&(l.xb(1),l.Ec(t.i18n.ad.deliveryMethod),l.xb(1),l.gc("formGroup",t.form),l.xb(1),l.gc("ngIf",!t.name),l.xb(1),l.gc("label",t.i18n.ad.deliveryPrice)("scale",t.currency.decimalDigits)("prefix",t.currency.prefix)("suffix",t.currency.suffix),l.xb(1),l.gc("label",t.i18n.ad.minDeliveryTime),l.xb(1),l.gc("label",t.i18n.ad.maxDeliveryTime),l.xb(1),l.gc("label",t.i18n.ad.remarks),l.xb(2),l.gc("disabled",l.bc(10,13,t.requesting$))("label",t.i18n.general.submit),l.xb(2),l.gc("label",t.i18n.general.cancel))},directives:[n.I,n.w,n.n,d.t,z.a,n.v,n.l,n.D,Ye.a,h.a,p.a,v.a,_e.a],pipes:[d.b],encapsulation:2,changeDetection:0}),e})();var rc=i("UnhA");function cc(e,t){if(1&e&&(l.Qb(0,"div",28),l.Lb(1,"avatar",29),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("roundBorders",!1)("zoom",!1)("image",e.data.image)}}function sc(e,t){if(1&e&&(l.Qb(0,"div",30),l.Lb(1,"avatar",29),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.gc("roundBorders",!1)("zoom",!1)("image",e.data.image)}}function oc(e,t){if(1&e&&(l.Qb(0,"label-value",7),l.Lb(1,"user-link",31),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.seller),l.xb(1),l.gc("user",e.data.seller)}}function lc(e,t){if(1&e&&(l.Qb(0,"label-value",7),l.Lb(1,"user-link",31),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.buyer),l.xb(1),l.gc("user",e.data.buyer)}}function bc(e,t){if(1&e&&(l.Qb(0,"label-value",7),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.remarks),l.xb(1),l.Fc(" ",e.data.remarks," ")}}function dc(e,t){if(1&e&&(l.Qb(0,"th",12),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",e.i18n.ad.number,"")}}function uc(e,t){if(1&e&&(l.Qb(0,"th",14),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc(" ",e.i18n.ad.unitPrice," ")}}function mc(e,t){if(1&e&&(l.Qb(0,"td"),l.Dc(1),l.Pb()),2&e){const e=l.Zb().$implicit;l.xb(1),l.Fc("",e.product.productNumber," ")}}function gc(e,t){if(1&e&&(l.Qb(0,"td",19),l.Dc(1),l.ac(2,"currency"),l.Pb()),2&e){const e=l.Zb().$implicit,t=l.Zb(2);l.xb(1),l.Fc(" ",l.cc(2,1,e.price,t.data.currency),"")}}function fc(e,t){if(1&e){const e=l.Rb();l.Qb(0,"tr",32),l.Xb("click",(function(){l.sc(e);const i=t.$implicit,a=l.Zb(2);return a.router.navigate(a.path(i))})),l.Bc(1,mc,2,1,"td",33),l.ac(2,"async"),l.Qb(3,"td",34),l.Dc(4),l.Pb(),l.Qb(5,"td"),l.Dc(6),l.Pb(),l.Bc(7,gc,3,4,"td",35),l.ac(8,"async"),l.Qb(9,"td",19),l.Dc(10),l.ac(11,"currency"),l.Pb(),l.Pb()}if(2&e){const e=t.$implicit,i=l.Zb(2);l.xb(1),l.gc("ngIf",l.bc(2,5,i.layout.gtxs$)),l.xb(3),l.Ec(e.product.name),l.xb(2),l.Ec(e.quantity),l.xb(1),l.gc("ngIf",l.bc(8,7,i.layout.gtxs$)),l.xb(3),l.Fc(" ",l.cc(11,9,e.totalPrice,i.data.currency)," ")}}function hc(e,t){if(1&e&&(l.Qb(0,"label-value",7),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.minDeliveryTime),l.xb(1),l.Fc(" ",e.format.formatTimeInterval(e.data.minDeliveryTime)," ")}}function pc(e,t){if(1&e&&(l.Qb(0,"label-value",7),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.maxDeliveryTime),l.xb(1),l.Fc(" ",e.format.formatTimeInterval(e.data.maxDeliveryTime)," ")}}function vc(e,t){if(1&e&&(l.Qb(0,"label-value",7),l.Dc(1),l.ac(2,"currency"),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.price),l.xb(1),l.Fc(" ",l.cc(2,2,e.data.deliveryPrice,e.data.currency)," ")}}function yc(e,t){if(1&e&&(l.Qb(0,"label-value",36),l.Lb(1,"address-details",37),l.Pb()),2&e){const e=l.Zb(2);l.gc("label",e.i18n.ad.deliveryAddress),l.xb(1),l.gc("address",e.data.deliveryAddress)}}function xc(e,t){if(1&e&&(l.Qb(0,"h2",23),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.Fc("",e.i18n.ad.remarks," ")}}function Pc(e,t){if(1&e&&(l.Qb(0,"label",38),l.Dc(1),l.Pb()),2&e){const e=l.Zb(2);l.xb(1),l.Ec(e.remarks)}}const Ic=function(e){return{"mt-4":e}};function Qc(e,t){if(1&e&&(l.Qb(0,"form",39),l.Lb(1,"textarea-field",40),l.Pb()),2&e){const e=l.Zb(2);l.gc("ngClass",l.jc(2,Ic,e.remarks))("formGroup",e.form)}}function Dc(e,t){if(1&e&&(l.Qb(0,"page-content",2),l.ac(1,"async"),l.Bc(2,cc,2,3,"div",3),l.ac(3,"async"),l.Qb(4,"div",4),l.Bc(5,sc,2,3,"div",5),l.ac(6,"async"),l.Qb(7,"div",6),l.Qb(8,"label-value",7),l.Dc(9),l.Pb(),l.Qb(10,"label-value",7),l.Dc(11),l.ac(12,"dateTime"),l.Pb(),l.Qb(13,"label-value",7),l.Dc(14),l.Pb(),l.Bc(15,oc,2,2,"label-value",8),l.Bc(16,lc,2,2,"label-value",8),l.Bc(17,bc,2,2,"label-value",8),l.Pb(),l.Pb(),l.Qb(18,"h2",9),l.Dc(19),l.Pb(),l.Qb(20,"table",10),l.Qb(21,"thead"),l.Bc(22,dc,2,1,"th",11),l.ac(23,"async"),l.Qb(24,"th",12),l.Dc(25),l.Pb(),l.Qb(26,"th",12),l.Dc(27),l.Pb(),l.Bc(28,uc,2,1,"th",13),l.ac(29,"async"),l.Qb(30,"th",14),l.Dc(31),l.Pb(),l.Pb(),l.Qb(32,"tbody"),l.Bc(33,fc,12,12,"tr",15),l.Qb(34,"tr",16),l.Qb(35,"td",17),l.ac(36,"async"),l.Dc(37),l.Pb(),l.Qb(38,"td",18),l.Dc(39),l.ac(40,"currency"),l.Pb(),l.Pb(),l.Qb(41,"tr",16),l.Qb(42,"td"),l.ac(43,"async"),l.Dc(44),l.Pb(),l.Qb(45,"td",19),l.Dc(46),l.ac(47,"currency"),l.Pb(),l.Pb(),l.Qb(48,"tr",20),l.Qb(49,"td",21),l.ac(50,"async"),l.Dc(51),l.Pb(),l.Qb(52,"td",22),l.Dc(53),l.ac(54,"currency"),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(55,"h2",23),l.Dc(56),l.Pb(),l.Bc(57,hc,2,2,"label-value",8),l.Bc(58,pc,2,2,"label-value",8),l.Bc(59,vc,3,5,"label-value",8),l.Bc(60,yc,2,2,"label-value",24),l.Bc(61,xc,2,1,"h2",25),l.Bc(62,Pc,2,1,"label",26),l.Bc(63,Qc,2,4,"form",27),l.Pb()),2&e){const e=l.Zb();l.gc("heading",e.i18n.ad.title.order)("mobileHeading",e.i18n.ad.mobileTitle.order)("headingActions",l.bc(1,38,e.headingActions$)),l.xb(2),l.gc("ngIf",e.data.image&&l.bc(3,40,e.layout.ltsm$)),l.xb(3),l.gc("ngIf",e.data.image&&l.bc(6,42,e.layout.gtxs$)),l.xb(3),l.gc("label",e.i18n.ad.order),l.xb(1),l.Fc(" ",e.data.number," "),l.xb(1),l.gc("label",e.i18n.general.date),l.xb(1),l.Fc(" ",l.bc(12,44,e.data.creationDate)," "),l.xb(2),l.gc("label",e.i18n.general.status),l.xb(1),l.Fc(" ",e.resolveStatusLabel()," "),l.xb(1),l.gc("ngIf",!e.seller),l.xb(1),l.gc("ngIf",!e.buyer),l.xb(1),l.gc("ngIf",e.data.remarks),l.xb(2),l.Fc("",e.i18n.ad.products," "),l.xb(3),l.gc("ngIf",l.bc(23,46,e.layout.gtxs$)),l.xb(3),l.Ec(e.i18n.ad.product),l.xb(2),l.Ec(e.i18n.ad.quantity),l.xb(1),l.gc("ngIf",l.bc(29,48,e.layout.gtxs$)),l.xb(3),l.Fc("",e.i18n.transaction.amount," "),l.xb(2),l.gc("ngForOf",e.data.items),l.xb(2),l.yb("colspan",l.bc(36,50,e.layout.gtxs$)?4:2),l.xb(2),l.Fc(" ",e.i18n.ad.subtotal,""),l.xb(2),l.Fc(" ",l.cc(40,52,e.subtotal,e.data.currency),""),l.xb(3),l.yb("colspan",l.bc(43,55,e.layout.gtxs$)?4:2),l.xb(2),l.Fc(" ",e.i18n.ad.deliveryMethod+": "+e.resolveDeliveryLabel()," "),l.xb(2),l.Fc(" ",l.cc(47,57,e.data.deliveryPrice,e.data.currency),""),l.xb(3),l.yb("colspan",l.bc(50,60,e.layout.gtxs$)?4:2),l.xb(2),l.Fc(" ",e.i18n.ad.total,""),l.xb(2),l.Fc(" ",l.cc(54,62,e.data.totalPrice,e.data.currency),""),l.xb(3),l.Ec(e.i18n.ad.deliveryInformation),l.xb(1),l.gc("ngIf",e.data.minDeliveryTime),l.xb(1),l.gc("ngIf",e.data.maxDeliveryTime),l.xb(1),l.gc("ngIf",e.data.deliveryPrice),l.xb(1),l.gc("ngIf",e.hasAddressFields),l.xb(1),l.gc("ngIf",e.remarks||e.canSetRemarks),l.xb(1),l.gc("ngIf",e.remarks),l.xb(1),l.gc("ngIf",e.canSetRemarks)}}const Sc=[{path:"",children:[{path:"search",component:Ln},{path:":user/:kind/list",component:tr},{path:":user/purchases",component:Hn},{path:":user/sales",component:Hn},{path:"sale/:id",component:fa},{path:":user/sale/new",component:fa},{path:":user/:kind/ad/new",component:di},{path:"view/:id",component:Ur},{path:"edit/:id",component:di},{path:"order/:id",component:(()=>{class e extends vt.a{constructor(e,t,i,a,n){super(e),this.modal=t,this.marketplaceHelper=i,this.addressHelper=a,this.orderService=n,this.OrderStatusEnum=C.Q}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.orderService.viewOrder({order:this.id,fields:["-history"]}).subscribe(e=>this.data=e))}onDataInitialized(e){this.seller=this.authHelper.isSelfOrOwner(e.seller),this.buyer=!this.seller&&this.authHelper.isSelfOrOwner(e.buyer),this.form=this.formBuilder.group({remarks:null});const t=[];(e.canAccept||e.canSetDeliveryInformation)&&t.push(new Re.c("done",e.canSetDeliveryInformation?this.i18n.ad.setDeliveryMethod:this.i18n.ad.accept,()=>this.accept())),e.canReject&&t.push(new Re.c("clear",this.i18n.ad.reject,()=>this.reject())),e.history&&t.push(new Re.c("history",this.i18n.general.viewHistory,()=>this.router.navigate(["/marketplace","order",this.id,"history"]))),this.exportHelper.headingActions(e.exportFormats,t=>this.orderService.exportOrder$Response({format:t.internalName,order:e.id})).forEach(e=>t.push(e)),this.headingActions=t}path(e){return["/marketplace","view",e.product.id]}resolveStatusLabel(){return this.marketplaceHelper.resolveOrderStatusLabel(this.data.status)}resolveDeliveryLabel(){const e=(this.data.deliveryMethod||{}).name;return Object(s.h)(e)?this.i18n.ad.toBeConfirmedBySeller:e}resolveMenu(){return this.buyer?o.b.PURCHASES:this.seller?o.b.SALES:this.menu.searchUsersMenu()}orderDeviceConfirmation(e){return()=>({type:e,order:this.id})}orderFields(e){const t=[];return e&&!Object(s.h)(e.paymentTypes)&&e.paymentTypes.length>1&&t.push({internalName:"paymentType",name:this.i18n.transaction.type,type:C.p.SINGLE_SELECTION,control:C.n.RADIO,hasValuesList:!0,defaultValue:e.paymentTypes[0].id,possibleValues:e.paymentTypes.map(e=>({id:e.id,value:e.name})),required:!0}),t.push({internalName:"remarks",name:this.i18n.ad.remarks,type:C.p.TEXT}),t}acceptByBuyer(){this.addSub(this.orderService.getOrderDataForAcceptByBuyer({order:this.id}).subscribe(e=>{this.notification.confirm({title:this.i18n.ad.acceptOrder,labelPosition:"above",customFields:this.orderFields(e),passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.orderDeviceConfirmation(C.s.ACCEPT_ORDER),callback:t=>{this.addSub(this.orderService.acceptOrderByBuyer({order:this.id,confirmationPassword:t.confirmationPassword,body:{remarks:t.customValues.remarks,paymentType:t.customValues.paymentType||(Object(s.h)(e.paymentTypes)?null:e.paymentTypes[0].id)}}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderAccepted),this.reload()}))}})}))}acceptBySeller(){this.addSub(this.orderService.acceptOrderBySeller({order:this.id,body:this.form.value}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderAccepted),this.reload()}))}setDeliveryMethod(){const e=this.data.deliveryMethod||{},t=this.modal.show(nc,{class:"modal-form",initialState:{title:this.i18n.ad.deliveryMethod,name:e.name,chargeAmount:e.price,minTime:e.minTime,maxTime:e.maxTime,currency:this.data.currency}});this.addSub(t.content.done.subscribe(e=>{this.orderService.setDeliveryMethod({order:this.id,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderAccepted),this.reload()})}))}accept(){this.data.status===C.Q.PENDING_BUYER?this.acceptByBuyer():this.data.status===C.Q.PENDING_SELLER&&(this.data.canSetDeliveryInformation?this.setDeliveryMethod():this.acceptBySeller())}reject(){this.notification.confirm({title:this.i18n.ad.rejectOrder,labelPosition:"above",customFields:this.orderFields(),callback:e=>{this.addSub(this.orderService.rejectOrder({order:this.id,body:{remarks:e.customValues.remarks}}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderRejected),this.reload()}))}})}get hasAddressFields(){return this.addressHelper.hasFields(this.data.deliveryAddress)}get subtotal(){let e=0;return this.data.items.forEach(t=>e+=+t.totalPrice),e}get remarks(){return this.data.remarks?this.data.remarks:null}get canSetRemarks(){return this.data.status===C.Q.PENDING_SELLER&&this.seller&&this.data.canAccept}}return e.\u0275fac=function(t){return new(t||e)(l.Kb(l.r),l.Kb(Ot.b),l.Kb(B.a),l.Kb(F.a),l.Kb(Hi.a))},e.\u0275cmp=l.Eb({type:e,selectors:[["view-order"]],features:[l.ub],decls:3,vars:4,consts:[[3,"ready"],["mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["class","d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["class","image ml-4",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label"],[3,"label",4,"ngIf"],[1,"mt-4","mb-2"],[1,"table","table-hover","small-height"],["class","no-border",4,"ngIf"],[1,"no-border"],["class","no-border text-right",4,"ngIf"],[1,"no-border","text-right"],["class","cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"no-hover"],[1,"table-head-color"],[1,"table-head-color","text-right"],[1,"text-right"],[1,"totalAmount","no-hover"],[1,"border-bottom-0","label","label-value-label"],[1,"border-bottom-0","text-right","label-value-value"],[1,"mb-2"],["class","align-items-baseline",3,"label",4,"ngIf"],["class","mb-2",4,"ngIf"],["class","any-label-value",4,"ngIf"],[3,"ngClass","formGroup",4,"ngIf"],[1,"d-flex","justify-content-center","mt-2","mb-4"],["size","140","useLightbox","",3,"roundBorders","zoom","image"],[1,"image","ml-4"],[3,"user"],[1,"cursor-pointer",3,"click"],[4,"ngIf"],[1,"link"],["class","text-right",4,"ngIf"],[1,"align-items-baseline",3,"label"],[3,"address"],[1,"any-label-value"],[3,"ngClass","formGroup"],["formControlName","remarks"]],template:function(e,t){1&e&&(l.Qb(0,"page-layout",0),l.ac(1,"async"),l.Bc(2,Dc,64,65,"page-content",1),l.Pb()),2&e&&(l.gc("ready",l.bc(1,2,t.data$)),l.xb(2),l.gc("ngIf",t.data))},directives:[b.a,d.t,u.a,m.a,d.s,f.a,g.a,rc.a,n.I,n.w,d.q,n.n,h.a,n.v,n.l],pipes:[d.b,y.a,K.a],encapsulation:2,changeDetection:0}),e})()},{path:"order/:id/history",component:ic},{path:"shopping-cart",component:Ee},{path:"cart/:id",component:Ue},{path:"checkout/:id",component:Be},{path:":user/delivery-methods",component:pt},{path:":user/ad-interests",component:Bi},{path:"delivery-methods/view/:id",component:Dt},{path:"ad-interests/view/:id",component:Ri},{path:"delivery-methods/edit/:id",component:ct},{path:":user/delivery-methods/new",component:ct},{path:":user/ad-interests/new",component:Ii},{path:"ad-interests/edit/:id",component:Ii},{path:":user/webshop-settings/view",component:mr},{path:":user/webshop-settings/edit",component:sr},{path:"unanswered-questions",component:Kn},{path:"unanswered-questions/view/:id",component:w}]}];let kc=(()=>{class e{}return e.\u0275mod=l.Ib({type:e}),e.\u0275inj=l.Hb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(Sc)],a.i]}),e})();var wc=i("Se2V");let Cc=(()=>{class e{}return e.\u0275mod=l.Ib({type:e}),e.\u0275inj=l.Hb({factory:function(t){return new(t||e)},imports:[[kc,wc.a]]}),e})()}}]);